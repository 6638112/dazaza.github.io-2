<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>漏洞允许Chrome，Firefox，Safari和Tor中的跨浏览器跟踪 Vulnerability allows cross-browser tracking in Chrome, Firefox, Safari, and Tor</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Vulnerability allows cross-browser tracking in Chrome, Firefox, Safari, and Tor<br/>漏洞允许Chrome，Firefox，Safari和Tor中的跨浏览器跟踪 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-05-14 04:14:11</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/5/6ada50584425a126e1a19fbf243f6a53.png"><img src="http://img2.diglog.com/img/2021/5/6ada50584425a126e1a19fbf243f6a53.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>In this article we introduce a scheme flooding vulnerability, explain how the exploit works across four major desktop browsers and show why it&#39;s a threat to anonymous browsing.</p><p>在本文中，我们介绍了一个计划泛滥漏洞，解释了漏洞利用如何在四个主要的桌面浏览器上工作，并显示为什么它＆＃39;对匿名浏览的威胁。</p><p>  DISCLAIMER: FingerprintJS does not use this vulnerability in our products and does not provide third-party tracking services. We focus on stopping fraud and support modern privacy trends for removing third-party tracking entirely. We believe that vulnerabilities like this one should be discussed in the open to help browsers fix them as quickly as possible. To help fix it, we have submitted bug reports to all affected browsers, created a live demo and have made a  public source code repository available to all.</p><p>  免责声明：FingerPrintJS不在我们的产品中使用此漏洞，并不提供第三方跟踪服务。我们专注于阻止欺诈，并支持完全删除第三方跟踪的现代隐私趋势。我们认为，应该在开放中讨论这样一个这样的漏洞，以帮助浏览器尽快修复它们。为了帮助解决它，我们已将错误报告提交给所有受影响的浏览器，创建了一个直播演示，并为所有人提供了公共源代码存储库。</p><p>   In our research into anti-fraud techniques, we have discovered a vulnerability that allows websites to identify users reliably across different desktop browsers and link their identities together. The desktop versions of Tor Browser, Safari, Chrome, and Firefox are all affected.</p><p>   在我们对防欺诈技术的研究中，我们发现了一种漏洞，允许网站在不同的桌面浏览器上可靠地识别用户，并将其身份链接在一起。 Tor浏览器，Safari，Chrome和Firefox的桌面版本都受到影响。</p><p> We will be referring to this vulnerability as scheme flooding, as it uses custom URL schemes as an attack vector. The vulnerability uses information about installed apps on your computer in order to assign you a permanent unique identifier even if you switch browsers, use incognito mode, or use a VPN.</p><p> 我们将通过作为方案泛滥的此漏洞引用，因为它使用自定义URL方案作为攻击向量。该漏洞使用计算机上已安装应用程序的信息，以便为您切换浏览器，使用隐姓埋名模式或使用VPN来为您分配永久唯一标识符。</p><p>  The scheme flooding vulnerability allows for third party tracking across different browsers and thus is a violation of privacy.</p><p>  该计划泛洪漏洞允许跨不同浏览器的第三方跟踪，因此违反了隐私。</p><p>  Cross-browser anonymity is something that even a privacy conscious internet user may take for granted. Tor Browser is known to offer the ultimate in privacy protection, though due to its slow connection speed and performance issues on some websites, users may rely on less anonymous browsers for their every day surfing. They may use Safari, Firefox or Chrome for some sites, and Tor for sites where they want to stay anonymous. A website exploiting the scheme flooding vulnerability could create a stable and unique identifier that can link those browsing identities together.</p><p>  跨浏览器匿名是一种隐私有意识的互联网用户可能被视为理所当然的东西。众所周知，Tor浏览器提供了最终的隐私保护，尽管由于某些网站上的连接速度和性能问题慢，但用户可以依赖于他们每天冲浪的较少匿名浏览器。他们可以使用Safari，Firefox或Chrome来到某些网站，以及用于他们想要保持匿名的网站的托架。利用方案泛滥漏洞的网站可以创建一个稳定而唯一的标识符，可以将这些浏览标识链接在一起。</p><p> Even if you are not a Tor Browser user, all major browsers are affected. It’s possible to link your Safari visit to your Chrome visit, identify you uniquely and track you across the web.</p><p> 即使您不是Tor浏览器用户，所有主要浏览器也会受到影响。可以将您的Safari访问与您的Chrome访问相连，识别您的独特识别并跟踪您的网络。 </p><p>  Additionally, the scheme flood vulnerability allows for targeted advertisement and user profiling without user consent. The list of installed applications on your device can reveal a lot about your occupation, habits, and age. For example, if a Python IDE or a PostgreSQL server is installed on your computer, you are very likely to be a backend developer.</p><p>此外，该计划泛洪漏洞允许有针对性的广告和用户分析，而无需用户同意。您的设备上已安装的应用程序列表可以揭示您的职业，习惯和年龄的很多。例如，如果计算机上安装了Python IDE或PostgreSQL服务器，则非常可能成为后端开发人员。</p><p> Depending on the apps installed on a device, it may be possible for a website to identify individuals for more sinister purposes. For example, a site may be able to detect a government or military official on the internet based on their installed apps and associate browsing history that is intended to be anonymous.</p><p> 根据设备上安装的应用，网站可能有可能识别个人以获取更多的险恶目的。例如，一个网站可以能够根据他们已安装的应用程序和涉及匿名的浏览历史来检测互联网上的政府或军事官员。</p><p>  This vulnerability has been possible for more than 5 years and its true impact is unknown. In a quick search of the web, we couldn’t find any website actively exploiting it but we still felt the need to report it as soon as possible.</p><p>  超过5年的这种漏洞是可能的，其真正的影响是未知的。在快速搜索网络中，我们无法找到任何积极利用它的网站，但我们仍然觉得需要尽快报告它。</p><p>  Note: You may skip this section if you are not interested in the technical implementation details. The source code of the  demo application is available on  GitHub.</p><p>  注意：如果您对技术实现详细信息不感兴趣，您可以跳过本节。演示应用程序的源代码可在Github上使用。</p><p> The scheme flooding vulnerability allows an attacker to determine which applications you have installed. In order to generate a 32-bit cross-browser device identifier, a website can test a list of 32 popular applications and check if each is installed or not. On average, the identification process takes a few seconds and works across desktop Windows, Mac and Linux operating systems.</p><p> 该方案泛洪漏洞允许攻击者确定已安装的应用程序。为了生成32位跨浏览器设备标识符，网站可以测试32个流行应用程序的列表，并检查是否安装了。平均而言，识别过程需要几秒钟，跨桌面窗口，Mac和Linux操作系统工作。</p><p> To check if an application is installed, browsers can use built-in custom URL scheme handlers. You can see this feature in action by entering skype:// in your browser address bar. If you have Skype installed, your browser will open a confirmation dialog that asks if you want to launch it. This feature is also known as deep linking and is widely used on mobile devices, but is available within desktop browsers as well. Any application that you install can register its own scheme to allow other apps to open it.</p><p> 要检查是否已安装应用程序，浏览器可以使用内置自定义URL方案处理程序。您可以通过在浏览器地址栏中输入Skype：//，从而在操作中查看此功能。如果安装了Skype，则浏览器将打开一个确认对话框，该对话框询问您是否要启动它。此功能也称为深度链接，并且广泛用于移动设备，但也可在桌面浏览器中使用。您安装的任何应用程序都可以注册自己的方案，以允许其他应用程序打开它。</p><p>  In order to detect if an application is installed, we can test an application&#39;s custom URL scheme and then check if a popup has been shown.</p><p>  为了检测是否安装了应用程序，我们可以测试应用程序＆＃39; s自定义URL方案，然后检查是否已显示弹出窗口。 </p><p>  Prepare a list of application URL schemes that you want to test. The list may depend on your goals, for example, if you want to check if some industry or interest-specific applications are installed.</p><p>准备要测试的应用程序URL方案列表。例如，该列表可能取决于您的目标，例如，如果要检查是否已安装某些行业或特定于特定的应用程序。</p><p> Add a script on a website that will test each application from your list. The script will return an ordered array of boolean values. Each boolean value is true if the application is installed or false if it is not.</p><p> 在网站上添加一个脚本，该脚本将从列表中测试每个应用程序。脚本将返回一个有序的布尔值数组。如果未安装应用程序，则每个布尔值都是如此。</p><p>  Optionally, use machine learning algorithms to guess your website visitors’ occupation, interests, and age using installed application data.</p><p>  可选地，使用机器学习算法猜测您的网站访问者使用已安装的应用程序数据的访问者的职业，兴趣和年龄。</p><p> The steps above may sound easy, but most browsers have safety mechanisms in place designed to prevent such exploits. Weaknesses in these safety mechanisms are what makes this vulnerability possible. A combination of  CORS policies and browser window features can be used to bypass it.</p><p> 上述步骤可能很容易，但大多数浏览器都有安全机制，用于防止这种漏洞。这些安全机制中的缺点是使这种脆弱性成为可能的原因。 CORS策略和浏览器窗口功能的组合可用于绕过它。</p><p> The actual implementation of the exploit varies by browser, however the basic concept is the same. It works by asking the browser to show a confirmation dialog in a popup window. Then the JavaScript code can detect if a popup has just been opened and detect the presence of an application based on that.</p><p> Exploit的实际实现因浏览器而异，但基本概念是相同的。它通过询问浏览器在弹出窗口中显示确认对话框来工作。然后，JavaScript代码可以检测是否刚刚打开弹出窗口并检测应用程序的存在。</p><p>   Of the four major browsers impacted, only Chrome developers appear to be aware of the scheme flooding vulnerability. The issue has been discussed on the  Chromium bug-tracker and is planned to be fixed soon.</p><p>   在受影响的四个主要浏览器中，只有Chrome开发人员似乎意识到该计划泛滥的漏洞。已经在铬kotser上讨论了该问题，并计划尽快解决。</p><p> Additionally, only the Chrome browser had any form of scheme flood protection which presented a challenge to bypass. It prevents launching any application unless requested by a user gesture, like a mouse click. There is a global flag that allows (or denies) websites to open applications, which is set to false after handling a custom URL scheme.</p><p> 此外，只有Chrome浏览器只有任何形式的方案洪水保护，呈现出旁路的挑战。除非用户手势请求，否则它会阻止启动任何申请，如鼠标单击。有一个全局标志，允许（或拒绝）网站打开应用程序，在处理自定义URL方案后，将其设置为false。 </p><p>  However, you can use Chrome extensions to reset this flag and bypass the scheme flood protection. By  specification, extensions need to be able to open custom URLs, such as mailto: links, without confirmation dialogs. The scheme flood protection conflicts with extension policies so there is a loophole that resets this flag every time any extension is triggered.</p><p>但是，您可以使用Chrome Extensions重置此标志并绕过方案防洪。通过规范，扩展需要能够打开自定义URL，例如Mailto：Links，而无需确认对话框。该计划泛洪保护与扩展策略冲突，因此有一个漏洞，每次触发任何扩展时都会重置此标志。</p><p> The built-in Chrome PDF Viewer is an extension, so every time your browser opens a PDF file it resets the scheme flood protection flag. Opening a PDF file before opening a custom URL makes the exploit functional.</p><p> 内置的Chrome PDF查看器是一个分机，因此每次浏览器打开PDF文件时，它会重置方案防洪标志。打开自定义URL之前打开PDF文件，使漏洞功能突出。</p><p>  Every time you navigate to an unknown URL scheme, Firefox will show you an internal page with an error. This internal page has a different origin than any other website, so it is impossible to access it because of the  Same-origin policy limitation. On the other hand, a known custom URL scheme will be opened as about:blank, whose origin will be accessible from the current website.</p><p>  每次导航到未知的URL方案时，Firefox都会向您展示错误的内部页面。此内部页面具有与任何其他网站不同的原始原点，因此由于同样的策略限制，无法访问它。另一方面，将打开已知的自定义URL方案：空白，其起源将可从当前网站访问。</p><p>  By opening a popup window with a custom URL scheme and checking if its document is available from JavaScript code, you can detect if the application is installed on the device.</p><p>  通过使用自定义URL方案打开弹出窗口并检查其文档是否可从JavaScript代码中获得，您可以检测设备是否已安装在设备上。</p><p>  Despite privacy being a main development focus for the Safari browser, it turned out to be the easiest browser of the four to exploit. Safari doesn’t have scheme flood protection and allows to easily enumerate all installed applications.</p><p>  尽管隐私是Safari浏览器的主要发展焦点，但事实证明是四个爆炸的最简单的浏览器。 Safari没有方案泛洪保护，允许轻松枚举所有已安装的应用程序。</p><p> The same-origin policy trick as used for the Firefox browser was used here as well.</p><p> 这里使用了Firefox浏览器的同样原始策略技巧。</p><p>  Tor Browser has confirmation dialogs disabled entirely as a privacy feature, which, ironically, exposed a more damaging vulnerability for this particular exploit. Nothing is shown while the exploit runs in the background, contrasting with other browsers that show pop-ups during the process. This oversight allows the exploit to check through installed applications without users even realizing it.</p><p>  Tor浏览器完全禁用了确认对话框作为隐私功能，讽刺意义地暴露了这种特定利用的更具破坏性漏洞。在漏洞利用在后台运行时，没有显示任何内容，与在此过程中显示弹出窗口的其他浏览器进行对比。这种监督允许利用甚至意识到未经用户的安装应用程序。 </p><p> Tor Browser is based on the Firefox source code, so the Same-origin policy trick was used here as well. But because Tor Browser does not show pop-ups, we used the same-origin policy trick with iframe elements instead.</p><p>Tor浏览器基于Firefox源代码，因此同样使用了同样的策略技巧。但是因为Tor浏览器没有显示弹出窗口，我们使用了Iframe元素的同位策略技巧。</p><p> By creating an iframe element with a custom URL scheme and checking if its document is available you can check if the application is installed or not.</p><p> 通过使用自定义URL方案创建IFRAME元素并检查其文档是否可用，您可以检查应用程序是否已安装。</p><p>  Of the four browsers, the scheme flooding vulnerability takes the longest to successfully run in Tor.  It can take up to 10 seconds for each application to be checked due to Tor Browser policies. Still, the exploit can be made to work in the background and track you over a longer browsing session. If you left a Tor Browser window on a web page only for 4 minutes, it could be enough to expose your identity.</p><p>  在四个浏览器中，方案泛洪漏洞需要最长的才能成功地运行Tor。由于TOR浏览器策略，每个应用程序需要需要10秒钟。尽管如此，可以在后台工作并在后台上工作，并通过更长的浏览会话跟踪您。如果您在网页上留下Tor浏览器窗口4分钟，则可能足以暴露您的身份。</p><p> It’s possible to remove the 10-second limitation by running each application test inside a user-triggered gesture. A fake captcha is an ideal candidate: 24 characters entered by a user makes it possible to reset that 10-second limitation 24 times in a row and enumerate 24 installed applications instantaneously.</p><p> 通过在用户触发的手势内运行每个应用程序测试，可以删除10秒限制。假CAPTCHA是一个理想的候选者：用户输入的24个字符使得可以连续24次重置10秒限制，并瞬时枚举24个安装的应用程序。</p><p>  The exact steps to make the scheme flooding vulnerability possible may vary by browser, but the end result is the same. Getting a unique array of bits associated with a visitor’s identity is not only possible, but can be used on malicious websites in practice. Even Tor Browser can be effectively exploited by tricking a user into typing one character per application we want to test.</p><p>  使方案泛滥漏洞可能的确切步骤可能因浏览器而异，但最终结果是相同的。获取与访问者身份相关联的唯一的比特数量不仅可能，而且可以在实践中使用恶意网站。即使是通过欺骗用户在每个应用程序中键入一个字符，可以有效地利用浏览器。</p><p> Until this vulnerability is fixed, the only way to have private browsing sessions not associated with your primary device is to use another device altogether.</p><p> 直到此漏洞是固定的，唯一可以与主设备关联的私人浏览会话的方法是完全使用另一个设备。</p><p> By submitting these bug reports, writing this article and building our demo application, we hope that this vulnerability is fixed across all browsers as soon as possible.</p><p> 通过提交这些错误报告，撰写本文并构建我们的演示应用程序，我们希望尽快解决所有浏览器的漏洞。 </p><p>   If you enjoyed reading this article, consider joining our fully remote team to work on exciting research in online security:  work@fingerprintjs.com</p><p>如果您喜欢阅读本文，请考虑加入我们全面的远程团队在线安全令人兴奋的研究：Work@fingerprintJS.com </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://fingerprintjs.com/blog/external-protocol-flooding/">https://fingerprintjs.com/blog/external-protocol-flooding/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/chrome/">#chrome</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/浏览器/">#浏览器</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cross/">#cross</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>