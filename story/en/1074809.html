<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>研究人员：三星售出了约100万部手机，其中包括Galaxy S21，这些手机的设计缺陷已经修补，攻击者可以利用这些缺陷提取秘密密钥Researchers: Samsung shipped ~100M phones, including the Galaxy S21, with since-patched design flaws that could let attackers extract secret cryptographic keys</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Researchers: Samsung shipped ~100M phones, including the Galaxy S21, with since-patched design flaws that could let attackers extract secret cryptographic keys<br/>研究人员：三星售出了约100万部手机，其中包括Galaxy S21，这些手机的设计缺陷已经修补，攻击者可以利用这些缺陷提取秘密密钥</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-25 10:24:04</div><div class="page_narrow text-break page_content"><p>Academics at Tel Aviv University in Israel have found that recent Android-based Samsung phones shipped with design flaws that allow the extraction of secret cryptographic keys.</p><p>以色列特拉维夫大学（Tel Aviv University）的学者发现，最近基于Android的三星手机存在设计缺陷，允许提取秘密密钥。</p><p> The researchers – Alon Shakevsky, Eyal Ronen, and Avishai Wool – describe their work in  a paper titled, &#34;Trust Dies in Darkness: Shedding Light on Samsung&#39;s TrustZone Keymaster Design,&#34; which is scheduled for presentation at Real World Crypto and USENIX Security, 2022.</p><p>研究人员阿隆·沙克夫斯基、埃亚尔·罗宁和阿维谢·沃尔在一篇题为&#34；信任在黑暗中消逝：三星&#39；s TrustZone Keymaster设计和#34；计划在2022年的真实世界加密和USENIX安全大会上展示。</p><p> Android smartphones, which pretty much all use Arm-compatible silicon, rely on a Trusted Execution Environment (TEE) supported by Arm&#39;s TrustZone technology to keep sensitive security functions isolated from normal applications. These TEEs run their own operating system, TrustZone Operating System (TZOS), and it&#39;s up to vendors to implement the cryptographic functions within TZOS.</p><p>Android智能手机几乎都使用与Arm兼容的硅芯片，依靠Arm&#39；s TrustZone技术，将敏感的安全功能与正常应用程序隔离。这些TEE运行自己的操作系统TrustZone operating system（TZOS）和it&#39；由供应商在TZOS中实现加密功能。</p><p>   The  Android Keystore, the researchers explain, offers hardware-backed cryptographic key management via the Keymaster Hardware Abstraction Layer (HAL). Samsung implemented the HAL through a Trusted Application running in the TrustZone called Keymaster TA, to carry out cryptographic operations like key generation, encryption, attestation, and signature creation in a secure environment. The results of these TEE crypto calculations can then be used in apps operating in the less secure Android environment.</p><p>研究人员解释说，Android密钥库通过Keymaster硬件抽象层（HAL）提供硬件支持的加密密钥管理。三星通过在TrustZone中运行的名为Keymaster TA的受信任应用程序实现了HAL，以便在安全环境中执行密钥生成、加密、认证和签名创建等加密操作。这些TEE加密计算的结果可以用于在不太安全的Android环境中运行的应用程序。</p><p>     The Keymaster TA stores cryptographic keys as blobs – the keys are wrapped (encrypted via AES-GCM) so they can be stored in the file system of the Android environment. In theory, they should only be readable within the TEE.</p><p>Keymaster TA将加密密钥存储为BLOB——密钥经过包装（通过AES-GCM加密），因此可以存储在Android环境的文件系统中。理论上，它们应该只在T形三通内可读。</p><p> However, Samsung failed to implement Keymaster TA properly in its Galaxy S8, S9, S10, S20, and S21 phones. The researchers reverse engineered the Keymaster app and showed they could conduct an  Initialization Vector (IV) reuse attack to obtain the keys from the hardware-protected key blobs.</p><p>然而，三星未能在Galaxy S8、S9、S10、S20和S21手机中正确实现Keymaster TA。研究人员对Keymaster应用程序进行了反向工程，并表明他们可以进行初始化向量（IV）重用攻击，从受硬件保护的密钥块中获取密钥。</p><p>   The IV is supposed to be a unique number each time, which ensures the AES-GCM encryption operation produces a different result even when the same plain text is encrypted. But when the IV – referred to by the researchers as &#34;salt&#34; – and encryption key remain the same, the same output gets generated. And that sort of predictability is the bane of encryption.</p><p>IV每次都应该是唯一的数字，这确保了AES-GCM加密操作即使在加密相同的纯文本时也会产生不同的结果。但是当静脉注射——研究人员称之为&#34；盐&#34；——加密密钥保持不变，生成相同的输出。这种可预测性是加密的祸根。</p><p> &#34;So they could have derived a different key-wrapping key for each key they protect,&#34; observed Matthew Green, associate professor of computer science at the Johns Hopkins Information Security Institute in the US,  via Twitter. &#34;But instead Samsung basically doesn’t. Then they allow the app-layer code to pick encryption IVs. This allows trivial decryption.&#34;</p><p>&#34;因此，他们可以为保护的每一个密钥导出不同的密钥包装密钥；美国约翰·霍普金斯信息安全研究所计算机科学副教授马修·格林通过Twitter观察到&#34;但三星基本上没有。然后他们允许应用层代码选择加密IVs。这允许进行琐碎的解密&#34;</p><p> Our Tel Aviv University boffins found three blob formats used among the Samsung phones – v15, v20-s9, and v20-s10. The first, v15, is the default in the Galaxy S8; v20-s9 corresponds to the Galaxy S9; and v20-s10 was found in the S10, S20, and S21.</p><p>我们特拉维夫大学的研究人员发现三星手机中使用了三种blob格式——v15、v20-s9和v20-s10。第一个是v15，是星系S8中的默认值；v20-s9对应于星系s9；在s10、S20和S21中发现了v20-s10。</p><p>   In the v15 and v20-s9 blobs, the researchers say, the salt is a deterministic function that relies on the application ID, application data, and constant strings from the Android environment. So for any given application, corresponding key blobs will be protected by the same key-wrapping key.</p><p>研究人员说，在v15和v20-s9 Blob中，salt是一个确定性函数，依赖于Android环境中的应用程序ID、应用程序数据和常量字符串。因此，对于任何给定的应用程序，相应的密钥块将受到相同的密钥包装密钥的保护。</p><p> &#34;Surprisingly, we discovered that the Android client is allowed to set the IV when generating or importing a key,&#34; the paper stated. &#34;All that is necessary is to place an attacker-chosen IV as part of the key parameters, and it is used by the Keymaster TA instead of a random IV.</p><p>&#34;令人惊讶的是，我们发现Android客户端可以在生成或导入密钥时设置IV，&#34；该报称&#34;所需的只是将攻击者选择的IV作为关键参数的一部分，并由Keymaster TA使用，而不是随机IV。</p><p> &#34;As the [Android environment] also controls the application ID and application data, this means that an attacker can force the Keymaster TA to reuse the same key and IV that were previously used to encrypt some other v15 or v20-s9 blobs. Since AES-GCM is a stream cipher, the attacker can now recover hardware-protected keys from key blobs.&#34;</p><p>&#34;由于[Android environment]还控制应用程序ID和应用程序数据，这意味着攻击者可以迫使Keymaster TA重新使用之前用于加密其他一些v15或v20-s9 Blob的相同密钥和IV。由于AES-GCM是一种流密码，攻击者现在可以从密钥块中恢复受硬件保护的密钥&#34;</p><p>  More recent model Samsung devices with v20-s10 blobs are not normally vulnerable to IV reuse attacks, though the researchers found a way to conduct a downgrade attack by having the Android environment pass an &#34;encryption version&#34; parameter telling the device to use the vulnerable v15 blob format.</p><p>带有v20-s10 Blob的较新型号三星设备通常不易受到IV重用攻击，不过研究人员找到了一种方法，通过让Android环境通过&#34；加密版本&#34；告诉设备使用易受攻击的v15 blob格式的参数。</p><p> The weak crypto was also used by the researchers to bypass FIDO2 WebAuthn, a way to use public-key cryptography, instead of passwords, to register for and authenticate to websites. Their proof-of-concept attack allowed the researchers to authenticate themselves to a website protected by the Android StrongKey application. What&#39;s more, they also managed to bypass Google&#39;s  Secure Key Import, designed to let servers share keys securely with Android devices.</p><p>研究人员还使用弱加密绕过FIDO2 WebAuthn，这是一种使用公钥加密而不是密码来注册和验证网站的方法。他们的概念验证攻击使研究人员能够通过Android StrongKey应用程序保护的网站进行身份验证。什么&#39；此外，他们还设法绕过了谷歌&#39；s安全密钥导入，旨在让服务器与Android设备安全共享密钥。</p><p> In all, the researchers estimate 100 million Samsung devices were vulnerable when they identified the encryption flaw last year. However, they responsibly disclosed their findings to Samsung in May 2021, which led to the August 2021 assignment of CVE-2021-25444 to the vulnerability, and a patch for affected devices. In July 2021, they revealed their downgrade attack, which led in October 2021 to CVE-2021-25490 and a patch that removed the legacy blob implementation (v15) from devices including the S10, S20, and S21.</p><p>研究人员估计，去年发现加密漏洞时，总共有1亿台三星设备易受攻击。然而，他们在2021年5月向三星公开了他们的发现，这导致了CVE-2021-2544的2021年8月分配给漏洞，并为受影响的设备提供了补丁。在2021年7月，他们揭示了他们的降级攻击，这导致了2021年10月到CVE-2021-25490和一个补丁，从遗留的BLB实现（V15）从包括S10、S20和S21的设备中移除。</p><p> Looking ahead, the boffins argue that an encryption scheme other than AES-GCM, or an IV reuse resistant version like AES-GCM-SIV, should be considered.</p><p>展望未来，专家们认为，应该考虑使用AES-GCM以外的加密方案，或者像AES-GCM-SIV这样的抗IV重用版本。</p><p> Samsung did not immediately respond to a request to confirm the researchers&#39; estimate of affected devices and to estimate how many affected devices, if any, remain unpatched. ®</p><p>三星没有立即回复确认研究人员的请求&#39；估计受影响的设备，并估计有多少受影响的设备（如果有的话）尚未修补。®</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/缺陷/">#缺陷</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/samsung/">#samsung</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/加密/">#加密</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>