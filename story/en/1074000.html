<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GoIP-1 GSM网关可能被黑客用来进行电话欺诈GoIP-1 GSM gateway could be harnessed for phone fraud by hackers</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">GoIP-1 GSM gateway could be harnessed for phone fraud by hackers<br/>GoIP-1 GSM网关可能被黑客用来进行电话欺诈</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-19 03:15:25</div><div class="page_narrow text-break page_content"><p>While listening to  Risky Business ep. 642, I learned about  a botnet that has been abusing a vulnerability in TP-Link routers to provide SMS messaging as a service for years. The exploited vulnerability allowed the botnet operator to send SMS messages on someone else’s bill and the operator sold this capability for others, including other criminals. Similar services are no doubt used when you receive smishing messages notifying you about false packages stuck in customs. It is not clear how much this specific botnet operator is making, but there is demand for sure.</p><p>一边听风险商业ep。642年，我了解到一个僵尸网络多年来一直在利用TP-Link路由器中的漏洞提供短信服务。利用该漏洞，僵尸网络运营商可以通过他人的账单发送短信，运营商将此功能卖给其他人，包括其他罪犯。毫无疑问，当你收到虚假信息，通知你海关有虚假包裹时，也会使用类似的服务。目前尚不清楚这家特定的僵尸网络运营商能赚多少钱，但肯定有需求。</p><p> The relatively cheap GoIP-1 GSM gateway device I bought specifically for  my wardialing project has the functionality to send SMS messages and to make calls on the PSTN network. Thus, compromising it would grant a hacker not only the possibility to send smishing messages, but also to make (scam) calls. The device also did not come across as too secure by default so the time investment into hacking one might be small. A device that powerful and easily hackable would be an ideal target for the SMS messaging service operators.</p><p>我专门为我的wardialing项目购买的相对便宜的GoIP-1 GSM网关设备具有发送短信和在PSTN网络上拨打电话的功能。因此，破坏它将使黑客不仅有可能发送虚假信息，还可以拨打（诈骗）电话。默认情况下，该设备也不会太安全，因此黑客攻击的时间投入可能很小。功能强大且易于黑客攻击的设备将是短信服务运营商的理想目标。</p><p> Intrigued by the business prospect we chose to investigate the device in our “hack weekend” with my good friend and colleague  Lassi Korhonen. After a weekend of sitting in a dark apartment hacking and occasionally walking to the nearest fast food joint, we uncovered multiple vulnerabilities on the device, some of which enable compromising such devices for the purpose of sending SMS messages or making calls for free.</p><p>出于对商业前景的兴趣，我们选择在“黑客周末”与我的好朋友兼同事拉西·科霍宁一起调查该设备。经过一个周末坐在一个黑暗的公寓里进行黑客攻击，偶尔步行到最近的快餐店，我们发现了该设备上的多个漏洞，其中一些漏洞使我们能够为了发送短信或免费拨打电话而破坏这些设备。</p><p>   Hack weekends are something we started having together with Lassi once we had worked on the security field for some time. The idea is that we choose some target that interests us both and work on it under the same roof over a weekend fueled by pizza and sushi.</p><p>黑客周末是我们在安全领域工作了一段时间后开始与拉西一起度过的。我们的想法是，我们选择一些我们双方都感兴趣的目标，在一个周末，在披萨和寿司的推动下，在同一个屋檐下工作。</p><p> During these weekends we catch up on life and learn from each other while having fun hacking. It doesn’t have to be hacking though, we may also focus on developing a proof-of-concept (PoC) of something. Sometimes we find something, sometimes we don’t, but we always learn something new. I warmly recommend this format of entertainment for those that are fortunate enough to share a nerdy interest with their friend.</p><p>在这些周末，我们在享受黑客攻击乐趣的同时，了解生活，相互学习。不过，这不一定是黑客攻击，我们也可以专注于开发某种东西的概念证明（PoC）。有时我们发现了一些东西，有时我们没有，但我们总是学习新的东西。我热情地向那些有幸与朋友分享书呆子兴趣的人推荐这种娱乐形式。</p><p>    In early 2017, Trustwave  found a secret backdoor telnet account, ‘dbladm’, that granted root shell on the device. This account was protected with a custom challenge-response algorithm which in turn relied on obscurity for security. Thus anyone could log in. In our testing, the account seemed to still exist, but the challenge-response algorithm had been changed. Trustwave had reverse-engineered the algorithm from an upgrade package, but based on our research it was no longer part of the newer upgrade packages. Perhaps it could have been extracted from the device with special tooling? We, however, lacked the tools.</p><p>2017年初，Trustwave发现了一个秘密的后门telnet帐户“dbladm”，该帐户授予设备上的root shell权限。该帐户受到自定义质询响应算法的保护，该算法反过来又依赖于隐蔽性来确保安全性。这样任何人都可以登录。在我们的测试中，该帐户似乎仍然存在，但挑战-响应算法已经更改。Trustwave从一个升级包中对算法进行了反向工程，但根据我们的研究，它不再是更新的升级包的一部分。也许它可以用特殊工具从设备中提取出来？然而，我们缺乏工具。</p><p> In late 2017 the author Securiteam has submitted  multiple vulnerabilities reported by an independent security researcher affecting the web panel on GoIP devices to  The Exploit Database. These vulnerabilities allow downloading the configuration of the device along with all credentials and executing commands on it. Thus they allow full takeover of the device. These vulnerabilities had since been fixed and were of no use against our GoIP-1 device.</p><p>2017年末，作者SecurityTeam向漏洞数据库提交了一名独立安全研究人员报告的影响GoIP设备上web面板的多个漏洞。这些漏洞允许下载设备的配置以及所有凭据，并在设备上执行命令。因此，它们允许完全接管设备。这些漏洞已经修复，对我们的GoIP-1设备没有任何用处。</p><p> Aside from concrete vulnerabilities, GoIP devices are ridden with weak default credentials that users are not forced to change. The weak credentials could most likely be used to gain unauthorized access to the same number of GoIP devices as with the past vulnerabilities (and the new ones disclosed in this blog post).</p><p>除了具体的漏洞外，GoIP设备还存在薄弱的默认凭据，用户不必被迫更改这些凭据。与过去的漏洞（以及本博文中披露的新漏洞）一样，弱凭据很可能被用于未经授权访问相同数量的GoIP设备。</p><p>  The firmware version of the GoIP-1 device was GHSFVT-1.1-67-5 M26FBR03A02 RSIM. Before testing, the device was reset to the default configuration, and a static IP was set to the LAN interface.</p><p>GoIP-1设备的固件版本为GHSFVT-1.1-67-5 M26FBR03A02 RSIM。在测试之前，设备被重置为默认配置，LAN接口设置了静态IP。</p><p> The IP address of the device on ‘PC’ port was 192.168.8.1 and on ‘LAN’ port 192.168.9.1. The PoCs, therefore, point to these IP addresses. Based on our analysis, all of the vulnerabilities were present in both interfaces of the device.</p><p>“PC”端口上的设备IP地址为192.168.8.1，“LAN”端口上的设备IP地址为192.168.9.1。因此，POC指向这些IP地址。根据我们的分析，所有漏洞都存在于设备的两个接口中。</p><p>  Information that might be useful for an attacker is leaked from the device to unauthenticated users.</p><p>可能对攻击者有用的信息会从设备泄露给未经身份验证的用户。</p><p>  Opening the following URL in browser reveals the ping log for unauthenticated users. This file is only displayed if the ping functionality has been used since rebooting the device.</p><p>在浏览器中打开以下URL会显示未经身份验证用户的ping日志。仅当重新启动设备后已使用ping功能时，才会显示此文件。</p><p>         The TCP port 2096 on the device is a debug port that allows the eavesdropping of many events. There is no authentication, thus anyone can simply connect to the port and start secretly collecting information. There is also no encryption.</p><p>设备上的TCP端口2096是一个调试端口，允许窃听许多事件。没有身份验证，因此任何人都可以简单地连接到端口并开始秘密收集信息。也没有加密。</p><p>  The content of all received SMS messages when admin browses to that view in the web panel</p><p>管理员在web面板中浏览到该视图时收到的所有SMS消息的内容</p><p> The following screenshot shows messages received from the port. Among the messages, it is visible that an SMS message with the content “Hello world!” is sent to a redacted phone number, and that a 5-second test call is made to a redacted phone number.</p><p>下面的屏幕截图显示了从端口接收到的消息。在这些信息中，可以看到一条内容为“Hello world！”的短信发送到修改过的电话号码，并对修改过的电话号码进行5秒钟的测试通话。</p><p>   There are two Local File Inclusion (LFI) vulnerabilities in the web panel that allows fetching data useful to an attacker without authentication. Opening the following URLs in browser will display the passwd file of the device.</p><p>web面板中存在两个本地文件包含（LFI）漏洞，允许在无需身份验证的情况下获取对攻击者有用的数据。在浏览器中打开以下URL将显示设备的passwd文件。</p><p>  These vulnerabilities can be exploited to fetch the serial number, firmware version, and module versions through fetching the file /dev/mtdblock/5.</p><p>可以利用这些漏洞通过获取文件/dev/mtdblock/5获取序列号、固件版本和模块版本。</p><p> The most sensitive file an attacker can request is the config.dat, which stores the whole configuration of the device in cleartext. It includes for example all credentials to the device, including SIP, H.323, and web panel. This file can be requested from /tmp/config.dat if the configuration backup feature has been used. Previously the same information was available in /dev/mtdblock/5 according to the  Securiteam’s report. According to our testing, the data was no longer there in this version of the firmware.</p><p>攻击者可以请求的最敏感文件是配置文件。dat，它以明文形式存储设备的整个配置。例如，它包括设备的所有凭证，包括SIP、H.323和web面板。可以从/tmp/config请求此文件。dat如果已使用配置备份功能。根据SecurityTeam的报告，以前的/dev/mtdblock/5中也提供了相同的信息。根据我们的测试，数据不再存在于这个版本的固件中。</p><p> Opening the following URLs in browser will fetch the config.dat file from a device that has used the configuration backup feature since the last reboot:</p><p>在浏览器中打开以下URL将获取配置。自上次重新启动以来使用配置备份功能的设备的dat文件：</p><p>   There were systematic reflected Cross-site scripting (XSS) vulnerabilities in the web panel. Exploiting them is not the most straightforward way for an attacker to gain access to the SMS sending or calling capabilities of the device, therefore I will only report the vulnerable paths and corresponding parameters.</p><p>web面板中存在系统性的跨站点脚本（XSS）漏洞。攻击者利用这些漏洞并不是访问设备短信发送或呼叫功能的最直接方式，因此我只报告易受攻击的路径和相应参数。</p><p>  The following paths contain parameters vulnerable to reflected cross-site scripting. It is possible to provide input that is reflected without sanitization and thus cause Javascript to be executed in the context of the application. The input is however reflected only once and is not saved anywhere. The vulnerable parameters in each path shown in the table below.</p><p>以下路径包含易受跨站点脚本影响的参数。可以提供无需净化即可反映的输入，从而使Javascript在应用程序的上下文中执行。然而，输入只反映一次，并且不会保存在任何地方。每个路径中的易受攻击参数如下表所示。</p><p>   The following paths contain parameters vulnerable to stored cross-site scripting. It is possible to provide input that is reflected back without sanitization and thus cause Javascript to be executed in the context of the application. The input is stored by the web panel and reflected to the user every time they visit a certain view until the user deletes or overwrites the malicious input. The vulnerable parameters in each path shown in the table below.</p><p>以下路径包含易受存储的跨站点脚本攻击的参数。可以提供无需净化就能反射回来的输入，从而使Javascript在应用程序的上下文中执行。输入由web面板存储，并在用户每次访问某个视图时反映给用户，直到用户删除或覆盖恶意输入。每个路径中的易受攻击参数如下表所示。</p><p>   The same LFI vulnerability used in the Information Disclosure subsection can be used to deny the service of the web panel completely. Requesting the file /etc/ipin will cause the web panel to become so slow that it is no longer usable. Any other user will not be able to use the web panel either. Exploitation does not require authentication. Rebooting the device will fix the condition.</p><p>信息披露小节中使用的相同LFI漏洞可用于完全拒绝web面板的服务。请求文件/etc/ipin将导致web面板变得非常慢，无法再使用。任何其他用户也将无法使用web面板。利用此漏洞不需要身份验证。重新启动设备将修复该问题。</p><p>   How an attacker could use these findings to send free SMS messages or to make free calls?</p><p>攻击者如何利用这些发现发送免费短信或拨打免费电话？</p><p> The attacker profile we consider is someone who can connect to a GoIP-1 device from the internet with only publicly available information and without any higher level of access to the device. Our attacker plans to start SMS messaging or scam calling as a service using GoIP-1 devices, thus they are after the level of access that allows just that.</p><p>攻击者简介我们认为是一个人谁可以连接到GOIP-1设备从互联网上只有公开的可用信息，没有任何更高级别的访问设备。我们的攻击者计划使用GoIP-1设备以服务的形式启动短信或诈骗呼叫，因此他们的访问级别已经达到了允许的级别。</p><p> Based on our analysis, the vulnerabilities disclosed in this blog post create two new avenues for attack for the kind of attacker we consider. The attacker can use the LFI vulnerability to fetch credentials to the device, and then proceed to use the device using those. They could also try to exploit the XSS vulnerabilities to gain the same credentials.</p><p>基于我们的分析，这个博客帖子中披露的漏洞为我们考虑的攻击者创建了两个攻击的新途径。攻击者可以使用LFI漏洞获取设备的凭据，然后使用这些凭据继续使用设备。他们还可以尝试利用XSS漏洞获得相同的凭据。</p><p> To exploit the LFI vulnerability to get extract credentials from the device, there is a prerequisite that the GoIP configuration has been saved since the last reboot. It is hard to estimate how often the configuration is saved, and thus narrows the window of exploitation. The exploitation of XSS vulnerabilities requires interaction with the victims, which makes exploitation harder.</p><p>要利用LFI漏洞从设备获取提取凭据，必须在上次重新启动后保存GoIP配置。很难估计保存配置的频率，从而缩小了利用窗口。利用XSS漏洞需要与受害者互动，这使得利用漏洞变得更加困难。</p><p> If these fail, the attacker may resort to credential brute force attacks. There are three well-known users with weak default passwords, the web panel uses basic authentication and is not protected against brute force attacks. This makes it likely a very simple and effective attack vector.</p><p>如果这些攻击失败，攻击者可能会诉诸凭证暴力攻击。有三个知名用户的默认密码较弱，web面板使用基本身份验证，不受暴力攻击的保护。这使得它可能是一个非常简单有效的攻击向量。</p><p> It is unclear whether the findings are valid for also other GoIP devices. The same manufacturer offers GSM gateways with up to 32 channels. In this setting, the number of channels means the number of SIM cards that can be plugged into the device, the number of simultaneous calls that can be made, and the number of different phone numbers one can send SMS messages from. Thus the more channels, the more useful the device is for a hacker. The device used in testing has only one channel and thus is the least useful.</p><p>目前尚不清楚这些发现是否也适用于其他GoIP设备。同一家制造商提供最多32个信道的GSM网关。在此设置中，频道数表示可以插入设备的SIM卡数量、可以同时拨打的电话数量，以及可以发送SMS消息的不同电话号码的数量。因此，通道越多，设备对黑客就越有用。测试中使用的设备只有一个通道，因此是最不有用的。</p><p>  We strongly recommend against allowing traffic to any port on this device from the public internet or any untrusted device. Given the record of vulnerabilities and the limited time we spent investigating, the device is guaranteed to contain more. Given the clear value of hacking one of these devices, they will likely get targeted.</p><p>我们强烈建议不要允许从公共互联网或任何不受信任的设备传输到此设备上的任何端口。鉴于漏洞记录和我们调查的时间有限，该设备保证包含更多漏洞。鉴于黑客攻击其中一台设备的明显价值，他们很可能会成为攻击目标。</p><p>  These vulnerabilities were reported to the device manufacturer  Dbltek on 7th November 2021, and the findings were acknowledged. Dbltek was given over 90 days to fix the findings, as well as support for the fixes.</p><p>这些漏洞在2021年11月7日被报告给设备制造商DBLTEK，结果得到了确认。Dbltek有超过90天的时间来修复这些发现，以及对修复的支持。</p><p> Dbltek has not released a new version of the GoIP-1 firmware after the report. However, looking at the  firmware releases page, we see that the one we tested was not the latest and greatest. We did not verify whether the vulnerabilities exist in the newest firmware</p><p>报告发布后，Dbltek尚未发布新版本的GoIP-1固件。然而，看看固件发布页面，我们发现我们测试的那个并不是最新、最棒的。我们没有验证最新固件中是否存在漏洞</p><p> The device does not have automatic updates, and the update process is not completely straightforward. Thus, it is likely that vulnerable devices are still being sold, and that all devices are not going to be updated. We chose to disclose these details nevertheless to urge the implementation of automatic updates or at least an easier update process. Our findings with the biggest impact also have a limited window of exploitation and thus will not likely put a large number of the devices into immediate danger. By disclosing we also hope to educate potential buyers of the device about the dangers associated with the devices.</p><p>该设备没有自动更新，更新过程也不是完全直接的。因此，可能仍在销售易受攻击的设备，并且不会更新所有设备。尽管如此，我们还是选择披露这些细节，以敦促实施自动更新，或至少简化更新过程。我们最具影响力的发现也有一个有限的开发窗口，因此不太可能将大量设备置于即时危险之中。通过披露信息，我们还希望教育潜在的设备购买者有关设备的危险。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/黑客/">#黑客</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/gsm/">#gsm</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/设备/">#设备</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>