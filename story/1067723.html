<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ARM组件中的代码：使用指针 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">ARM组件中的代码：使用指针 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-23 22:56:05</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/6/e760290ff5dfdb4ee9be1c6511e156b8.jpg"><img src="http://img2.diglog.com/img/2021/6/e760290ff5dfdb4ee9be1c6511e156b8.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>在上一篇文章中，我解释了ARM64处理器的寄存器的基本架构，并说明了如何通过汇编语言例程来访问和返回值的方式。我与一个悬崖师结束，希望解释如何从传递给例程的指针访问参数。</p><p> 有两个基本说明，用于在内存和寄存器之间传输数据，LDR加载到寄存器中，并将其存储到内存中。他们最简单的用途是：</p><p> LDR X0，[REG]加载REG中的地址，例如寄存器X1，进入寄存器X0</p><p> str x0，[reg]将寄存器x0中的内容存储到reg中的地址中，例如寄存器x1</p><p> 请注意，两者的移动方向如何不同：LDR将第一个操作数加载为目的地，而str存储在第一个操作数中的源。说明更常用使用第一个操作数指定结果的目的地; str是一个重要的例外。</p><p> 这些指令中的reg项目可以使用五种不同的寻址模式中的任何一种：[x1]  - 基本寄存器，它可以包括使用堆栈指针[x1，偏移]  - 归档寄存器，其中有效地址是基本寄存器中的地址和偏移[x1，偏移]的总和！ - 预索引，它类似于偏移量，但在使用寄存器中的地址之前，请在寄存器中添加偏移量;这通常用于在阵列[x1]中加载或存储值，偏移 - 索引后，它类似于偏移量，但由于该指令，通过在末尾添加偏移量来更新寄存器中的地址执行;这通常用于从堆栈标签 -  PC相对弹出值，它用于通过标签访问代码中定义的值。</p><p> 要了解这些，通过一些例子很有用。在这些开始的开始时，寄存器X1包含地址00000100。 </p><p>LDR X0，[x1,8]将地址00000108（00000100 + 8）的64位整数加载到寄存器x0中  ldr x0，[x1,8]！ 将地址00000108（00000100 + 8）的64位整数加载到寄存器x0中，并在寄存器x1中离开地址00000108  LDR X0，[X1]，8将地址00000100的64位整数加载到寄存器X0中，并在寄存器X1中离开地址00000108（00000100 + 8）。  指定地址的最终复杂性是指定偏移量的变化，这里显示为寄存器X1的偏移量：  [x1，x2，lsl 2]  - 偏移量是寄存器x2中包含的整数，左移2个位置  [X1，W2，UXTW 2]  - 偏移量是寄存器W2（32位）中包含的整数，左移2个位置。  这些图中概述了该图，其中还涵盖了我已经检查过的其他操作数类型和返回值。 </p><p>现在尝试其中一些负载并使用不同的寻址模式存储说明。这是简单的，使用ASMattic：首先，您需要更改ASMMATH.h头文件以提供新的呼叫，请在我的壳体外部TATEADD（双，双*，双*）;它将一个双倍作为值和两个视为指针，并返回双重值。要在SWIFT中调用，请使用类似于Let MyA = Thea.DoubleValue var myb = thetemp = thec.doublevalue var myc = [thetemp + 1.0），（thetemp + 2.0）]让myd = testadd（ Mya，＆amp; myb，＆amp; myc）这首先设置三个参数来包含一个不可变双值，指向一个双重的指针，指向三个元素的双打数组，在调用该函数返回双重之前结果。然后，您使用self.outputtext.string =＆＃34显示结果。结果= \（Myd）a = \（mya）b = \（myb）c = \（myc）\ n＆＃34;</p><p>  _testadd：str lr，[sp，＃-16]！ LDR D5，Multi_two //  - 使用PC-Inflication Access FMUL D6，D0，D5 //  -  DOUNDE的标记值是从D0寄存器LDR D7，[x0] //  - 使用基地的第一个参数注册访问。请注意，双倍的地址不在浮点寄存器中传递，而是在通用寄存器中传递。 FMUL D7，D7，D5 STR D7，[X0] LDR D5，MULTER_THREE LDR D4，[X1] FMUL D7，D4，D5 STR D7，[X1] LDR D4，[X1,8]！ //  - 使用预索引递增x1递增8的索引，因此访问阵列中的下一个双倍。 FMUL D7，D4，D5 STR D7，[X1] LDR D4，[X1,8]！ FMUL D7，D4，D5 STR D7，[X1] FMOV D0，D6 //  - 结果返回为D0寄存器中的双值。 LDR LR，[SP]，＃16 RET</p><p>  现在我们处于访问传递给装配例程的参数的位置，返回结果为值以及通过引用传递的这些参数。下一步是控制程序流，我将在本系列中的下一步开始。</p><p>  1：构建应用程序以开发装配例程，包括将汇集语言从SWIFT调用汇编语言的解释，其中包含一个完整的Xcode项目2：寄存器解释，图表显示了ARM64处理器的寄存器，并按值传递参数</p><p>    手术呼叫标准用于ARM 64位架构（ARM）从GitHub写作ARM64代码用于Apple平台（Apple）Stephen Smith（2020）用64位ARM汇编语言编程，APRess，ISBN 978 1 4842 5880 4. Daniel Kusswurm（ 2020）现代ARM汇编语言编程，APRess，ISBN 978 1 4842 6266 5. ARM64指令集参考（ARM）。</p><p>  发布在Mac，技术和标记的Apple硅，臂，汇编器，汇编语言，M1，Xcode。书签永久链接。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://eclecticlight.co/2021/06/21/code-in-arm-assembly-working-with-pointers/">https://eclecticlight.co/2021/06/21/code-in-arm-assembly-working-with-pointers/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/arm/">#arm</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/寄存器/">#寄存器</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>