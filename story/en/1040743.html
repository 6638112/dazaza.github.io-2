<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用Pytest解决Python中的算法问题（2019） Solving Algorithmic Problems in Python with Pytest (2019)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Solving Algorithmic Problems in Python with Pytest (2019)<br/>使用Pytest解决Python中的算法问题（2019） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-19 23:47:13</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/1b6452df64d0b9e45266551a51134d09.jpg"><img src="http://img2.diglog.com/img/2020/12/1b6452df64d0b9e45266551a51134d09.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>I occasionally enjoy solving algorithmic problems, for example  Project Euler or  The Advent of Code.I’ve been doing them since I was a pimply PHP-slinging teenager, competing with my peers across the UK in the British Informatics Olympiad.It was terribly nerdy and terribly fun.</p><p>我偶尔会喜欢解决算法问题，例如Project Euler或Code Advent，自从我还是个PHP小子以来就一直在做这些事情，与我在英国的信息学奥林匹克竞赛中在英国的同龄人竞争。和非常有趣。</p><p> Algorithmic problems are often used in technical interviews, which I find less fun.Strict deadlines stress me out.</p><p> 技术面试经常在技术面试中使用，我觉得这没什么好玩的。</p><p> In either case, using automated tests makes these problems way easier.I wish I knew this earlier!</p><p> 无论哪种情况，使用自动化测试都会使这些问题更容易解决，我希望我早点知道！</p><p> Online algorithmic platforms, such as  Codility, provide their own automated tests.You use these for basic validation on some examples, but edge cases are sneakily reserved for final marking.To ensure your solution covers all the bases, you need to write your own tests.</p><p> 在线算法平台（例如Codility）提供了自己的自动化测试，您可以在一些示例中将其用于基本验证，但是边缘案例被保留以供最终标记。为确保您的解决方案涵盖所有基础，您需要编写自己的测试。</p><p> In Python, there’s no better test framework than  Pytest - I use it on all my open source projects.It makes it easy for you to add tests for any Python code.And it’s much better than Python’s built-in   unittest.</p><p> 在Python中，没有比Pytest更好的测试框架-我在所有开放源代码项目中都使用了它。它使您可以轻松地为任何Python代码添加测试，并且比Python的内置单元测试好得多。</p><p>    Let’s look at a small problem together using Pytest.Here’s the problem statement:</p><p>    让我们一起使用Pytest来看一个小问题。这是问题陈述：</p><p> Write a function  solve(items) that takes  items, a list of integers, and returns the smallest integer greater than 0 that appears in the list, or 0 if there is none.</p><p> 编写一个函数solve（items），该函数接受项，一个整数列表，并返回列表中出现的大于0的最小整数；如果不存在，则返回0。 </p><p> First, let’s write the most basic sketch of a  solve function.Since 0 is a default value to return, if we always return that we can score some easy points.Create a file called  example.py with the contents:</p><p>首先，让我们写一个最基本的求解函数草图。由于0是默认值，如果总是返回，我们可以给一些简单的分数打分。创建一个名为example.py的文件，内容如下：</p><p>  Let’s test the function manually by running it in the Python 3 interpreter. Open the command line and run the examples:</p><p>  让我们通过在Python 3解释器中运行功能来手动测试该功能。打开命令行并运行示例：</p><p> $ pythonPython 3.7.3 (default, Apr 14 2019, 21:08:36)[Clang 10.0.1 (clang-1001.0.46.3)] on darwinType &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.&gt;&gt;&gt; from example import solve&gt;&gt;&gt; solve([1, 2])0&gt;&gt;&gt; solve([-1])0</p><p> $ pythonPython 3.7.3（默认值，Apr 14 2019，21:08:36）[dar 10.0.1（clang-1001.0.46.3）] on darwinType＆＃34; help＆＃34 ;,＆＃34; copyright＆＃34; ，＆＃34;信用＆＃34;或＆＃34;许可证＆＃34;有关更多信息。来自示例importsolve＆gt;＆gt;＆gt; resolve（[1，2]）0＆gt;＆gt;解决（[-1]）0</p><p>  Doing this each time we modify the code would get tiresome quickly.We have to restart the interpreter, rerun the import and tests, and manually compare the outputs.Writing automated tests now, before we’ve tried to solve the problem properly, makes the whole loop faster.It also makes us think about all the cases up front.</p><p>  每次修改代码时这样做都会很快变得很累，我们必须重新启动解释器，重新运行导入和测试，并手动比较输出结果。在尝试正确解决问题之前，现在编写自动化测试可以使整个循环更快，这也使我们可以提前考虑所有情况。</p><p> Let’s write the tests and solve the problem with the  Red, Green, Refactor pattern.</p><p> 让我们编写测试并使用“红色，绿色，重构”模式解决问题。</p><p>   Pytest can work with tests in the same file as our code, as simple functions with names starting  test_.We use Python’s  assert statement to compare the results of our code with our expectations.</p><p>   Pytest可以与代码位于同一文件中的测试一起工作，其名称以test_开头的简单函数。我们使用Python的assert语句将代码的结果与期望值进行比较。</p><p>  def  solve ( items ):  return  0 def  test_example_1 ():  assert  solve ([ 1 ,  2 ])  ==  1 def  test_example_2 ():  assert  solve ([ - 1 ])  ==  0</p><p>  def Solve（items）：返回0 def test_example_1（）：assert求解（[1，2]）== 1 def test_example_2（）：assert求解（[-1]）== 0 </p><p>  $ python -m pip install pytestCollecting pytest Downloading...Successfully installed atomicwrites-1.3.0 attrs-19.1.0 more-itertools-7.0.0 pluggy-0.9.0 py-1.8.0 pytest-4.4.1 six-1.12.0$ pytest example.py============================= test session starts ==============================platform darwin -- Python 3.7.3, pytest-4.4.1, py-1.8.0, pluggy-0.chainz.0rootdir: /Users/chainz/tmp/pytest_algoscollected 2 itemsexample.py F. [100%]=================================== FAILURES ===================================________________________________ test_example_1 ________________________________ def test_example_1():&gt; assert solve([1, 2]) == 1E assert 0 == 1E + where 0 = solve([1, 2])example.py:5: AssertionError====================== 1 failed, 1 passed in 0.03 seconds ======================</p><p>$ python -m pip install pytest正在收集pytest下载...成功安装了atomicwrites-1.3.0 attrs-19.1.0 more-itertools-7.0.0 pluggy-0.9.0 py-1.8.0 pytest-4.4.1六-1.12。 0 $ pytest example.py ============================测试会话开始============= ==================平台达尔文 - 的Python 3.7.3，pytest-4.4.1，PY-1.8.0，pluggy-0.chainz.0rootdir：/用户/ chainz / tmp / pytest_algos收集了2个项目example.pyF。[100％] ===================================失败=================================== ________________________________ test_example_1 ________________________________ def test_example_1（）：＆gt;断言solve（[1，2]）== 1E断言0 == 1E +其中0 = Solve（[1，2]）example.py:5：AssertionError =============== ======== 1个失败，1个通过了0.03秒======================</p><p> In the middle of the output, we see the tests in  example.py running.Pytest outputs an  F for the failing test, and a dot  . for the passing one.</p><p> 在输出的中间，我们可以看到example.py正在运行中的测试.Pytest为失败的测试输出一个F和一个dot。对于过去的。</p><p> The  FAILURES section expands on the failure with the line that failed.It then shows that  solve([1, 2]) returned  0 which doesn’t compare equal to the expected value  1.</p><p> FAILURES部分以失败的行扩展到失败，然后显示Solve（[1，2]）返回0，该结果不等于期望值1。</p><p> The tests we have are a start but they don’t cover all the cases.We don’t have any lists that contain  0.Also two extremes are missing: the empty list and a list of 1,000,000 items.Long lists could also contain lots of negative or positive integers, so we should try both of these.</p><p> 我们的测试只是一个开始，但并不能涵盖所有情况。我们没有包含0的列表，还缺少两个极端：空列表和1,000,000个项目的列表，长列表也可能包含很多取负整数或正整数，因此我们应同时尝试这两种方法。</p><p> Let’s add more tests.We can make a list of 1,000,000 items in Python by multiplying a short list.Add these tests at the end of the file:</p><p> 让我们添加更多测试。通过将简短列表相乘，我们可以在Python中列出1,000,000个项目。在文件末尾添加以下测试：</p><p> def  test_empty_list ():  assert  solve ([])  ==  0 def  test_list_with_zero ():  assert  solve ([ 0 ,  2 ])  ==  2 def  test_long_positive_list ():  assert  solve ([ 1 ,  2 ,  3 ,  4 ]  *  250_000 )  ==  1 def  test_long_negative_list ():  assert  solve ([ - 1 ,  - 2 ,  - 3 ,  - 4 ]  *  250_000 )  ==  0</p><p> def test_empty_list（）：断言解决（[]）== 0 def test_list_with_zero（）：断言解决（[0，2]）== 2 def test_long_positive_list（）：断言解决（[1，2，3，4] * 250_000 ）== 1 def test_long_negative_list（）：断言求解（[-1，-2，-3，-4] * 250_000）== 0</p><p>  ============================= test session starts ==============================platform darwin -- Python 3.7.3, pytest-4.4.1, py-1.8.0, pluggy-0.9.0rootdir: /Users/chainz/tmp/pytest_algoscollected 6 itemsexample.py F..FF. [100%]=================================== FAILURES ===================================________________________________ test_example_1 ________________________________ def test_example_1():&gt; assert solve([1, 2]) == 1E assert 0 == 1E + where 0 = solve([1, 2])example.py:6: AssertionError_____________________________ test_list_with_zero ______________________________ def test_list_with_zero():&gt; assert solve([0, 2]) == 2E assert 0 == 2E + where 0 = solve([0, 2])example.py:18: AssertionError___________________________ test_long_positive_list ____________________________ def test_long_positive_list():&gt; assert solve([1, 2, 3, 4] * 250_000) == 1E assert 0 == 1E + where 0 = solve(([1, 2, 3, 4] * 250000))example.py:22: AssertionError====================== 3 failed, 3 passed in 0.08 seconds ======================</p><p>  =============================测试会话开始=================== =====================================================达尔文平台-python 3.7.3，pytest-4.4.1，py-1.8.0，pluggy-0.9.0rootdir：/ Users / chainz / tmp / pytest_algos收集了6个项目示例。 py F..FF。 [100％] ==================================失败========== ======================== ________________________________ test_example_1 ________________________________ def test_example_1（）：＆gt;断言solve（[1，2]）== 1E断言0 == 1E +其中0 = Solve（[1，2]）example.py:6：AssertionError_____________________________ test_list_with_zero ______________________________ def test_list_with_zero（）：＆gt;断言solve（[0，2]）== 2E断言0 == 2E +其中0 = Solve（[0，2]）example.py:18：AssertionError___________________________ test_long_positive_list ____________________________ def test_long_positive_list（）：＆gt;断言solve（[1、2、3、4] * 250_000）== 1E断言0 == 1E +其中0 = solve（（[1、2、3、4] * 250000））example.py:22：AssertionError ====================== 3个失败，其中3个通过了0.08秒===================== == </p><p>   Now we can work to a solution that makes all the tests pass.Replace  solve with this first attempt:</p><p>现在我们可以尝试使所有测试都通过的解决方案，第一次尝试解决：</p><p> def  solve ( items ):  minimum  =  0  for  i  in  items :  if  minimum  ==  0  or  i  &lt;  minimum :  minimum  =  i  return  minimum</p><p> defsolve（项目）：项目中的i的最小值= 0：如果最小值== 0或i＆lt;最小：最小=我返回最小</p><p>  ============================= test session starts ==============================platform darwin -- Python 3.7.3, pytest-4.4.1, py-1.8.0, pluggy-0.9.0rootdir: /Users/chainz/tmp/pytest_algoscollected 6 itemsexample.py .F...F [100%]=================================== FAILURES ===================================________________________________ test_example_2 ________________________________ def test_example_2():&gt; assert solve([-1]) == 0E assert -1 == 0E + where -1 = solve([-1])example.py:14: AssertionError___________________________ test_long_negative_list ____________________________ def test_long_negative_list():&gt; assert solve([-1, -2, -3, -4] * 250_000) == 0E assert -4 == 0E + where -4 = solve(([-1, -2, -3, -4] * 250000))example.py:30: AssertionError====================== 2 failed, 4 passed in 0.17 seconds ======================</p><p>  =============================测试会话开始=================== ==================================================达尔文平台-python 3.7.3，pytest-4.4.1，py-1.8.0，Pluggy-0.9.0rootdir：/ Users / chainz / tmp / pytest_algos收集了6个项目示例。 py .F ... F [100％] ===================================失败=== ================================ ________________________________ test_example_2 ________________________________ def test_example_2（）：＆gt;断言solve（[-1]）== 0E断言-1 == 0E + -1 = Solve（[-1]）example.py:14：AssertionError___________________________ test_long_negative_list ____________________________ def test_long_negative_list（）：＆gt;断言solve（[-1，-2，-3，-4] * 250_000）== 0E断言-4 == 0E +其中-4 = solve（（[[-1，-2，-3，-4] * 250000））example.py:30：AssertionError ====================== 2次失败，其中4次通过了0.17秒=========== ============</p><p> We have two different failures now.It seems we have yet to ignore negative numbers, woops!</p><p> 现在我们有两种不同的失败方法，看来我们还没有忽略负数，糟糕透顶！</p><p>  def  solve ( items ):  minimum  =  0  for  i  in  items :  if  i  &gt;  0  and  ( minimum  ==  0  or  i  &lt;  minimum ):  minimum  =  i  return  minimum</p><p>  defsolve（项）：项中i的最小值= 0，如果i＆gt; 0和（最小值== 0或i <最小值）：最小值=我返回最小值</p><p>   Re-running the tests produces the same, all-passing output as above.Yay, we got the code down to one line!</p><p>   重新运行测试会产生与上面相同的通行输出。是的，我们将代码简化为一行！</p><p>  I hope this tutorial has been useful, and you use this technique to level up your algorithmic game,</p><p>  希望本教程对您有所帮助，并且您可以使用此技术来升级算法游戏， </p><p>      Working on a Django project? Check out my book  Speed Up Your Django Tests which covers loads of best practices so you can write faster, more accurate tests.</p><p>在Django项目上工作？ 查看我的《加快Django测试速度》一书，其中涵盖了许多最佳实践，因此您可以编写更快，更准确的测试。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://adamj.eu/tech/2019/04/21/solving-algorithmic-problems-in-python-with-pytest/">https://adamj.eu/tech/2019/04/21/solving-algorithmic-problems-in-python-with-pytest/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/算法/">#算法</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pytest/">#pytest</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/测试/">#测试</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>