<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>黑客利用0天，而不是2018年的错误，以质量擦拭我的预订现场设备 Hackers exploited 0-day, not 2018 bug, to mass-wipe My Book Live devices</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Hackers exploited 0-day, not 2018 bug, to mass-wipe My Book Live devices<br/>黑客利用0天，而不是2018年的错误，以质量擦拭我的预订现场设备 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-29 23:03:15</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/6/f01908094ae4a6df60aafac5de2396c2.jpeg"><img src="http://img2.diglog.com/img/2021/6/f01908094ae4a6df60aafac5de2396c2.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Last week’s mass-wiping of Western Digital My Book Live storage devices involved the exploitation of not just one vulnerability but a second critical security bug that allowed hackers to remotely perform a factory reset without a password, an investigation shows.</p><p>上周的西方数字我的预订现场存储设备的群众擦拭涉及不仅仅是一个漏洞的开发，而且允许黑客在没有密码的情况下远程执行出厂重置的第二个关键安全性错误。</p><p> The vulnerability is remarkable because it made it trivial to wipe what is likely petabytes of user data. More notable still was that, according to the vulnerable code itself, a Western Digital developer actively removed code that required a valid user password before allowing factory resets to proceed.</p><p> 漏洞是显着的，因为它使擦除可能的用户数据的宠物薄物的琐碎。更值得注意的是，根据易受攻击的代码本身，西方数字开发人员在允许工厂重置之前主动删除所需有效用户密码的代码。</p><p>  The undocumented vulnerability resided in a file aptly named system_factory_restore. It contains a PHP script that performs resets, allowing users to restore all default configurations and wipe all data stored on the devices.</p><p>  无证漏洞驻留在一个名为system_factory_restore的文件中。它包含一个执行重置的PHP脚本，允许用户恢复所有默认配置并擦除存储在设备上的所有数据。</p><p> Normally, and for good reason, factory resets require the person making the request to provide a user password. This authentication ensures that devices exposed to the Internet can only be reset by the legitimate owner and not by a malicious hacker.</p><p> 通常情况下，出于充分的原因，工厂重置要求该人员请求提供用户密码。此身份验证可确保暴露于互联网的设备只能由合法所有者重置，而不是由恶意黑客重置。</p><p> As the  following script shows, however, a Western Digital developer created five lines of code to password-protect the reset command. For unknown reasons, the authentication check was cancelled, or in developer parlance, it was commented out as indicated by the double / character at the beginning of each line.</p><p> 然而，由于以下脚本显示，Western Digital Developer创建了五行代码以密码保护reset命令。出于未知的原因，验证检查已取消，或者在开发人员策略中，如每行开头的双/字符所示。</p><p>  “The vendor commenting out the authentication in the system restore endpoint really doesn&#39;t make things look good for them,” HD Moore, a security expert and the CEO of network discovery platform Rumble, told Ars. “It’s like they intentionally enabled the bypass.”</p><p>  “供应商评论系统恢复端点中的身份验证真的并不是让事情对他们看起来有益，”网络发现平台隆隆的安全专家和首席执行官告诉Ars。 “这就像他们故意启用旁路。”</p><p> To exploit the vulnerability, the attacker would have had to know the format of the XML request that triggers the reset. That’s “not quite as easy as hitting a random URL with a GET request, but [it’s] not that far off, either,” Moore said.</p><p> 要利用漏洞，攻击者必须知道触发重置的XML请求的格式。这是“与获取请求的随机URL不那么容易，但是[它是]并不是那么远，”摩尔说。 </p><p>   The discovery of the second exploit comes five days after people all over the world reported that their  My Book Live devices had been compromised and then factory-reset so that all stored data was wiped. My Book Live is a book-sized storage device that uses an Ethernet jack to connect to home and office networks so that connected computers have access to the data on it. Authorized users can also access their files and make configuration changes over the Internet. Western Digital stopped supporting the My Book Live in 2015. Western Digital personnel  posted an advisory following the mass wiping that said it resulted from attackers exploiting  CVE-2018-18472. The remote command execution vulnerability was  discovered in late 2018 by security researchers Paulos Yibelo and Daniel Eshetu. Because it came to light three years after Western Digital stopped supporting the My Book Live, the company never fixed it.</p><p>在世界各地的人们报道，他们的预订现场设备已经受到损害，然后恢复出厂时，第二天都会到五天内发现了这第二天的是，然后擦除所有存储的数据。我的书籍Live是一本书大小的存储设备，使用以太网插孔连接到家庭和Office网络，以便连接计算机可以访问其上的数据。授权用户还可以访问其文件并通过Internet进行配置更改。西方数字停止支持我的书籍于2015年。西方数码人员在大规模擦拭后发布了一份咨询，表示这是由攻击者开发CVE-2018-18472的攻击者。通过安全研究人员Paulos Yibelo和Daniel Eshetu，在2018年底发现了遥控命令执行漏洞。因为它在西方数字停止支持我的书生活后三年来光明，公司从未修复它。</p><p>    An analysis performed by Ars and Derek Abdine, CTO at security firm Censys, found that the devices hit by last week’s mass hack had also been subjected to attacks that exploited the unauthorized reset vulnerability. The additional exploit is documented in log files extracted from two hacked devices.</p><p>    ARS和Derek Abdine在Security Consys的ARS和Derek Abdine进行了分析，发现该设备遭到上周的群众黑客攻击，也受到利用未经授权的重置漏洞的攻击。额外的exproit在从两个黑客设备中提取的日志文件中记录。</p><p> One of the logs was  posted in the Western Digital  support forum where the mass compromise first came to light. It shows someone from the IP address 94.102.49.104 successfully restoring a device:</p><p> 其中一个日志已发布在西部数字支持论坛中，群众妥协首次亮起。它显示IP地址94.102.49.104的人成功恢复设备：</p><p> rest_api.log.1:Jun 23 15:46:11 MyBookLiveDuo REST_API[9529]: 94.102.49.104 PARAMETER System_factory_restore POST : erase = none rest_api.log.1:Jun 23 15:46:11 MyBookLiveDuo REST_API[9529]: 94.102.49.104 OUTPUT System_factory_restore POST SUCCESS</p><p> rest_api.log.1：6月23日15:46:11 mybookliveduo rest_api [9529]：94.102.49.104参数system_factory_restore帖子：erase = none rest_api.log.1：6月23 15:46:11 mybookliveduo rest_api [9529]：94.102 49.104输出系统_factory_restore帖子成功</p><p> A  second log file I obtained from a hacked My Book Live device showed a different IP address—23.154.177.131—exploiting the same vulnerability. Here are the telltale lines:</p><p> 我从Hacked My Bable Live设备中获取的第二个日志文件显示出不同的IP地址-23.154.177.131-in-prefoiting相同的漏洞。这是Telltale Line：</p><p> Jun 16 07:28:41 MyBookLive REST_API[28538]: 23.154.177.131 PARAMETER System_factory_restore POST : erase = format Jun 16 07:28:42 MyBookLive REST_API[28538]: 23.154.177.131 OUTPUT System_factory_restore POST SUCCESS</p><p> 2007年6月16日07:28:41 [28538]：231参数system_factory_restore帖子：erase = format 2016 07:28:42 mybooklive rest_api [28538]：231输出system_factory_restore帖子成功</p><p> After presenting these findings to Western Digital representatives, I received the following confirmation: “We can confirm that in at least some of the cases, the attackers exploited the command injection vulnerability (CVE-2018-18472), followed by the factory reset vulnerability. It’s not clear why the attackers exploited both vulnerabilities. We’ll request a CVE for the factory reset vulnerability and will update our bulletin to include this information.”</p><p> 在向Western Digital代表介绍这些调查结果后，我收到以下确认：“我们可以确认至少在某些情况下，攻击者利用命令注入漏洞（CVE-2018-18472），然后是出厂重置漏洞。目前尚不清楚为什么攻击者利用这两种漏洞。我们将为工厂重置漏洞的CVE申请，并将更新我们的公告以包含此信息。“ </p><p>  The discovery raises a vexing question: if the hackers had already obtained full root access by exploiting CVE-2018-18472, what need did they have for this second security flaw? There’s no clear answer, but based on the evidence available, Abdine has come up with a plausible theory—that one hacker first exploited CVE-2018-18472 and a rival hacker later exploited the other vulnerability in an attempt to wrest control of those already compromised devices.</p><p>该发现提出了一个烦恼的问题：如果黑客通过利用CVE-2018-18472已经获得了完全root访问权限，他们为这一第二次安全漏洞有什么需要？没有明确的答案，但基于可用的证据，ABDINE提出了一种合理的理论 - 即一个黑客首次开发的CVE-2018-18472和竞争对手黑客以便在尝试控制那些已经受到影响的情况下剥夺了其他脆弱性设备。</p><p> The attacker who exploited CVE-2018-18472 used the code execution capability it provided to modify a file in the My Book Live stack named language_configuration.php, which is where the vulnerability is located. According to a  recovered file, the modification added the following lines:   }</p><p> 被利用CVE-2018-18472的攻击者使用了所提供的代码执行功能来修改我的书籍实时堆栈中的文件，命名为language_configuration.php，这是漏洞所在的位置。根据恢复的文件，修改添加了以下行：}</p><p>   $langConfigObj = new LanguageConfiguration();  if(!isset($changes[&#34;submit&#34;]) || sha1($changes[&#34;submit&#34;]) != &#34;56f650e16801d38f47bb0eeac39e21a8142d7da1&#34;) 	{ 	die(); 	}  The change prevented anyone from exploiting the vulnerability without the password that corresponds to the cryptographic SHA1 hash 56f650e16801d38f47bb0eeac39e21a8142d7da1. It turns out that the password for this hash is p$EFx3tQWoUbFc%B%R$k@. The plaintext appears in the recovered log file  here.</p><p>   $ langconfigobj = new languageconfiguration（）; if（！isset（$更改[＆＃34;提交＆＃34;]）|| sha1（$ drame [＆＃34;提交＆＃34;]）！=＆＃34; 56f650e16801d38f47bb0ead39e21a8142d7da1＆＃34;）{die（） ;更改阻止了任何人都会利用与密码对应于加密SHA1 HASH 56F650E16801D38F47B0142D7DA1的密码的漏洞。事实证明，此哈希的密码为P $ EFX3TQWOUBFC％B％R $ K @。明文在此处显示在恢复的日志文件中。</p><p>    A  separate modified language_configuration.php file recovered from a hacked device used a different password that corresponds to the hash 05951edd7f05318019c4cfafab8e567afe7936d4. The hackers used a third hash—b18c3795fd377b51b7925b2b68ff818cc9115a47—to password-protect a separate file named accessDenied.php. It was likely done as an insurance policy in the event that Western Digital released an update that patched language_configuration.</p><p>    从黑客设备中恢复的单独修改的语言_Configuration.php文件使用了与Hash 05951EDD7F05318019C4CFAFAB8E567AFE7936D4对应的不同密码。黑客使用第三个哈希-B18C3795FD377B51B7925B2B68FF818CC9115A47-to password-protect一个名为deacternied.php的单独文件。如果西方数字发布更新修补的Language_Configuration，它可能会作为保险单。</p><p>  According to Western Digital’s advisory linked above, some of the My Book Live devices hacked using CVE-2021-18472 were infected with malware called  .nttpd,1-ppc-be-t1-z, which was written to run on the PowerPC hardware used by My Book Live devices. One user in the support forum  reported a hacked My Book Live receiving  this malware, which  makes devices part of a botnet called Linux.Ngioweb.</p><p>  根据上面链接的Western Digital的咨询，使用CVE-2021-18472被CVE-2021-18472发送的一些我的书籍直播设备被称为.nttpd，1-ppc-be-t1-z的恶意软件被攻击，它被写入使用的PowerPC硬件运行由我的书籍现场设备。支持论坛中的一个用户报告了一个攻击我的书籍现场，接收此恶意软件，这使得设备的一部分被称为Linux.ngiowebeB。</p><p>  So why would someone who successfully wrangled so many My Book Live devices into a botnet turn around and wipe and reset them? And why would someone use an undocumented authentication bypass when they already have root access?</p><p>  那么为什么将那些成功捆绑这么多的人的人会将设备直播到僵尸网络转身并擦拭并重置它们？为什么有人会在已经有root访问权限时使用未记录的身份验证旁路？</p><p> The most likely answer is that the mass wipe and reset was performed by a different attacker, very possibly a rival who either attempted to take control of the rival’s botnet or simply wanted to sabotage it.</p><p> 最有可能的答案是，大众擦除和重置是由不同的攻击者执行的，这可能是一个竞争对手，他们试图控制竞争对手的僵尸网络或只是想破坏它。 </p><p> “As for motive for POSTing to this [system_factory_restore] endpoint on a mass scale, it is unknown, but it could be an attempt at a rival botnet operator to take over these devices or render them useless, or someone who wanted to otherwise disrupt the botnet which has likely been around for some time, since these issues have existed since 2015,” Abdine wrote in a  recent blog post.</p><p>“对于发布到这个[system_factory_restore]端点的动机在大规模范围内，它是未知的，但它可能是对竞争对手僵尸网络运营商的尝试，以接管这些设备或使其无用，或者想要侵扰的人僵尸网络可能已经存在了一段时间，因为自2015年以来存在这些问题，“Abdine在最近的博客文章中写道。</p><p> The discovery of this second vulnerability means that My Book Live devices are even more insecure than most people thought. It adds authority to Western Digital’s recommendation to all users to disconnect their devices from the Internet. Anyone using one of these devices should heed the call immediately.</p><p> 发现这一第二漏洞意味着我的书籍现场设备比大多数人认为更不安全。它为Western Digital的建议添加了对所有用户的推荐，将其设备与Internet的连接断开。使用其中一个设备的任何人都应该立即呼叫。</p><p> For many hacked users who lost years&#39; or decades&#39; worth of data, the thought of buying another Western Digital storage device is probably out of the question. Abdine, however, says that My Cloud Live devices, which replaced Western Digital’s My Book Live products, have a different codebase that doesn’t contain either of the vulnerabilities exploited in the recent mass wiping.</p><p> 对于减少几年的许多黑客用户＆＃39;或数十年＆＃39;值得的数据，购买另一个西方数字存储设备的想法可能是不可能的。然而，ABDINE表示，我的云实时设备替换了Western Digital的我的书籍现场产品，具有不同的代码库，这些代码库不包含最近遭受批量擦拭的任何一个漏洞。</p><p> “I took a look at the My Cloud firmware, too,” he told me. “It&#39;s rewritten and bears some, but mostly little, resemblance to My Book Live code. So it doesn&#39;t share the same issues.”</p><p> “我也看看我的云固件，”他告诉我。 “它和＃39;重写并忍受了一些，但大多数很少，与我的书籍实时代码相似。所以它没有分享同样的问题。“</p><p>  I was happier when the story was simply &#34;We didn&#39;t bother patching this thing from 2018&#34;...</p><p>  当故事只是＆＃34时，我更快乐;我们在2018年从2018年和＃34打扰了这个东西。...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://arstechnica.com/gadgets/2021/06/hackers-exploited-0-day-not-2018-bug-to-mass-wipe-my-book-live-devices">https://arstechnica.com/gadgets/2021/06/hackers-exploited-0-day-not-2018-bug-to-mass-wipe-my-book-live-devices</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/黑客/">#黑客</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/现场/">#现场</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/exploited/">#exploited</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/设备/">#设备</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>