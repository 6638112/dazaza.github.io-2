<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>初始M1支持合并到Linux Soc树中 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">初始M1支持合并到Linux Soc树中 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-09 13:43:55</div><div class="page_narrow text-break page_content"><p>* ARM / Apple-M1：（79款项）ARM64：Apple：Apple：添加初始Apple Mac Mini（M1,2020）DeviceTree DT绑定：显示：添加Apple，简单框架缓冲器ARM64：KCONFIG：介绍CONFIG_ARCH_APPLE IRQCHIP / APPL-AIC：添加支持对Apple中断控制器DT绑定：中断控制器：为Apple-AIC ARM64添加DT绑定：从ARM-GIC-V3.H到SYSREG.H的ICH_ SYSREG位，SYSREG.H /地址：添加基础架构以声明MMIO使用iORemap_np arm64实现pci_remap_cfgspace：ioRemap_np（）以将MMIO映射为NGNRNE文档：Driver-API：Device-IO：Document IORemap（）Variants＆amp; Access Funcs Docs：Driver-API：Device-IO：Document I / O Access Functions ASM-Generic / IO.H：添加IORemap（）arm64：ARCH_TIMER的非发布变量：INCELES支持中断名称DT绑定：计时器：ARM，ARCH_TIMER：添加中断名称支持ARM64：CPOTYPE：添加CPU实现者＆amp; Apple M1核心类型的类型DT绑定：ARM：CPU：添加Apple，Firestorm＆amp; ICEStorm Compatibles DT-绑定：ARM：Apple：为Apple Arm Platforms添加绑定DT绑定：供应商 - 前缀：添加Apple Prefix ARM64：IRQ：允许FIQS处理ARM64：始终保持DAIF ...</p><p>    + Apple设备树的根节点的属性，降低。有可能</p><p>                                                                                                                                                                                                                                                                                                                                      +由于它取决于特定的装置中的两半中的特定装置</p><p>               +仅安全使用这些来访问设备总线后面的内存，但不是MMIO</p><p>  +访问甚至自旋锁。字节顺序通常与正常相同</p><p> +内存，所以与其他功能不同，这些功能可用于复制数据之间的数据</p><p>                    +在PCI基地址寄存器中可能与端口号相对应 </p><p>+由设备驱动程序。 便携式驱动程序需要阅读端口号  FIFO寄存器中的第一个字节对应于内存中的第一个字节  + *没有投机操作 -  CPU可能不会发出读写或写入  + *没有重新排序 -  CPU可能不会重新排序访问此内存映射  + *没有重复 -  CPU可能不会为单个发出多个读取或写入  +写道。 在使用__raw I / O访问器时或可能不会强制执行这一点或者  发布+映射，这意味着CPU不等待写入 </p><p>+ * CPU可以重新排序操作，只要结果与结果一致  + * CPU可以多次写入同一位置，即使程序  +在PCI总线上，通常可以安全地使用标记为MMIO区域的IORemap_WC（）  + * CPU可以缓存写入的写入并从设备读取，并提供读取  +写入以及时地到达设备（而不是卡在CPU中  +由于发布的写语义，这并不是如此  +可以使用缓存，并且CPU可以自由处理设备，好像它是一个 </p><p>+它也应该不用于实际的RAM，因为返回的指针是一个  - 它将运作。 驱动程序仅被测试为该模块  -device主要数字46，并将是命名/ dev / ttyrx，其中x是端口号  -in命令使用端口，必须使用mknod创建其设备名称（节点）。  - 在安装和使用它之前卡。 这是通过设置一组DIP来完成的  - 第一板使用该范围的前4个字节。 你会  - 将第二个，第三或第四板设置为下一个可用的一个 </p><p>-  | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       -  * fiq例外，在＆＃39; daif＆＃39;登记。我们在＆＃39中掩盖和揭开它们; Dai＆＃39;</p><p> + * fiq例外，在＆＃39; daif＆＃39;登记。我们在＆＃39中掩盖和揭开它们; daif＆＃39;</p><p>     -  *其他标志的副作用。保持这个订单使它更容易</p><p>    -  * FIQ从未预期，但在禁用调试异常时，我们会掩盖它，</p><p>    + *标志。保持此命令使入门更容易知道哪个</p><p>                                                                                                                                                                                                           -  * DA_F在处理开始时被清除。如果在Daif中设置有任何东西， </p><p>-  *等待要发送的最后剩余数据。 然后，我们取消链接它  + *此外，此驱动程序还处理FIQS，因为它们被路由到相同  + * IRQ矢量。 这些用于快速IPIS（TODO），ARMv8计时器IRQS，以及  + *  - 此驱动程序创建两个IRQ域，一个用于HW IRQS和内部FIQS，  + *  - 由于Linux需要超过2个IPI，因此我们实现了软件IRQ控制器  + *并汇集所有IPI到一个每CPU IPI（第二＆＃34;自我和＃34; IPI未使用）。  + *由他们的目的（HV或Guest）。 此映射是核心时的 </p><p>+ *在EL2运行（带VHE）。 当内核在EL1运行时，  + *有办法找出任何给定的IRQ的类型，所以只需允许两者。  + / *我们掩盖到ACK（我们可以在哪里），所以我们需要在EOI揭开。 * /  + *如果我们有一个系统寄存器，这将是非常好的，让我们得到  + * ack ipi。 我们需要在AIC事件读取后订购此，但  + *不需要订购屏蔽读取。 只有我们可以改变  + *无论如何，我们自己的面具，所以这里没有比赛，只要 </p><p>写部分的+ *，而后者是由此处理的</p><p>                                                                                                    + *确保内核＆＃39;逻辑CPU秩序的思想与AIC＆＃39; s相同</p><p> + *如果我们在这里有不匹配的话，我们将不得不介绍</p><p>                                                                                                                                                                                                                                                 + *目前仅在支持Apple Arm设备的构建时启用，如</p><p>                                                                  *尝试启动下一个IO并唤醒进程等待TTY。</p><p>                                                                                                                                                                                    - 如果要将此驱动程序汇总到内核中，请在此处说y。如果</p><p>                                                                                                                                                                                                                                                                                                    -static const char baud_co_60 [] = {/ * 60 MHz时钟选项表（CD1400 j）* / </p><p>-static const char baud_bpr_60 [] = {/ * 60 MHz波特率句号表（CD1400 J）* /</p><p>                -  *允许我们利用CD1400中的特殊功能来避免</p><p>  -  *即使系统中断延迟太高，即使系统中断延迟过高）。这些标志</p><p>   -  *需要使用特殊的电缆（DTR和RTS反转）。在新的</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                  -		 * 发送。如果是，我们必须确保它有空间</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      - 如果关闭Termio标志的挂起，则删除*和DTR。</p><p>                                                                                                                                                                                                                                                                                                                                                          -  *如果端口已处于活动状态，则无需启动它。 </p><p>- 如果（波特== 0）{/ *波特率为零，请关闭线* /</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -  * IRQ丢失，因此，我们必须将其重新写入PCI配置。</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    -  for（j = 0，i = cy_next_channel; i＆lt; cy_next_channel + nchan; i ++，j ++）</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -  -1,0，1,2,3,4,5,6,7,8,9,11,13,15,16,17,18,19,20，21</p><p>                                   -  *卡片的内核锁定并将卡放在一个位置</p><p>                                                                                                                                                                               -  *我们定期将数据铲到卡缓冲区中。卡片</p><p>                                                                                                                                                                                                                                                                                                             -  / *如果CBAudex位打开并将波特设置为50或75 </p><p>-  / *在港口上打开比卡片的端口数！ * /</p><p>                                                                                                                                                                                                                                                                                                                                                       -  / *告诉卡片现在无法处理此端口无法处理的数据* /</p><p>               -  / *告诉卡片该端口已准备好接受更多数据* /</p><p>                                                                                                -  if（sig！= 0xa5＆amp;＆amp; sig！= 0xbb＆amp;＆amp; sig！= 0xcc＆amp;＆amp; sig！= 0xdd＆amp;＆amp;</p><p>             -  if（！（inw（基本+ 0xe）＆amp; 0x1）||（portcount！= 0＆amp; portcount！= 4＆amp;＆amp;</p><p>                                                                                                                        -  / * xxx：我们应该通过读回来并与原始相比进行测试</p><p>                                                                                                                                                                                                                                                                                                              -  for（i = count，dp = cp，f = fp; i; i--，dp ++）{ </p><p>-  *此驱动程序有2个内核控制路径 - 异常处理程序（调用进入驱动程序  -  *从用户模式）和定时器底部（tasklet）。 这是一个轮询司机，中断  -  *  -  rp_table []，通过传递和＃34访问;信息＆＃34; 指针，是一个全局（静态）数组  -  *  -  XMIT_FLAGS []，按行（端口）编号索引的int数组，表示存在  -  * ISA和常规PCI板之间的这些位不同  -  {-1，-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0，0，{0,0,0,0,0}，  -  {-1，-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0，0，{0,0,0,0,0}， </p><p>-  {-1，-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0，0，{0,0,0,0,0}，  -  {-1，-1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0，0，{0,0,0,0,0}，  -  *接收数据存在于串行端口上。 从FIFO中取出数据，将其移入  -  *串口传输数据功能。 从计时器轮询循环调用  -  *在XMIT_FLAGS []中设置的比特结果，指示数据（来自TTY层）已准备就绪  -  *要发送串行端口。 数据在rp_table [line] .xmit_buf中缓冲，它是  -  *移动到端口＆＃39; s xmit fifo。 * INFO是由Spinlocks保护的关键数据。 </p><p>-  *当串口信号时调用它在它中读取数据＆＃39; s rx fifo。  -  *到端口上的XMIT。 位0是端口0在该板上，位1是端口  -  * 1，......（32种）。 我拥有AIOP和CH的变量  -  *重置计时器，以便在下一个时钟滴答（10ms）时调用。  -  *初始化端口的R_Port结构，以及启用端口  -  / *获取端口的R_PORT结构，填写它并全局保存，按行号索引* /  -  *用户模式进入驱动程序（例外处理程序）。 *信息CD操作是Spinlock受保护的。 </p><p>-  *我们不能从这里睡觉，直到港口充分标记使用。</p><p>                                                                                                                                                                                                                     -  *加入UPCI板，决定使这是一个功能，因为</p><p>                      -  / *以下是RP_IOCTL使用的例程。这些都从例外处理程序调用。 * /</p><p>    -  *返回串行调制解调器控制线的状态。下一个功能</p><p>  -  *是内核版本＆gt的方式; 2.5处理调制解调器控制线而不是IOCTL。</p><p>                                                                                                                                                                                                                                                                                                                                                                                                                                           -  *异常处理程序 - 写RITI</p><p>...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://git.kernel.org/pub/scm/linux/kernel/git/soc/soc.git/commit/?h=for-next&id=0d5fe4b31785b732b71e764b55cda5c8d6e3bbbf">https://git.kernel.org/pub/scm/linux/kernel/git/soc/soc.git/commit/?h=for-next&id=0d5fe4b31785b732b71e764b55cda5c8d6e3bbbf</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/m1/">#m1</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1055998.html"><img src="http://img2.diglog.com/img/2021/4/thumb_29ed6eefb83ec993766bc0b67680012a.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1055998.html">阿尔马辛克斯作为那些喜欢Centos的人释放为稳定的Rhel克隆 </a></div><span class="my_story_list_date">2021-4-4 4:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1055577.html"><img src="http://img2.diglog.com/img/2021/4/thumb_62427be997d64c0b04c61c1d5beb4656.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1055577.html">sco linux fud从死者返回 </a></div><span class="my_story_list_date">2021-4-2 1:25</span></div><div class="col-sm"><div><a target="_blank" href="/story/1055356.html"><img src="http://img2.diglog.com/img/2021/4/thumb_ade9e1dcc6a3e20075f9c164698b6ef9.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1055356.html">UP：使用即时实时预览编写Linux管道的工具 </a></div><span class="my_story_list_date">2021-4-1 20:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1055335.html"><img src="http://img2.diglog.com/img/2021/4/thumb_8b0308443b25cdf8f1c72ef7c0feca6c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1055335.html">最新的T2 Linux在486上，只有32mib RAM </a></div><span class="my_story_list_date">2021-4-1 19:54</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>