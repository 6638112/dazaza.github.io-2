<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>混沌网格有望为混沌工程带来秩序 Chaos Mesh Promises to Bring Order to Chaos Engineering</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Chaos Mesh Promises to Bring Order to Chaos Engineering<br/>混沌网格有望为混沌工程带来秩序 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-07 03:00:30</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/2bd05e4988e4da6633f0e98cba97af60.jpg"><img src="http://img2.diglog.com/img/2020/12/2bd05e4988e4da6633f0e98cba97af60.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Chaos and engineering are two words you would never have seen together before the year  2010. Probably because engineering is generally considered constructive while chaos is, well, quite the opposite. That being said, when you first read about Netflix’s Chaos Monkey, the original chaos engineering tool, it’s tempting to imagine a monkey pulling out wires and hammering on systems with a wrench at random. Quite the contrary, however, chaos engineering is a disciplined approach to finding faults before they become outages. This is done by proactive failure testing or injecting failures in a controlled manner so that the system’s ability to respond can be measured and improved upon. These failures could be anything from injecting latency to network failures to high CPU and memory usage. You can even simulate a DDoS (distributed denial-of-service) attack or any other event that would cause disruption to your services. Quoting  Seth Eliot from AWS, “You can’t consider your workload to be resilient until you hypothesize how your workload will react to failures.” And that brings us to Chaos Mesh.</p><p>混沌和工程是您在2010年之前从未见过的两个词。可能是因为工程通常被认为具有建设性，而混乱却恰恰相反。话虽这么说，当您初次了解Netflix的原始混沌工程工具Chaos Monkey时，很容易想像到猴子会随机拔出电线并用扳手敲击系统。但是，恰恰相反，混沌工程是一种在故障变成断电之前发现故障的有纪律的方法。这是通过主动进行故障测试或以受控方式注入故障来完成的，以便可以评估和改进系统的响应能力。这些故障可能是从注入延迟到网络故障再到较高的CPU和内存使用量。您甚至可以模拟DDoS（分布式拒绝服务）攻击或任何其他可能导致服务中断的事件。引用AWS的Seth Eliot的话，“除非您假设工作负载将如何应对故障，否则您不能认为工作负载具有弹性。”这使我们进入了混沌网格。</p><p>   Chaos Mesh 1.0 hit general availability earlier this month and is an open-source, CNCF hosted, cloud-native chaos engineering solution that orchestrates fault injection for complex systems on  Kubernetes. Chaos Mesh was developed at PingCAP for fault-testing their open-source database system TiDB. It is the second CNCF-hosted project from PingCAP after TiKV, the distributed key-value storage engine.  PingCAP CTO Ed Huang stated that “traditional deterministic testing” isn’t enough to ensure resilience in distributed systems on Kubernetes.</p><p>   Chaos Mesh 1.0将于本月初正式面市，它是一个开放源代码，由CNCF托管，云原生的混沌工程解决方案，可为Kubernetes上的复杂系统编排故障注入。 Chaos Mesh是在PingCAP上开发的，用于对其开源数据库系统TiDB进行故障测试。这是继PikCAP之后的第二个由CNCF托管的项目，仅次于分布式键值存储引擎TiKV。 PingCAP首席技术官Ed Huang表示，“传统确定性测试”不足以确保Kubernetes上分布式系统的弹性。</p><p> Built exclusively for Kubernetes, Chaos Mesh covers chaos experiments on everything from pods to networks to file systems and even the kernel itself. Chaos Mesh aims to be a “universal” and neutral chaos testing platform that’s easy-to-use, as well as scalable to the petabyte level. Being Kube-native, it requires no special dependencies or modifications and can be deployed directly on clusters. Another advantage is that it integrates well with other testing frameworks and can even perform chaos experiments in production environments.</p><p> 专门为Kubernetes构建的Chaos Mesh涵盖了从Pod到网络到文件系统甚至内核本身的所有混沌实验。 Chaos Mesh的目标是成为一个易于使用且可扩展到PB级的“通用”且中立的混沌测试平台。作为Kube原生的，它不需要特殊的依赖关系或修改，并且可以直接部署在集群上。另一个优点是，它可以与其他测试框架很好地集成，甚至可以在生产环境中执行混乱的实验。</p><p>   Unlike in the past, where servers being “up” was an indication of everything being as it’s supposed to be, today it’s about functionality and user experience. Similar to how Netflix  checks its pulse by calculating the number of times the play button is pressed, Chaos Mesh works by simulating pod downtime using TiKV and then analyzing how this affects the QPS (queries per second). If the button in question doesn’t do what it’s supposed to, users are going to keep pressing it, causing the QPS to go up and indicating that something isn’t functioning right.</p><p>   与过去不同，服务器处于“启动”状态表明一切都应运而生，而今天则与功能和用户体验有关。类似于Netflix通过计算按下播放按钮的次数来检查其脉冲的方式，Chaos Mesh的工作原理是使用TiKV模拟pod的停机时间，然后分析其对QPS（每秒查询量）的影响。如果所讨论的按钮没有达到预期的功能，则用户将继续按下该按钮，从而导致QPS上升，并指示某些功能无法正常运行。</p><p> In such a case where a crashed pod causes the QPS to fluctuate and then come back to acceptable levels within a minute, you know your system is resilient, and you can move on to the next test. However, in the case where it takes up to nine minutes to return to normal, like in  this example, further investigation is required. Chaos Mesh features two kinds of pod-level fault injections, namely, pod-kill and pod-failure. While the latter simulates a pod being unavailable, the former, as the name suggests, simulates a pod being killed, you can also create custom pod-level faults like PodNetworkChaos or PodIOChaos.</p><p> 在这种情况下，当机顶盒崩溃导致QPS波动，然后在一分钟内恢复到可接受的水平时，您就知道系统具有弹性，可以继续进行下一个测试。但是，如本例所示，在最多需要9分钟才能恢复正常的情况下，需要进一步调查。混沌网格具有两种pod级别的故障注入，即pod-kill和pod-failure。后者模拟了一个不可用的Pod，而前者，顾名思义，模拟了一个Pod被杀死，您还可以创建自定义的Pod级别故障，例如PodNetworkChaos或PodIOChaos。</p><p>   Now bear in mind, a crashed pod is just one example of fault injection that Chaos Mesh is capable of. There are six chaos types: PodChaos, NetworkChaos, TimeChaos, StressChaos, IOChaos, and KernelChaos. Concerning networking errors, in particular, you have a lot more options than the other chaos types. There’s network-delay, network-corrupt, network-loss, network-duplication, and network-partition, all of which affect the network as their names suggest. For filesystem chaos, you have just two, I/O delay and I/O error that simulate file system I/O delays and errors, respectively.</p><p>   现在要记住，一个崩溃的吊舱只是Chaos Mesh能够进行故障注入的一个示例。有六种混沌类型：PodChaos，NetworkChaos，TimeChaos，StressChaos，IOChaos和KernelChaos。特别是在网络错误方面，您比其他混乱类型有更多选择。网络延迟，网络损坏，网络丢失，网络复制和网络分区，正如它们的名称所暗示的，所有这些都会影响网络。对于文件系统混乱，您只有两个，即I / O延迟和I / O错误，分别模拟文件系统I / O延迟和错误。</p><p> Other major chaos experiments include container-kill, an important one because it lets you kill a specific container in a pod, CPU-burn that stresses the CPU of a selected pod, and Memory-burn that stresses its memory. TimeChaos is also an important one, especially in a distributed environment where it’s critical to maintain a synchronized clock across all nodes to remain compliant and maintain security. TimeChaos introduces a fault called “clock skew” that basically introduces a time difference between the clocks on different nodes to see how your systems respond.</p><p> 其他主要的混乱实验包括容器杀死，这是一个重要的实验，因为它可以杀死容器中的特定容器，CPU消耗使选定容器的CPU处于压力状态，内存消耗使存储器处于压力状态。 TimeChaos也是重要的一环，尤其是在分布式环境中，在该环境中，跨所有节点维护同步时钟以保持合规性并维护安全至关重要。 TimeChaos引入了一个称为“时钟偏斜”的故障，该故障从根本上引入了不同节点上的时钟之间的时差，以了解您的系统如何响应。 </p><p>  Now CustomResourceDefinition or CRD is a powerful Kubernetes feature that basically extends the Kubernetes API to allow you to define custom resources. Chaos Mesh uses this ability of Kubernetes to define custom chaos objects like the 6 chaos types we mentioned earlier. Chaos Mesh also leverages existing CRD implementations wherever applicable and allows you to use existing CRDs to build new objects to start chaos experiments with. New objects can be created or existing CRDs updated with a YAML file or a Kubernetes API.</p><p>现在，CustomResourceDefinition或CRD是强大的Kubernetes功能，从根本上扩展了Kubernetes API以允许您定义自定义资源。 Chaos Mesh使用Kubernetes的这种功能来定义自定义混沌对象，例如我们前面提到的6种混沌类型。 Chaos Mesh还可以在适用的情况下利用现有的CRD实现，并允许您使用现有的CRD来构建新对象以开始进行混沌实验。可以创建新对象，或使用YAML文件或Kubernetes API更新现有CRD。</p><p> The YAML method is the preferred method here, especially since it can conduct chaos experiments post-deployment. To create your own custom chaos experiment, you need to create your own YAML config file though it’s pretty easy to find  examples online. Alternatively, CRDs can be manipulated directly through the Kubernetes API. The fact that Chaos Mesh defines chaos objects with CRDs makes it a natural fit for Kubernetes for Kubernetes-based applications. This also makes installation a lot easier since it’s as simple as applying a set of CRDs to a cluster.</p><p> YAML方法是此处的首选方法，尤其是因为它可以在部署后进行混乱的实验。要创建自己的自定义混乱实验，您需要创建自己的YAML配置文件，尽管在线查找示例非常容易。或者，可以通过Kubernetes API直接操作CRD。 Chaos Mesh用CRD定义混沌对象的事实使得它很自然地适合Kubernetes用于基于Kubernetes的应用程序。这也使安装变得容易得多，因为它就像将一组CRD应用于集群一样简单。</p><p>  At the moment, Chaos Mesh is made up of  two core components, Chaos Operator, which performs the orchestration (GA and is fully open-sourced), and Chaos Dashboard, that’s essentially a web UI for creating, managing, and monitoring chaos experiments (under development). The Chaos Operator is also referred to as the controller-manager and uses object controllers to manage CRDs, and admission-webhook controllers to insert sidecar proxies into containers. The Chaos Operator also features a Chaos Daemon functioning as an agent, running a pod on each node.</p><p>  目前，Chaos Mesh由两个核心组件组成：执行编排的Chaos Operator（GA，并且是完全开源的）和Chaos Dashboard，它实质上是用于创建，管理和监视混沌实验的Web UI（正在开发中）。混沌操作员也称为控制器管理器，它使用对象控制器来管理CRD，并使用准入网钩控制器将Sidecar代理插入到容器中。 Chaos Operator还具有一个Chaos Daemon，它充当代理程序，在每个节点上运行一个pod。</p><p> The Chaos Daemon here is a daemonset running with privileged permissions for a specific node. The controller-manager relays the required actions to the daemonset that, in turn, uses its privilege to manipulate the system to affect the target pods as required. Admission Webhooks comes into the picture when we’re looking to simulate more serious IO type failures, which are achieved by injecting chaos-sidecars into pods during app deployment and basically hijacking the IO by intercepting file-system calls. Based on how the above scenario affects the QPS, the necessary changes can be made to avoid outages caused by similar situations.</p><p> 这里的Chaos守护程序是一个具有特定节点特权的守护程序集。控制器管理器将所需的操作中继到守护程序集，该守护程序集继而使用其特权来操纵系统以根据需要影响目标容器。当我们要模拟更严重的IO类型故障时，准入Webhooks出现了，这是通过在应用程序部署期间将混乱的小车注入到pod中并通过拦截文件系统调用来劫持IO来实现的。根据上述情况如何影响QPS，可以进行必要的更改以避免类似情况引起的中断。</p><p>  Chaos Mesh is by no means the only option for a chaos engineering platform, and another CNCF hosted competitor that checks a lot of the same boxes is called Litmus or LitmusChaos. We say this because, like Chaos Mesh, Litmus is an open-source, cloud-native, uses CRDs for chaos management, and is built for Kubernetes. Other popular options include the original chaos engineering tool Chaos Monkey, Gremlin that offers chaos engineering as a Service, Chaos Toolkit, and KubeInvader.</p><p>  混沌网格绝不是混沌工程平台的唯一选择，另一个由CNCF托管并检查很多相同盒子的竞争对手称为Litmus或LitmusChaos。我们之所以这样说，是因为与Chaos Mesh一样，Litmus是开源的云原生平台，使用CRD进行混沌管理，并且是为Kubernetes构建的。其他流行的选项包括原始的混沌工程工具Chaos Monkey，提供混沌工程即服务的Gremlin，Chaos Toolkit和KubeInvader。</p><p>  While chaos engineering may sound like a new-fangled oxymoron and breaking things in production may just sound just crazy, breaking things “productively” is quickly becoming the standard for resiliency testing in Kubernetes.</p><p>  虽然混乱的工程听起来像是一种新型的矛盾词，而在生产中破坏事物听起来似乎很疯狂，但“有效地”破坏事物正迅速成为Kubernetes弹性测试的标准。</p><p>              report this ad</p><p>              报告此广告 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://techgenix.com/chaos-mesh-chaos-engineering/">http://techgenix.com/chaos-mesh-chaos-engineering/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/带来/">#带来</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/chaos/">#chaos</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>