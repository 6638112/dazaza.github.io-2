<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>所有东西都是一个X</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">所有东西都是一个X</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-14 16:57:52</div><div class="page_narrow text-break page_content"><p>“Everything is an X” is a very high level pattern that you see applied in thedesign of lots of systems, including programming languages and user interfaces.It has a lot of advantages, and some disadvantages. I’ll discuss some of these,then look at some examples, which will be necessary to understand what I’mreally talking about.</p><p>“一切都是X”是一种非常高级的模式，你可以看到它应用于许多系统的设计中，包括编程语言和用户界面。它有很多优点，但也有一些缺点。我将讨论其中的一些，然后看一些例子，这些例子对于理解我真正在说什么是必要的。</p><p> When we say “everything” here, we’re talking very loosely — many things in thesystem are not, in fact, instances of “X”, but are something lower level, orjust completely different. “Everything is an X” really means “a surprisingnumber of things in this system are an X”.</p><p>当我们在这里说“一切”时，我们说的是非常松散的--事实上，系统中的许多东西不是“X”的实例，而是一些更低级别的东西，或者只是完全不同的东西。“Everything is a X”的真正意思是“这个系统中有令人惊讶的数量的东西都是X”。</p><p>   This gives a certain uniformity in how APIs work that tends to reduce theamount of work you have to do when learning a new library.</p><p>这使得API的工作方式具有一定的统一性，这往往会减少您在学习新的API库时必须做的工作量。</p><p> In terms of meta-levels, Java doesn’t have so much. It has some reflectionabilities that allow classes to be represented as runtime objects, although itis not very deep in terms of what it offers (contrast Python below).</p><p>就元级别而言，Java没有那么多。它有一些反射能力，允许将类表示为运行时对象，尽管它提供的内容不是很深入(对比下面的Python)。</p><p> The limited power for users is undoubtedly useful for compiler writers,however — you can get excellent performance with Java due to the more limitednature of the language (again, contrast Python below).</p><p>然而，用户有限的能力对编译器编写人员来说无疑是有用的--由于Java语言的局限性(同样，下面对比一下Python)，您可以在Java中获得出色的性能。</p><p> Java breaks its own pattern of basing everything on classes with “primitivetypes”, which means you have also have to deal with boxing, auto-boxing etc.Javascript has similar issues with  Number.</p><p>Java打破了自己将所有东西都建立在带有“primitivetype”的类上的模式，这意味着你还必须处理装箱、自动装箱等问题。Javascript在Number方面也有类似的问题。</p><p> Note that this is very different from Java’s version of “everything is aclass/object” — far more things are actually runtime objects in Python,including functions, methods, types/classes and modules, as well as instancesof classes. This makes  parameterisation anextremely powerful and general pattern in Python.</p><p>请注意，这与Java版本的“一切都是类/对象”有很大不同--更多的东西实际上是Python中的运行时对象，包括函数、方法、类型/类和模块，以及类的实例。这使得参数化成为了Python中一种非常强大和通用的模式。</p><p>   So meta-class programming is just normal programming. It can be done at a REPL, or with any other technique that you have already learned. Usingmeta-classes of course requires learning new things, but things still work invery familiar ways. Python feels like it’s made out of Python all the way down.</p><p>所以元类编程只是普通编程。它可以在REPL中完成，也可以使用您已经学习过的任何其他技术来完成。使用元课程当然需要学习新的东西，但事情仍然以非常熟悉的方式运作。Python给人的感觉就像是从Python一直往下做的。</p><p> We also see the disadvantages. For example, Python integers are full Pythonobjects, which is extremely wasteful of memory compared to compactrepresentations (like C would use, or numpy uses for example). Plus, they areimmutable (for good reasons), so doing simple addition can cause memoryallocations. This is pretty horrifying from an efficiency point of view!</p><p>我们也看到了不利之处。例如，Python整数是完全的PythonObjects，与紧凑的表示形式(比如C将使用的，或者Numpy使用的)相比，这是非常浪费内存的。此外，它们是不可变的(有充分的理由)，所以进行简单的加法可能会导致内存分配。从效率的角度来看，这是相当可怕的！</p><p> [Correction - in depends on implementation; CPython caches integers between -5and 255 and has some  other optimisations,but still has a lot of overhead in terms of the size of the object]</p><p>[修正取决于实现；CPython缓存-5到255之间的整数，并进行了一些其他优化，但在对象大小方面仍有很大开销]。</p><p> So, for example, there is no  if statement, there is instead an  ifexpression. Assignments, too, are actually expressions — for example a  letstatement is instead an expression that defines some local values and returnsthe value of the ‘body’.</p><p>例如，没有if语句，而是一个if表达式。赋值实际上也是表达式--例如，let语句是定义一些局部值并返回主体的值的表达式。</p><p> Exceptions: Top level assignments, and type signatures. At least in Haskell,the type system feels quite separate. Due to this,  AFAICS the meta level iskind of missing in Haskell. Haskell “super-powers” come from a bunch ofdifferent features, such as  deriving and TemplateHaskell, and programmingat type level, especially with various language extensions. These are all coolfeatures, but they have to be learned separately, and I think this is whatgives Haskell the feeling of being a big and intimidating language.</p><p>例外：顶层分配和类型签名。至少在哈斯克尔，类型系统感觉相当独立。正因为如此，AFAICS在Haskell中缺少元级别。Haskell的“超能力”来自一系列不同的特性，比如派生和模板化Haskell，以及类型级编程，特别是使用各种语言扩展。这些都是很酷的功能，但它们必须单独学习，我认为这就是哈斯克尔给人一种庞大而令人生畏的语言的感觉。</p><p> In contrast to Haskell, this goes much further and includes top levelstatements. This uniformity of syntax is hugely helpful in writing macros,probably the biggest meta-power that Lisp boasts.</p><p>与Haskell不同的是，它走得更远，包括最高级别的声明。这种统一的语法对编写宏非常有帮助，这可能是Lisp引以为豪的最大元能力。</p><p> This is one of Emacs’ big ideas — it has very few different  UI elements,because almost everything appears in a buffer. As well as the text of a fileto edit, you also have:</p><p>这是Emacs的一个重要想法--它几乎没有什么不同的用户界面元素，因为几乎所有的东西都出现在一个缓冲区中。除了要编辑的文件文本外，您还需要：</p><p> search results (this is an essential part of my workflow for recursivesearching that remembers context)</p><p>搜索结果(这是我记住上下文的递归搜索工作流程的重要组成部分)。</p><p> Once you have learned how to navigate and use buffers, you know how tonavigate these things.</p><p>一旦你学会了如何导航和使用缓冲区，你就知道如何导航这些东西了。</p><p> Of course, there are other  UI elements, such as the toolbar and menubar, tomake Emacs slightly less terrifying to new users. But these tend to be turnedoff by experienced users — they’re not very useful because…they’re not buffers!</p><p>当然，还有其他的用户界面元素，比如工具栏和菜单栏，让Emacs对新用户来说不那么可怕。但这些往往会被有经验的用户拒之门外--它们不是很有用，因为…。他们不是缓冲器！</p><p> You also gain meta-powers: the list of all buffers is of course a buffer, andyou can manipulate the buffer-buffer using normal mechanisms (e.g. delete lineto kill a buffer).</p><p>你也获得了元能力：所有缓冲区的列表当然是一个缓冲区，你可以使用正常的机制来操作缓冲区-缓冲区(例如，删除行可以杀死一个缓冲区)。</p><p> With some implementations such as PostgreSQL, as well as the normal relationsyou have created, internal structures are also presented as relations,including the lists of tables/relations/indexes, and runtime information.</p><p>在PostgreSQL等一些实现中，以及您创建的普通关系中，内部结构也以关系的形式呈现，包括表/关系/索引的列表，以及运行时信息。</p><p>     And  many other things. These things benefit from allthe usual powers of   SELECT, such as joins, filtering, ordering etc.</p><p>还有很多其他的东西。这些功能得益于SELECT的所有常见功能，如联接、过滤、排序等。</p><p> If you extended the meta-powers, you could create/delete tables by insertinginto/deleting from the “tables table”, and similarly add/remove/alter columnsby manipulating the “columns table”. Your schema then becomes data, and yourpower has become a super-power. I don’t know if any  DB has implemented this,or if the advantages would be really compelling over normal  DDL.</p><p>如果扩展了元能力，可以通过在“表”中插入/删除表来创建/删除表，并通过操作“列表”来类似地添加/删除/更改列。然后，你的模式就变成了数据，你的力量就变成了超能力。我不知道是否有数据库实现了这一点，或者它的优点是否真的比普通的DDL更有吸引力。</p><p> At points this seems to go further than PostgreSQL in terms of giving youmeta-powers and sticking to the pattern. In addition to the normal data sheets:</p><p>在某种程度上，这似乎比PostgreSQL在给你元能力和坚持模式方面走得更远。除了正常的数据报表外，还有：</p><p>   I’m loving the power of Visidata, which is basically “Excel as a text userinterface”, and I’ve realised that a lot of its power comes from its  lack ofpower.</p><p>我喜欢Visidata的强大功能，它基本上就是“Excel作为文本用户界面”，我意识到它的很多功能都来自于它的不足。</p><p> In Excel, you can have multiple tables in a sheet, and put them wherever youlike. You can have headers, or not, you can have a different format or datatype for every cell etc. In Visidata, you have exactly one table per sheet,you must have headers, each column has exactly one data type etc. The enforceduniformity of “Everything is a sheet (and a sheet has a tightly definedstructure)” is actually crucial to making Visidata so much nicer than Excelfor many tasks — without it, most of the interface shortcuts and meta-powerswould fail.</p><p>在Excel中，您可以在一个工作表中包含多个表，并将它们放在您喜欢的任何位置。你可以有页眉，也可以没有页眉，你可以为每个单元格设置不同的格式或数据类型等。在Visidata中，每个工作表只有一个表格，你必须有标题，每列只有一种数据类型等等。“一切都是工作表(并且工作表有严格定义的结构)”的强制一致性实际上是使Visidata在许多任务上比Excel更好的关键--没有它，大多数界面快捷方式和元功能都不会失败。</p><p> The idea of everything in your system being a “resource” which you canmanipulate with a few well-understood verbs ( GET,  PUT,  DELETE etc.) is areally attractive part of  REST.</p><p>系统中的所有东西都是“资源”的想法，你可以用几个容易理解的动词(GET、PUT、DELETE等)来操纵。是真正吸引人的休息的一部分。</p><p> It comes with some meta-powers - with things like  OpenAPI, the list of resources is typically also servedas a resource.</p><p>它附带了一些元功能--像OpenAPI这样的东西，资源列表通常也是作为一种资源来服务的。</p><p> Relatively frequently with  REST I feel I hit the “awkward fit” disadvantage.Modelling some actions as “manipulating a resource” is very bizarre, and whatyou really want is just a  RPC (for example, with “clone/copy/move” actionswhere there are hidden properties that you also want to be handled).</p><p>相对频繁地使用REST，我觉得我遇到了“不合适”的缺点。将某些操作建模为“操纵资源”非常奇怪，您真正想要的只是一个RPC(例如，使用“克隆/复制/移动”操作，其中有一些您也希望处理的隐藏属性)。</p><p> This is a pretty successful abstraction, but it does leak quite a bit — forexample, stdout and stdin are “files”, except when they are terminals, whichyou very often want to special case because they are not really very much likefiles when they have humans sitting in front of them. Also, files turn out tobe  much harder than you think, evenbefore you start treating things that aren’t files as files. And in some casesyou might want to deal with files as if they are not files but memory anyway (mmap).</p><p>这是一个相当成功的抽象，但它确实泄露了一些信息-例如，stdout和stdin都是“文件”，但当它们是终端时除外，您通常希望将它们作为特例，因为当它们有人类坐在它们前面时，它们实际上并不太像文件。而且，事实证明，文件比你想象的要难得多，甚至在你开始把不是文件的东西当作文件之前也是如此。在某些情况下，您可能希望处理文件，就好像它们不是文件，而是内存一样(Mmap)。</p><p> I’m sure there are many, many more examples of this pattern, and I’m onlyscratching the surface.  EverythingIsa on c2.com has a longer list, for example, butwithout much analysis. What are your favourite examples? Are there exampleswhere it works very well — or very badly? Are there otheradvantages/disadvantages that I’ve missed?</p><p>我相信这种模式的例子还有很多很多，我只是触及了皮毛。例如，c2.com上的EverythingIsa有一个更长的名单，但没有太多的分析。你最喜欢的例子是什么？有没有这样做效果很好的例子--或者非常糟糕的例子？有没有其他我没有错过的优点/缺点？</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://lukeplant.me.uk/blog/posts/everything-is-an-x-pattern/">https://lukeplant.me.uk/blog/posts/everything-is-an-x-pattern/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/文件/">#文件</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1033508.html"><img src="http://img2.diglog.com/img/2020/11/thumb_34433945ca23b6c223d75f623de56dbc.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033508.html">IBIS-一款PHP工具，可帮助您以标记格式编写电子书并将其转换为PDF</a></div><span class="my_story_list_date">2020-11-6 11:9</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032532.html"><img src="http://img2.diglog.com/img/2020/11/thumb_67de2ef7326f5b0cfc6201d2a0c3b804.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032532.html">预压缩：进一步压缩已压缩的文件</a></div><span class="my_story_list_date">2020-11-1 3:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031468.html"><img src="http://img2.diglog.com/img/2020/10/thumb_d31768f043a397f45761ccf56624d357.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031468.html">潜入/proc/pid/mem</a></div><span class="my_story_list_date">2020-10-27 21:7</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031258.html"><img src="http://img2.diglog.com/img/2020/10/thumb_2f679d0f803a613d2605ba8877034dec.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031258.html">分布式：将按需文件下载作为文件系统的Torrent客户端</a></div><span class="my_story_list_date">2020-10-26 23:57</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>