<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我的自动作曲方法My approach to automatic musical composition</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">My approach to automatic musical composition<br/>我的自动作曲方法</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-15 16:20:53</div><div class="page_narrow text-break page_content"><p>In this blog, I will introduce my approach to automatic musical composition, including the theory, the algorithm, and a Python package implementation  ch0p1n.</p><p>在这个博客中，我将介绍我的自动音乐创作方法，包括理论、算法和Python包实现ch0p1n。</p><p>   As a trivial example, imagine that you put a cat on a piano to randomly press keys to generate music. The music is thus the result of a predetermined algorithm rather than of your instantaneous emotions or compositional skills. This is why it is called  automatic composition.</p><p>举一个简单的例子，想象你把一只猫放在钢琴上，随机按下键来产生音乐。因此，音乐是预先确定的算法的结果，而不是你瞬间的情绪或作曲技巧的结果。这就是为什么它被称为自动合成。</p><p> Automatic composition has many different approaches or paradigms.  1 The approach I take is inspired by the theories of Arnold Schoenberg, Heinrich Schenker and William Caplin. The key idea is that  music can develop or be generated from limited materials under some common operations. I will explain the theoretical foundation of my approach in the following three sections.</p><p>自动作文有许多不同的方法或范例。1我采取的方法受到了阿诺德·勋伯格、海因里希·申克和威廉·卡普林理论的启发。关键的想法是，在一些常见的操作下，音乐可以从有限的材料中发展或产生。我将在以下三个部分中解释我的方法的理论基础。</p><p>  Let’s see an example, the beginning of Beethoven’s first piano sonata:</p><p>让我们来看一个例子，贝多芬第一首钢琴奏鸣曲的开头：</p><p>       In fact, the structure in the blue frame can be generated by merely transposing the structure in the red one. Therefore, to compose this piece, I need only to create the structure in the red frame, then reuse or slightly modify it to generate the structure in the blue frame, rather than create both structures from scratch.</p><p>事实上，蓝色框架中的结构可以仅通过转置红色框架中的结构来生成。因此，为了创作这篇文章，我只需要在红色框架中创建结构，然后重用或稍微修改它以生成蓝色框架中的结构，而不是从头开始创建两个结构。</p><p> The same situation happens in other parts too. As indicated below, the four framed structures are also highly similar:</p><p>同样的情况也发生在其他地方。如下所示，四个框架结构也非常相似：</p><p>  Does this kind of reuse exist only in Beethoven’s music? No, this probably happens in every musical work.  No matter how long a musical work lasts or how varied it can sound, the amount of its core materials is always small.</p><p>这种重复使用是否只存在于贝多芬的音乐中？不，这可能发生在每一部音乐作品中。无论一部音乐作品持续多长时间，或者它的声音有多变化多端，其核心材料的数量总是很少的。</p><p>   Sometimes, however, a material can be modified so much that you can barely recognize it, as in the following example, the beginning of Chopin’s nocturne Op.9 No.1:</p><p>然而，有时候，一种材料可以被修改得太多以至于你几乎认不出来，比如在下面的例子中，肖邦的夜曲作品9第一首的开头：</p><p>     The two framed structures look and sound quite different, but, in my approach, it is still that the structure in the blue frame can be generated by elaborating the structure in the red one, rather than that they are totally unrelated. It is so because the two structures have some morphological characteristics in common, they have the same background harmonic progression, and from the perspective of musical form, the structure in the blue frame is indeed a repetition of the structure in the red one.  2</p><p>这两个框架结构看起来和听起来都非常不同，但在我的方法中，蓝色框架中的结构仍然可以通过在红色框架中详细阐述结构来生成，而不是它们完全不相关。这是因为这两个结构有一些共同的形态特征，它们具有相同的背景和声级数，并且从音乐形式的角度来看，蓝色框架中的结构确实是红色框架中结构的重复。2.</p><p> Please note that, in stating that a structure can be generated from other structure, I do not assert that Beethoven or Chopin actually did this or deliberately did this when composing music. Rather, my point is that we can use this music generation perspective to formalize or automate the process of musical composition.</p><p>请注意，在声明一个结构可以由其他结构生成时，我并没有断言贝多芬或肖邦在作曲时确实这样做或故意这样做。相反，我的观点是，我们可以使用这种音乐生成的视角来正式化或自动化音乐创作的过程。</p><p>  Once a structure is created, some common operations can be applied to them to generate new structures. I will talk about some operations below.</p><p>一旦创建了一个结构，就可以对其应用一些常见的操作来生成新的结构。我将在下面讨论一些操作。</p><p> The first operation I will talk about is  repetition. It means repeating a structure in a new harmony without changing its morphology.</p><p>我要讲的第一个操作是重复。它意味着在不改变形态的情况下，以新的和谐方式重复一个结构。</p><p>   The structure in the blue frame is a  transposition of the structure in the red one. The two structures have the same morphology, although they are adapted to different background harmonies.</p><p>蓝色框架中的结构是红色框架中结构的换位。这两种结构具有相同的形态，尽管它们适应不同的背景和声。</p><p> The Chopin’s nocturne is another example. The accompaniment motif in the blue frame is a repetition of the one in the red frame:</p><p>肖邦的夜曲是另一个例子。蓝色框架中的伴奏主题与红色框架中的主题重复：</p><p>  In the repetition, some pitches move to their nearest pitches to fit the new harmony, according to some  voice-leading rules.  3 Some of these changes are indicated below:</p><p>在重复中，根据一些语音引导规则，一些音调会移动到最近的音调以适应新的和声。3其中一些变化如下所示：</p><p>     The next operation is  elaboration. It means adding passing notes, neighbor notes, and other types of notes to a structure. The Chopin’s nocturne is an example, in which a lot of tuplets are added in the repetition:</p><p>下一个操作是精化。这意味着向结构中添加传递注释、相邻注释和其他类型的注释。肖邦的夜曲就是一个例子，在重复中加入了许多元组：</p><p>  Sometimes, elaborations are rather inferred from than showed in scores. Heinrich Schenker’s theory differentiates music’s superficial structure from its deep structure(s), and the superficial structure is the outcome of elaboration of a deep structure, as showed in the following example:  4</p><p>有时，详细描述更多地是从分数中推断出来的，而不是表现在分数中。海因里希·申克（Heinrich Schenker）的理论区分了音乐的表层结构和深层结构，表层结构是深层结构细化的结果，如下例所示：</p><p>  In the above score, for example, piece b can be generated by elaborating piece c.</p><p>例如，在上面的分数中，b部分可以通过阐述c部分生成。</p><p> The opposite operation of elaboration is  reduction. For example, in the above score, piece b can be reduced to piece c.</p><p>精化的相反操作是简化。例如，在上述分数中，b部分可以减少为c部分。</p><p> The last operation I will talk about is  fragmentation. It means taking a fragment from a material.</p><p>我要说的最后一个操作是碎片化。这意味着从材料中取出一块碎片。</p><p> As in the Beethoven’s sonata, the structure in the blue frame is a fragment from the structure in the red one:</p><p>正如贝多芬的奏鸣曲一样，蓝色框架中的结构是红色框架中的一个片段：</p><p>       The fragment in the red frame can be modified to generate the structure in the orange frame; the fragment in the blue frame can be modified to generate the structures in the green frames. The two fragments are taken from the structure in the purple frame.</p><p>可以修改红色框架中的片段以生成橙色框架中的结构；蓝色框架中的片段可以修改以生成绿色框架中的结构。这两块碎片取自紫色框架中的结构。</p><p> There are more operations can be applied to musical materials, but I will stop here. The four operations I have introduced are enough for the purpose of this blog.</p><p>有更多的操作可以应用到音乐材料上，但我就到此为止。我所介绍的四个操作对于本博客来说已经足够了。</p><p>  Created and generated structures can be combined into larger structures, according to musical forms. A  musical form is a way in which musical materials should be organized.</p><p>根据音乐形式，创建和生成的结构可以组合成更大的结构。音乐形式是音乐材料组织的一种方式。</p><p> For example, the beginning of the Beethoven’s sonata has the form  sentence. Below is how this sentence is analyzed in William Caplin’s system:  2</p><p>例如，贝多芬奏鸣曲的开头有形式句。下面是威廉·卡普林的系统是如何分析这句话的：2</p><p>  The beginning of the Chopin’s nocturne is from a larger structure of the form  compound period, which is far more complex than sentence.</p><p>肖邦夜曲的开始是从一个更大的结构形式复合时期，这是远比句子复杂。</p><p> I will not go deep into the subject of musical forms here. I highly recommend William Caplin’s excellent textbook  2 on this topic. My key point is that musical materials should be combined according to musical forms to generate meaningful music.</p><p>我不会在这里深入讨论音乐形式的问题。我强烈推荐威廉·卡普林关于这个话题的优秀教材2。我的重点是，音乐材料应该根据音乐形式进行组合，以产生有意义的音乐。</p><p>      We first need to strictly define musical  materials and  structures, which we have been talking about quite vaguely.</p><p>我们首先需要严格定义音乐材料和结构，我们一直在模糊地谈论这些。</p><p> Let’s return to the Beethoven’s sonata. Below is its first two bars:</p><p>让我们回到贝多芬的奏鸣曲。下面是它的前两个栏：</p><p>  This piece of music has two voices or musical lines. Each musical line consists of notes, rests or chords which consist of notes too. A note has several attributes, among which only pitch and duration will be considered here. Rather than represent notes as single objects, we will handle their pitch and durational contents separately.</p><p>这首曲子有两种声音或乐句。每一段音乐都由音符、休止符或和弦组成，而和弦也由音符组成。音符有几个属性，这里只考虑音高和持续时间。我们将分别处理音符的音高和持续时间内容，而不是将音符表示为单个对象。</p><p> Pitches can be represented by  scientific pitch notations or  MIDI note numbers. Mostly, the latter are used, for ease of operation. For example, pitch C4 is represented by MIDI note number 60.</p><p>音高可以用科学的音高符号或MIDI音符数字来表示。为了便于操作，通常使用后者。例如，音高C4由MIDI音符编号60表示。</p><p>  The pitch contents of a  chord can be represented by list in Python. For example, in Python we can use  [&#39;C4&#39;, &#39;A-3&#39;, &#39;F3&#39;] or  [60, 56, 53] to represent the pitch contents of the chord in the red frame:</p><p>在Python中，和弦的音高内容可以用列表表示。例如，在Python中，我们可以使用[&#39；C4&#39；，&#39；A-3&#39；，&#39；F3&#39；]或[60,56,53]代表红色框架中和弦的音高内容：</p><p>  Durations can be represented by numbers. For example, quarter note’s duration is 1.</p><p>持续时间可以用数字表示。例如，季度票据的持续时间为1。</p><p> The pitch contents of a  musical line can be represented by what I call  pitch line. In Python, a pitch line is a list whose members are  None, numbers or lists of numbers. With Python package  typing, pitch line can be defined as:</p><p>一条音乐线的音高内容可以用我所说的音高线来表示。在Python中，音高线是一个列表，其成员为无、数字或数字列表。使用Python包类型，节线可以定义为：</p><p>  The durational contents of a musical line can be represented by  duration line. In Python, a duration line is a list whose members are numbers.</p><p>一条音乐线的持续时间内容可以用持续时间线来表示。在Python中，持续时间行是成员为数字的列表。</p><p> Finally,  harmonies and  scales can be represented by lists of  pitch classes. For example, in Python C major harmony can be represented by  [&#39;C&#39;, &#39;E&#39;, &#39;G&#39;] or  [0, 4, 7].</p><p>最后，和声和音阶可以用音高等级列表来表示。例如，在Python中，C大调和声可以用[&#39；C&#39；，&#39；E&#39；，&#39；G&#39；]来表示或者[0,4,7]。</p><p>  You may have heard this term a lot. A  motif is structurally a musical line, usually short in length. Motifs are the building blocks of music. They can be repeated, elaborated, fragmented and combined to generate music.</p><p>你可能经常听到这个词。母题在结构上是一条音乐线，通常长度较短。主题是音乐的基石。它们可以被重复、细化、分割和组合，从而产生音乐。</p><p> For example, the following is how Schoenberg analysed the beginning of the Beethoven’s sonata:  5</p><p>例如，以下是勋伯格如何分析贝多芬奏鸣曲的开头：5</p><p>  In his analysis, the melody part of this piece can be generated from only three motifs.</p><p>在他的分析中，这首曲子的旋律部分只能由三个主题生成。</p><p> There are different kinds of motifs. For example, two kinds of motifs are framed in the following score:</p><p>有不同种类的图案。例如，以下乐谱中有两种主题：</p><p>  The motifs in the red frames can be called  accompaniment motifs as they appear in the accompaniment line of this nocturne. They can also be called  harmonic motifs as they consist of only harmonic notes. The motifs in the blue frames can be called  melodic motifs as they appear in the melody line, or  non-harmonic motifs if they contain non-harmonic notes.</p><p>红色框架中的图案可以称为伴奏图案，因为它们出现在这首夜曲的伴奏行中。它们也可以被称为和声母题，因为它们只包含和声音符。蓝色框架中的主题可以称为旋律主题，因为它们出现在旋律线中，或者如果它们包含非和声音符，则称为非和声主题。</p><p> In the following several sections, I will talk about the implementation of the common operations that can be applied to motifs.</p><p>在接下来的几节中，我将讨论可应用于Motif的常见操作的实现。</p><p>  The function  transpose() from my Python package  ch0p1n is for transposing a motif along a scale.</p><p>我的Python包ch0p1n中的函数transpose（）用于沿比例变换图案。</p><p>  pitch_motif  =  [ 60 ,  67 ,  76 ,  72 ] # [&#39;C4&#39;, &#39;G4&#39;, &#39;E5&#39;, &#39;C5&#39;] duration_motif  =  [ 1 ,  1 ,  1 ,  1 ]</p><p>音高主题=[60,67,76,72]#[#39；C4&#39；&#39；G4&#39；&#39；E5&#39；&#39；C5&#39；]持续时间主题=[1,1,1,1]</p><p>  We can show this motif in score with  show(), which is built on Python package  music21:</p><p>我们可以用show（）在score中显示这个主题，它构建在Python包music21上：</p><p> from  ch0p1n.utils  import  show show (  pitch_lines  =  [ pitch_motif ],  duration_lines  =  [ duration_motif ],  group  =  1 ,  # the number of voices in the treble staff  key  =  0 ,  meter  =  &#39;4/4&#39; ,  clefs  =  [ &#39;g&#39; ,  &#39;f&#39; ] )</p><p>来自ch0p1n。utils import show（音高线=[pitch_motif]、音长线=[duration_motif]、组=1、#高音杆键中的声音数=0、米=和#39；4/4和#39；、谱号=[和#39；g和#39；，&#39；f和#39；]））</p><p>   from  ch0p1n.motif  import  transpose pitch_motif_transposed  =  transpose (  pitch_motif  =  pitch_motif ,  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  step  =  1 )</p><p>来自ch0p1n。motif import transpose pitch_motif_transposed=transpose（pitch_motif=pitch_motif，scale=[0,2,4,5,7,9,11]，step=1）</p><p>   show (  pitch_lines  =  [ pitch_motif_transposed ],  duration_lines  =  [ duration_motif ],  group  =  1 ,  # the number of voices in the treble staff  key  =  0 ,  meter  =  &#39;4/4&#39; ,  clefs  =  [ &#39;g&#39; ,  &#39;f&#39; ] )</p><p>显示（音高线=[pitch_motif_transposed]，duration_lines=[duration_motif]，group=1，#高音杆键中的声音数=0，meter=&#39；4/4&#39；，谱号=[&#39；g&#39；，&#39；f&#39；]））</p><p>  It looks good. Every pitch has moved up by one step along the C major scale.</p><p>看起来不错。每一个音高都在C大调音阶上上升了一步。</p><p> Since harmony is a special kind of scale, we can use  transpose() to repeat the motif in a harmony, say, the G major harmony:</p><p>由于和声是一种特殊的音阶，我们可以使用转置（）在和声中重复主题，比如G大调和声：</p><p> pitch_motif_transposed  =  transpose (  pitch_motif  =  pitch_motif ,  scale  =  [ 7 ,  11 ,  2 ],  # G major harmony  step  =  1 )</p><p>音高调换=调换（音高调换=音高调换，音阶=[7,11,2]，#G大调和声阶=1）</p><p>  show (  pitch_lines  =  [ pitch_motif  +  pitch_motif_transposed ],  duration_lines  =  [ duration_motif  *  2 ],  group  =  1 ,  key  =  0 ,  meter  =  &#39;4/4&#39; ,  clefs  =  [ &#39;g&#39; ,  &#39;f&#39; ] )</p><p>表演（音高线条=[音高主题+音高主题转置]，音长线条=[音长主题*2]，组=1，键=0，节拍=&#39；4/4&#39；，谱号=[&#39；g&#39；，&#39；f&#39；]））</p><p>  The original motif is in the first bar, and the transposed the second. You can see how each pitch moves up by one step in the G major harmony.</p><p>最初的主题在第一栏，第二栏转置。你可以看到G大调和声中的每个音高是如何上升一步的。</p><p> In some cases, however,  transpose() does not work well. Still in the above example, suppose we transpose the motif down rather than up by one step with  step = -1:</p><p>然而，在某些情况下，transpose（）并不好用。仍然在上面的例子中，假设我们用step=-1将motif向下转一步，而不是向上转一步：</p><p>  The transposed motif in the second bar is not acceptable because it contains no pitch class G to fully reify the G major harmony.</p><p>第二小节中的转置主题是不可接受的，因为它没有音高等级G来完全具体化G大调和声。</p><p>  We can improve this situation with function  lead() from  ch0p1n. The function got its name from the concept of voice-leading, which means every note in a motif  leads by step to the note(s) in a given harmony.</p><p>我们可以通过ch0p1n中的函数lead（）来改善这种情况。这个函数的名字来源于声音引导的概念，意思是一个主题中的每个音符都一步一步地引导到一个给定和声中的音符。</p><p>  from  ch0p1n.motif  import  lead pitch_motifs  =  lead (  pitch_motif  =  pitch_motif ,  harmony  =  [ 7 ,  11 ,  2 ],  # G major harmony  steps  =  [ - 1 ,  0 ],  complete  =  False ,  similar  =  None )</p><p>来自ch0p1n。motif import lead pitch_motif=lead（pitch_motif=pitch_motif，harmony=[7,11,2]，35;G大调和声步数=[-1,0]，complete=False，Simular=None）</p><p> steps = [-1, 0] means each pitch will move zero step if it fits the harmony, and at the same time one step downwards. In other words, each pitch may generate more than one pitch in the given harmony under  lead(), and the result returned is thus a list of pitch motifs rather than a single one. I will talk about parameters  complete and  similar later.</p><p>步数=[-1，0]意味着每个音高如果符合和声，将移动零步，同时向下移动一步。换句话说，每个音高可能会在lead（）下的给定和声中生成多个音高，因此返回的结果是音高主题列表，而不是单个。稍后我将讨论完整参数和类似参数。</p><p>    # to merge `pitch_motifs` from  itertools  import  chain show (  pitch_lines  =  [ list ( chain ( * pitch_motifs ))],  duration_lines  =  [ duration_motif  *  2 ],  group  =  1 ,  key  =  0 ,  meter  =  &#39;4/4&#39; ,  clefs  =  [ &#39;g&#39; ,  &#39;f&#39; ] )</p><p>#合并itertools导入链展示中的'pitch_Motions'（pitch_lines=[列表（链（*pitch_Motions））]，duration_lines=[duration_motif*2]，group=1，key=0，meter=&39；4/4&#39; ,  谱号=[&#39；g&#39；，&#39；f&#39；]）</p><p>  While the motif in the first bar is as same as the unacceptable one generated by  transpose() with  step = -1, the motif in the second bar is good, which fully reifies the G major harmony.</p><p>虽然第一小节中的主题与转置（）产生的不可接受的主题相同，步骤=-1，但第二小节中的主题是好的，这充分体现了G大调和声。</p><p> With  complete = True, we can screen out the pitch motifs which are not harmonically complete or do not fully reify the given harmony:</p><p>使用complete=True，我们可以筛选出不和谐完整或不完全具体化给定和谐的音高主题：</p><p> pitch_motifs  =  lead (  pitch_motif  =  pitch_motif ,  harmony  =  [ 7 ,  11 ,  2 ],  steps  =  [ - 1 ,  0 ],  complete  =  True ,  similar  =  None )</p><p>音高母题=引导（音高母题=音高母题，和声=[7,11,2]，步数=[1,0]，完整=正确，相似=无）</p><p>   With parameter  similar, we can screen out the pitch motifs which do not have the same contour as the original one. I will skip this part in this introductory blog.</p><p>在参数相似的情况下，我们可以筛选出与原始基调轮廓不同的基调图案。在这篇介绍性博客中，我将跳过这一部分。</p><p>  The function  thread() is for repeating a motif in consecutive harmonies or  threading a motif through harmonies. Let’s try it on the motif defined earlier:</p><p>函数thread（）用于在连续的和声中重复一个主题，或在和声中穿插一个主题。让我们尝试一下前面定义的主题：</p><p> from  ch0p1n.motif  import  thread pitch_motifs  =  thread (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  harmonies  =  [[ 5 ,  9 ,  0 ],  [ 7 ,  11 ,  2 ]],  # F, G  durations  =  [ 2 ,  2 ],  steps  =  [ 1 ] ) show (  pitch_lines  =  pitch_motifs ,  duration_lines  =  [ duration_motif ],  group  =  1 ,  key  =  0 ,  meter  =  &#39;2/4&#39; ,  clefs  =  [ &#39;g&#39; ,  &#39;f&#39; ] )</p><p>来自ch0p1n。motif import thread pitch_motif=thread（pitch_motif=pitch_motif，duration_motif=duration_motif，和声=[5,9,0]，[7,11,2]，#F，G durations=[2,2]，steps=[1]）show（pitch lines=pitch_motif，duration_lines=[duration_motif]组=1，键=0，米=39；2/4&#39; ,  谱号=[&#39；g&#39；，&#39；f&#39；]）</p><p>  The first two notes of the motif are adapted to the F major harmony, while the last two notes to the G major harmony.</p><p>主题的前两个音符改编为F大调和声，而最后两个音符改编为G大调和声。</p><p> So far, I have talked only about harmonic motifs. To deal with non-harmonic motifs, which is more complex, we need first to consider how to elaborate motifs.</p><p>到目前为止，我只讨论了和声主题。为了处理非谐波图案，这是更复杂的，我们首先需要考虑如何精心制作图案。</p><p>  Simply speaking, elaboration is adding notes to a motif. The function  elaborate() from  ch0p1n serves the exact purpose.</p><p>简单地说，精化就是给主题添加注释。ch0p1n中的函数deployate（）正好用于此目的。</p><p>  from  ch0p1n.motif  import  elaborate motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ - 1 ,  - 1 ],  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  position  =  &#39;left&#39; )</p><p>来自ch0p1n。motif import deployate motif=deployate（音高=pitch_motif，持续时间=duration_motif，参考=2，步数=1，-1]，音阶=0,2,4,5,7,9,11]，位置=39；左&#39；）</p><p>  show (  pitch_lines  =  [ pitch_motif  +  motif [ 0 ]],  duration_lines  =  [ duration_motif  +  motif [ 1 ]],  group  =  1 ,  key  =  0 ,  meter  =  &#39;4/4&#39; ,  clefs  =  [ &#39;g&#39; ,  &#39;f&#39; ] )</p><p>表演（音高线=[pitch_motif+motif[0]]，持续时间线=[duration_motif+motif[1]]，组=1，键=0，音阶=&#39；4/4&#39；，谱号=[&#39；g&#39；，&#39；f&#39；]））</p><p>    The argument  reference indicates where to add notes or elaborate the motif. For example,  reference = 2 means the notes are added at the third note. We can elaborate the last note instead:</p><p>参数引用指示在何处添加注释或阐述主题。例如，reference=2表示在第三个注释处添加注释。我们可以详细说明最后一点：</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  3 ,  # the last note  steps  =  [ - 1 ,  - 1 ],  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  position  =  &#39;left&#39; )</p><p>motif=精心设计（音高#motif=音高#motif，持续时间#motif=持续时间#motif，参考=3，#最后一个音符步数=[-1，-1]，音阶=[0,2,4,5,7,9,11]，位置=&#39；左&#39；）</p><p>  The argument  steps specifies the pitches of the notes to add. For example,  steps = [-1, -1] indicates that the reference note should move one step downwards to generate the first note, then this note should move one step downwards to generate the second note. Let’s add three descending notes with this argument:</p><p>参数步骤指定要添加的音符的音高。例如，steps=[-1，-1]表示参考注释应向下移动一步以生成第一个注释，然后此注释应向下移动一步以生成第二个注释。让我们用这个参数添加三个降序注释：</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ 1 ,  1 ,  1 ],  # three descending notes  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  position  =  &#39;left&#39; )</p><p>motif=精致（音高#音高#音高#音高#音高#音高#音长#音高#音高#音长#音高#音高#音高#音高#音长#音高#音长#音高#音高#音高</p><p>  With  steps, you can also repeat some note or add rests to a motif, as in the following example:</p><p>通过这些步骤，您还可以重复一些注释或为主题添加休息，如以下示例所示：</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ 0 ,  0 ,  None ]  # repeat the note twice then add a rest )</p><p>motif=精心设计（音高_motif=音高_motif，持续时间_motif=持续时间_motif，参考=2，步骤=[0,0，无]#重复两次音符，然后添加休息）</p><p>  The argument  scale specifies the scale along which to move the reference note to generate the notes to add. For example,  scale = [0, 2, 4, 5, 7, 9, 11] indicates that it is the C major scale. We can use C chromatic scale instead:</p><p>参数比例指定移动参考注释以生成要添加的注释的比例。例如，scale=[0,2,4,5,7,9,11]表示它是C大调音阶。我们可以用C色阶来代替：</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ - 1 ,  - 1 ],  scale  =  list ( range ( 12 )),  # C chromatic scale  position  =  &#39;left&#39; )</p><p>motif=精细（音高#motif=音高#motif，持续时间#motif=持续时间#motif，参考=2，步骤=[-1，-1]，音阶=列表（范围（12）），#C色阶位置=&#39；左&#39；）</p><p>  The argument  position specifies the position of the added notes relative to the reference note. For example,  position = &#39;left&#39; indicates that the notes are added at the left side of the reference note. We can add the notes at the right side:</p><p>参数位置指定添加注释相对于参考注释的位置。例如，position=&#39；左&#39；指示将注释添加到参考注释的左侧。我们可以在右边添加注释：</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ - 1 ,  - 1 ],  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  position  =  &#39;right&#39;  # add the notes at the right side )</p><p>motif=精心设计（音高#motif=音高#motif，持续时间#motif=持续时间#motif，参考=2，步数=[-1，-1]，音阶=[0,2,4,5,7,9,11]，位置=&#39；右侧&#39；#在右侧添加注释）</p><p>  Please note that, with  &#39;left&#39; and  &#39;right&#39;, the added notes take durations from the reference note. If you want that the durations are taken from the note before or after the reference note, use  &#39;previous&#39; or  &#39;next&#39;. For example,</p><p>请注意，带有&#39；左&#39；和&#39；对&#39；，添加的注释采用参考注释的持续时间。如果你想从参考注释之前或之后的注释中提取持续时间，请使用&#39；前&#39；或&#39；接下来&#39；。例如</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ - 1 ,  - 1 ],  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  position  =  &#39;previous&#39;  # take durations from the previous note )</p><p>motif=精心设计（音高#motif=音高#motif，持续时间#motif=持续时间#motif，参考=2，步数=[-1，-1]，音阶=[0,2,4,5,7,9,11]，位置=&#39；上一个&#39；#从上一个音符中选取持续时间）</p><p>  The argument  ratio specifies the percentage of duration the added notes take. For example,  ratio = 1/2 means that the added notes take 50% of the duration of the reference note:</p><p>参数比率指定添加的笔记持续时间的百分比。例如，比率=1/2意味着添加的注释占参考注释持续时间的50%：</p><p> motif  =  elaborate (  pitch_motif  =  pitch_motif ,  duration_motif  =  duration_motif ,  reference  =  2 ,  steps  =  [ - 1 ,  - 1 ],  scale  =  [ 0 ,  2 ,  4 ,  5 ,  7 ,  9 ,  11 ],  position  =  &#39;left&#39; ,  ratio  =  1 / 2  # take 50% of the duration of the reference note )</p><p>motif=精心设计（音高#motif=音高#motif，持续时间#motif=持续时间#motif，参考=2，步骤=[-1，-1]，音阶=[0,2,4,5,7,9,11]，位置=&#39；左&#39；，比率=1/2#占参考音符持续时间的50%）</p><p>   Reduction is the opposite of elaboration. It is removing notes from a motif. The corresponding function from  ch0p1n is  reduce().</p><p>精简与精化相反。这是从一个主题中删除注释。ch0p1n的相应函数是reduce（）。</p><p>    from  ch0p1n.motif  import  reduce motif  =  reduce (  pitch_motif  =  motif [ 0 ],  duration_motif  =  motif [ 1 ],  start  =  2 ,  end  =  3 ,  position  =  &#39;right&#39; )</p><p>来自ch0p1n。motif import reduce motif=reduce（音高motif=motif[0]，持续时间motif=motif[1]，开始=2，结束=3，位置=&#39；右&#39；）</p><p>  The arguments  start and  end specify the notes to remove. The argument  position specifies the reference note to which to add the durations of the removed notes.</p><p>参数start和end指定要删除的注释。参数位置指定要向其添加已删除注释的持续时间的参考注释。</p><p>    The background harmony is Fm, and the circled notes are non-harmonic since they do not fit the harmony.</p><p>背景和声为Fm，圆圈音符不符合和声，因此为非和声。</p><p>     pitch_motif  =  [ 65 ,  68 ,  72 ,  77 ,  80 ,  79 ,  77 ,  76 ,  77 ,  None ] duration_motif  =  [ 1 ,  1 ,  1 ,  1 ,  1.5 ,  1 / 6 ,  1 / 6 ,  1 / 6 ,  1 ,  1 ]</p><p>音高主题=[65,68,72,77,80,79,77,76,77，无]持续时间主题=[1,1,1,1,1.5,1/6,1/6,1/6,1,1]</p><p>  pitch_motif ,  duration_motif  =  reduce (  pitch_motif ,  duration_motif ,  start  =  5 ,  end  =  7 ,  position  =  &#39;left&#39; ) # the same below show (  [ pitch_motif ],  [ duration_motif ],  key  =  - 4 )</p><p>音高主题，持续时间主题=减少（音高主题，持续时间主题，开始=5，结束=7，位置=&#39；左&#39；）#以下显示相同（[pitch_motif]，[duration_motif]，key=-4）</p><p>      pitch_motif ,  duration_motif  =  elaborate (  pitch_motif ,  duration_motif ,  reference  =  4 ,  steps  =  [ - 1 ,  - 1 ,  - 1 ],  scale  =  [ 5 ,  7 ,  8 ,  10 ,  0 ,  1 ,  4 ],  position  =  &#39;right&#39; ,  ratio  =  1 / 4 )</p><p>音高主题，持续时间主题=精心设计（音高主题，持续时间主题，参考=4，步数=[-1，-1，-1]，音阶=[5,7,8,10,0,1,4]，位置=&#39；右&#39；，比率=1/4）</p><p>   Fragmentation is breaking a motif up into several shorter motifs or taking a fragment from a motif. The corresponding functions from  ch0p1n are  divide() and  fragment().</p><p>碎片化是将一个主题分解成几个较短的主题，或从一个主题中提取一个片段。ch0p1n中相应的函数是divide（）和fragment（）。</p><p>    pitch_motif  =  [ 82 ,  84 ,  85 ,  81 ,  82 ,  78 ]  +  [ 77 ] * 4  +  [ 78 ,  77 ,  75 ,  72 ,  73 ,  70 ] duration_motif  =  [ 0.5 ] * 6  +  [ 1 ] * 4  +  [ 0.5 ] * 4  +  [ 2 ,  1 ]</p><p>音高主题=[82,84,85,81,82,78]+[77]*4+[78,77,75,72,73,70]持续时间主题=[0.5]*6+[1]*4+[0.5]*4+[2,1]</p><p> With  divide(), we can divide this motif into, say, three shorter motifs of equal length:</p><p>使用divide（），我们可以将这个图案分成三个长度相等的较短图案：</p><p>  &gt;&gt;&gt;  motifs [  ([ 82 ,  84 ,  85 ,  81 ,  82 ,  78 ,  77 ],  [ 0.5 ,  0.5 ,  0.5 ,  0.5 ,  0.5 ,  0.5 ,  1 ]),  ([ 77 ,  77 ,  77 ,  78 ,  77 ],  [ 1 ,  1 ,  1 ,  0.5 ,  0.5 ]),  ([ 75 ,  72 ,  73 ,  70 ],  [ 0.5 ,  0.5 ,  2 ,  1 ]) ]</p><p>&gt&gt&gt；主题[（[82,84,85,81,82,78,77]，[0.5,0.5,0.5,0.5,0.5,1]），（[77,77,77,78,77]，[1,1,1,0.5,0.5]，[75,72,73,70]，[0.5,0.5,2,1]）]</p><p>       from  ch0p1n.motif  import  fragment motif  =  fragment (  pitch_motif ,  duration_motif ,  start  =  6 ,  end  =  9 ,  ratio  =  1 / 2 ,  fit  =  &#39;right&#39; ) show ([ motif [ 0 ]],  [ motif [ 1 ]],  key  =  - 5 ,  meter  =  &#39;6/4&#39; )</p><p>来自ch0p1n。motif import fragment motif=fragment（音高、持续时间、开始=6、结束=9、比率=1/2、适合度=&#39；右&#39；）显示（[motif[0]，[motif[1]，[key=-5，meter=&#39；6/4&#39；）</p><p>  The arguments  start and  end specify the start note and the end note of the fragment.  ratio = 1/2 indicates that the fragment’s length should be 50% of the original motif, and to accomplish this,  fit = &#39;right&#39; indicates that the end note should be prolonged.</p><p>参数start和end指定片段的开始注释和结束注释。比率=1/2表示片段的长度应该是原始图案的50%，为了实现这一点，fit=&#39；右&#39；表示尾音应该延长。</p><p>  Now it is time to put it all together. Let’s first try to generate the beginning of the Beethoven’s sonata from a small amount of materials, under the operations that we have been talking about.</p><p>现在是时候把这一切放在一起了。首先，我们试着用少量的材料，在我们已经讨论过的操作下，生成贝多芬奏鸣曲的开头。</p><p> To simplify the problem and to make patterns more discernible, I will remove slurs, articulations, dynamics, grace notes, and some other notes from the original score:</p><p>为了简化问题并使模式更加清晰，我将从原始乐谱中删除含糊、发音、动态、优雅音符和其他一些音符：</p><p>  This piece consists of two voices or musical lines, the melody line in the treble staff and the accompaniment line in the bass staff.</p><p>这首曲子由两个声部或乐谱组成，高音管中的旋律线和低音管中的伴奏线。</p><p>         In summary, to generate the beginning of the Beethoven’s sonata, the core materials are</p><p>总之，要创作贝多芬奏鸣曲的开头，核心材料是</p><p>    melodic_pitch_motif  =  [ 65 ,  68 ,  72 ,  77 ,  80 ,  77 ] melodic_duration_motif  =  [ 1 ,  1 ,  1 ,  1 ,  2 ,  2 ]</p><p>旋律音高主题=[65,68,72,77,80,77]旋律音长主题=[1,1,1,1,2,2]</p><p>    # Fm, C7, Fm, C7, Fm, Gdim, C7 harmonies  =  [  [ 5 ,  8 ,  0 ],  [ 0 ,  4 ,  7 ,  10 ],  [ 5 ,  8 ,  0 ],  [ 0 ,  4 ,  7 ,  10 ],  [ 5 ,  8 ,  0 ],  [ 7 ,  10 ,  1 ],  [ 0 ,  4 ,  7 ,  10 ] ] # F harmonic minor scale scale  =  [ 5 ,  7 ,  8 ,  10 ,  0 ,  1 ,  4 ]</p><p>#Fm，C7，Fm，C7，Fm，Gdim，C7和声=[[5,8,0]，[0,4,7,10]，[5,8,7,10]，[5,8,0]，[7,10,1]，[0,4,7,10]#F谐波小调音阶=[5,7,8,10,0,1,4]</p><p>  def  generate_beethoven_sonata (  melodic_pitch_motif ,  melodic_duration_motif ,  accompaniment_pitch_motif ,  accompaniment_duration_motif ,  harmonies , </p><p>def生成贝多芬奏鸣曲（旋律、音高、旋律、音长、伴奏、伴奏、音高、和声、，</p><p>......</p><p>......</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/作曲/">#作曲</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/automatic/">#automatic</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/音高/">#音高</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>