<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Rust应用程序的ClickOnce ClickOnce for Rust Apps</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">ClickOnce for Rust Apps<br/>Rust应用程序的ClickOnce </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-02 09:49:23</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/1/7029c1ff0843b2fefa0e50c0cd7b6fc7.png"><img src="http://img2.diglog.com/img/2021/1/7029c1ff0843b2fefa0e50c0cd7b6fc7.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>ClickOnce is a cool decentralized way of distributing applications on Windows. I’ll demonstrate distributing a  Rust language application using ClickOnce. The game uses  Rust/WinRT to build a UI on top of the  Windows Runtime.  ClickOnce shipped with  .NET Framework 2.0 in January of 2006. Almost 15 years later, .NET 5.0 was announced with  improved ClickOnce support. A simple .NET 5.0 app is used to launch the bundled game.</p><p>ClickOnce是在Windows上分发应用程序的一种很酷的分散式方法。我将演示如何使用ClickOnce分发Rust语言应用程序。该游戏使用Rust / WinRT在Windows运行时之上构建UI。 ClickOnce于2006年1月随.NET Framework 2.0一起提供。将近15年之后，宣布了具有改进的ClickOnce支持的.NET 5.0。一个简单的.NET 5.0应用程序用于启动捆绑游戏。</p><p>     I published the app to GitHub Pa  ges in an orphaned  gh-pages branch. A concern of this approach may be bloat for the GitHub repository. One way to keep the repository smaller is to not keep history in that branch by force pushing to it. I published the  Minesweeper.application file and the entire  Application Files/Minesweeper_0_1_0_0 folder.</p><p>     我在一个孤立的gh-pages分支中将应用程序发布到了GitHub Pa ges。对于GitHub存储库，此方法可能令人担忧。保持存储库较小的一种方法是不通过强制将历史记录保留在该分支中。我发布了Minesweeper.application文件和整个Application Files / Minesweeper_0_1_0_0文件夹。</p><p>   The  Application Files folder contains all the files with a  .deploy  extension. To avoid some checksum validation problems due to different line endings, I added a  .gitattributes file.</p><p>   Application Files文件夹包含所有带有.deploy扩展名的文件。为了避免由于行尾不同而产生的校验和验证问题，我添加了一个.gitattributes文件。</p><p>  The published files were copies from the ClickOnce the  app.publish folder. The ClickOnce can be tested locally by double clicking on the  Minesweeper.application. The .NET launcher can be tested without ClickOnce by just clicking on the  Minesweeper.exe. The Rust app can be tested without the .NET launcher by clicking on the  minesweeper-rs.exe.</p><p>  已发布的文件是从ClickOnce app.publish文件夹中复制的。可以通过双击Minesweeper.application在本地测试ClickOnce。只需单击Minesweeper.exe，即可​​在没有ClickOnce的情况下测试.NET启动器。单击minesweeper-rs.exe，可以在没有.NET启动器的情况下测试Rust应用程序。</p><p>    I put all the files needed to publish via ClickOnce in a folder named  ClickOnce. After building the Rust app with  cargo build --release, I just call  .\ClickOnce\build.ps1. It launches  msbuild to build the .NET launcher, create the  ClickOnce Application Manifest, create the  ClickOnce Deployment Manifest, and sign both of them, creating the  app.publish folder above. The targets come with any version of Visual Studio, include Visual Studio Build Tools. The targets to sign the manifests do not work with  dotnet msbuild yet, so stick to  msbuild. In PowerShell, I can add add it to the  PATH environment variable with  $env:PATH</p><p>    我将通过ClickOnce发布所需的所有文件放在一个名为ClickOnce的文件夹中。用货物构建--release构建Rust应用程序后，我只需调用。\ ClickOnce \ build.ps1。它启动msbuild来构建.NET启动器，创建ClickOnce应用程序清单，创建ClickOnce部署清单，并对它们进行签名，从而在上面创建app.publish文件夹。目标随Visual Studio的任何版本一起提供，包括Visual Studio Build Tools。标记清单的目标尚不适用于dotnet msbuild，因此请坚持使用msbuild。在PowerShell中，我可以使用$ env：PATH将其添加到PATH环境变量中。</p><p>  FYI, Visual Studio Build Tools are available using winget. Run  winget install Microsoft.VisualStudio.BuildTools. There are a few ways to  install winget, but I usually just download and launch the latest .appxbundle from the most recent release on the  releases page. Running the  Visual Studio Installer app will help you update if you wish to.</p><p>  仅供参考，Visual Studio Build Tools可以使用winget获得。运行winget install Microsoft.VisualStudio.BuildTools。有几种安装Winget的方法，但是我通常只是从发行页面上的最新发行版中下载并启动最新的.appxbundle。如果需要，运行Visual Studio Installer应用程序将帮助您进行更新。</p><p>  You could build the ClickOnce manifests by hand, but it is much easier to let the MSBuild targets do it for you using a publish profile. A publish profile is itself an MSBuild file containing a bunch of properties and items.</p><p>  您可以手动构建ClickOnce清单，但是让MSBuild目标使用发布配置文件为您轻松完成。发布配置文件本身就是包含一系列属性和项的MSBuild文件。 </p><p>   The  ClickOnce\Properties\PublishProfiles\ClickOnceProfile.pubxml was generated from a Build &gt; Publish wizard in Visual Studio. I’m not sure what the minimal set of properties are.</p><p>ClickOnce \ Properties \ PublishProfiles \ ClickOnceProfile.pubxml是从Build＆gt; Visual Studio中的发布向导。我不确定最小的属性集是什么。</p><p>  I moved a couple of the properties into a  ClickOnceProfile.pubxml.user file that are specific to a particular user and shouldn’t be committed. The  InstallUrl is the base URL for the deployments. The  ManifestCertificateThumbprint is the certificate of my locally installed code signing certificate.</p><p>  我将几个属性移到了特定于特定用户且不应提交的ClickOnceProfile.pubxml.user文件中。 InstallUrl是部署的基本URL。 ManifestCertificateThumbprint是我本地安装的代码签名证书的证书。</p><p>   The .NET app that starts the Rust app is a very basic Windows Form application.</p><p>   启动Rust应用程序的.NET应用程序是一个非常基本的Windows Form应用程序。</p><p>  The project file is also straight forward, but take the time to read how  .NET 5.0 has changed things, especially  TargetFramework:</p><p>  该项目文件也很简单，但是花一些时间阅读.NET 5.0如何改变了事情，尤其是TargetFramework：</p><p> Windows desktop APIs (including Windows Forms, WPF, and WinRT) will only be available when targeting net5.0-windows. You can specify an operating system version, like  net5.0-windows7 or  net5.0-windows10.0.17763.0 ( for  Windows October 2018 Update). You need to target a Windows 10 version if you want to use  WinRT APIs.</p><p> Windows桌面API（包括Windows窗体，WPF和WinRT）仅在面向net5.0-windows时可用。您可以指定操作系统版本，例如net5.0-windows7或net5.0-windows10.0.17763.0（适用于Windows October 2018 Update）。如果要使用WinRT API，则需要定位Windows 10版本。</p><p>  I added the  Configuration and  PublishProfile properties to that project file, but you leave them out and pass them in or override them by passing them as parameters to  msbuild on the command line, such as  /p:Configuration=Release and  /p:PublishProfile=ClickOnceProfile.</p><p>  我将Configuration和PublishProfile属性添加到了该项目文件，但是您将它们保留并传递给它们，或者通过将它们作为参数传递给命令行中的msbuild来覆盖它们，例如/ p：Configuration = Release和/ p：PublishProfile = ClickOnceProfile。</p><p>   I enjoy seeing Rust being used more for desktop application development. Projects like  Rust/WinRT and  gtk-rs are making desktop application development more accessible from Rust. I’m looking forward to even better support for  WinUI 3 and  GTK 4.0. Even though ClickOnce is a .NET component, it can be used to distribute desktop apps built in Rust as well.</p><p>   我很高兴看到Rust被更多地用于桌面应用程序开发。 Rust / WinRT和gtk-rs等项目使Rust可以更轻松地访问桌面应用程序开发。我期待为WinUI 3和GTK 4.0提供更好的支持。即使ClickOnce是.NET组件，它也可以用于分发Rust中内置的桌面应用程序。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://taggartsoftware.medium.com/clickonce-for-rust-apps-f96873feb8f1">https://taggartsoftware.medium.com/clickonce-for-rust-apps-f96873feb8f1</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/rust/">#rust</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/应用程序/">#应用程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/clickonce/">#clickonce</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>