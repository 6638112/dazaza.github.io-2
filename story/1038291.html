<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>FuzzOS –专为模糊测试而设计的操作系统 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">FuzzOS –专为模糊测试而设计的操作系统 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-08 04:13:09</div><div class="page_narrow text-break page_content"><p>我们将使用专门为模糊测试设计的操作系统！这将是12月大部分时间的流媒体系列，内容包括制作一个新的操作系统，重点是模糊测试。这意味着诸如内存管理器，确定性和可伸缩性之类的东西将是操作系统最重要的部分，并且要花很多精力才能使其变得超快！</p><p>  直播将在12月10日（星期四）世界标准时间18:00左右的某个时间开始，但直播将在相对随机的日期相对随机的时间进行。我真的不能承诺特定的时间！</p><p> 信息流一周大概有4-5天（可能是M-F），长度可能是8-12小时。我们将知道，这取决于我们能获得多少乐趣！</p><p>  您可以在我的Twitch频道上找到直播，而如果不幸或错过了直播，则可以在我的YouTube频道上找到录音！当然，不要忘记喜欢，评论和订阅。</p><p>  所以……最终，我真的不知道会发生什么。但是，我可以预测我们会做的一些事情。首先，必须注意这些流不是培训材料。没有准备好的脚本，材料，流程等。如果我们最终构建出完全不同的东西，那很好，我们就顺其自然。不需要完成此项目，也不必承诺完成该项目的某些方式。所以……除了那个。</p><p> 我们将致力于开发专门针对x86-64的操作系统（一开始是Intel风味处理器，但AMD应该在非管理程序模式下工作）。该操作系统将专为模糊测试而设计，这意味着我们将专注于使虚拟内存管理非常快速。这是性能最高的模糊测试的基础，我们需要能够在模糊情况下修改页面时映射，取消映射和还原页面。</p><p> 为了让您保持脚尖，我首先要从无聊的事情开始。 </p><p>我们必须制作一个可以启动的操作系统。我们将要制作UEFI内核，并且可能会涉足在ARM64上运行它，因为我们的大多数代码都是平台无关的。但是，谁知道。这将是一个非常通用的内核，我主要是在裸机上开发它，但是当然，我们将确保它在KVM / Xen / Hyper-V上运行，以便可以在云环境中使用。</p><p>  我们将需要编写ACPI表解析器，以便我们可以找到系统上内存和CPU的NUMA局部性。这对于获得可随内核扩展的高性能内存管理器至关重要。</p><p>  当然，内核将支持多个内核，否则对于计算来说是没有用的。</p><p>  由于我从不使用磁盘，因此我将遵循将网络作为通用用途的标准模型。为此，我们需要10gbit网络驱动程序和TCP堆栈，以便我们可以与网络的其余部分进行通信。这里没有什么太疯狂的，我们可能会从Chocolate Milk中借用一些代码</p><p>     由于我们将要“快照”内存本身，因此我们需要确保指针等不是问题。最快，最简单，最好的解决方案只是确保内存始终加载到同一地址。对于单个核心来说，这没问题，但是对于多个核心来说，这很困难，因为它们需要在同一位置映射相同数据的副本。</p><p> 有什么解决方案？当然，我们将使系统上的每个核心都运行自己的地址空间。这意味着内核之间没有共享内存（带有一些非常非常小的概念）。这不仅会带来极高的内存访问性能（由于缓存仅处于互斥或共享状态），而且这意味着共享（可变）内存将不再是问题！这意味着我们将通过消息传递来完成所有核心同步，在最佳情况下，此延迟比共享内存模型要高，但具有扩展性更好的优势。只要我们的消息可以序列化为TCP流，这意味着我们可以毫不费力地跨网络扩展。</p><p> 这具有一些很棒的属性，因为我们不再需要对页表进行任何锁定来添加和删除条目，也不需要执行任何TLB击落操作，这会花费数万个周期。 </p><p>我在Sushi Roll中使用了这个模型，我真的很想念它。它具有令人难以置信的良好性能，并迫使人们多考虑在内核之间共享信息。</p><p>  与我所写的大多数东西一样，将需要线性缩放，并且暗示着在整个网络中进行缩放，因为对于任何实际的模糊应用来说都是必需的。</p><p>  到目前为止，这些事情都没有超级有趣。很长时间以来，我有很多操作系统可以很好地完成这些任务。但是，我从未将这些内存管理技术变成真正的数据结构，而是根据需要手动使用它们。我计划使用Rust程序宏和虚拟内存管理技巧的组合来构成该操作系统的核心，以允许将任意数据结构存储在树形检查点结构中。</p><p> 这将允许在快照快照时在结构的不同状态之间进行快速转换。这将通过利用页表中的脏位并创建一个分配器来实现，该分配器将在内存池中进行分配，该内存将在快照中保存和恢复。此内存在内部将被视为不透明的Blob，因此它可以保存您想要的任何信息，设备状态，来宾内存状态，寄存器状态，与绒毛完全无关的信息，都没有关系。为了处理嵌套结构（或更具体地说，是要跟踪的结构中的指针），我们将使用Rust过程宏来禁止在跟踪的结构中使用未跟踪的指针。</p><p> 实际上，我们将充分利用硬件的MMU，以不同的方式快照，在它们之间传送和恢复内存块。对于模糊测试，这是保持访客内存状态和寄存器状态的一种方法。通过不透明地处理此问题，我们可以专注于真正很好地处理MMU方面，而不必担心特殊的大小写，这些所有变量在重置时都需要恢复。</p><p>  好的，所有这些都为开发高性能模糊器腾出了空间。就我而言，我主要是希望对矢量化仿真进行新的重写，但是为了让其他用户感兴趣，我们将实现一个能够运行QEMU的Linux仿真器。</p><p> 这意味着我们将能够（可能只是静态地）编译QEMU。然后，我们可以获取此二进制文件，并将其加载到我们的操作系统中，然后在我们的操作系统中运行QEMU。这意味着我们可以控制对QEMU发出的请求的系统调用响应。如果我们（将）确定性地执行此操作，则这意味着QEMU将是确定性的。因此，这意味着QEMU内部的来宾也将是确定性的。你看？这是我过去使用过的一种技术，效果非常好。我们绝对会胜过Linux对syscall的处理，并且我们会更好地扩展，并且在内存管理方面我们将Linux淘汰。 </p><p>因此，我不知道这样做会有多困难，但是从浏览Internet大约5分钟之后，看来我可以很轻松地在我的OS中编写模拟KVM ioctl的虚拟机管理程序。意思是QEMU只会认为KVM在那，然后使用它！</p><p> 这将使我们能够完全控制QEMU的确定性，系统调用，性能和重置速度……而无需实际修改QEMU代码。</p><p>  这就是计划。一个OS +快速的MMU代码+虚拟机管理程序+ Linux模拟器，使我们能够确定性地运行QEMU可以运行的任何东西，这实际上就是一切。我们这样做的性能可能是每个内核每秒数百万个VM重置，并与内核线性地扩展，包括通过网络进行扩展，以实现世界上见过的最快的通用模糊测试：D</p><p>   我在Twitch上的直播越来越频繁了！我已经开发了用于模糊测试的虚拟机管理程序，转换器，仿真器，并且在流中完成了很多有趣的模糊测试工作。来吧！</p><p> 如果您想在新博客出现时收到通知，请在Twitter上@gamozolabs跟我来。我经常会根据输入的数据发布数据和图形，然后我就会学习！ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://gamozolabs.github.io/fuzzing/2020/12/06/fuzzos.html">https://gamozolabs.github.io/fuzzing/2020/12/06/fuzzos.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/操作系统/">#操作系统</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/operating/">#operating</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/内存/">#内存</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1038103.html"><img src="http://img2.diglog.com/img/2020/12/thumb_7f012df251666ad74b1a462ec6daff8c.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1038103.html">Gustave –嵌入式操作系统内核模糊器 </a></div><span class="my_story_list_date">2020-12-7 1:55</span></div><div class="col-sm"><div><a target="_blank" href="/story/1037853.html"><img src="http://img2.diglog.com/img/2020/12/thumb_01d5f8a2ef8e1a2e79d34a06b8c809d3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1037853.html">Chrome操作系统87添加了标签搜索和蓝牙设备电池电量 </a></div><span class="my_story_list_date">2020-12-5 9:40</span></div><div class="col-sm"><div><a target="_blank" href="/story/1037274.html"><img src="http://img2.diglog.com/img/2020/11/thumb_fb1ef8ea052c755a68a3f70d5e41ae9d.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1037274.html">E基金会–非Google的非Google智能手机操作系统和在线服务</a></div><span class="my_story_list_date">2020-11-30 21:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1035886.html"><img src="http://img2.diglog.com/img/2020/11/thumb_76cf782731b04e955798cfcf00026eba.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1035886.html">Unix的诞生与Brian Kernighan – CoRecursive播客</a></div><span class="my_story_list_date">2020-11-22 18:32</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>