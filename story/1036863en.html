<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在Apple Silicon M1上运行Docker（后续）Running Docker on Apple Silicon M1 (Follow-Up)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Running Docker on Apple Silicon M1 (Follow-Up)<br/>在Apple Silicon M1上运行Docker（后续）</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-27 22:48:46</div><div class="page_narrow text-break page_content"><p>This is a follow-up post to  “Running Docker on Apple Silicon M1”, continuing the journey of exploring Docker on Apple’s new M1 machines.</p><p>这是“在Apple Silicon M1上运行Docker”的后续文章，继续了在Apple的新M1机器上探索Docker的旅程。</p><p> We left off at booting an ARM Linux virtual machine, and installing &amp; running Docker inside it. This works fine and allows you run containers like for instance a Postgres database. They can expose their ports and instead of connecting to  localhost:5432 on the host, you connect to your VM’s IP address, for instance  192.168.64.8:5432.</p><p> 我们停止了启动ARM Linux虚拟机，并在其中安装和运行Docker的工作。这工作正常，并允许您运行类似Postgres数据库的容器。他们可以公开其端口，而不必连接到主机上的localhost：5432，而是连接到VM的IP地址，例如192.168.64.8:5432。</p><p> Now in case you’re not aware, Docker is actually a service that exposes an API over HTTP and when you run  docker commands, they control the service via these API requests on a local socket. You’ve probably seen the reference to  unix:///var/run/docker.sock at times.</p><p> 现在，如果您不知道，Docker实际上是一项通过HTTP公开API的服务，当您运行docker命令时，它们通过本地套接字上的这些API请求来控制服务。您可能有时会看到对unix：///var/run/docker.sock的引用。</p><p> What that means is that it’s possible to direct your  docker client to talk to a Docker service over the network, and that’s what we can do as well to enable “regular” docker commands to work with a locally running “Linux Docker VM”.</p><p> 这意味着可以引导您的Docker客户端通过网络与Docker服务进行通讯，这也是我们可以做的，以使“常规” Docker命令能够与在本地运行的“ Linux Docker VM”一起使用。</p><p> Incidentally, that’s exactly what “Docker for Mac” is doing under the hood: it is actually a VirtualBox VM which hosts Docker, not your Mac itself.</p><p> 顺便说一句，这正是“ Docker for Mac”在幕后所做的：实际上，这是一个托管Docker的VirtualBox VM，而不是Mac本身。</p><p>  In order to get started, we need to obtain the Docker client app. Now I’m not sure if “Docker for Mac” can actually be installed on an M1 Mac. I migrated my existing setup from a Time Machine backup and therefore had Docker installed from the start. Presumably you could copy the app bundle from an Intel machine if the installer fails.</p><p>  为了开始，我们需要获取Docker客户端应用程序。现在，我不确定是否可以在M1 Mac上实际安装“ Docker for Mac”。我从Time Machine备份迁移了现有设置，因此从一开始就安装了Docker。如果安装程序失败，大概可以从英特尔计算机复制应用程序捆绑包。</p><p> Assuming you have a  docker binary to hand, you’re good to go. The way we’ll set up the connection is via a “docker context” and all this is  thanks to a tip by Johannes Weiss.</p><p> 假设您手头有一个docker二进制文件，那您就很好了。我们通过“ docker context”建立连接的方式，这一切都要归功于Johannes Weiss的技巧。</p><p>  First though, we need to configure to connect to our VM via SSH. Install the SSH server:</p><p>不过，首先，我们需要配置为通过SSH连接到我们的VM。安装SSH服务器：</p><p>  and copy your public key to the  ubuntu user’s  authorized_keys for password-less access.</p><p>  并将您的公钥复制到ubuntu用户的authorized_keys中，以进行无密码访问。</p><p> In order to connect to the VM, you’ll need to find its IP address (which is on a  192.168.64.0 network if you’ve followed along from the previous blog post).</p><p> 为了连接到VM，您需要找到其IP地址（如果您之前的博客文章中介绍的，则位于192.168.64.0网络上）。</p><p>       With all this out of the way, we can test the connection from the host:</p><p>       通过所有这些，我们可以测试来自主机的连接：</p><p>        Now all docker commands are targeting the virtual machine, just like they do in Docker for Mac.</p><p>        现在，所有docker命令都以虚拟机为目标，就像在Mac版Docker中一样。</p><p> ❯ docker context create myvm --docker  &#34;host=ssh:// [email protected]&#34;myvmSuccessfully created context  &#34;myvm&#34; ~❯ docker context use myvmmyvm ~❯ docker psCONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES ~❯ docker run hello-worldHello from Docker !This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the  &#34;hello-world&#34; image from the Docker Hub. (arm64v8) 3. The Docker daemon created a new container from that image which runs the executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it to your terminal.To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bashShare images, automate workflows, and more with a free Docker ID: https://hub.docker.com/For more examples and ideas, visit: https://docs.docker.com/get-started/</p><p> ❯Docker上下文创建myvm --docker“ host = ssh：// [受电子邮件保护]” myvm成功创建的上下文“ myvm”〜❯docker上下文使用myvmmyvm〜❯docker ps容器ID图像命令创建的状态端口名〜❯docker运行hello-worldHello来自Docker的消息！此消息表明您的安装似乎正常运行。要生成此消息，Docker采取了以下步骤：1. Docker客户端联系了Docker守护程序。 2. Docker守护程序从Docker Hub中提取了“ hello-world”映像。 （arm64v8）3. Docker守护进程从该映像创建了一个新容器，该容器运行可执行文件，该可执行文件将生成您当前正在读取的输出。 4. Docker守护程序将该输出流式传输到Docker客户端，该客户端将其发送到您的终端。要尝试更具野心的东西，您可以使用以下命令运行一个Ubuntu容器：$ docker run -it ubuntu bash免费的Docker ID：https：//hub.docker.com/有关更多示例和想法，请访问：https：//docs.docker.com/get-started/</p><p>  Bear in mind that this setup does not come with the convenience of Docker for Mac’s bridge networking or support for volumes – but surely these aren’t far off.</p><p>  请记住，此设置并不具备用于Mac的桥接网络或对卷的支持的Docker的便利性-但可以肯定的是，相距不远。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://finestructure.co/blog/2020/11/27/running-docker-on-apple-silicon-m1-follow-up">https://finestructure.co/blog/2020/11/27/running-docker-on-apple-silicon-m1-follow-up</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/docker/">#docker</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/silicon/">#silicon</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>