<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Stor：全栈样板-发布、部署、强制约定</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Stor：全栈样板-发布、部署、强制约定</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-02 10:13:12</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/47b45f7cdaac6a336c6e173a69cdb0de.png"><img src="http://img2.diglog.com/img/2020/11/47b45f7cdaac6a336c6e173a69cdb0de.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>你曾经自己开始过一个新项目吗？如果有，你可能知道设置所有必要的工具是很繁琐的。就像你一样，我最喜欢的部分是编码，而不是样板。</p><p>Stor通过使用最新的技术和最新的标准为您解决了所有这些问题。实际上，此模板坚持认为什么是最好的，但它确实强制执行优秀的实践，如代码可重用性、强制执行编码指南、使用Monorepo等。</p><p>如果您想更详细地了解这个想法是如何实现的，我建议您阅读我写的关于这个主题的系列博客文章。</p><p>此模板包括作为声音模式示例的待办事项演示应用程序。当然，您不会为项目创建待办事项应用程序，但您可以将其用作有用模式的示例，并了解如何使用此项目中提供的技术。</p><p>此存储库是存储库模板，这意味着您可以使用顶部的Use This Template按钮在此基础上创建项目。</p><p>*注意：如果您已有存储库，则需要更多工作。我建议使用Use Template按钮并将当前代码迁移到新创建的项目中。</p><p>现在，您将希望将所有出现的组织和项目命名替换为您自己的名称，从而使此项目成为您的项目。谢天谢地，我们有一个专门用于此目的的脚本：</p><p>*注意：强烈建议项目名称与您的git仓库相同。</p><p>文件完成后将自动删除。完成后，您将看到以下消息：</p><p>此模板集成了Github操作，以实现其持续集成。现有工作流位于.github/workflow下。要使配置项正常工作，您必须：</p><p>(可选)在NX_CLOUD_TOKEN下的GitHub机密中插入您的NX Cloud访问令牌。这实现了高速缓存和更快的构建时间。</p><p>对于简单而快速的部署，来自Digital Ocean的新App平台使得使用Monorepos变得容易。对于我们的todo应用程序，配置文件位于.do/app.yaml下。在那里，您可以更改正在部署的不同应用程序的配置。规格可以在这里找到。</p><p>在数字海洋云上创建帐户(这是赞助链接)并启用Github访问。</p><p>一旦完成，您的应用程序将与规范中定义的主分支提交挂钩。因此，在合并时，应用程序将更新。要更新应用程序的规范，首先使用doctl apps list获取应用程序id，然后只需运行doctl apps update&lt；app id&gt；--spe.do/app.yaml。</p><p>有两个可用的数据库，postgres和mongo。为了确保您的开发人员在安装这些数据库时不会遇到任何麻烦，它们已经预先配置了docker-compose.yml文件。</p><p>默认情况下，项目使用明信片。如果这是您想要的，您就可以开始了；一切都将开箱即用。</p><p>默认情况下，在模型和数据库之间激活自动同步。这意味着对模型所做的更改将自动反映在数据库架构上。如果要手动控制迁移，可以通过在orm-config.ts文件中将Synchronize设置为False来执行此操作。</p><p>这将检查您定义的实体和数据库架构的模型之间的差异。如果发现更改，它将生成适当的迁移脚本。</p><p>如果您想使用MongoDB，尽管绝对不推荐，因为它目前不能很好地与typeorm一起使用，但您仍然可以通过更新./apps/api/src/config/configation.ts下的连接信息来做到这一点。您只需将type：&#34；postgres&#34；替换为type：&#34；mongo&34；。</p><p>对于postgres，将您的sql语句添加到APPS/DATABASE/postgres/init.sql文件中。对于mongo，将您的mongo语句添加到apps/database/mongo/mongo-entrypoint/seed-data.js文件中。</p><p>我们使用尖端技术来确保您获得所希望的最佳开发体验。为了与数据库通信，我们使用了卓越的类型。我们使用代码优先的方法，这意味着定义您的模型也将表示您的数据库中的表。下面是一个示例：</p><p>从&#34；typeorm&#34；导入{RootEntity}从&#34；导入{Column，Entity}。/root.entity&#34；从&#34；class-validator&#34；@Entity()导出类TODO扩展RootEntity{@Column()@MinLength(5，{Always：True})文本：String}。</p><p>为了满足您的API请求，我们结合使用Nest和Fastify来确保超快的性能。</p><p>为了减少创建新实体时常见的样板，我们使用了nestjsx/CRUD插件，该插件将为CRUD操作生成所有必要的路由。</p><p>从&#34；@nestjs/common&#34；导入{Controller}从&#34；@nestjsx/CRUD&#34；导入{TODO}从&#34；@stator/Models&#34；导入{TodosService}从&#34；/todos.service&#34；@Crud({model：{type：TODO})@Controller(&#34；TODOS&#34；)导出类TodosController实现CrudController&lt；TODO&gt；{构造函数(public service：TodosService){}}。</p><p>当然，您可能想知道这是否真的有效。为了说服您，我们使用SuperTest实现了执行真实请求的集成测试。</p><p>对于我们的Web应用程序，我们正在使用非常流行的REDUX-TOOLKIT和READICT-ROUTER。我们强烈建议您使用示例中演示的功能组件。</p><p>为了进一步减少redux-toolkit所需的样板，我们提供了thunkFactory，它允许您生成CRUD端点所需的所有操作。</p><p>从&#34；@stator/model&#34；导入{thunkFactory}从&#34；../utils/thunkFactory&#34；export const todoThunks={...。ThunkFactory&lt；待办事项&&gt;(&#34；/待办事项&34；)，}。</p><p>我们还提供了一个sliceReducerFactory，它将为您刚刚创建的块生成所需的削减器。</p><p>从&#34；@reduxjs/toolkit&#34；import{todo}from&#34；@stator/model&#34；import{sliceReducerFactory}from&#34；../utils/sliceReducerFactory&#34；import{SliceState，getInitialSliceState}from&#34；../utils/SliceState&#34；import{todoThunks}from&#34；/todos.thunk&#34；import{todoThunks}from&#34；./utils/SliceState&#34；import{todoThunks}from&#34；./utils/sliceReducerFactory&#34；import{SliceState，getInitialSliceState}from&#34；import{todoThunks}from&#34；。Todo&gt；{}export Const todoSlice：Slice=createSlice({name：&#34；todos&34；，initialState：getInitialSliceState&lt；TodoState，TODO&gt；()，Reducers：{}，ExtraReducers：{...。SliceReducerFactory&lt；TODO，TODOSTATE&gt；(TODOTUNKS)，}，})。</p><p>如您所见，所有内容都打得很充分。因此，您将在开发时自动完成。</p><p>现在让我们假设我们想要从API中获取所有的待办事项，我们可以简单地这样做：</p><p>当API正在处理时，我们想要添加一个加载，这非常简单，因为我们的thunkFactory会为我们处理所有这些事情。您可以通过如下方式访问加载状态：</p><p>在我们的示例中，我们使用Material-UI，但是您可以用任何其他框架替换它。</p><p>我们还使用AXIOS来简化请求处理，因为它可以很好地处理TypeScript。</p><p>我们坚信键入有助于创建更健壮的程序；因此，我们使用TypeScript。</p><p>提交消息必须遵守这些准则。如果您需要遵循它们的帮助，只需运行npm run Commit，系统将以交互菜单提示您。</p><p>分支机构名称甚至在您提交之前就已强制执行，以确保每个人都采用相同的标准：{issue-number}-{branch-work-title-kebab-case}.。</p><p>我们还为您提供了一个预置的CI工具包，用于构建和运行测试。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/chocolat-chaud-io/stator">https://github.com/chocolat-chaud-io/stator</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/发布/">#发布</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/全栈/">#全栈</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/full/">#full</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1032413.html"><img src="http://img2.diglog.com/img/2020/10/thumb_143fbef9b0ed69c82865997cfb610016.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032413.html">Waymo发布了2019年1月至9月期间其在亚利桑那州自动驾驶业务的公共道路测试数据。2020，表示其汽车在2019年行驶了610万英里以上</a></div><span class="my_story_list_date">2020-10-31 8:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032351.html"><img src="http://img2.diglog.com/img/2020/10/thumb_b34e59923e0d16ff27bc0ef5957d5086.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032351.html">Apple One今日发布，捆绑音乐、iCloud，售价14.95美元以上</a></div><span class="my_story_list_date">2020-10-31 2:51</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032324.html"><img src="http://img2.diglog.com/img/2020/10/thumb_c857c6b9d91a71f609fc7c4d0472727c.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032324.html">让我们加密发布的新根证书和中间证书</a></div><span class="my_story_list_date">2020-10-31 2:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032162.html"><img src="http://img2.diglog.com/img/2020/10/thumb_b570dfc6b6d6c0c91a77f7bcda00e98e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032162.html">
Apple One服务订阅捆绑包明天开始发布</a></div><span class="my_story_list_date">2020-10-30 5:46</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>