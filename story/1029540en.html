<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用空间填充曲线可视化二进制文件(2011)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用空间填充曲线可视化二进制文件(2011)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-18 09:13:30</div><div class="page_narrow text-break page_content"><p>Edit: Since this post, I&#39;ve created an interactive tool for binaryvisualisation - see it at  binvis.io</p><p>编辑：自从这篇文章以来，我已经创建了一个用于二进制可视化的交互式工具-请参见binvis.io。</p><p> In my day job I often come across binary files with unknown content. I have aset of standard avenues of attack when I confront such a beast - use &#34;file&#34; tosee if it&#39;s a known file type, &#34;strings&#34; to see if there&#39;s readable text, runsome in-house code to extract compressed sections, and, of course, fire up a hexeditor to take a direct look. There&#39;s something missing in that list, though - Ihave no way to get a quick view of the overall structure of the file. Using ahex editor for this is not much chop - if the first section of the file looksrandom (i.e. probably compressed or encrypted), who&#39;s to say that there isn&#39;t achunk of non-random information a meg further down? Ideally, we want to do thistype of broad pattern-finding by eye, so a visualization seems to be in order.</p><p>在日常工作中，我经常遇到内容未知的二进制文件。当我面对这样的野兽时，我有一套标准的攻击途径-使用文件来检查它是否是已知的文件类型，使用字符串来查看是否有可读的文本，运行一些内部代码来提取压缩部分，当然，还可以启动十六进制编辑器来直接查看。不过，这份列表中缺少一些东西--我无法快速查看文件的整体结构。使用十六进制编辑器来做这件事并不费力--如果文件的第一部分看起来是随机的(即可能是压缩的或加密的)，谁又能说再低一点的地方就没有一大块非随机信息呢？理想情况下，我们希望通过肉眼进行这种类型的广泛模式查找，因此可视化似乎是合适的。</p><p> First, lets begin by picking a colour scheme. We have 256 different byte values,but for a first-pass look at a file, we can compress that down into a few commonclasses:</p><p>首先，让我们从选择配色方案开始。我们有256个不同的字节值，但是对于第一遍查看文件，我们可以将其压缩成几个公共类：</p><p>  This covers the most common padding bytes, nicely highlights strings, and lumpseverything else into a miscellaneous bucket. The broad outline of what we needto do next is clear - we sample the file at regular intervals, translate eachsampled byte to a colour, and write the corresponding pixel to our image. Thisbrings us to the big question - what&#39;s the best way to arrange the pixels? Afirst stab might be to lay the pixels out row by row, snaking to and fro to makesure each pixel is always adjacent to its predecessor. It turns out, however,that this zig-zag pattern is not very satisfying - small scale features (i.e.features that take up only a few lines) tend to get lost. What we want is alayout that maps our one-dimensional sequence of samples onto the 2-d image,while keeping elements that are close together in one dimension as near aspossible to each other in two dimensions. This is called &#34;localitypreservation&#34;, and the  space-fillingcurves are a family ofmathematical constructs that have precisely this property. If you&#39;re a regularreader of this blog, you may know that I have an almost unseemly fondness for these critters. So, letsadd a couple of space-filling curves to the mix to see how they stack up. The Z-Order curve has found widepractical use in computer science. It&#39;s not the best in terms of localitypreservation, but it&#39;s easy and quick to compute. The  Hilbertcurve, on the other hand, is(nearly) as good as it gets at locality preservation, but is much morecomplicated to generate. Here&#39;s what our three candidate curves look like - ineach case, the traversal starts in the top-left corner:</p><p>这涵盖了最常见的填充字节，很好地突出显示了字符串，并将所有其他内容集中到一个杂项存储桶中。我们下一步需要做的大致轮廓很清楚-我们定期对文件进行采样，将每个采样的字节转换为一种颜色，并将相应的像素写入我们的图像。这给我们带来了一个大问题--排列像素的最佳方式是什么？第一步可能是逐行布置像素，来回蜿蜒以确保每个像素始终与其前一个像素相邻。然而，事实证明，这种之字形模式并不是很令人满意-小比例的要素(即只占几行的要素)往往会丢失。我们需要的是一种布局，它将一维样本序列映射到二维图像上，同时保持一维上相近的元素在二维上尽可能彼此接近。这就是所谓的局部保持性，空间填充曲线就是一族具有这种性质的数学构造。如果你是这个博客的常客，你可能知道我对这些动物有一种近乎不合时宜的喜爱。因此，让我们在混合中添加几条填充空间的曲线，看看它们是如何堆积起来的。Z级曲线在计算机科学中有广泛的实际应用。就保存地方性而言，它并不是最好的，但它很容易计算，而且计算起来也很快。另一方面，Hilbert曲线在局部保持方面(几乎)和它一样好，但是生成起来要复杂得多。下面是我们的三条候选曲线的外观-在每种情况下，遍历都从左上角开始：</p><p>  And here they are, visualizing the ksh( Mach-O, dual-architecture) binarydistributed with OSX - click for the significantly more spectacular largerversions of the images:</p><p>下面是它们，可视化使用OSX分发的ksh(Mach-O，双体系结构)二进制文件，并单击以获取更壮观的更大版本的图像：</p><p>  The classical Hilbert and Z-Order curves are actually square, so for thesevisualizations I&#39;ve unrolled them, stacking four sub-curves on top of eachother. To my eye, the Hilbert curve is the clear winner here. Local featuresare prominent because they are nicely clumped together. The Z-order curve showssome annoying artifacts with contiguous chunks of data sometimes split betweentwo or more visual blocks.</p><p>经典的希尔伯特曲线和Z级曲线实际上是正方形的，所以为了便于理解，我展开了它们，将四条子曲线叠加在一起。在我看来，希尔伯特曲线显然是这里的赢家。地方特色之所以突出，是因为它们很好地聚集在一起。Z顺序曲线显示了一些令人讨厌的伪像，其中连续的数据块有时会在两个或多个视觉块之间拆分。</p><p> The downside of the space-filling curve visualizations is that we can&#39;t look ata feature in the image and tell where, exactly, it can be found in the file.I&#39;m toying with the idea (though not very seriously) of writing an interactivebinary file viewer with a space-filling curve navigation pane. This would letthe user click on or hover over a patch of structure and see the file offsetand the corresponding hex.</p><p>空间填充曲线可视化的缺点是，我们不能查看图像中的某个特征，然后判断它在文件中的确切位置。我正在考虑(尽管不是很认真地)编写一个带有空间填充曲线导航窗格的交互式二进制文件查看器。这会让用户点击或悬停在结构的补丁上，并看到文件偏移量和相应的十六进制。</p><p>  We can get more detail in these images by increasing the granularity of thecolour mapping. One way to do this is to use a trick I first concocted to visualize the Hilbert Curve atscale. The basic idea is to use a3-d Hilbert curve traversal of the RGB colour cube to create a palette ofcolours. This makes use of the locality-preserving properties of the Hilbertcurve to make sure that similar elements have similar colours in thevisualization. See the  originalpost for more.</p><p>通过增加颜色映射的粒度，我们可以在这些图像中获得更多细节。要做到这一点，一种方法是使用我第一次炮制的技巧在比例上可视化希尔伯特曲线。基本思想是使用RGB颜色立方体的3-d希尔伯特曲线遍历来创建调色板。这利用了Hilbert曲线的局部性保持特性，以确保相似元素在可视化中具有相似的颜色。有关更多信息，请参阅原始帖子。</p><p> So, here&#39;s a Hilbert curve mapping of a binary file, using a Hilbert-ordertraversal of the RGB cube as a colour palette. Again, click on the image forthe much nicer large scale version:</p><p>因此，这里是一个二进制文件的希尔伯特曲线映射，使用希尔伯特顺序遍历的RGB立方体作为调色板。同样，点击图片可以看到更好的大尺寸版本：</p><p>  This shows significantly more fine-grained structure, which might be good for adeep dive into a binary. On the other hand, the colours don&#39;t map cleanly todistinct byte classes, so the image is harder to interpret. An ideal hex viewerwould let you flick between the two palettes for navigation.</p><p>这显示出明显更细粒度的结构，这对于深入研究二进制文件可能是有好处的。另一方面，颜色不能清晰地映射到不同的字节类，因此图像更难理解。理想的十六进制查看器可以让您在两个调色板之间切换以进行导航。</p><p>  As usual, I&#39;m publishing the code for generating all of the images in thispost. The binary visualizations were created with binvis, which is a newaddition to  scurve, my space-filling curveproject. The curve diagrams were made with the &#34;drawcurve&#34; utility to be foundin the same place.</p><p>像往常一样，我将发布生成此帖子中所有图像的代码。二进制可视化是用binvis创建的，这是我的充满空间的曲线项目scurve的一个新功能。曲线图是用可以在同一位置找到的绘图工具绘制的。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://corte.si/posts/visualisation/binvis/index.html">http://corte.si/posts/visualisation/binvis/index.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/可视化/">#可视化</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/空间/">#空间</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/binaries/">#binaries</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/曲线/">#曲线</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>