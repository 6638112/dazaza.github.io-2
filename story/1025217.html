<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>云虚拟机管理程序-用Rust编写的开源虚拟机监视器</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">云虚拟机管理程序-用Rust编写的开源虚拟机监视器</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-21 02:52:31</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/1fe95708a9cd6b3e2c5c63d6deccf74f.png"><img src="http://img2.diglog.com/img/2020/9/1fe95708a9cd6b3e2c5c63d6deccf74f.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Cloud Hypervisor是在KVM之上运行的开源虚拟机监视器(VMM)。该项目专注于在一组有限的硬件体系结构和平台上专门运行现代的云工作负载。云工作负载是指通常由云提供商内部的客户运行的工作负载。对于我们来说，这意味着大多数I/O由半虚拟化设备(即virtio)处理的现代操作系统，不需要遗留设备和64位CPU。</p><p>云虚拟机监控程序支持x86-64和AArch64架构。这两种架构在功能上有一些细微的不同(参见#1125)。</p><p>云虚拟机管理程序支持64位Linux，并支持目前正在开发的现代64位Windows客户。</p><p>$PUSH$CLOUDH$GIT CLONE https://github.com/cloud-hypervisor/cloud-hypervisor.git$CD云虚拟机管理程序$CAGOR BUILD--Release#我们需要为云虚拟机管理程序二进制文件提供NET_ADMIN功能，以便它在主机上设置分路接口。$sudo setcap_net_admin+ep./target/release/cloud-Hypervisor$popd。</p><p>如果您希望构建和测试Cloud Hypervisor而不必安装所有必需的依赖项(Ruust工具链、货运工具等)，您也可以使用Cloud Hypervisor的开发脚本：dev_cli.sh。请注意，在第一次调用时，此脚本将拉出相当大的容器图像。</p><p>使用dev_cli.sh还可以在本地运行云虚拟机管理程序配置项。这可以非常方便地调试CI错误，而不必完全依赖云虚拟机管理程序CI基础设施。</p><p>运行./scripts/dev_cli.sh--help命令查看所有受支持的开发脚本命令及其相关选项。</p><p>您可以通过使用现有云映像或引导到您自己的内核和磁盘映像来运行来宾VM。</p><p>云管理程序支持启动包含运行云工作负载所需的所有组件的磁盘镜像，也称为。云图。为此，我们依靠Rust Hypervisor Firmware项目提供ELF格式的KVM固件，以供云虚拟机管理程序直接引导。</p><p>我们需要最新的Ruust-Hypervisor-Firmware版本，还需要一个可用的云映像。这里我们将使用Ubuntu镜像：</p><p>$PUSH D$CLOUDH$wget https://cloud-images.ubuntu.com/focal/current/focal-server-cloudimg-amd64.img$qemu-img转换-p-f qco2-O原始焦点服务器-cloudimg-amd64.img焦点服务器-cloudimg-amd64.raw$wget https://github.com/cloud-hypervisor/rust-hypervisor-firmware/releases/download/0.2.8/hypervisor-fw$popd。</p><p>$PUSH$CLOUDH$SUDO SETCAP_NET_ADMIN+EP./cloud-hypervisor/target/release/cloud-hypervisor$./cloud-hypervisor/target/release/cloud-hypervisor\--内核。/HYPMOVER-FW\--磁盘路径=焦点-服务器-CLODMG-AMD64.raw\--CPU引导=4\--内存大小=1024M\--NET&#34；TAP=，mac=，ip=，MASK=&#34；\--rng$popd。</p><p>云虚拟机管理程序还支持内核直接引导到vmlinux ELF内核或bzImage。为了支持virtio-fs和virtio-IOMMU，我们有自己的开发分支。您当然可以使用您自己的内核，但是这些说明将继续使用我们开发和测试的版本。</p><p>#克隆云虚拟机管理程序Linux分支$PUSH$CLOUDH$GIT CLONE--深度1 https://github.com/cloud-hypervisor/linux.git-bvirtio-fs-virtio-IOMMU-virtio-mem-5.6-rc4linux-cloud-Hypervisor$push d linux-cloud-Hypervisor#使用云虚拟机管理程序内核配置构建内核$cp bzImage.config$make bzImage-j`nproc`$popd。</p><p>对于磁盘镜像，我们将使用包含根分区的Ubuntu云镜像：</p><p>$PUSH D$CLOUDH$wGET https://cloud-images.ubuntu.com/focal/current/focal-server-cloudimg-amd64.img$qemu-img转换-p-f qco2-O原始焦点服务器-cloudimg-amd64.img焦点服务器-cloudimg-amd64.raw$popd</p><p>现在，我们可以直接引导到自定义内核，并使其使用Ubuntu根分区。如果我们想拥有4个vCPU和512MB内存：</p><p>$PUSH$CLOUDH$SUDO SETCAP_NET_ADMIN+EP./cloud-hypervisor/target/release/cloud-hypervisor$./cloud-hypervisor/target/release/cloud-hypervisor\--内核./linux-cloud-hypervisor/arch/x86/boot/compressed/vmlinux.bin\--磁盘路径=焦点-服务器-Cloudimg-amd64.raw\--cmdline&#34；控制台=hvc0root=/dev/vda1 RW&#34；\--CPU引导=4\--内存大小=1024M\--NET&#34；TAP=，mac=，ip=，掩码=&#34；\--RNG。</p><p>上面的示例使用virtio-console设备作为客户控制台，客户内核可能不会很快启用该设备以获取早期内核调试消息。</p><p>当需要更早的调试消息时，首选使用基于传统串行设备的控制台：</p><p>$./cloud-hypervisor/target/release/cloud-hypervisor\--内核./linux-cloud-hypervisor/arch/x86/boot/compressed/vmlinux.bin\--控制台关闭\--串行tty\--磁盘路径=焦点-服务器-cloudimg-amd64.raw\--cmdline&#34；控制台=ttyS0root=/dev/vda1 RW&#34；\--CPU引导=4\--内存大小=1024M\--NET&#34；TAP=，mac=，ip=，掩码=&#34；\--rng。</p><p>云管理程序支持CPU热插拔、直通设备热插拔(VFIO)、virtio-{net、block、pem、fs、vsock}和内存调整。本文档详细介绍如何将设备添加到正在运行的虚拟机。</p><p>我们不是通过特定的git跟踪文件来跟踪Cloud Hypervisor TODO列表，而是通过GitHub问题来跟踪。</p><p>为了满足拥有高性能、以安全为中心的虚拟机管理程序的设计目标，决定使用Rust编程语言。该语言对内存和线程安全的高度关注使其成为实现虚拟机管理系统的理想候选者。</p><p>云虚拟机管理程序不是从头开始实现VMM组件，而是导入rust-vmmcrates，并与亚马逊(Amazon)的Firecracker和谷歌(Google)的CrossVM等其他虚拟机共享代码和架构。</p><p>Cloud Hypervisor接受了Rust-VMM项目的目标，即能够共享和重用尽可能多的虚拟化机箱。因此，云虚拟机管理程序与rust-vmmproject的关系是双重的：</p><p>它将尽可能多地使用Rust-VMM代码。任何与项目目标相关的新的铁锈-VMM板条箱都将尽快集成。</p><p>由于RUST-VMM项目可能会缺少云虚拟机管理程序所需的一些功能(例如，ACPI、VFIO、vhost-User等)，我们将使用云虚拟机管理程序VMM来实现和测试它们，并将其贡献给RUST-VMM项目。</p><p>云虚拟机管理程序的很大一部分代码要么基于Firecracker，要么基于CrossVM项目实现，两者都是用Rust编写的侧重于安全性的虚拟机管理程序，就像云虚拟机管理程序一样。</p><p>然而，我们想要强调的是，云虚拟机管理程序项目既不是这些项目的分支，也不是它们的重新实现。我们试图实现的目标和使用案例各不相同。我们的目标是支持云工作负载，即那些目前由云服务提供商(CSP)租户运行的现代化、完整的Linux分发映像。</p><p>我们的主要目标不是支持客户端或无服务器用例，因此我们的代码库已经与CrossVM和Firecracker有所不同。随着我们添加更多的功能来支持我们的用例，我们相信分歧将会增加，同时通过RUST-VMM项目箱共享尽可能多的基本虚拟化代码。</p><p>我们正致力于围绕云虚拟机管理程序项目建立一个全球性、多样化和协作性的社区。欢迎任何有兴趣参与该项目的人参与。</p><p>我们相信，为像Cloud Hypervisor这样的开源项目做出贡献所涵盖的不仅仅是发送代码。测试、文档编制、拉请求审查、错误报告、特性请求、项目改进建议等都是平等且受欢迎的贡献方式。有关更多详细信息，请参阅投稿文档。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/cloud-hypervisor/cloud-hypervisor">https://github.com/cloud-hypervisor/cloud-hypervisor</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/虚拟机/">#虚拟机</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/开源/">#开源</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/rust/">#rust</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1021210.html"><img src="http://img.diglog.com/img/2020/8/thumb_0160747ebaf571e0a4459f17e22fd3a6.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021210.html">离职5个月后，前思科工程师从AWS擦除了456个WebEx虚拟机</a></div><span class="my_story_list_date">2020-8-30 5:10</span></div><div class="col-sm"><div><a target="_blank" href="/story/1011727.html"><img src="http://img.diglog.com/img/2020/7/thumb_a4ac36548c9f404c5faf3e3c448d264c.gif" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1011727.html">Google Cloud首次推出保密虚拟机，可在使用时对数据进行加密，并为政府提供有保证的工作负载，从而帮助满足合规性要求</a></div><span class="my_story_list_date">2020-7-14 20:50</span></div><div class="col-sm"><div><a target="_blank" href="/story/1011715.html"><img src="http://img.diglog.com/img/2020/7/thumb_97d2ceaea5aaa002f0f5da32bd5d7981.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1011715.html">
谷歌云推出保密虚拟机</a></div><span class="my_story_list_date">2020-7-14 20:5</span></div><div class="col-sm"><div><a target="_blank" href="/story/1010360.html"><img src="http://img.diglog.com/img/2020/7/thumb_5f4ecaab9a048a9dd67fb5dab2fa79da.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1010360.html">新的计算引擎A2虚拟机-云中首个NVIDIA安培A100 GPU</a></div><span class="my_story_list_date">2020-7-8 0:42</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>