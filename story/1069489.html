<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>研究人员使用 Chrome 的密码恢复工具发现了一个恶意的 NPM 包</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">研究人员使用 Chrome 的密码恢复工具发现了一个恶意的 NPM 包</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-07-25 00:55:49</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/7/0a5765b8d3efc24d97e71ac62fa3a142.jpeg"><img src="http://img2.diglog.com/img/2021/7/0a5765b8d3efc24d97e71ac62fa3a142.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>在 npm 开源代码存储库中发现了一个使用合法密码恢复工具的凭据窃取代码炸弹，它潜伏在 npm 开源代码存储库中，等待从该源提取代码的庞大应用程序群中植入。研究人员从 Windows 系统上的 Chrome 中捕获了恶意软件窃取凭据。密码窃取器是多功能的：它还可以侦听来自攻击者的命令和控制 (C2) 服务器的传入命令，可以上传文件、从受害者的屏幕和摄像头进行记录以及执行 shell 命令。 npm（最初是 Node Package Manager 或 NPM 的缩写）是 JavaScript 运行时环境 Node.js 的默认包管理器，Node.js 建立在 Chrome 的 V8 JavaScript 引擎之上。它类似于 GitHub、RubyGems 和 PyPI 等其他代码存储库，因为它是（非常长的）软件供应链的一部分。用“庞大”来描述生态系统是一种轻描淡写的说法：npm 托管着超过 150 万个独特的包，每天为全球约 1100 万开发人员提供超过 10 亿次 JavaScript 包请求。除了文本 JavaScript 文件，npm 还包含各种类型的可执行文件，例如 PE、ELF 和 Mach-O。 ReversingLabs 研究人员在周三的一篇文章中发表了他们的发现，他们表示，在对代码存储库进行分析期间，他们发现了一个有趣的嵌入式 Windows 可执行文件：凭据窃取威胁。标记为“Win32.Infostealer.Heuristics”，它出现在两个包中：nodejs_net_server 和 temptesttempfile。 nodejs_net_server：自 2019 年 2 月首次发布以来，已发布 12 个版本，总共下载量超过 1,300 次的包。它最后一次更新是在六个月前，由某人使用“chrunlee”的名字编写。根据 ReversingLabs 的说法，chrunlee 似乎也是 GitHub 上的活跃开发人员，该开发人员正在开发 61 个存储库。通过静态分析，研究人员在 nodejs_net_server 包的多个版本中发现了 Win32.Infostealer.Heuristics 文件。它的元数据显示该文件的原始名称是“a.exe”并且它位于“lib”文件夹内。研究人员指出，带有类似扩展名的单字母文件名会向威胁猎人发出危险信号。果然，a.exe 原来是一个名为 ChromePass 的实用程序：一种用于恢复存储在 Chrome 网络浏览器中的密码的合法工具。</p><p>chrunlee 通过 12 个版本增强了 nodejs_net_server 包，直到去年 12 月最终使用脚本对其进行升级以下载密码窃取程序，开发人员将其托管在个人网站上。研究人员推测，它随后被调整为运行 TeamViewer.exe，“可能是因为作者不想在恶意软件与其网站之间建立如此明显的联系”。分析师称，chrunlee 发布了第一个版本“只是为了测试 NPM 包的发布过程”。三个月后，恶意软件制造商实现了远程 shell 功能，并在多个后续版本中进行了改进。然后，在 2020 年 4 月，chrunlee 对版本 1.0.7 和 1.0.8 中的 shell 功能进行了小的修改。最后，在 2020 年 12 月，版本 1.1.0 更新了一个脚本来下载密码窃取工具。 temptesttempfile：总下载量超过 800 次。分析师观察到，考虑到“主页和 GitHub 存储库链接到此包会导致不存在的网页”，这有点令人头疼。 chrunlee 的 npm 包之一——tempdownloadtempfile——也有不存在的链接。它的一个文件——file/test.js——实现了与 nodejs_net_server 包版本中发现的相同的远程 shell 功能，但这个包不执行执行劫持，并且它缺乏持久性机制，使其目的是“一个有点不清楚，”ReversingLabs 说。 ReversingLabs 的分析师在挑选 nodejs_net_server 代码时发现了一个开发“有趣的事实”：它的作者 chrunlee 不仅编写了一个凭据窃取程序，而且还意外地发布了他们自己存储的登录凭据，与密码抓取器直接打开作者自己起来攻击。 “看来 npm 存储库中已发布的 1.1.1 和 1.1.2 版本包含在作者的个人计算机上测试 ChromePass 工具的结果，”研究人员观察到。 “这些登录凭据存储在名为“a.exe”的密码恢复工具所在的同一文件夹中的“a.txt”文件中。”另一个有趣的事实：该文本文件有 282 个从 chrunlee 浏览器捕获的登录凭据，其中一些可能仍然有效（ReversingLabs 没有验证它们）。而且，其中一些凭据具有最蹩脚的密码（例如“111”）和用户名（“admin”，任何人？）。</p><p>“仅查看一些恢复的凭据……就表明作者并不总是关心最佳密码策略实践，”分析师优雅地轻描淡写。 ReversingLabs 于 7 月 2 日联系了 npm 安全团队，让他们提前了解 nodejs_net_server 和 tempdownloadtempfile 包，并在上周（周四）再次回过头来，因为该团队仍未从存储库中删除这些包。当 Threatpost 联系维护存储库的 npm Inc. 时，GitHub 发言人发送了以下声明：“在我们调查后，这两个软件包都被删除了。”这不是 npm 第一次被有毒代码渗透。今年早些时候，三个恶意软件包被发布到 npm；研究人员表示，任何被代码损坏的应用程序都可能窃取 Discord 用户的令牌和其他信息。 2018 年 7 月，攻击者破坏了 ESLint 维护者的 npm 凭据，并向 npm 注册表发布了流行的“eslint-scope”和“eslint-config-eslint”软件包的恶意版本。恶意代码复制了运行 eslint-scope 的机器的 npm 凭据并将其上传给攻击者。几个月后，也就是 2018 年 11 月，又发现了另一个恶意软件包：它依赖于流行软件包“event-stream”的 3.3.6 版。这个名为“flatmap-stream”的恶意包包含一个加密的有效载荷，专门用于从 Copay 应用程序中窃取比特币。尽管该恶意软件在 npm 注册表中存在超过三年的事实令人担忧，但值得庆幸的是，那些年让防病毒引擎有机会迎头赶上：VirusTotal 显示 46 家安全供应商已将 a. exe 文件为恶意文件。 Sonatype 高级安全研究员 Ax Sharma 表示，他周三告诉 Threatpost，Chrome 密码窃取恶意软件“进一步证实了对开源生态系统的攻击是如何存在的，并且可能多年未被发现。”</p><p>请注意，这不仅仅是网络攻击者瞄准线中的 npm。本月早些时候，研究人员偶然发现了一组渗透到 PyPI 中的加密矿工，也就是 Python Package Index (PyPI)，这是一个用 Python 编程语言创建的软件代码存储库。根据该报告，npm 渗透只是开发人员如何过度信任第三方代码、重用库以获得快速、简单的结果以及“很少 [进行] 深入的安全评估，然后再将它们纳入其中的最新例子他们的项目。” ReversingLabs 表示：“这种遗漏是由于第三方代码中发现的潜在安全问题具有压倒性的性质和数量庞大的结果。” “因此，一般来说，软件包会被快速安装以验证它们是否解决了问题，如果没有，则转向替代方案。这是一种危险的做法，可能会导致意外安装恶意软件。” Sharma 说，发现 a.exe 的特别之处在于它使用合法的密码恢复 Windows 实用程序 ChromePass 从用户的 Chrome 浏览器窃取密码。 “威胁行为者通常依靠合法的组件和服务来进行他们的险恶活动，以逃避检测，”他通过电子邮件说。在报告的结论中，ReversingLabs 指出，软件供应链攻击正成为恶意行为者的“强大策略”，开发人员成为其组织及其客户群的关键切入点。报告警告说：“针对开发人员的最常见的攻击媒介之一是利用公共软件包存储库。” “由于这些存储库拥有大量托管软件包，它们为恶意软件潜伏提供了一个很好的藏身之处。在这些存储库中反复发现恶意软件包已经证明，对能够提供可靠识别和保护的安全解决方案的需求不断增长对抗这些类型的攻击。” 072121 15:09 更新：添加了来自 Axe Sharma 的输入。 072121 16:18 更新：更新了故事以包含 GitHub 的声明。 072121 17:44 更新：更正了 GitHub 的初始声明：此时，两个包都已被删除。</p><p>查看我们即将举行的免费直播和点播网络研讨会活动 -​​ 与网络安全专家和 Threatpost 社区进行独特、动态的讨论。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://threatpost.com/npm-package-steals-chrome-passwords/168004/">https://threatpost.com/npm-package-steals-chrome-passwords/168004/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/chrome/">#chrome</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/密码/">#密码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/npm/">#npm</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/malicious/">#malicious</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1069253.html"><img src="http://img2.diglog.com/img/2021/7/thumb_5dde89b7aab3e4426e457ccc6a2f1b1e.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1069253.html">谷歌发布了 Chrome 中隐私沙盒推出的详细时间表，重申其早先宣布的将 cookie 淘汰推迟到 2023 年下半年的计划</a></div><span class="my_story_list_date">2021-7-24 3:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1069189.html"><img src="http://img2.diglog.com/img/2021/7/thumb_24e5c61565960f1c26356fee6b9165f1.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1069189.html">谷歌正在修复 Chrome OS 91 中的一个错误，该错误显然是由一个错字引起的，该错误在重新启动时将 Chromebook 所有者锁定在设备之外</a></div><span class="my_story_list_date">2021-7-23 19:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1069158.html"><img src="http://img2.diglog.com/img/2021/7/thumb_18680f3d11a3648e3683ded285a15536.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1069158.html">恶意 NPM 包窃取 Chrome 密码</a></div><span class="my_story_list_date">2021-7-23 12:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1069082.html"><img src="http://img2.diglog.com/img/2021/7/thumb_b5d199b4adcea3a78afbed0b00f2e572.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1069082.html">谷歌将一个字符的错别字推向生产，使 Chrome OS 设备变砖</a></div><span class="my_story_list_date">2021-7-23 2:55</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>