<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Jpeg2png：平滑的JPEG解码-不再有瑕疵</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Jpeg2png：平滑的JPEG解码-不再有瑕疵</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-11 00:49:22</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/7/1a35a255fb98fb6d4a83560179770be4.png"><img src="http://img.diglog.com/img/2020/7/1a35a255fb98fb6d4a83560179770be4.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>JPEG编码会丢失信息。但是JPEG解码通过用噪声填充丢失的信息来引入伪影。</p><p>左下角：采用GIMP的4：2：0色度子采样以10%质量编码的JPEG，64x64细节。</p><p>左下：采用GIMP的4：4：4色度子采样以90%质量编码的JPEG，64x64细节。</p><p>jpeg2png是用可移植的C编写的，特别是C11。它依赖于libjpeg和libpng，您可以使用GNU make和GCC或Clang编译可执行文件。执行以下其中一项。</p><p>jpeg2png为不应另存为JPEG的图片提供最佳效果。例如，图表、徽标和卡通样式的数字绘图。</p><p>另一方面，对于照片或其他纹理精细的图片，jpeg2png的效果很差。</p><p>jpeg2png查找编码为给定JPEG文件的尽可能平滑的图片。但是什么是平滑？第一个近似值是总方差，它说平滑度是相邻像素之间差异的总和。这很有效，但它可以产生非常尖锐的过渡。0 1 2 3 4和0 0 0 4 4的总变异均为4。</p><p>我们需要的不只是看差异，还要看差异的差异，这就是所谓的全广义变差[1]。0 1 2 3 4的差值之和为0，0 0 0 4 4的差值之和为4。</p><p>为了将一阶差和和二阶差和结合起来，我们选择一个权w，那么0 1 2 3 4的总光滑度为4+w*0，0 0 0 4的总光滑度为4+w*4。</p><p>jpeg2png允许您使用-w参数选择二阶差之和的权重。</p><p>纯粹为了平滑而优化有时可能会太过分。如果我们平滑0 3 3..。3 3 0，最大偏差0.5，结果为0.5 2.5。2.5 2.5 0.5整个内部块以一种不太可能的方式改变以适应边界。在真实图片中，这可以被视为亮度或颜色的轻微改变。为了防止这种情况，我们还以非常小的权重优化DCT系数的最小偏差平方和。</p><p>jpeg2png允许您使用-p参数选择偏差平方和的权重。</p><p>现在我们知道我们要找的是什么了。但是如何找到它呢？原来这是一个非线性的凸优化问题，我们使用的方法是一步一步地使解码变得更平滑，步数越多，解码就越平滑。</p><p>较少的步骤，例如10步，只需要几秒钟。质量可能会更好，但与常规解码相比，已经很好了。</p><p>步骤很多，比如1000步，可能只需要几分钟，质量非常好，但是这么高的数字可能是矫枉过正。</p><p>JPEG编码类似于将颜色转换为YCbCr-&gt；色度子采样-&gt；分块DCT-&gt；量化-&&gt;舍入-&&gt;熵编码</p><p>标准的JPEG解码类似于熵解码-&gt；去量化-&gt；分块IDCT-&gt；色度上采样-&gt；将颜色转换为RGB。</p><p>解码过程中缺少的关键一步是反转取整。当然取整不是一对一可逆的，但是我们可以将x解舍入到区间[x-0.5，x+0.5]。这就给出了一组可能的图像。</p><p>我们的目标是最小化sum i=1 to n(范数(梯度(U_I)+w*sum i=1 to n(范数(梯度(U_I)+p*sum(DCT(u-Original)/quant)^2)。为了得到目标TV项的梯度，我们使用前向差分。范数是欧几里得范数。对于二阶TGV项，我们使用后向差作为第二梯度，给出一个2x2的Hessian矩阵。也就是说，我们平均dxdy和dydx。这里的范数是Frobenius标准。我们不使用任何高阶TGV项。偏差由量化因子归一化。我们不区分直流系数和交流系数的偏差。</p><p>不幸的是，如果其中一个范数为零，我们的目标的梯度就没有定义，所以我们的目标是不光滑的，当范数为零时选择的次导数为0。</p><p>目标是凸的，我们的搜索空间Q也是凸的，因为DCT是正交的，所以我们可以很容易地投影到我们的搜索空间上。所以我们可以进行离散余弦变换，将偏差投影到方框[-0.5，+0.5]^n上，然后对其进行独立变换。</p><p>综上所述，我们使用投影和Fista加速的次梯度法，选择的步长为半径(Q)/sqrt(1+步数)，其中半径(Q)为sqrt(N)/2。</p><p>让它并行得更快(OpenMP)不确定最终是否值得花费时间，但当--分离-组件是唯一的模式时，这是有意义的。</p><p>不能将电视翻转到平行的地方：C版本(双核)加速1.15倍(分支并行电视)</p><p>最终，进度条比将时间从40秒提高到18秒更重要。</p><p>我相信这可能是他2004年的一本书的草稿，但它是一种惊人的不道德行为。这是一个坚实的基础，组织得很好，有清晰的解释和充分的证据。强烈推荐。</p><p>电视目标，用次梯度法和投影的凸优化，回想起来都很明显，这是我想出来后发现的，但它仍然是一本很好的书。</p><p>在此基础上，考虑了二次采样、TGV、原始-对偶等算法。宣传材料[视频][演示文稿][至]。</p><p>这是DCT偏差模型的来源。误差的均匀分布足够接近，即使β=1/2的广义正态分布更接近实际。我忽略了HMRF的东西，因为我发现Huber功能非常特别和不雅致。</p><p>qjpegrest是一个工具，可以让你尝试许多不同的JPEG恢复方法(基于电视、基于带通和基于Huber MRF)。我从代码中学到了一些东西。有关安装帮助，请参阅Notes/qjpegrest.txt。</p><p>本程序是自由软件：您可以根据自由软件基金会发布的GNU通用公共许可证的条款、许可证的第三版或(根据您的选择)任何更高版本对其进行再分发和/或修改。</p><p>分发本程序的目的是希望它有用，但没有任何担保；甚至没有对适销性或是否适用于特定目的的默示担保。有关更多详细信息，请参阅GNU通用公共许可证。</p><p>您应该已经收到了GNU通用公共许可证的副本以及此程序。如果没有，请参阅http://www.gnu.org/licenses/.</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/victorvde/jpeg2png">https://github.com/victorvde/jpeg2png</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/jpeg/">#jpeg</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/silky/">#silky</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/解码/">#解码</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>