<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ARM组件中的代码：注册说明 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">ARM组件中的代码：注册说明 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-16 17:24:24</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/6/aaeaa0233c7881cbead32bc8df1d9251.jpg"><img src="http://img2.diglog.com/img/2021/6/aaeaa0233c7881cbead32bc8df1d9251.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>在本系列中的第一条上文章中使用汇编语言开发Apple Silicon Macs，我建立了一个简单的框架ASMattic，可用作开发ARM汇编语言例程的基础。在此，我提供了一个简短而简单的演示，可以调用装配例程并获得其结果。本文首先通过解释ARM64处理器的寄存器架构来解释写自己的例程的机制。</p><p> 在这第一篇文章中，我发出了一款外部双级Multadd（Double，Double，Double）的C包装器来调用_Multadd：str lr，[sp，＃-16]的汇编语言例程！ FMADD D0，D0，D1，D2 LDR LR，[SP]，＃16 RET</p><p> 踩通过组装线，首先保存一组寄存器，执行我想要的浮点操作，恢复寄存器并返回。对于任何一个有意义的，您首先需要了解ARM64处理器的寄存器架构。</p><p> 处理器有三种主要类型的寄存器：通用，浮点（包括SIMD）和特殊。当调用和运行这样的例程时，您最关心前两个，这在ARM的过程调用标准（下面参考文献）和Apple的特定于平台文档（参考文献）中详细解释。</p><p>   有31个通用寄存器，每个寄存器可以用于64位或32位值。当使用64位时，它们将命名为x0至x30，并且32位为w30到w30。</p><p> 存在32个浮点寄存器，每个浮点数可以用于128位值作为V0至V31，64位为D0至D31，以及32位为S0至S31。</p><p> 为简单起见，在本系列中，我将默认为不同的整数和浮点使用64位值。这意味着我将最常用的寄存器是x和d系列，如上面的例子。在更高的语言等价物中，它们等同于C型Long，指针，SWIFT INT，C双倍和SWIFT双倍的数据。 </p><p>这两种类型，X0-X7和D0-D7中的每一个中的前八个寄存器用于将参数传递给装配功能，并且第一个X0和D0用于返回组装例程的结果。它们是按顺序使用的：第一个非浮点参数将在X0中传递X0，X1中的第二个，等等;第一个浮点参数将在D0中传递，第二个浮点数为D1等。</p><p> 重要的是要记住，这些是根据寄存器组使用的。对于Extern双磁带的C包装器（长，双，长，双）第一个长度将在X0中传递，D0中的第一个双倍，X1中的第二个长，D1中的第二个双倍，结果返回在D0中，因为它是一个双重的。</p><p> 这是将参数传递给装配例程的最简单方法，其中使用该值，并将其放置在寄存器中，准备好用于访问的例程：“按值呼叫”（或按值传递））。在X0或D0中返回的唯一结果也是单个值。</p><p> 传递阵列，结构和其他不能简单地放入单个寄存器的参数需要不同的方法，其中传递给数据的指针：“通过引用调用”。这也用于使例程返回多个结果：当参数传递为指向浮点数的指针时，例如，如果例程更改该指针引用的值，则可以使用该值的值调用该例程的代码。</p><p> 让我们假设浮点程需要三个代表x，y和z协调的双打，并且我希望它返回三个，表示转换为投影空间的协调的三倍。由于只有一个浮点数可以返回，因此在寄存器D0中，我们可以通过参考，extern void变换（* double，* double，* double）通过那些通过引用来传递那些协调</p><p> 在SWIFT中，我们可能会又称为变换（＆amp; x，＆amp; y，＆amp; z）来传递那些双打的地址。</p><p> 在组装例程中，按值调用最简单，因为该值可直接从指定的寄存器提供。通过引用呼叫有点复杂，但是，如在例程可以访问值之前，它首先必须从通过的地址加载它们。这就是我的下一篇文章开始的地方。 </p><p>Apple硅的代码与Asmattic App（上一篇关于此博客上的文章）手术呼叫标准用于APS 64位架构（ARM）从Github编写ARM64代码（Apple）Stephen Smith（2020）编程为64- 位ARM汇编语言，APRESS，ISBN 978 1 4842 5880 4.Daniel KUSSWURM（2020）现代ARM汇编语言编程，APRess，ISBN 978 1 4842 6266 5. ARM64指令集参考（ARM）。  发布在Mac，技术和标记的Apple硅，臂，汇编器，汇编语言，M1，Xcode。 书签永久链接。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://eclecticlight.co/2021/06/16/code-in-arm-assembly-registers-explained/">https://eclecticlight.co/2021/06/16/code-in-arm-assembly-registers-explained/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/注册/">#注册</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/arm/">#arm</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/例程/">#例程</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1066094.html"><img src="http://img2.diglog.com/img/2021/6/thumb_779a88d60311c1956bed244ca3f5ace2.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1066094.html">蒂姆伯德斯 - 李先生将第一个Web浏览器的代码销售为NFT </a></div><span class="my_story_list_date">2021-6-16 9:27</span></div><div class="col-sm"><div><a target="_blank" href="/story/1066075.html"><img src="http://img2.diglog.com/img/2021/6/thumb_98fce8ac3244ffbccc2f20796c1351ec.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1066075.html">RFC为700 HTTP状态代码 </a></div><span class="my_story_list_date">2021-6-16 7:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1066026.html"><img src="http://img2.diglog.com/img/2021/6/thumb_581c797af66b93396174c52c49888dd4.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1066026.html">世界范围的网络代码将世界变为拍卖为NFT </a></div><span class="my_story_list_date">2021-6-16 4:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1066015.html"><img src="http://img2.diglog.com/img/2021/6/thumb_bfc55d49b917ce4db20daf927fdb5f70.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1066015.html">Tim Berners-Lee从万维网的目标-C中制作一个NFT </a></div><span class="my_story_list_date">2021-6-16 3:22</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>