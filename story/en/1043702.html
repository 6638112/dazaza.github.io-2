<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>看一下Spectre / Meltdown三年后的CPU安全缓解成本 A Look at the CPU Security Mitigation Costs Three Years After Spectre/Meltdown</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">A Look at the CPU Security Mitigation Costs Three Years After Spectre/Meltdown<br/>看一下Spectre / Meltdown三年后的CPU安全缓解成本 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-09 15:37:30</div><div class="page_narrow text-break page_content"><p>With this week marking three years since Spectre and Meltdown were made public in ushering in a wave of CPU security disclosures that followed and mitigations that often resulted in measurable performance hits, here is a look at how the performance costs stand today with various new and older Intel CPUs as well as AMD processors too. This article is looking at the current performance costs under Linux with the default mitigations and then the run-time disabling of the relevant mitigations for each of the processors under test while using an up-to-date Ubuntu 20.10 paired with the new Linux 5.10 LTS kernel.</p><p>自从Spectre和Meltdown公开发布以来，本周已经过去了三年，随后又引发了一系列CPU安全性披露，并且缓解措施常常导致可衡量的性能下降，下面我们来看看当今各种新旧设备的性能成本如何变化英特尔CPU和AMD处理器也是如此。本文研究的是使用默认缓解措施在Linux下当前的性能成本，然后在运行时禁用每个被测处理器的相关缓解措施，同时使用最新的Ubuntu 20.10与新的Linux 5.10 LTS配对核心。</p><p>    For seeing how the performance is looking three years after Meltdown and Spectre were initially disclosed, I spent the holidays re-testing a range of Intel and AMD desktop processors for seeing the current default mitigation costs. A mix of desktop processors were tested while using an up-to-date Linux software stack with Ubuntu 20.10 with all available stable release updates and also opting to use the brand new Linux 5.10 kernel that is significant in its also a Long-Term Support (LTS) kernel series to be maintained for at least the next five years.</p><p>    为了了解在首次披露Meltdown和Spectre三年后的性能，我度过了假期重新测试了一系列Intel和AMD台式机处理器，以了解当前的默认缓解成本。测试了多种台式机处理器，同时使用了最新的Linux软件堆栈和Ubuntu 20.10，并提供了所有可用的稳定版本更新，并且还选择使用全新的Linux 5.10内核，该内核在长期支持方面也很重要（ LTS）内核系列至少要维持五年。</p><p>  Over the past three years we have continued to see new vulnerabilities disclosed resulting in new mitigations. We also continue to see ongoing work around trying to minimize the performance penalties incurred by the likes of return trampolines (Retpolines), finding new kernel code susceptible to Spectre V1 issues, and more.</p><p>  在过去的三年中，我们继续看到新的漏洞被披露，从而导致了新的缓解措施。我们还继续看到正在进行的工作，这些工作试图尽量减少诸如返回蹦床（Retpolines）之类的性能损失，发现容易受Spectre V1问题影响的新内核代码等。</p><p>    A range of desktop systems were tested for this three-year look at the mitigations. On each system the same software stack was used while booting the Linux 5.10 kernel in its default configuration and then on the second run after booting it with the &#34;mitigations=off&#34; kernel command line flag for the run-time disabling of all applicable CPU security mitigations that have come in the past three years.</p><p>    在三年的缓解期间，已经测试了多种台式机系统。在每个系统上，以默认配置引导Linux 5.10内核时使用了相同的软件堆栈，然后使用＆＃34; mitigations = off＆＃34;引导它之后的第二次运行。内核命令行标志，用于在运行时禁用过去三年来所有适用的CPU安全缓解措施。</p><p>  Below is a look at the mix of processors tested for this article as well as the relevant (default) mitigations for the each of them. This article is looking at just the default versus off configuration and isn&#39;t toggling SMT/HT or any other overrides / extra precautions.</p><p>  下面是针对本文测试过的处理器的混合以及每个处理器的相关（默认）缓解措施。本文仅研究默认配置与关闭配置，并且不会切换SMT / HT或任何其他替代/额外的预防措施。</p><p>  Core i7 4770K - itlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Mitigation of PTE Inversion; VMX: conditional cache flushes SMT vulnerable + mds: Mitigation of Clear buffers; SMT vulnerable + meltdown: Mitigation of PTI + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full generic retpoline IBPB: conditional IBRS_FW STIBP: conditional RSB filling + srbds: Mitigation of Microcode + tsx_async_abort: Not affected</p><p>  核心i7 4770K-itlb_multihit：KVM：禁用VMX缓解+ l1tf：缓解PTE反转； VMX：有条件的缓存刷新了SMT易受攻击者+ mds：清除了Clear缓冲区； SMT易受攻击+崩溃：缓解PTI + spec_store_bypass：通过prctl和seccomp禁用了SSB缓解+ spectre_v1：减轻了usercopy / swapgs障碍和__user指针清理+ spectre_v2：减轻了通用通用repoline IBPB：有条件的IBRS_FW STIBP： srbds：缓解微码+ tsx_async_abort：不受影响</p><p>  Core i7 5775C - tlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Mitigation of PTE Inversion; VMX: conditional cache flushes SMT vulnerable + mds: Mitigation of Clear buffers; SMT vulnerable + meltdown: Mitigation of PTI + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full generic retpoline IBPB: conditional IBRS_FW STIBP: conditional RSB filling + srbds: Mitigation of Microcode + tsx_async_abort: Mitigation of Clear buffers; SMT vulnerable</p><p>  核心i7 5775C-tlb_multihit：KVM：禁用VMX缓解+ l1tf：缓解PTE反转； VMX：有条件的缓存刷新了SMT易受攻击者+ mds：清除了Clear缓冲区； SMT易受攻击+崩溃：缓解PTI + spec_store_bypass：通过prctl和seccomp禁用了SSB缓解+ spectre_v1：减轻了usercopy / swapgs障碍和__user指针清理+ spectre_v2：减轻了通用通用repoline IBPB：有条件的IBRS_FW STIBP： srbds：减轻微码+ tsx_async_abort：减轻清除缓冲区； SMT脆弱 </p><p>  Core i7 7700K - itlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Mitigation of PTE Inversion; VMX: conditional cache flushes SMT vulnerable + mds: Mitigation of Clear buffers; SMT vulnerable + meltdown: Mitigation of PTI + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full generic retpoline IBPB: conditional IBRS_FW STIBP: conditional RSB filling + srbds: Mitigation of Microcode + tsx_async_abort: Mitigation of Clear buffers; SMT vulnerable</p><p>酷睿i7 7700K-itlb_multihit：KVM：禁用VMX缓解+ l1tf：缓解PTE反转； VMX：有条件的缓存刷新了SMT易受攻击者+ mds：清除了Clear缓冲区； SMT易受攻击+崩溃：缓解PTI + spec_store_bypass：通过prctl和seccomp禁用了SSB缓解+ spectre_v1：减轻了usercopy / swapgs障碍和__user指针清理+ spectre_v2：减轻了通用通用repoline IBPB：有条件的IBRS_FW STIBP： srbds：减轻微码+ tsx_async_abort：减轻清除缓冲区； SMT脆弱</p><p>  Core i7 8700K - itlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Mitigation of PTE Inversion; VMX: conditional cache flushes SMT vulnerable + mds: Mitigation of Clear buffers; SMT vulnerable + meltdown: Mitigation of PTI + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full generic retpoline IBPB: conditional IBRS_FW STIBP: conditional RSB filling + srbds: Mitigation of Microcode + tsx_async_abort: Mitigation of Clear buffers; SMT vulnerable</p><p>  核心i7 8700K-itlb_multihit：KVM：禁用VMX缓解+ l1tf：缓解PTE反转； VMX：有条件的缓存刷新了SMT易受攻击者+ mds：清除了Clear缓冲区； SMT易受攻击+崩溃：缓解PTI + spec_store_bypass：通过prctl和seccomp禁用了SSB缓解+ spectre_v1：减轻了usercopy / swapgs障碍和__user指针清理+ spectre_v2：减轻了通用通用repoline IBPB：有条件的IBRS_FW STIBP： srbds：减轻微码+ tsx_async_abort：减轻清除缓冲区； SMT脆弱</p><p>  Core i9 9900K - itlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Not affected + mds: Mitigation of Clear buffers; SMT vulnerable + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full generic retpoline IBPB: conditional IBRS_FW STIBP: conditional RSB filling + srbds: Mitigation of Microcode + tsx_async_abort: Mitigation of Clear buffers; SMT vulnerable</p><p>  核心i9 9900K-itlb_multihit：KVM：禁用VMX缓解+ l1tf：不受影响+ mds：清除Clear缓冲区； SMT易受攻击+崩溃：未受影响+ spec_store_bypass：通过prctl和seccomp禁用了SSB的缓解+ spectre_v1：减轻了usercopy / swapgs障碍和__user指针清理+ spectre_v2：减轻了完全通用的repoline IBPB：有条件的IBRS_FW STIBPs：有条件的rbds ：缓解微码+ tsx_async_abort：缓解清除缓冲区； SMT脆弱</p><p>  Core i9 10900K - itlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Not affected + mds: Not affected + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Enhanced IBRS IBPB: conditional RSB filling + srbds: Not affected + tsx_async_abort: Not affected</p><p>  Core i9 10900K-itlb_multihit：KVM：禁用VMX缓解+ l1tf：不受影响+ mds：不受影响+崩溃：不受影响+ spec_store_bypass：通过prctl和seccomp禁用了SSB缓解+ spectre_v1：缓解了用户复制/交换障碍和__user指针消毒+ spectre_v2：增强的IBRS IBPB的缓解：有条件的RSB填充+ srbds：不受影响+ tsx_async_abort：不受影响</p><p>  Core i9 10980XE - itlb_multihit: KVM: Mitigation of VMX disabled + l1tf: Not affected + mds: Not affected + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Enhanced IBRS IBPB: conditional RSB filling + srbds: Not affected + tsx_async_abort: Mitigation of TSX disabled</p><p>  Core i9 10980XE-itlb_multihit：KVM：禁用VMX + l1tf：不受影响+ mds：不受影响+崩溃：不受影响+ spec_store_bypass：通过prctl和seccomp禁用了SSB + spectre_v1：减轻了用户复制/交换障碍和__user指针清理+ spectre_v2：增强的IBRS缓解IBPB：有条件的RSB填充+ srbds：不受影响+ tsx_async_abort：禁用TSX</p><p>  Ryzen 7 1800X - itlb_multihit: Not affected + l1tf: Not affected + mds: Not affected + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full AMD retpoline IBPB: conditional STIBP: disabled RSB filling + srbds: Not affected + tsx_async_abort: Not affected</p><p>  Ryzen 7 1800X-itlb_multihit：不受影响+ l1tf：不受影响+ mds：不受影响+崩溃：不受影响+ spec_store_bypass：通过prctl和seccomp + spectre_v1禁用了SSB的缓解：减少了usercopy / swapgs障碍和__user指针清理+ spectre_v2：完全AMD瑞波林IBPB的缓解：有条件的STIBP：禁用RSB填充+ srbds：不受影响+ tsx_async_abort：不受影响</p><p>  Ryzen 9 3950X - itlb_multihit: Not affected + l1tf: Not affected + mds: Not affected + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full AMD retpoline IBPB: conditional STIBP: conditional RSB filling + srbds: Not affected + tsx_async_abort: Not affected</p><p>  Ryzen 9 3950X-itlb_multihit：不受影响+ l1tf：不受影响+ mds：不受影响+崩溃：不受影响+ spec_store_bypass：通过prctl和seccomp + spectre_v1禁用了SSB的缓解：减轻了usercopy / swapgs障碍和__user指针清理+ spectre_v2：完全AMD瑞波林IBPB的缓解：有条件的STIBP：有条件的RSB填充+ srbds：不受影响+ tsx_async_abort：不受影响 </p><p>  Ryzen Threadripper 3970X - itlb_multihit: Not affected + l1tf: Not affected + mds: Not affected + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full AMD retpoline IBPB: conditional STIBP: conditional RSB filling + srbds: Not affected + tsx_async_abort: Not affected</p><p>Ryzen Threadripper 3970X-itlb_multihit：不受影响+ l1tf：不受影响+ mds：不受影响+崩溃：不受影响+ spec_store_bypass：通过prctl和seccomp + spectre_v1禁用了SSB的缓解：减少了usercopy / swapgs障碍和__user指针清理：spectre_v2完全AMD瑞波林IBPB的缓解：有条件的STIBP：有条件的RSB填充+ srbds：不受影响+ tsx_async_abort：不受影响</p><p>  Ryzen 9 5950X - itlb_multihit: Not affected + l1tf: Not affected + mds: Not affected + meltdown: Not affected + spec_store_bypass: Mitigation of SSB disabled via prctl and seccomp + spectre_v1: Mitigation of usercopy/swapgs barriers and __user pointer sanitization + spectre_v2: Mitigation of Full AMD retpoline IBPB: conditional IBRS_FW STIBP: always-on RSB filling + srbds: Not affected + tsx_async_abort: Not affected</p><p>  Ryzen 9 5950X-itlb_multihit：不受影响+ l1tf：不受影响+ mds：不受影响+崩溃：不受影响+ spec_store_bypass：通过prctl和seccomp + spectre_v1禁用了SSB缓解：减少了usercopy / swapgs障碍和__user指针清理+ spectre_v2：完全AMD瑞波林IBPB的缓解：有条件的IBRS_FW STIBP：永远在线的RSB填充+ srbds：不受影响+ tsx_async_abort：不受影响</p><p>  The same solid-state storage was used on each of the systems tested and each system was running with RAM at its optimal number of memory channels and frequency for each platform. Via the  Phoronix Test Suite a wide range of workloads relevant to these CPU security mitigations were carried out with the default kernel protections as of Linux 5.10 and then in the mitigations=off mode.</p><p>  在每个测试的系统上都使用了相同的固态存储，并且每个系统都以RAM以及每个平台的最佳存储通道数和频率运行。通过Phoronix测试套件，使用Linux 5.10以后的默认内核保护，然后以mitigations = off模式，执行了与这些CPU安全缓解相关的各种工作负载。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.phoronix.com/scan.php?page=article&item=3-years-specmelt&num=1">https://www.phoronix.com/scan.php?page=article&item=3-years-specmelt&num=1</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/安全/">#安全</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/security/">#security</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/缓解/">#缓解</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>