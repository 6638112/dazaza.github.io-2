<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>把互联网连在一起的管道胶带(2017)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">把互联网连在一起的管道胶带(2017)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-01 15:04:33</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/237951dfabf82ebe4ba5c72f467c95d6.png"><img src="http://img2.diglog.com/img/2020/11/237951dfabf82ebe4ba5c72f467c95d6.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>On Sunday July 2 starting at 4:30 PM, the   ca.la  domain name and all subdomains (site, API, other tools) were inaccessible for almost 12 hours. We registered an alternate domain name and directed customers to it via social media, but we still saw a significant drop in site traffic and our iPhone app was unavailable during this time.</p><p>7月2日周日，从下午4：30开始，ca.la域名和所有子域名(站点、API、其他工具)几乎12个小时都无法访问。我们注册了一个备用域名，并通过社交媒体将客户引导到它，但我们仍然看到网站流量大幅下降，在此期间我们的iPhone应用程序不可用。</p><p> When we have downtime, we run a postmortem to figure out what went wrong and how we can avoid it next time. We found this one pretty interesting, and we thought you might enjoy reading it too.</p><p>当我们有停机时间时，我们会进行尸检，找出哪里出了问题，以及下一次如何避免。我们发现这本书很有趣，我们想你也会喜欢看的。</p><p>  Due to a security issue with our domain registry, another registrar (not the one that manages our domain) was able to incorrectly mark our domain name as pending deletion. Per the ICANN specification,  when a domain has “Pending Delete” status, it’s no longer included in the zone file and becomes inaccessible even if DNS records are configured correctly.</p><p>由于我们的域名注册表存在安全问题，另一家注册商(不是管理我们域名的注册商)无法正确地将我们的域名标记为待删除。根据ICANN规范，当域处于“待定删除”状态时，即使正确配置了DNS记录，它也不再包含在区域文件中，并且变得不可访问。</p><p>   All servers were happily serving requests when queried directly. When accessed via their *.ca.la subdomains they were not available.</p><p>当直接查询时，所有服务器都愉快地为请求提供服务。当通过他们的*.ca.la子域访问时，它们是不可用的。</p><p> Our nameserver records were still pointed to  CloudFlare, which was up and running serving the correct responses.</p><p>我们的命名服务器记录仍然指向CloudFlare，它正在启动并运行，提供正确的响应。</p><p>  $ whois ca.la Domain Name: CA.LA ... Registry Expiry Date: 2020-04-20T23:59:59.0Z Registrar: Gandi SAS Registrar IANA ID: Domain Status: pendingDelete  https://icann.org/epp#pendingDelete</p><p>$whis ca.la域名：CA.LA...。注册表到期日：2020-04-20T23：59：59.0Z注册器：Gandi SAS注册器IANA ID：域名状态：PendingDelete https://icann.org/epp#pendingDelete。</p><p> Though we had renewed the domain for several years to make sure we had no expiration surprises, it was marked as “pending delete”. Everything appeared normal in our registrar’s account dashboard — the domain was active and unexpired, and the expiration date was correctly shown as 2020.</p><p>虽然我们已经续订了几年的域名，以确保我们没有到期的惊喜，但它被标记为“等待删除”。我们注册商的账户仪表盘显示一切正常-域名处于活动状态且未过期，过期日期正确显示为2020年。</p><p>  On March 1 we transferred our domain name ( ca.la) from our original registrar ( www.la) to  Gandi. Everything went smoothly, and we renewed the domain with Gandi for several years into the future. Checking the whois results gave us just what we expected:</p><p>3月1日，我们将我们的域名(ca.la)从原来的注册商(www.la)转移到甘地。一切都很顺利，我们和甘地续签了几年的域名。检查WHOIS结果给出了我们所期望的结果：</p><p>  A few weeks later, we started receiving weekly emails from the previous registrar that our domain was close to expiration. We confirmed with Gandi that the domain was fully transferred to them and renewed, and ignored these notifications going forward, assuming this was just a bug in their billing system that would not affect us.</p><p>几周后，我们开始每周收到前注册商发来的电子邮件，告知我们的域名即将到期。我们与甘地确认，域名已完全转移给他们并续订，并忽略了这些通知，假设这只是他们的计费系统中的一个漏洞，不会影响我们。</p><p>  Surprisingly, after some digging we found out that many of the procedures around domain name management are  essentially done on the honor system.</p><p>令人惊讶的是，经过一番挖掘，我们发现，围绕域名管理的很多程序基本上都是在荣誉系统上完成的。</p><p> When you transfer a domain between registrars, all the authorization codes and email confirmations are a layer of paperwork on top of the simple fact that the new registrar just  announces that it owns your domain now, and promises they’ve confirmed it.</p><p>当你在注册商之间转移域名时，所有的授权码和电子邮件确认都是一层文件，而新的注册商刚刚宣布它现在拥有你的域名，并承诺他们已经确认了这一点。</p><p> The same is apparently true for EPP codes like “pending delete”; as long as a registrar has login access to a given registry — in this case CentralNIC— there’s  nothing stopping them issuing any updates to any domain of their choosing.</p><p>EPP代码(如“待删除”)显然也是如此；只要注册商拥有对给定注册表(在本例中为CentralNIC)的登录访问权限，就没有什么能阻止他们向他们选择的任何域发布任何更新。</p><p> Unlike generic top level domains (.com, .net, .fashion etc), ICANN has  little or no control over country-specific “ccTLDs”. This means the registry operators have full license to manage their own registry’s security — or lack thereof— however they want.</p><p>与通用顶级域(.com、.net、.Fashion等)不同，ICANN对特定国家/地区的“ccTLD”几乎没有控制。这意味着注册表操作员拥有完全的许可证，可以随心所欲地管理自己注册表的安全性-或缺乏安全性。</p><p> We received an email from the previous registrar at 3:00 PM on July 2 titled “Domain expiry notice”, but didn’t see this until after the domain became inaccessible at 4:30 PM.  Shortly after this, the registrar automatically issued a “delete” command to the registry, which was accepted without question.</p><p>我们在7月2日下午3：00收到一封来自前注册商的电子邮件，标题为“域名到期通知”，但直到下午4：30域名变得无法访问时才看到这封邮件。此后不久，书记官长自动向登记处发出“删除”命令，该命令被毫无疑问地接受。</p><p>  As soon as we identified the issue, we contacted both  www.la and  Gandi to seek assistance. Our point of contact at  www.la was also able to connect us with  CentralNIC, the registry for  .la and several other extensions.</p><p>一旦发现问题，我们立即联系www.la和Gandi寻求帮助。我们在www.la的联络点还能够将我们与CentralNIC、.la注册中心和其他几个分机连接起来。</p><p> As our entire domain was unavailable including MX records, we were unable to receive email at any @ca.la email address during the downtime period. We initially attempted to log into the  www.la dashboard to see any issues we might be able to resolve ourselves, but were unable to as the login verification process required clicking on a link in an email.</p><p>由于我们的整个域(包括MX记录)不可用，因此在停机期间，我们无法通过任何@ca.la电子邮件地址接收电子邮件。我们最初尝试登录www.la仪表板，查看我们可能能够自行解决的任何问题，但未能成功，因为登录验证过程需要单击电子邮件中的链接。</p><p> Unfortunately the  www.la engineering team were unable to assist until the next morning, as this incident happened at 12:30 AM in the UK where they are based.</p><p>不幸的是，www.la工程团队直到第二天早上才能提供帮助，因为这起事件发生在他们所在的英国凌晨12：30。</p><p> We contacted CentralNIC and were told they do not deal with customer requests directly, and any issues need to be escalated via Gandi. Gandi was very responsive, and reached out to CentralNIC on our behalf. Though Gandi followed up regularly, they didn’t get a reply until July 9 — long after the situation was resolved.</p><p>我们联系了CentralNIC，并被告知他们不直接处理客户请求，任何问题都需要通过Gandi上报。甘地反应很快，代表我们联系了CentralNIC。尽管甘地定期跟进，但直到7月9日-情况得到解决很久之后-他们才得到回复。</p><p> We called ICANN, who advised that they’re unable to assist with ccTLD issues, but gave us the  contact information for LANIC, the manager for the  .la TLD. We contacted several individuals at LANIC and have still not heard back.</p><p>我们打电话给ICANN，他们告诉我们他们无法协助处理ccTLD问题，但给了我们.la TLD的经理LANIC的联系方式。我们联系了LANIC的几个人，但仍然没有得到回复。</p><p> Since a resolution wasn’t forthcoming, we registered a  new gTLD domain name, updated our service configurations to refer to this instead, and began directing customers there via social media.</p><p>由于没有解决方案，我们注册了一个新的gTLD域名，更新了我们的服务配置以引用此域名，并开始通过社交媒体将客户引导到那里。</p><p> When the  www.la engineering team came online, they were able to revoke the “pending delete” status manually. The domain quickly became available again.</p><p>当www.la工程团队上线时，他们可以手动撤销“待删除”状态。该域名很快又可以使用了。</p><p>  Though we believe major fault lies with both the registrar and the registry itself, we take full responsibility for not following up sooner when we saw unexpected notification emails.</p><p>虽然我们认为注册处和注册处本身都有重大过错，但当我们看到意外的通知电子邮件时，我们会对没有及时跟进承担全部责任。</p><p> We’ve centralized our site and API configuration to make it easier to roll between different domains in the future, and removed unnecessary layers of aliases to several services.</p><p>我们已经集中了我们的站点和API配置，使将来更容易在不同的域之间滚动，并删除了几个服务的不必要的别名层。</p><p> We’ve made sure the email address on our Gandi account is located on a domain name that’s not registered via Gandi, to avoid communication issues if a similar situation happens again.</p><p>我们已经确保我们甘地账户上的电子邮件地址位于一个不是通过甘地注册的域名上，以避免再次发生类似情况时的通信问题。</p><p> We hope the information we’ve provided to the registrars and registry involved will help them develop security measures to prevent this happening to other customers in the future.</p><p>我们希望我们提供给注册商和注册处的信息将帮助他们制定安全措施，以防止这种情况在未来发生在其他客户身上。</p><p> If you’ve ever run into a similar issue in the past, or have any ideas on how we can prevent problems like this from happening again, we’d love your comments and suggestions.</p><p>如果您在过去遇到过类似的问题，或者对如何防止类似的问题再次发生有任何想法，我们将非常欢迎您的意见和建议。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/thisiscala/the-duct-tape-holding-the-internet-together-12118be60ff1">https://medium.com/thisiscala/the-duct-tape-holding-the-internet-together-12118be60ff1</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/连在一起/">#连在一起</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tape/">#tape</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/域名/">#域名</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>