<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何在命令行清除CSV数据-第2部分</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">如何在命令行清除CSV数据-第2部分</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-08 13:53:02</div><div class="page_narrow text-break page_content"><p>In the last blog post, we proved that  xsv is ~1882x faster than csvkit when joining two CSVs and saw how performant xsv is and when we can use  xsv or  csvkit when we are at the terminal.</p><p>在上一篇博客文章中，我们证明了当加入两个CSV时，xsv比csvkit快约1882倍，并且看到了xsv的性能以及我们在终端上什么时候可以使用xsv或csvkit。</p><p> Today, we&#39;re talking about part 2 of cleaning CSV data at the command line investigating a large CSV file (from Kaggle) that contains  ~26 million users and their number of comments posted from 2005 to 2017. We also talked about  cleaning text files in general using the command line if you want to check out.</p><p>今天，我们要讨论的是在命令行清理CSV数据的第二部分，调查一个大型CSV文件(来自Kaggle)，该文件包含约2600万用户及其在2005年至2017年发布的评论数量。我们还讨论了如果您想签出，一般使用命令行清理文本文件。</p><p>             but you need to have  Cargo installed which is Rust&#39;s package manager since xsv is written in Rust</p><p>但您需要安装Cargo，这是Rust的包管理器，因为xsv是用Rust编写的。</p><p>  Let&#39;s first create a CSV file to play with instead of the large file. Create it with your favorite text editor or just at the command line:</p><p>让我们先创建一个csv文件来玩，而不是创建一个大的csv文件。使用您最喜欢的文本编辑器或仅在命令行中创建它：</p><p>  Here, we’d like to concatenate this  fake_users.csv file with the large  users.csv file.</p><p>在这里，我们希望将这个fake_users.csv文件与大的users.csv文件连接在一起。</p><p> To see the effect of the performance here, we will stack the large file first because that will be more accurate when using  tail to validate that the second file is already read into memory and concatenated.</p><p>要查看这里的性能效果，我们将首先堆叠大文件，因为在使用Tail验证第二个文件是否已读入内存并连接时，这会更准确。</p><p>   rows here is used to indicate that we will concatenate the rows so the rows of the second file will be appended to the rows of the first file</p><p>此处的行用于指示我们将连接这些行，以便将第二个文件的行追加到第一个文件的行上。</p><p>       Let’s first see how  csvsort and  xsv sort work by sorting  fake_users.csv by the number of comments  n:</p><p>让我们首先看看csvsorte和xsv是如何排序的，方法是按照评论数量n对fake_users.csv进行排序：</p><p>        After downloading  users.csv,  the ~359MB CSV file, let&#39;s sort it with  xsv first. This is a +25 million records so expect a latency here!</p><p>下载了约359MB的CSV文件users.csv后，让我们先用xsv对其进行排序。这是+2500万条记录，所以这里会有延迟！</p><p>     -t, to determine the field separator which is comma here as the file is a CSV file</p><p>-t，以确定此处为逗号的字段分隔符，因为该文件是CSV文件。</p><p>   -k2 for setting the key field (the column that you sort by which is the second column here)</p><p>-k2用于设置关键字段(您排序的列是这里的第二列)。</p><p>    Do you know that I have terminated my terminal after  more than an hour of waiting for this command to complete execution and it&#39;s not completed yet!</p><p>你知道吗，在等待这个命令完成执行一个多小时后，我已经终止了我的终端，而它还没有完成！</p><p> Knowing that  csvkit is written in pure python can somehow proves that it&#39;s not advisable to write a very performant tool with such technology alone unless you use C or Cython with Python as  Pandas did:</p><p>知道csvkit是用纯Python编写的，可以从某种程度上证明，仅用这种技术编写性能非常好的工具是不可取的，除非您像Pandas那样将C或Cython与Python一起使用：</p><p>   Pandas here beats ALL,  csvkit,  BSD sort, and even  xsv with execution time of ~78 seconds which means it&#39;s very close to  xsv result (1.4min = 84s) so just 6 seconds difference and with each run, the time varies so it&#39;s acceptable for  xsv to be competing with  pandas for performance.</p><p>这里的熊猫胜过一切，csvkit，BSD分类，甚至xsv，执行时间约为78秒，这意味着它非常接近xsv的结果(1.4分钟=84秒)，所以只有6秒的差异，每次运行，时间都不同，所以xsv可以接受与熊猫在性能上的竞争。</p><p>  From our investigation of the 26 million records data of the Reddit username data, it seems that  xsv is the fastest command line I ever used and I think ever existed at the terminal. It is more performant than  csvkit. We’ve seen a tremendous improvement in speed when cleaning our data by:</p><p>从我们对Reddit用户名数据的2600万条记录数据的调查来看，xsv似乎是我使用过的最快的命令行，我认为在终端上也存在过。它比csvkit性能更好。在清理数据时，我们已经看到速度有了极大的提高，原因是：</p><p> concatenating the rows of the CSV files using  xsv cat rows and comparing it with  csvstack‍</p><p>使用xsv cat行连接csv文件的行，并将其与csv栈‍进行比较。</p><p> sorting by a column and in a reverse order using  xsv sort -sRN comparing it with  csvsort -rc</p><p>使用xsv sorte-srn按列和逆序排序，并将其与csvort-rc进行比较。</p><p> also comparing the two utilities with  BSD sort and  pandas resulting in a very good performing of pandas and xsv</p><p>此外，将这两种公用事业与BSD、Sort和Pandas进行了比较，得出了Pandas和Xsv的非常好的表现。</p><p> In the end, as always you have the choice to choose whatever you want from the  csvkit or  xsv but it&#39;d be fair to use what makes our life easy which is  xsv especially when we&#39;re dealing with a large CSV file like what we saw today and if speed and performance are not what we look for especially when we&#39;re dealing with small CSVs, we can go for  csvkit.</p><p>最后，你可以一如既往地从csvkit或xsv中选择你想要的任何东西，但使用让我们的生活变得简单的xsv是公平的，特别是当我们正在处理像我们今天看到的大型CSV文件时，如果速度和性能不是我们想要的，特别是当我们正在处理小型CSV时，我们可以选择csvkit。</p><p> You might have noticed that the syntax is kind of similar in sorting and stacking. So you always have the choice!</p><p>您可能已经注意到，它们在排序和堆叠方面的语法有些相似。所以你总有选择的余地！</p><p>    Disclosure:  The Amazon links for the book (in this section) are paid links so if you buy the book, I will have a small commission</p><p>披露：这本书的亚马逊链接(在这一部分)是付费链接，所以如果你买了这本书，我会有一小笔佣金。</p><p> This book tries to catch your attention on the ability of the command line when you do data science tasks - meaning you can obtain your data, manipulate it, explore it, and make your prediction on it using the command line. If you are a data scientist, aspiring to be, or want to know more about it, I highly recommend this book. You can read it online for free from  its website or order an  ebook or paperback.</p><p>本书试图在您执行数据科学任务时引起您对命令行功能的关注-这意味着您可以使用命令行获取数据、操作数据、探索数据并对其进行预测。如果你是一名数据科学家，有志于成为一名数据科学家，或者想要更多地了解它，我强烈推荐这本书。你可以从它的网站上免费阅读它，或者订购一本电子书或平装本。</p><p>  You might be interested in my previous tutorials on  part 1 of cleaning CSV data or  why we use docker tutorial or the one similar to this on  how to clean text data at the command line‍</p><p>您可能会对我以前关于清理csv文档数据的第1部分的教程感兴趣，或者为什么我们使用docker教程，或者是关于如何在命令行‍中清理文本数据的类似教程。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.ezzeddinabdullah.com/posts/how-to-clean-csv-data-at-the-command-line-part-2">https://www.ezzeddinabdullah.com/posts/how-to-clean-csv-data-at-the-command-line-part-2</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/清除/">#清除</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/csv/">#csv</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/xsv/">#xsv</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>