<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>隐藏 16 年 – 全球数百万打印机易受攻击</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">隐藏 16 年 – 全球数百万打印机易受攻击</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-07-22 21:54:35</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/7/29c7790f91fd2899e48a616ecb8c52bc.jpg"><img src="http://img2.diglog.com/img/2021/7/29c7790f91fd2899e48a616ecb8c52bc.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>自 2005 年以来，惠普、三星和施乐在全球范围内发布了数百万台带有易受攻击的驱动程序的打印机。 SentinelLabs 的发现已于 2021 年 2 月 18 日主动报告给惠普，并被跟踪为 CVE-2021-3438，标记为 CVSS 评分 8.8。惠普于 5 月 19 日向其客户发布了安全更新以解决此漏洞。作为我们为所有用户确保互联网安全的承诺的一部分，我们的研究人员针对影响广泛最终用户的目标开展了一个开放式漏洞发现过程。我们的研究一直卓有成效，尤其是在 OEM 驱动程序领域[1, 2]。许多这些驱动程序预装在设备上，或者在安装一些无害的合法软件包时被悄悄丢弃，用户完全不知道它们的存在。这些 OEM 驱动程序通常已有数十年历史，并且在编码时并不担心它们对这些系统的整体完整性的潜在影响。我们的研究方法使我们能够主动与供应商和制造商合作，在它们被广泛利用之前修补以前未知的漏洞。我们将继续努力减少狡猾的对手可用的整体攻击面。几个月前，在配置全新的 HP 打印机时，由于 Process Hacker 再次发出警报，我们的团队遇到了 2005 年的旧打印机驱动程序，名为 SSPORT.SYS。这导致在 HP、Xerox 和 Samsung 打印机驱动程序软件中发现了一个高度严重的漏洞，该漏洞已经 16 年未公开。此漏洞影响了超过 380 种不同的 HP 和三星打印机型号以及至少十几种不同的施乐产品。</p><p>由于所有这些型号实际上都是由 HP 制造的，我们向他们报告了该漏洞。只需运行打印机软件，无论您是完成安装还是取消安装，驱动程序都会在机器上安装并激活。因此，实际上，该驱动程序甚至无需询问或通知用户即可安装和加载。无论您是将打印机配置为无线工作还是通过 USB 电缆工作，都会加载此驱动程序。此外，它会在每次启动时由 Windows 加载：这使得驱动程序成为目标的完美候选者，因为即使没有连接打印机，它也将始终加载到机器上。驱动程序中的漏洞函数通过 IOCTL（输入/输出控制）接受从用户模式发送的数据，而无需验证大小参数：此函数使用 strncpy 从用户输入复制字符串，并使用由用户控制的大小参数。本质上，这允许攻击者溢出驱动程序使用的缓冲区。在调查这个驱动程序时，我们注意到一个有趣的事情是这个特殊的硬编码字符串：“这个字符串来自设备驱动程序@@@@”。</p><p>似乎惠普没有开发这个驱动程序，而是从微软的 Windows Driver Samples 中的一个项目中复制了它，该项目具有几乎相同的功能；幸运的是，MS 示例项目不包含该漏洞。可利用的内核驱动程序漏洞可将非特权用户引导至 SYSTEM 帐户并在内核模式下运行代码（因为易受攻击的驱动程序在本地可供任何人使用）。此类漏洞的明显滥用包括它们可用于绕过安全产品。成功利用驱动程序漏洞可能允许攻击者安装程序、查看、更改、加密或删除数据，或者创建具有完全用户权限的新帐户。武器化这个漏洞可能需要链接其他错误，因为考虑到投入的时间，我们没有找到一种方法来单独武器化它。一般来说，强烈建议为了减少暴露 IOCTL 处理程序的设备驱动程序提供的攻击面，开发人员应该在创建内核设备对象时强制执行强 ACL，验证用户输入，而不是将通用接口暴露给内核模式操作。 HP 安全咨询 HPSBPI03724 和施乐咨询迷你公告 XRX21K 中描述了此漏洞及其补救措施。我们建议 HP/Samsung/Xerox 客户，包括企业和消费者，尽快应用补丁。为了缓解这个问题，用户应该使用这个链接并寻找他们的打印机型号，然后下载如图所示的补丁文件：一些 Windows 机器可能已经有这个驱动程序，甚至没有运行专用的安装文件，因为该驱动程序与 Microsoft Windows 一起提供通过 Windows 更新：</p><p>注意：并非所有受影响的产品最初都列在咨询页面上。我们最初进行了小样本测试，发现其他产品易受攻击，因此我们建议进一步验证。自 2005 年以来，HP、Samsung 和 Xerox 打印机软件中就存在这种严重性高的漏洞，影响了全球数百万台设备和数百万用户。与我们之前披露的隐藏了 12 年 (1, 2) 的漏洞类似，这可能对未能修补的用户和企业产生深远而重大的影响。虽然到目前为止我们还没有看到任何迹象表明此漏洞已被广泛利用，但目前有数百万台打印机型号易受攻击，如果攻击者将此漏洞武器化，他们将不可避免地寻找那些没有采取适当行动的人.我们要感谢惠普对我们的披露和快速修复漏洞的方法。 2021 年 2 月 18 日——初步报告。 2021 年 2 月 23 日 – 我们通知惠普三星和施乐打印机存在同样的问题。 2021 年 5 月 19 日——惠普发布了 CVE-2021-3438 的公告。 2021 年 5 月 20 日 – 我们通知惠普“受影响产品”列表不完整，并提供了额外信息。 2021 年 6 月 1 日 – 惠普更新了受影响产品的列表。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://labs.sentinelone.com/cve-2021-3438-16-years-in-hiding-millions-of-printers-worldwide-vulnerable/">https://labs.sentinelone.com/cve-2021-3438-16-years-in-hiding-millions-of-printers-worldwide-vulnerable/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/打印/">#打印</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/打印机/">#打印机</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/hiding/">#hiding</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/驱动程序/">#驱动程序</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>