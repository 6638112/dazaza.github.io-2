<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>通过USB实现的树莓PI-UASP、Trim和Boot性能</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">通过USB实现的树莓PI-UASP、Trim和Boot性能</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-20 11:51:03</div><div class="page_narrow text-break page_content"><p>在过去的几周里，我回顾了Raspberry Pi4上的USB驱动器性能，以及UASP支持对USB驱动器性能的重要性。</p><p>这两个帖子都引起了很大的讨论，我想在这篇后续文章中谈到三件事，即：</p><p>作为参考，这里是我在这篇文章中测试的所有产品(产品链接指向他们的亚马逊产品页面，从中间上方开始，顺时针方向)：</p><p>首先，在上一篇文章中，我完全忘记了讨论我测试的哪些USB驱动器支持UASP，哪些不支持UASP。</p><p>对于更新器，UASP允许Raspberry PI使用SCSI协议与驱动器通信，这在文件复制和磁盘性能方面比旧的USB大容量存储协议快两倍。</p><p>您可以使用命令lsusb-t检查您自己的驱动器是否支持UASP。如果输出显示&#39；UAS&#39；，则表示支持开箱即用。如果它显示&#39；usb-storage&#39；，则不会。</p><p>看起来，我测试的所有最快的硬盘都支持它，而所有最慢的硬盘都不支持它。这并不令人惊讶；速度较快的硬盘使用的芯片组更好，这些芯片组都是为固态硬盘性能而打造的。</p><p>不过，奥坎特是一个异常值。它不支持UASP，但它的价格确实表现得很好。有时它的行为有点像固态硬盘-我稍后会谈到这一点。</p><p>对于我想要报道的第二件事，不是别人，正是树莓PI的工程总监戈登·霍林沃斯(Gordon Hollingworth)在他的Twitter帖子中提示我的。他说：</p><p>真正有趣的是，不同的SD卡、USB闪存和NVMe存储在引导时间和从命令行启动网页的时间方面有何比较……。</p><p>-戈登·霍林沃斯(@gsholling)2020年8月7日。</p><p>测量引导时间时，最重要的是找到一种使用客观测量来比较不同设备的方法。也就是说，你不想坐在那里拿着秒表，试着从插件到桌面都计时，看起来就像开机时间一样。这有时可能会有帮助，但这不是很客观。</p><p>取而代之的是，我使用Raspberry PI OS中的内置工具，称为systemd-Analyze。它是一个帮助您分析系统管理器的工具，默认情况下，如果您只运行该命令，它将输出引导时间。这有多容易？！</p><p>所有的驱动器都表现得相当不错，尽管非UASP驱动器确实倾向于速度较慢，但奇怪的是SanDisk Ultra Fair例外，它的表现超出了它的重量级别。到目前为止最慢的是SanDisk Ultra Fit，我在上一篇帖子中提到过，它有过热和减速的趋势。</p><p>首先，我使用2020年8月版本的Rasbperry PI OS启动，并按照这篇博客文章中的说明配置USB驱动器以启动PI。</p><p>其次，PI似乎已经很好地优化了它的引导性能。第一次引导总是有点慢，但在我测试的所有USB驱动器上，随后的引导花费了大约15-17秒。</p><p>最大的不同之处在于，在速度较快的固态硬盘和NVMe驱动器上，首次启动速度要快得多，而在廉价的闪存驱动器和microSD卡上，第一次启动速度要慢得多。</p><p>戈登在他的推文中提到的另一件事是从命令行测试Web浏览器的启动时间。</p><p>这实际上需要做一些工作，想出一种方法从命令行启动Chromium，加载一个网页，然后退出它，并获得该过程的准确时间测量。仅仅使用铬浏览器[这里的URL]并不能解决问题，因为这会启动浏览器，并且在我手动退出浏览器之前，该进程不会退出。</p><p>在Twitter上询问其他人可能会做些什么后，我发现了一款名为“木偶”(Puppeteer)的巧妙Node.js实用程序，我可以用它自动完成所有操作，然后我使用Linux中的时间实用程序对每个驱动器的进程进行了三次基准测试。我在这篇文章中详细描述了我是如何做这个基准测试的：测试Chromium打开、加载网页和退出Debian需要多长时间。</p><p>差别真的不是那么大。绝对没有我想的那么大。速度更快的驱动器打开Chromium的速度仍然会稍微快一点-特别是在第一次发布时-但速度只有一点点！</p><p>我通过VNC连接测试了所有这些PI，在raspi-config中将分辨率设置为1280x720。就像启动时间一样，重启后第一次启动浏览器所需的时间比第二次、第三次、第四次或第五次启动的时间要长一些。</p><p>我认为这仅仅意味着只要您有足够的系统内存，Linux中的缓存机制就可以很好地正常化即使是非常慢的引导卷的性能。</p><p>一旦第二次启动，在退出并重新启动Chrome之后，最慢的驱动器和NVMe驱动器之间的常见UI任务几乎察觉不到差异。</p><p>有些事情，特别是当您在进行升级、安装软件、编写文件或处理大型项目(如我维护的Drupal网站)时，差异会更加明显。</p><p>为了测试这一点，我在每个驱动器上安装了php7.3-cli，并检查了这需要多长时间：</p><p>还有.。与其他性能测试一样，此测试不是最一致的。我在一些驱动器上运行了几次，在两次运行之间重新刷新了整个驱动器，标准偏差-运行之间的差异-通常在20%左右，所以对这些结果持保留态度。</p><p>一般来说，速度较快的驱动器确实做得更好，但在对实际工作负载进行基准测试时，很难获得准确的数字。</p><p>您知道GTX和Arcanite是否支持装饰吗？在考虑操作系统存储时，这肯定会有不同之处。</p><p>为什么Legogris会对Trim支撑件感兴趣？简而言之，使用固态硬盘时，当少量数据被删除，而新数据需要写入那些旧的已删除位所在的位置时，驱动器可能会减慢速度，并且还会做比应该做的更多的工作。</p><p>这是一个非常简单的答案，但基本上可以将其视为SSD的自动碎片整理。我不知道你是否有幸坐在一台旧的Windows电脑前，连续几个小时看着它对你的80MB IDE驱动器进行碎片整理，但它就是这样，速度超快。Trim在技术上不做碎片整理，但它的相似之处在于它让您的固态硬盘通过一些自动清理过程发挥最佳性能。</p><p>最困难的是，你必须在你的操作系统--在我们的例子中，Raspberry Pi OS(确实支持TRIM)--和驱动器控制器的固件中都有TRIM支持。</p><p>有几种方法可以检查TRIM支持，如运行fstrim命令：</p><p>如果它显示不支持丢弃操作，则TRIM当前不适用于您的驱动器。</p><p>如果DISC-MAX值为0B，则再次说明，TRIM当前不适用于您的驱动器。</p><p>在您按照特殊流程更改其供应模式后，许多适配器将与TRIM一起工作。</p><p>我有一篇单独的博客文章，详细介绍了如何启用Trim支持(如果您的固件支持，但默认情况下没有启用)：在Raspberry PI上的外部SSD上启用Trim。</p><p>某些驱动器控制器可能还需要固件更新才能启用微调支持，因此请查看驱动器制造商的网站。</p><p>令人惊讶的是，Inatech外壳似乎没有任何修剪支撑，而TDBT NVMe外壳和海盗船则有。</p><p>此外，这是我从未想过的-Raspberry PI实际上支持内置microSD卡的开箱即用的修剪！</p><p>但最令人担忧的结果是，Arcanite固件显示了TRIM支持，但当我按照流程更改配置模式并运行fstrim时，驱动器出现了惊人的故障，现在我甚至无法在任何计算机上挂载或初始化它！</p><p>所以..。Arcanite固件可能来自SSD，但是闪存本身似乎不能很好地接受fstrim命令。要么是那样，要么是我有一个有缺陷的装置！</p><p>最后，我发现在我测试的所有驱动器上都有很多不同的特征，有积极的，也有消极的。如果你只需要一个驱动器来存储大文件，我仍然认为Arcanite是最好的整体价值，即使它不支持UASP，而且如果你尝试启用Trim，它就会爆炸。</p><p>如果你追求原始性能，机箱内的NVMe将给你带来最好的回报，以及-至少在我测试的TDBT机箱-完全内饰和UASP支持。</p><p>最后，如果你有任何USB3.0驱动器，除了便宜的闪存驱动器，它的性能可能会和Raspberry PI 4中的microSD卡一样好，甚至更好。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.jeffgeerling.com/blog/2020/raspberry-pi-usb-boot-uasp-trim-and-performance">https://www.jeffgeerling.com/blog/2020/raspberry-pi-usb-boot-uasp-trim-and-performance</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/性能/">#性能</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/实现/">#实现</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pi/">#pi</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/驱动器/">#驱动器</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1024921.html"><img src="http://img2.diglog.com/img/2020/9/thumb_b1a2b2b318936d093683d6c1fcd2352c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1024921.html">三星Galaxy Tab S7，S7+评论：出色的显示屏，性能时髦，但Dex仍感觉未完成，宽屏纵横比不利于工作效率</a></div><span class="my_story_list_date">2020-9-19 3:17</span></div><div class="col-sm"><div><a target="_blank" href="/story/1024824.html"><img src="http://img2.diglog.com/img/2020/9/thumb_b89f42205318c416a913cb77ea162107.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1024824.html">RTX3080 TensorFlow和NAMD在Linux上的性能(初步版)</a></div><span class="my_story_list_date">2020-9-18 19:49</span></div><div class="col-sm"><div><a target="_blank" href="/story/1024816.html"><img src="http://img2.diglog.com/img/2020/9/thumb_07fdffc7e36ca792ee06a98faaa0fa97.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1024816.html">IPhone6S和SE上的iOS 14：性能很好，其他东西就不行了</a></div><span class="my_story_list_date">2020-9-18 19:18</span></div><div class="col-sm"><div><a target="_blank" href="/story/1024638.html"><img src="http://img2.diglog.com/img/2020/9/thumb_0844fabe78bcba4e3576cc704acfded7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1024638.html">针对笔记本电脑的英特尔第11代Tiger Lake CPU评测：在相同能耗的一系列不同任务上比Ice Lake性能更好</a></div><span class="my_story_list_date">2020-9-18 2:1</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>