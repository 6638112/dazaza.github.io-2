<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何以正确的方式构建可扩展的SDK(了解AWS SDK的收益)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">如何以正确的方式构建可扩展的SDK(了解AWS SDK的收益)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-09 21:14:54</div><div class="page_narrow text-break page_content"><p>AWS SDK为110多项服务维护和发布SDK，每天对所有SDK进行同步和多次更新。有趣的是，他们实现了所有大公司都在努力实现的目标，无缝、毫不费力地推出了新的API。在AWS的旗舰娱乐大会“Re：Inent”期间，SDK更新了新的API，这些API在不到2小时的时间里刚刚宣布，供全世界使用。</p><p>要与任何AWS服务交互，您需要使用Python、Java或您的软件使用的任何其他语言的AWS SDK。</p><p>我一直是AWS的PHP SDK的一名工程师，它在Github上是开源的，任何人都可以查看AWS团队发布的代码。AWS管理超过8个SDK，包括用于Java、Ruby、python、javascript、PHP、Go、C++和少数其他语言的SDK。</p><p>通常，只管理一个SDK需要大量的工程师。要确保所有的API和功能在所有SDK上都可用，这是一项巨大的壮举。在这篇文章中，我们将讨论如何扩展SDK，以及AWS如何通过手动更新每个SDK来实现跨所有SDK的完美同步，而无需晃动SDK团队。</p><p>所有SDK都有两个部分，一个是核心，另一个包含所有特定于服务的代码。SDK的核心处理各种功能，如“使用AWS的Sigv4协议对每个请求进行签名”、安全功能、SSL处理、多线程、异步请求、服务员、分页器，以及更多功能。</p><p>每个SDK的其他部分基于特定于每个服务的“模型”文件。每个SDK中的所有模型文件都完全相似。</p><p>这种差别在AWS的python SDK中非常明显，它分为两个不同的存储库“boto”和“botocore”。</p><p>所有的模型文件都在一定程度上建立在OpenApi协议之上，并与Swagger API协议兼容。</p><p>以下是名为“api-2.json”的AWS PHP SDK中DynamoDB的JSON定义，Boto SDK中也存在名为“service-2.json”的完全相同的文件。</p><p>在AWS，每个服务都将发布这些JSON模型文件，这些文件指定了与每个API&amp；服务相关的所有信息。与其他SDK相比，每个SDK处理这些文件的方式略有不同。PHP SDK会在每个客户端动态加载这些JSON文件，以支持各种API，而Java SDK会将这些方法预先构建到具体的类中。</p><p>每个AWS团队都会维护并发布这些特定于服务的模型文件，然后每个SDK团队都可以按照自己喜欢的方式使用这些文件。</p><p>我相信这些在你看来就像我第一次看到它时一样神奇。那么让我们深入研究一下代码吧。我们将查看PHP SDK示例，因为这是我所在的团队的一部分，我对SDK了如指掌。</p><p>&#34；调用&#34；：{&#34；名称&#34；：&#34；调用&#34；，&#34；http&#34；：{&#34；方法&#34；：&#34；发布&#34；，&#34；requestUri&#34；：&#34；/2015-03-31/functions/{FunctionName}/invocations&#34；}，&#34；input&#34；：{&#34；shape&#34；：&#34；InvocationRequest&#34；}，&#34；output&#34；：{&#34；shape&#34；：&#34；InvocationResponse&#34；}，&#34；错误&#34；：[{&#34；形状&#34；：&#34；服务异常&#34；}，{&#34；shape&#34；：&#34；ResourceNotFoundException&#34；}，{&#34；shape&#34；：&#34；InvalidRequestContentException&#34；}，{&#34；形状&#34；：&#34；RequestTooLargeException&#34；}，{&#34；shape&#34；：&#34；UnsupportedMediaTypeException&#34；}，{&#34；shape&#34；：&#34；TooManyRequestsException&#34；}，{&#34；shape&#34；：&#34；InvalidParameterValueException&#34；}，{&#34；shape&#34；：&#34；EC2UnexpectedException&#34；}，{&#34；shape&#34；：&#34；SubnetIPAddressLimitReachedException&#34；}，{&#34；shape&#34；：&#34；ENILimitReachedException&#34；}，{&#34；shape&#34；：&#34；EC2ThrottledException&#34；}，{&#34；shape&#34；：&#34；EC2AccessDeniedException&#34；}，{&#34；shape&#34；：&#34；InvalidSubnetIDException&#34；}，{&#34；shape&#34；：&#34；InvalidSecurityGroupIDException&#34；}，{&#34；shape&#34；：&#34；InvalidZipFileException&#34；}，{&#34；shape&#34；：&#34；KMSDisabledException&#34；}，{&#34；shape&#34；：&#34；KMSInvalidStateException&#34；}，{&#34；shape&#34；：&#34；KMSAccessDeniedException&#34；}，{&#34；shape&#34；：&#34；KMSNotFoundException&#34；}，{&#34；shape&#34；：&#34；InvalidRuntimeException&#34；}]}。</p><p>上面的API需要一个“InvocationRequest”对象，并返回一个“InvocationResponse”对象。</p><p>&#34；InvocationRequest&#34；：{&#34；类型&#34；：&#34；结构&#34；，&#34；必填&#34；：[&#34；函数名&#34；]，&#34；成员&#34；：{&#34；函数名&#34；：{&#34；shape&#34；：&#34；NamespacedFunctionName&#34；，&#34；位置&#34；：&#34；URI&#34；，&#34；位置名&#34；：&#34；函数名&#34；}，&#34；激发类型&#34；：：&#34；形状&#34；：&#34；激发类型&#34；，&#34；位置&#34；：&#34；标题&#34；，&#34；locationName&#34；：&#34；X-Amz-Invocation-Type&#34；}，&#34；日志类型&#34；：{&#34；形状&#34；：&#34；日志类型&#34；，&#34；Location&#34；：&#34；Header&#34；，&#34；locationName&#34；：&#34；X-Amz-Log-Type&#34；}，&#34；ClientContext&#34；：{&#34；Shape&#34；：&#34；String&#34；，&#34；Location&#34；：&#34；Header&#34；，&#34；locationName&#34；：&#34；X-Amz-Client-Context&#34；}，&#34；Payload&#34；：{&#34；shape&#34；：&#34；Blob&#34；}，&#34；限定符&#34；：{&#34；形状&#34；：&#34；限定符&#34；，&#34；位置&#34；：&#34；查询字符串&#34；，&#34；位置名称&#34；：&#34；限定符&#34；}}，&#34；有效载荷&#34；：&#34；有效载荷&#34；}。</p><p>&#34；InvocationResponse&#34；：{&#34；Type&#34；：&#34；Structure&#34；，&#34；Members&#34；：{&#34；StatusCode&#34；：{&#34；Shape&#34；：&#34；Integer&#34；，&#34；Location&#34；：&#34；statusCode&#34；}，&#34；FunctionError&#34；：{。，&#34；位置&#34；：&#34；标题&#34；，&#34；locationName&#34；：&#34；X-Amz-Function-Error&#34；}，&#34；日志结果&#34；：{&#34；形状&#34；：&#34；字符串&#34；，&#34；位置&#34；：&#34；标题&#34；，&#34；locationName&#34；：&#34；X-Amz-Log-Result&#34；}，&#34；Payload&#34；：{&#34；shape&#34；：&#34；Blob&#34；}，&#34；ExecutedVersion&#34；：{&#34；Shape&#34；：&#34；Version&#34；，&#34；Location&#34；：&#34；Header&#34；，&#34；locationName&#34；：&#34；X-Amz-Executed-Version&#34；}}，&#34；Payload&#34；：&#34；Payload&#34；}，</p><p>PHP SDK会自动为每个请求和响应对象生成代码，如下所示：</p><p>$Result=$Client-&&gt;；Invoke(array(//FunctionName是必需的&#39；FunctionName&#39；=&&gt;；String&#39；，&#39；InvocationType&#39；=&&gt;；&#39；String&#39；，&#39；LogType&#39；=&&gt;；&#39；String&#39；，&#39；ClientContext&#39；=&gt；&#。&#39；混合类型：string|resource|\Guzzle\Http\EntityBodyInterface&#39；，&#39；限定符&#39；=&gt；&#39；字符串&#39；，))；</p><p>因此，对于这些服务更新，各个SDK团队根本不需要“手动”编写任何代码。服务团队(在本例中为AWS Lambda)只需确保他们创建的模型文件没有错误。SDK将能够自动生成对现有客户端的任何更新，以及为新的API和服务自动生成代码。</p><p>SDK团队最棒的部分是，IS是完全开源的，并且直接集成到各种AWS服务中。</p><p>API Gateway允许您部署Swagger(也称为OpenAPI标准)模型，然后使用API直接生成具有已内置到AWS SDK中的所有功能的SDK。</p><p>我希望这对为您的服务设计SDK有帮助。在任何SDK中，重点都应该放在创建符合“OpenApi”标准的模型文件上。有了API的标准模型，就可以用很少的开发时间启动各种语言的SDK，变得超级简单和快速。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://dailyjag.com/technology/how-to-build-a-scalable-sdk-the-right-way-learnings-from-aws-sdks/">https://dailyjag.com/technology/how-to-build-a-scalable-sdk-the-right-way-learnings-from-aws-sdks/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/sdk/">#sdk</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/scalable/">#scalable</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>