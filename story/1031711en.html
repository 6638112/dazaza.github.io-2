<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用新的压缩算法提高快照速度</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用新的压缩算法提高快照速度</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-28 13:45:47</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/944c649a872d5bcad506adefd9480ef9.jpg"><img src="http://img2.diglog.com/img/2020/10/944c649a872d5bcad506adefd9480ef9.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Security and performance are often mutually exclusive concepts. A great user experience is one that manages to blend the two in a way that does not compromise on robust, solid foundations of security on one hand, and a fast, responsive software interaction on the other.</p><p>安全性和性能通常是相互排斥的概念。出色的用户体验是设法将两者融合在一起，一方面不会损害强大而坚实的安全基础，另一方面又不会影响快速、响应迅速的软件交互。</p><p> Snaps are self-contained applications, with layered security, and as a result, sometimes, they may have reduced perceived performance compared to those same applications offered via traditional Linux packaging mechanisms. We are well aware of this phenomenon, and we have invested significant effort and time in resolving any speed gaps, while keeping security in mind. Last year, we talked about improved snap startup times following  fontconfig cache optimization. Now, we want to tell you about another major milestone – the use of a new compression algorithm for snaps  offers 2-3x improvement in application startup times!</p><p>快照是独立的应用程序，具有分层的安全性，因此，与那些通过传统Linux打包机制提供的相同应用程序相比，它们有时可能会降低感知到的性能。我们很清楚这一现象，我们已经投入了大量的精力和时间来解决任何速度差距，同时考虑到安全问题。去年，我们讨论了在进行fontconfig缓存优化后改进Snap启动时间。现在，我们想告诉您另一个重要里程碑-对快照使用新的压缩算法可将应用程序启动时间缩短2-3倍！</p><p>  By default, snaps are packaged as a compressed, read-only squashfs filesystem using the XZ algorithm. This results in a high level of compression but consequently requires more processing power to uncompress and expand the filesystem for use. On the desktops, users may perceive this as a “slowness” – the time it takes for the application to launch. This is also far more noticeable on first launch only, before the application data is cached in memory. Subsequent launches are fast and typically, there’s little to no difference compared to traditionally packaged applications.</p><p>默认情况下，使用XZ算法将快照打包为压缩的只读squashfs文件系统。这会导致较高的压缩级别，但因此需要更多的处理能力来解压缩和扩展文件系统以供使用。在桌面上，用户可能会认为这是一种“缓慢”，即应用程序启动所需的时间。仅在应用程序数据缓存在内存中之前的第一次启动时，这一点也更加明显。随后的启动速度很快，通常与传统打包的应用程序相比几乎没有什么不同。</p><p> To improve startup times, we decided to test a different algorithm – LZO – which offers lesser compression, but needs less processing power to complete the action.</p><p>为了缩短启动时间，我们决定测试一个不同的算法-LZO-它提供较小的压缩，但需要较少的处理能力来完成操作。</p><p> As a test case, we chose the Chromium browser (stable build, 85.X). We believe this is a highly representative case, for several reasons. One, the browser is a ubiquitous (and popular) application, with frequent usage, so any potential slowness is likely to be noticeable. Two, Chromium is a relatively large and complex application. Three, it is not part of any specific Linux desktop environment, which makes the testing independent and accurate.</p><p>作为测试用例，我们选择了Chromium浏览器(稳定版本，85.X)。我们认为这是一个极具代表性的案例，原因有几个。首先，浏览器是一个无处不在的(和流行的)应用程序，使用频率很高，所以任何潜在的缓慢都可能是显而易见的。第二，铬是一个相对大而复杂的应用。第三，它不属于任何特定的Linux桌面环境，这使得测试具有独立性和准确性。</p><p> For comparison, the XZ-compressed snap weighs ~150 MB, whereas the one using the LZO compression is ~250 MB in size.</p><p>相比之下，XZ压缩的快照重约150 MB，而使用LZO压缩的快照大小约为250 MB。</p><p>  We decided to conduct the testing on a range of systems (2015-2020 laptop models), including HDD, SSD and NVMe storage, Intel and Nvidia graphics, as well as several operating systems, including Kubuntu 18.04, Ubuntu 20.04 LTS, Ubuntu 20.10 (pre-release at the time of writing), and Fedora 32 Workstation (just before Fedora 33 release). We believe this offers a good mix of hardware and software, allowing us a broader understanding of our work.</p><p>我们决定在一系列系统(2015-2020年笔记本电脑型号)上进行测试，包括硬盘、固态硬盘和NVMe存储、英特尔和Nvidia显卡，以及几个操作系统，包括Kubuntu 18.04、Ubuntu 20.04 LTS、Ubuntu 20.10(撰写本文时的预发布版本)和Fedora 32 Workstation(就在Fedora 33发布之前)。我们相信，这提供了硬件和软件的良好组合，使我们能够更广泛地了解我们的工作。</p><p> System 1 with 4-core/8-thread Intel(R) i5(TM) processor, 16GB RAM, 500GB SSD, and Intel(R) UHD 620 graphics, running Kubuntu 18.04.</p><p>System 1配备4核/8线程英特尔®i5(TM)处理器、16 GB RAM、500 GB固态硬盘和英特尔®超高清620显卡，运行Kubuntu 18.04。</p><p> System 2 with 4-core Intel(R) i3(TM) processor, 4GB RAM, 1TB 5,400rpm mechanical hard disk, and Intel(R) HD 440 graphics, running Ubuntu 20.04 LTS.</p><p>System 2配备4核英特尔(R)i3(TM)处理器、4 GB RAM、1TB 5,400 rpm机械硬盘和英特尔(R)HD 440显卡，运行Ubuntu 20.04 LTS。</p><p> System 3 with 4-core Intel(R) i3(TM) processor, 4GB RAM, 1TB 5,400rpm mechanical hard disk, and Intel(R) HD 440 graphics, running Fedora 32 Workstation.</p><p>System 3配备4核英特尔(R)i3(TM)处理器、4 GB RAM、1TB 5,400 rpm机械硬盘和英特尔(R)HD 440显卡，运行Fedora 32工作站。</p><p> System 4 with 4-core/8-thread Intel(R) i7(TM) processor, 64GB RAM, 1TB NVMe hard disk, and Nvidia GM204M (GeForce GTX 980M), running Ubuntu 20.10.</p><p>System 4配备4核/8线程英特尔(R)i7(TM)处理器、64 GB RAM、1TB NVMe硬盘和运行Ubuntu 20.10的NVIDIA GM204M(GeForce GTX 980M)。</p><p>  On each of the selected systems, we examined the time it takes to launch and display the browser window for:</p><p>在每个选定的系统上，我们检查了启动和显示以下各项的浏览器窗口所需的时间：</p><p>     We measured the startup time for the Chromium browser with a new, unused profile. Please note that these results are highly indicative, but there is always a degree of variance in interactive usage measurements, which can result from things like your overall system state, the current system load due to other, background activities, disk usage, your browser profile and add-ons, and other factors.</p><p>我们用一个新的、未使用的配置文件测量了Chromium浏览器的启动时间。请注意，这些结果具有很强的指示性，但是交互式使用情况测量总是存在一定程度的差异，这可能是由您的整体系统状态、其他后台活动导致的当前系统负载、磁盘使用情况、您的浏览器配置文件和附加组件以及其他因素造成的。</p><p>  The results in the table are average values over multiple runs. The standard deviation is ~0.7 seconds for the cold startups, and ~0.1 seconds for the hot startups.</p><p>表中的结果是多次运行的平均值。冷启动的标准偏差为~0.7秒，热启动的标准偏差为~0.1秒。</p><p> The use of the LZO compression  offers 40-74% cold startup improvements over the XZ compression.</p><p>与XZ压缩相比，使用LZO压缩可提供40-74%的冷启动改进。</p><p> On the Kubuntu 18.04 system, which still has Chromium available as a DEB package, the LZO-compressed snap now offers  near-identical startup performance!</p><p>在Kubuntu18.04系统上，仍然以DEB包的形式提供Chromium，LZO压缩的Snap现在提供几乎相同的启动性能！</p><p> On Fedora 32 Workstation, the  LZO-compressed snap cold startup is faster than the RPM package by a rather respectable  33% (actual ~5.0 seconds difference).</p><p>在Fedora32工作站上，LZO压缩的Snap冷启动比RPM包快33%(实际相差约5.0秒)。</p><p>  You may be interested in profiling the startup time of your browser – or any application for that matter. To that end, we’ve compiled a script, which you can  download (link to a GitHub Gist), make the file executable, and run on your system. The script allows you to compare the startup time of any native-packaged software with snaps, and is designed to work with any package manager, so you can use this on Ubuntu, Fedora, openSUSE, Manjaro, etc.</p><p>您可能对分析浏览器或任何应用程序的启动时间感兴趣。为此，我们编译了一个脚本，您可以下载该脚本(链接到GitHub Gist)，使该文件成为可执行文件，然后在您的系统上运行。该脚本允许您将任何本地打包软件的启动时间与Snap进行比较，并且可以与任何包管理器一起使用，因此您可以在Ubuntu、Fedora、openSUSE、Manjaro等上使用此脚本。</p><p> To prevent any potential data loss, the functions are commented out in the main section of the script, so you will need to uncomment them manually before the script does anything.</p><p>为了防止任何潜在的数据丢失，这些函数在脚本的主要部分被注释掉，因此您需要在脚本执行任何操作之前手动取消对它们的注释。</p><p>  We are happy with the improvements that the LZO compression introduces, as it allows users to have a faster, more streamlined experience with their snaps. We can now examine the optimal way to introduce and roll out similar changes with other snaps.</p><p>我们对LZO压缩带来的改进感到高兴，因为它允许用户获得更快、更流畅的快照体验。现在，我们可以研究通过其他快照引入和推出类似更改的最佳方式。</p><p> And this is by no means the end of the journey! Far from it. We are working on a whole range of additional improvements and optimizations. When it comes to size, you can use content snaps and stage snaps to reduce the side of your snaps, as well as utilize snapcraft extensions. We’re also working on a fresh set of font cache fixes, and there’s a rather compelling story on this topic, as well, which we will share soon. In the near future, we intend to publish a guide that helps developers trim down their snaps and reduce their overall size, all of which can help create leaner, faster applications.</p><p>这绝不是旅程的终点！差得远呢。我们正在进行一系列额外的改进和优化。在大小方面，您可以使用内容快照和阶段快照来减小快照的侧面，还可以利用Snapcraft扩展。我们还在致力于一组新的字体缓存修复，在这个主题上也有一个相当引人注目的故事，我们很快就会分享它。在不久的将来，我们打算发布一个指南，帮助开发人员削减快照和减小总体大小，所有这些都可以帮助创建更精简、更快的应用程序。</p><p> If you have any comments or suggestions on this topic, we’d like to  hear them. You can tell us about your own findings on snap startup performance, and point us to any glaring issues or problems you believe should be addressed, including any specific snaps you think should be profiled and optimized. We are constantly working on improving the user experience, and we take note of any feedback you may have. Meanwhile, enjoy your snappier browsing!</p><p>如果您对这个话题有什么意见或建议，我们很乐意听取。您可以告诉我们您自己对Snap启动性能的调查结果，并指出您认为应该解决的任何突出问题或问题，包括您认为应该分析和优化的任何特定快照。我们一直致力于改善用户体验，并注意您可能得到的任何反馈。同时，享受您更快的浏览吧！</p><p>  Learn how the Ubuntu desktop operating system powers millions of PCs and laptops around the world.</p><p>了解Ubuntu桌面操作系统如何支持全球数百万台PC和笔记本电脑。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://ubuntu.com//blog/snap-speed-improvements-with-new-compression-algorithm">https://ubuntu.com//blog/snap-speed-improvements-with-new-compression-algorithm</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/算法/">#算法</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/提高/">#提高</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/speed/">#speed</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1030258.html"><img src="http://img2.diglog.com/img/2020/10/thumb_18b6543ca958addeb58b9457547435ea.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030258.html">揭开共识算法的神秘面纱及其实现</a></div><span class="my_story_list_date">2020-10-21 14:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029873.html"><img src="http://img2.diglog.com/img/2020/10/thumb_5edc25cfdff6110cfb5a250368f8e1c0.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029873.html">Quantopian--一个定量金融算法工具箱</a></div><span class="my_story_list_date">2020-10-20 2:23</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029675.html"><img src="http://img2.diglog.com/img/2020/10/thumb_ecc9d9527948101d4aea4b96b256094d.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029675.html">一种新的人工智能算法快速准确地预测材料性能</a></div><span class="my_story_list_date">2020-10-19 6:31</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029653.html"><img src="http://img2.diglog.com/img/2020/10/thumb_f6147cc989cdb4ae0205fc85e0d093b9.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029653.html">人类决策的计算机科学</a></div><span class="my_story_list_date">2020-10-19 3:15</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>