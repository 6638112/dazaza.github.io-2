<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我们的软件依赖问题</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">我们的软件依赖问题</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-20 23:54:40</div><div class="page_narrow text-break page_content"><p>许多开发人员从未查看过代码的转移依赖的完整列表，也不知道它们依赖于什么。例如，2016年3月，NPM用户社区发现，许多流行的项目-包括Babel、Ember和Reaction-都直接依赖于一个名为Left-Pad的小程序包，该程序包只有一个8行的函数体。当Left-Pad的作者从NPM中删除该程序包时，他们发现了这一点，无意中破坏了大多数Node.js用户的构建。在这方面，Left-Pad也不例外。例如，在NPM上发布的750,000个包中，有30%依赖于-至少间接地-依赖于转义字符串-regexp.根据Leslie Lamport关于分布式系统的观察，依赖项管理器很容易造成这样一种情况，在这种情况下，您甚至不知道存在的包的故障可能会导致您自己的代码不可用。检查过程应该包括运行包自己的测试。如果包通过了检查，并且您决定使您的项目依赖于它，则下一步应该是编写新的测试，重点放在应用程序所需的功能上。这些测试通常从简短的独立程序开始编写，以确保您可以理解包的API，并确保它能完成您认为的功能。(如果您不能理解，或者它不能做到，现在就回头吧！)然后花额外的努力将这些程序转变为可以实现的自动化测试是值得的。您将希望能够以可测试的方式重新运行这些特定于项目的代码，以确保修复不会破坏任何其他内容。对于代码搜索，我们从过去的经验中了解到，PCRE有时要花很长时间来执行某些正则表达式搜索。我们最初的计划是使用单独的线程池进行“简单”和“复杂”的正则表达式搜索。我们运行的第一个测试之一是基准测试，将cregrep与其他几个grep实现进行比较。当我们发现，对于一个基本测试用例，pcregrep比最快的grep慢70倍。根据程序包的不同，您可能会在以后重新访问。可能更新会将程序包带向新的方向。可能会发现严重的安全问题。可能会出现更好的选择。由于所有这些原因，使您的项目轻松迁移到新的依赖项是值得的。如果将从项目源代码中的许多位置使用包，则迁移到新依赖项将需要对所有这些不同的源位置进行更改。更糟糕的是，如果包将在您自己的项目API中公开，迁移到新依赖项将需要在调用API的所有代码中进行更改，这可能无法控制。要避免这些成本，定义您自己的接口以及使用依赖项实现该接口的薄包装器是有意义的。请注意，包装器应该只包含什么内容。通过只更改包装器，迁移每个项目的测试以使用新的接口，可以测试接口和包装器实现，还可以轻松地测试依赖项的任何潜在替换。对于代码搜索，我们开发了一个抽象的Regexp类，它定义了任何正则表达式引擎所需的接口代码搜索。然后，我们围绕实现该接口的PCRE编写了一个薄包装器。这种间接性使得测试备用库变得很容易，并防止我们意外地将PCRE内部的知识引入源代码树的其余部分。这反过来又确保了在需要时可以很容易地切换到不同的依赖项。在运行时隔离依赖项也可能是合适的，以限制它中的错误可能造成的损害。例如，Google Chrome允许用户向浏览器添加依赖项-扩展代码。当Chrome在2008年发布时，它引入了关键功能(现在在所有浏览器中都是标准功能)，将每个扩展隔离在运行在独立操作系统进程中的沙箱中。15因此，编写糟糕的扩展中的可利用错误不会自动访问浏览器本身的整个内存，并且可以阻止其进行不适当的系统调用。16对于代码搜索，在完全放弃PCRE之前，我们的计划是在类似的沙箱中至少隔离PCRE解析器。现在，另一个选择是基于轻量级虚拟机管理程序的类似沙箱的gVisor。17隔离依赖项可以降低运行该代码的相关风险。即使有了这些示例和其他现成的选项，可疑代码的运行时隔离仍然太困难，而且很少做到。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://research.swtch.com/deps">https://research.swtch.com/deps</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/依赖/">#依赖</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/测试/">#测试</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1012939.html"><img src="http://img.diglog.com/img/2020/7/thumb_e113636a761397328865bd16daeb89ae.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012939.html">TeamViewer已同意以1.365亿欧元收购制造AR软件和可穿戴计算设备的Ubimax</a></div><span class="my_story_list_date">2020-7-20 5:59</span></div><div class="col-sm"><div><a target="_blank" href="/story/1012910.html"><img src="http://img.diglog.com/img/2020/7/thumb_f26326c01bdd6e84d42ce1c5220bad84.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012910.html">消息人士说，将通用电气重塑为软件巨头的计划因员工困惑和对如何重新定位公司的错觉而受挫</a></div><span class="my_story_list_date">2020-7-20 1:18</span></div><div class="col-sm"><div><a target="_blank" href="/story/1012718.html"><img src="http://img.diglog.com/img/2020/7/thumb_28ed6573f62119e8b8c7aac25304321e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012718.html">
投资于隐藏的一代</a></div><span class="my_story_list_date">2020-7-18 21:28</span></div><div class="col-sm"><div><a target="_blank" href="/story/1012676.html"><img src="http://img.diglog.com/img/2020/7/thumb_4ee844781b75302a6976336271b3e8af.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012676.html">Unix哲学是如何给我们带来“Web应用程序”而不是“软件”的</a></div><span class="my_story_list_date">2020-7-18 9:28</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>