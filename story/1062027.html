<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>fragattacks：影响Wi-Fi设备的新安全漏洞 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">fragattacks：影响Wi-Fi设备的新安全漏洞 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-05-12 03:58:24</div><div class="page_narrow text-break page_content"><p>2021年5月11日 - 本网站介绍了FragAttacks（碎片和聚合攻击），它是影响Wi-Fi设备的新安全漏洞的集合。在受害者的无线电范围内的对手可以滥用这些漏洞来窃取用户信息或攻击设备。其中三个发现的漏洞是Wi-Fi标准中的设计缺陷，因此影响大多数设备。在此之上，发现了几种其他漏洞，这是由Wi-Fi产品中广泛的编程错误引起的。实验表明，每个Wi-Fi产品受到至少一个漏洞的影响，大多数产品受到几种漏洞的影响。</p><p>  发现的漏洞影响了Wi-Fi的所有现代安全协议，包括最新的WPA3规范。即使是Wi-Fi的原始安全协议，称为WEP，也受到影响。这意味着自1997年发布以来的几个新发现的设计缺陷是Wi-Fi的一部分！幸运的是，设计缺陷很难滥用，因为这样做需要用户交互，或者只有在使用罕见的网络设置时才可能。因此，在实践中，最重要的是Wi-Fi产品中的编程错误，因为其中几个是微不足道的。</p><p>  这些漏洞的发现是一个惊喜，因为Wi-Fi的安全性实际上在过去几年中显着提高。例如，以前我们发现了克拉克攻击，验证了对Krack的防御安全，最新的WPA3安全规范已经提高。遗憾的是，在实践中没有采用可以防止新发现的设计缺陷之一的特征，并且其他两个设计缺陷存在于先前未被广泛研究的Wi-Fi的特征中。这表明甚至可以分析最着名的安全协议（如果您想帮助，我们正在招聘）。此外，它表明它＆＃39;对于定期测试Wi-Fi产品的安全漏洞，这可以在证明它们时完成。</p><p>  为了保护用户，在一个由Wi-Fi联盟和ICASI监督的9个月长期的协调披露中编写了安全更新。如果您的设备更新尚不可用，则可以通过确保网站使用HTTP来缓解一些攻击（但并非所有），并确保您的设备已收到所有其他可用更新。</p><p>     以下视频显示了三个例子，有关对手如何滥用漏洞。首先，滥用聚合设计缺陷以拦截敏感信息（例如，受害者＆＃39; s用户名和密码）。其次，它＆＃39; s显示了对手如何通过远程打开和关闭智能电源插座来利用不安全的互联网设备。最后，它＆＃39;展示了漏洞如何被滥用为踏脚石，以推出高级攻击。特别是，该视频展示了对手如何在本地网络内接管过时的Windows 7机器。</p><p>    随着演示所示，Wi-Fi可以用两种方式滥用。首先，在正确的条件下，它们可以滥用来窃取敏感数据。其次，对手可以滥用Wi-Fi缺陷攻击某人的设备。</p><p>  实践中最大的风险可能是滥用所发现的缺陷来攻击某人的攻击设备。例如，很少更新许多智能家庭和互联网的设备，而Wi-Fi安全性是防止某人攻击这些设备的最后一系列防护。不幸的是，由于发现漏洞，现在可以绕过最后一系列防守。在上面的演示中，通过远程控制智能电源插头并通过接管过时的Windows 7机器来说明这一点。 </p><p>Wi-Fi缺陷也可以滥用以抵消传输的数据。演示显示如何在使用NYU网站时滥用在受害者的用户名和密码。但是，当网站正确配置为始终使用HTTPS作为额外的安全性时，现在接近20％的网站是，传输的数据不能被盗。此外，若干浏览器现在警告用户未使用HTTPS时警告用户。最后，虽然并不总是完美的，但默认情况下最近的移动应用程序使用HTTPS，因此也使用此额外的保护。</p><p>       可以滥用若干实施缺陷以将帧轻松注入受保护的Wi-Fi网络。特别地，对手通常可以通过仔细构造该框架来注入未加密的Wi-Fi框架。这可以例如被滥用来拦截客户端＆＃39; s流量，通过欺骗客户端使用恶意DNS服务器，如演示中所示（截取的流量可能具有另一层保护）。对路由器来说，这也可以滥用来绕过NAT /防火墙，允许对攻击者攻击本地Wi-Fi网络（例如，攻击过时的Windows 7计算机，如演示中所示）。</p><p>  对手们如何构建未加密的Wi-Fi框架，以便它们被漏洞设备接受？首先，即使连接到受保护的Wi-Fi网络，某些Wi-Fi设备也接受任何未加密的框架。这意味着攻击者并不需要做任何特别的事情！四个测试的家庭路由器中的两个受到这种漏洞的影响，几种物质设备受到影响，有些智能手机受到影响。此外，在窗口上的许多Wi-Fi加密度将在分成几个（明文）片段时错误地接受明文帧。</p><p>  此外，某些设备可接受看起来像握手消息的明文聚合帧。对手可以通过发送汇总帧来利用这一点，其开始类似于握手消息，其第二子帧包含对手想要注入的数据包。一个易受攻击的设备将首先将该帧作为握手消息解释，但随后将作为聚合帧处理它。从某种意义上说，代码的一部分将认为框架是握手消息，即使它没有加密，也会接受它。代码的另一部分将将其视为聚合帧，并将处理对手想要注入的数据包。</p><p>    最后，几个设备将广播片段作为正常的未经用的帧进行了进程。更有问题，一些设备即使在发送未加密时也接受广播片段。攻击者可以通过将其封装在明文广播帧的第二片段中来滥用该数据包。</p><p>    第一设计缺陷位于Wi-Fi的帧聚合特征中。该特征通过将小帧组合成更大的聚合帧来提高网络的速度和吞吐量。为了实现此功能，每个帧的标题包含一个标志，该标志指示（加密）传输的数据是否包含单个或聚合帧。这在下图中说明：</p><p>    不幸的是，这个＆＃34;是汇总的＆＃34;标志未经身份验证，可以通过对手修改，这意味着受害者可以以意外的方式处理加密的传输数据。对手可以滥用这一点来通过欺骗受害者连接到他们的服务器然后设置＆＃34;聚合＆＃34;精心挑选的包的旗帜。实际上所有测试的设备都容易受到这种攻击的影响。注入数据包的能力依次滥用来拦截受害者的流量，使其使用恶意DNS服务器（请参阅演示）。 </p><p>这种设计缺陷可以通过验证＆＃34来修复;聚合＆＃34;旗帜。 Wi-Fi标准已包含一个要验证此标志的功能，即需要SPP A-MSDU帧，但这种防御不会向后兼容，并且在实践中不受支持。也可以使用ad-hoc修复来缓解攻击，但新的攻击可能仍然可能。</p><p>    第二种设计缺陷位于Wi-Fi的框架碎片特征中。通过将大帧分成较小的片段，此功能会增加连接的可靠性。执行此操作时，属于同一帧的每个片段都使用相同的密钥加密。但是，接收器不需要检查此问题，并将重新组装使用不同键解密的片段。在稀有条件下，这可以滥用以抵抗数据。这是通过混合在不同键下加密的片段来实现的，如下图所示：</p><p>    在上图中，使用与第二片段不同的键解密第一片段。尽管如此，受害者将重新组装两个碎片。在实践中，这允许对抗手进行灭绝选择的客户数据。</p><p>  该设计缺陷可以通过仅重新组装使用相同键解析的片段以向后兼容的方式固定。因为攻击只是在罕见条件下可能被认为是一个理论攻击。</p><p>    第三种设计缺陷也在Wi-Fi＆＃39; s框架碎片特征中。问题是，当客户端断开从网络的连接时，Wi-Fi设备不需要从内存中删除非重新组装的片段。这可以滥用eDUROAM和GOVORAM等热点的网络以及用户互相不信任的企业网络。在这些情况下，可以将受害者发送的所选数据被灭绝。这是通过在接入点的存储器（即片段高速缓存）中注入恶意片段来实现的。当受害者然后连接到接入点并发送碎片帧时，选择所选片段（即重新组装）与对手的注入片段组合（即重新组装）。这在下图中说明：</p><p>    在上图中，对手将第一片段注入接入点的片段高速缓存中。在对手断开连接之后，片段停留在片段缓存中，并将重新组装有受害者的片段。如果受害者发送碎片帧，则在实践中似乎罕见，如果可以滥用这种情况以抵消数据。</p><p>  每当断开连接或（重新）连接到网络时，该设计漏洞可以通过从存储器中移除片段来以向后兼容的方式固定。 </p><p>即使发件人尚未认证，某些路由器也会将握手帧转发到另一个客户端。此漏洞允许对致力的攻击性执行聚合攻击，并在没有用户交互的情况下注入任意帧。</p><p>  另一个极其常见的实现缺陷是接收器不检查所有片段是否属于同一帧，这意味着通过混合两个不同帧的碎片来实现对手来施加框架。</p><p>    最后，一些设备不支持碎片或聚合，但仍然容易受到攻击，因为它们将碎片帧作为全帧进行分散框架。在适当的情况下，这可以滥用来注入数据包。</p><p>     可以在GitHub上找到所有分配的常见漏洞和曝光（CVE）标识符的概述。在撰写本文时，ICASI具有简洁的概述，其中包含对供应商的附加信息的引用（下面的CVE链接可能只在几天后变为活动状态）。总结，设计缺陷被分配了以下CVES：</p><p>    允许在受保护的Wi-Fi网络中允许琐碎的明文帧的实现漏洞被分配了以下CVES：</p><p>  CVE-2020-26144：接受以EtherType EAPOL（在加密网络中的RFC1042标题开头的明文A-MSDU帧。</p><p>    CVE-2020-26139：即使发件人尚未经过身份验证（仅限APS），即使发件人也要转发EAPOL帧。 </p><p>对于每个实现漏洞，我们列出了引用CVE标识符。虽然每个受影响的CodeBase通常接收一个独特的CVE，但共识是在不同的Codebases上使用相同的CVE会使通信更容易。例如，通过将一个CVE绑定到每个漏洞，客户现在可以询问供应商他们的产品是否受特定CVE的影响。为每个码布使用唯一的CVE会使这些问题复杂化并引起混淆。</p><p>     我们的攻击纸张标题为片段和伪造：通过帧聚集和碎片破坏Wi-Fi，并将在Usenix Security呈现。您可以使用以下Bibtex条目引用我们的论文：</p><p>  @inproceings {vanhoef-usenix2021-fragattacks，作者= {mathy vanhoef}，title = {碎片和伪造：通过帧聚合和碎片破坏{wi-fi}，booktitle = {30th {usenix}安全研讨会}，年= {2021}，月= {八月}，Publisher = {{usenix}协会}}</p><p>    为Usenix安全性的预先录制的演示可以在线查看。请注意，此演示文稿的目标受众是学者和IT专业人士：</p><p>      所有攻击及其先决条件的概述。它还包含有关对手的两个额外示例：（1）滥用数据包注射漏洞，使受害者使用恶意DNS; （2）如何滥用数据包注入来绕过路由器的NAT /防火墙。</p><p>  幻灯片说明聚合攻击（CVE-2020-24588）如何在实践中工作。执行此次攻击需要将受害者欺骗到与对手的服务器连接到。这可以通过使受害者从敌人的服务器下载图像来完成。请注意，不需要对受害者的JavaScript代码执行。</p><p>     提出了一种工具，可以测试客户或AP是否受到发现的设计和实现缺陷的影响。它可以测试家庭网络和企业网络，其中使用，例如，PEAP-MSCHAPv2或EAP-TLS进行身份验证。该工具支持超过45个测试用例，并且需要修改的驱动程序，以便可靠地测试发现的漏洞。没有修改的驱动程序，一个人错误地得出结论，在现实中，设备不受影响。 </p><p>实时USB图像也可用。此图像包含预安装的修改驱动程序，某些Attheros USB Dongles的修改固件以及用于该工具的预先配置的Python环境。当您当然无法安装修改后的驱动程序（使用虚拟机对于某些网卡可能不可靠时，使用实时图像很有用。</p><p>  除了用于测试设备是否易受攻击的工具之外，我也提出了概念证明以利用缺点。因为并非所有设备当前已接收更新，因此如果认为有用，则将在稍后的点释放这些攻击脚本。</p><p>             是的！ Mathy Vanhoef将于今年晚些时候以Ku Leuven University（比利时）开始作为教授，正在寻找博士生。可以讨论您要上工作的精确主题。如果你＆＃39; ku leuven的主学生，您也可以联系我讨论主题＆＃39;他们的论文主题。请注意，KU Leuven的分类群体也在招聘与安全相关的研究领域。</p><p>  如果您想在Cyber​​ Security＆amp的纽约大学Abu Dhabi进行网络研究。隐私（CSP）团队进行了碎片研究的研究，您可以联系ChristinaPöpper。</p><p>    是的，您可以使用徽标，汇聚设计漏洞（移动版）的插图，混合密钥设计漏洞（移动版）的插图，以及片段缓存设计漏洞（移动版）的插图。</p><p>  谢谢去Darlee Urbiztondo设计徽标。您可以在此处找到更多她的令人敬畏的图形。</p><p>    当2007年撰写的802.11n修正案时，它介绍了汇总（A-MSDU）框架的支持，一些IEEE成员注意到＆＃34;是聚合的＆＃34;标志未被验证。不幸的是，许多产品已经实施了802.11N修正案的草案，这意味着该问题必须以向后兼容的方式解决。该决定是指示设备是否能够宣传它们是否能够验证＆＃34;是汇总的＆＃34;旗帜。只有当设备实现和宣传此功能时，＆＃34;是否被聚合＆＃34;国旗受保护。遗憾的是，在2020年，没有一个测试设备支持这种能力，可能是因为它被认为是难以利用的。引用2007年举行的言论：＆＃34;虽然很难看出如何利用这一点，但显然是一个能够修复的缺陷。＆＃34; </p><p>换句话说，人们确实注意到这种漏洞和防守是标准化的，但在实践中，防守从未被采用过。这是一个很好的例子，在攻击变得实用之前必须采用安全防御。</p><p>    可能因为它仅被认为是辩护时的理论脆弱性。引用2007年举行的言论：＆＃34;虽然很难看出如何利用这一点，但显然是一个能够修复的缺陷。＆＃34;</p><p>  此外，在聚集攻击中使用的威胁模型是受害者被诱导连接到对手和＃39; S服务器，只在野兽攻击披露后在2011年被广泛接受。换句话说，当IEEE添加了可防止攻击的可选功能时，2007年尚未众所周知威胁模型。甚至在这种威胁模型变得更加常见之后，所产生的攻击是明显的。</p><p>    首先，它总是很高兴记住一般安全最佳实践：更新您的设备，不要重用您的密码，确保您有重要数据的备份，Don＆＃39; T访问Shady网站，等等。</p><p>   关于发现的Wi-Fi漏洞，您可以通过仔细检查您访问的网站使用HTTPS来缓解攻击攻击敏感数据。甚至更好，您可以安装HTTPS Aplywhere插件。此插件迫使HTTPS在已知支持它的网站上的使用。</p><p>  减轻路由器和＃39;绕过的攻击和设备直接攻击的攻击，您必须确保更新所有设备。不幸的是，并非所有产品都定期接收更新，特别是智能或内互联网设备，在这种情况下，困难（如果不是不可能的）才能正确保护它们。</p><p>  在技​​术上，通过手动配置DNS服务器，也可以减少攻击的影响，以便无法中毒。具体到您的Wi-Fi配置，您可以通过禁用碎片，禁用成对reKeys和禁用Wi-Fi 6（802.11AX）设备中的动态碎片来缓解攻击（但未完全阻止它们）。 </p><p>这些天很多网站和应用程序都使用HTTP来加密数据。使用HTTPS时，即使在连接到打开的Wi-Fi网络时也无法看到对攻击性的数据。这也意味着您可以安全地使用Open Wi-Fi热点，只要您保持最新的设备，只要您确保网站正在使用HTTPS即可。不幸的是，并非所有网站都需要使用HTTPS（即，它们＆＃39;重复使用HSTS），这意味着它们仍然容易受到可能的攻击。</p><p>  在家里，您的Wi-Fi网络的安全性也是必不可少的。不安全的网络意味着其他人可能能够通过您的家连接到互联网。此外，越来越多的设备正在使用Wi-Fi在本地网络中传输个人文件，而无需额外的保护层（例如，在打印文件时，将文件发送到本地备份存储时，数码照片站）上）。更有问题的是，很多互联网的东西设备都有大量的安全漏洞，如果对手可以与他们沟通，可以利用。阻止来自exp的主体的主要件事</p><p>...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.fragattacks.com/">https://www.fragattacks.com/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/影响/">#影响</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/security/">#security</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/攻击/">#攻击</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1061489.html"><img src="http://img2.diglog.com/img/2021/5/thumb_0325bef6b81f8196fde2fbc1cdd0f7bf.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1061489.html">“幽灵枪”漏洞给美国司法部门提出了“枪支”的新定义 </a></div><span class="my_story_list_date">2021-5-9 4:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1061322.html"><img src="http://img2.diglog.com/img/2021/5/thumb_064b046923a90b767d9d0690379286b2.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1061322.html">超过十亿的Android设备有数据被盗的风险 </a></div><span class="my_story_list_date">2021-5-8 0:17</span></div><div class="col-sm"><div><a target="_blank" href="/story/1060938.html"><img src="http://img2.diglog.com/img/2021/5/thumb_89be7b15025fd68a195695fc3d741936.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1060938.html">发现和修复了Dell固件更新驱动程序中的严重漏洞 </a></div><span class="my_story_list_date">2021-5-6 8:25</span></div><div class="col-sm"><div><a target="_blank" href="/story/1060681.html"><img src="http://img2.diglog.com/img/2021/5/thumb_dc34a70d7b91c8bec0c299cb202e31c3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1060681.html">Peloton的漏洞API让任何人抓住骑手的私人帐户数据 </a></div><span class="my_story_list_date">2021-5-5 21:35</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>