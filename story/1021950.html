<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用Vim进行C++开发</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用Vim进行C++开发</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-04 00:17:51</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/b5d0f1167a86fdbbb8945644fc4c54f6.png"><img src="http://img2.diglog.com/img/2020/9/b5d0f1167a86fdbbb8945644fc4c54f6.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>我想分享一下我是如何使用Vim作为C++开发环境的，添加了代码完成、linting、格式化、代码段等功能。如果你来自IDE领域，并且已经在GUI上用复选框设置了选项，那么你可能需要转向使用基于文本的配置工具，比如Vim。</p><p>已经有插件可以为Vim提供类似IDE的功能。它们中的一些是成功的，一些是进化的，而另一些则是不受欢迎的。我试过像YouCompleteMe这样的插件，它们很棒，但让它们工作的过程并不是一种愉快的体验。</p><p>创建一个完成引擎诚然很难，在不触及实现细节的情况下移植那些代码给其他编辑器几乎是不可能的。</p><p>语言服务器协议就是为解决这一问题而开发的。其想法是，创建一组规则并实现遵循规则的服务器和客户端，然后通过协议进行通信，并提供自动完成、转到定义、搜索函数调用、诊断等功能。</p><p>LSP创造了降低m-x-n复杂性问题的机会，即在任何编辑器、IDE或客户端端点中提供对任何编程语言的高级别支持，从而解决更简单的m-+-n问题。</p><p>服务器需要安装在主机系统上，客户端需要由编辑器提供，可以是插件，也可以是内置的。在Vim中，它必须是一个插件，NeoVim有一个实验支持。有些IDE，比如克利安，都是从包裹里运出来的.。是有代价的。</p><p>有两个正在积极开发的C++语言服务器：clangd和ccl.这两个都很棒。我发现clangd更容易安装。这里提供了预编译的二进制文件。APT软件包也可在https://apt.llvm.org.上获得。在我新安装的Debian10上，我只使用：</p><p>Apt-add-repository&#39；deb http://apt.llvm.org/buster/llvm-toolchain-buster-11 main&#39；wget-O-https://apt.llvm.org/llvm-snapshot.gpg.key|sudo apt-key add-apt-get updateapt-get install-qq clang-11 clang-tools-11 clang-11-doc libclang-common-11-dev\libclang-11-dev libclang1-11 clang-format-11 clangd-11 clang-tidy-11</p><p>..。仅此而已。现在，除了clangd，我还有最新稳定的C++编译器、标准库实现(我可以享受添加到语言中的最新功能)、Linter和代码格式化程序。我们拿到服务器了，那客户端呢？</p><p>要使用clangd，我们需要一个语言客户端。有多种实现可用，我将使用co.nvim。用TypeScript编写的IT需要Node.js运行时：</p><p>要以简单的方式添加oc.nvim和其他插件，需要一个插件管理器。同样，有多种选项可供选择，我将使用vim-Plug：</p><p>对于&#39；：[&#39；zig&#39；，&#39；cmake&#39；，&#39；rust&#39；，\&#39；java&#39；，&#39；json&#39；，&#39；json&#39；，&#39；json&#39；，{&#39；cmake&#39；，\&#39；java&#39；，&#39；json&#39；，&#39；json&#39；，{&#39；cmake&#39；，&#39；rust&#39；，\&#39；java&#39；，&#39；json&#39；，{&#39；{&#39；}嘘&#39；，&#39；cs&#39；，\&#39；YAML&#39；，&#39；c&#39；，&#39；cpp&#39；，&#39；d&#39；，&#39；go&#39；，\&#39；python&#39；，&#39；Dart&#39；，&#39；javascript&#39；，&#39；vim&#39；]，&#39；分支&##。Release&#39；}调用Plug#End()。</p><p>这是我的.vimrc文件中的内容。插件作为Plug&#39；Github_URI_PATH&#39；列出在Plug#Begin和Plug#End之间。它允许插件使用特定的文件类型工作，该文件类型列在for之后。我不需要也不希望此插件支持其他文件类型，如.txt、.md等。</p><p>：PlugInstall将安装并：PlugUpdate更新插件。一个常见的仪式在振动器之间，一旦安装了插件，就会阅读它的文档。通常通过：help pluginName提供。</p><p>Nvim将服务器配置保存在一个名为coc-settings.json的JSON文件中(带有：CocConfig)。您几乎可以自定义服务器的所有行为方式。请从此处查看完整方案。目前，我将只注册语言服务器，并将其他语言服务器保留为默认设置：</p><p>{&#34；语言服务器&#34；：{&#34；clangd&#34；：{&#34；command&#34；：&#34；clangd&#34；，&#34；filetypes&#34；：[&#34；c&#34；，&#34；cpp&#34；]，&#34；rootPatterns&#34；：[&#34；Compile_Commands.json&#34；，&#。Args&#34；：[&#34；--COMPILE-COMMANDS-DIR=BUILD&#34；，&#34；--COMPILE_ARGS_FROM=文件系统&#34；，&#34；--所有作用域-完成&#34；，&#34；--后台索引&#34；，&#34；--clang-tidy&#34；，&#34；--完成-解析=始终&#34；，&#34；--完成-。--跨文件重命名&#34；，&#34；--函数-参数占位符&#34；，&#34；--标题插入-装饰符&#34；，&#34；--查询-驱动程序=/usr/bin/**/clang-*，/home/adm/GCC-10/bin/g++*&34；，&#34；--标题插入=从不&#34；，&#34；-交叉文件---Limit-Results=0&#34；，&#34；-j=6&#34；，&#34；--pch-storage=内存&#34；，]}}</p><p>这将使用args数组中列出的参数调用clangd。使用clangd--help查看clangd的所有选项。</p><p>您可以向LanguagesServer对象添加任意数量的服务器，这样您就可以在同一编辑器上对不同的语言拥有相同的编辑体验、映射、主题等：</p><p>{&#34；languagesserver&#34；：{&#34；clangd&#34；：{//clangd options}，&#34；rls&#34；{//rls options}，&#34；bash-lsp&#34；{//bash-lsp options}。</p><p>对于映射(Vim中用于可重新分配的快捷方式的术语)，从examplecConfiguration开始。如果您想看一下，这个白痴在Github上保存他的配置。</p><p>仪式的最后一部分涉及到使用CMake。我们需要做的就是在toplevel CMakeLists.txt上添加一个单行定义：</p><p>这将在构建目录上生成一个名为Compile_Commands.jsonon的文件。它包含包含路径、编译器命令和选项，这些可以帮助clangd找出什么是位置。</p><p>如果项目不使用CMake，而使用make，您可以使用Bear生成带有Bear Makecmand的文件。</p><p>整齐的皮棉工具可以通过叮当作响。Linter是一种工具，它可以说出代码中可疑的部分。确保在coc-setting.json文件上传递--clang-tiy arg to clangd。</p><p>Clangd将检测到此文件，并根据某些条件嵌入您的代码。查看所有检查：clang-tidy--list-checkks。</p><p>人们使用Aspell和其他一些工具来格式化他们的代码，作为一个千禧一代，我第一次遇到这样的工具是在clang-format。它相当容易使用：</p><p>片断是一种被低估的帮助者。它们减少了重复性、不费吹灰之力的工作。安装co.nvim代码段扩展名：：CocInstall coc-snippits。</p><p>其中每个|都在等待打字。编写这样的代码片段相当容易。就像在VSCode中一样，它的JSON文件：</p><p>{&#34；cmake&#34；：{&#34；prefix&#34；：[&#34；cmake&#34；]，&#34；正文&#34；：[&#34；cmake_Minimum_Required(Version${1：Version})&#34；，&#34；，&#34；project(${2：projname}&#34；，&#34；description\&#34；${3：description}\&#34。，&#34；HOMEPAGE_URL语言https://github.com/p1v0t/${4:reponame}&#34；，&#34；，&#34；，&#34；，&#34；设置(CMAKE_EXPORT_COMPILE_COMMANTS ON)&#34；，&#34；${0}&#34；]}}。</p><p>还有一个用于CMake的扩展，它提供基本的完成。请参阅此处的分机列表。</p><p>如果您喜欢编写小程序，并且不需要构建，SingleCompile插件正好适合这一点。下面是一个映射示例：</p><p>记住这种客户端-服务器体系结构，您可以在其他平台上使用类似的设置。在Windows中，您可以安装从LLVM获取Windows二进制文件，并使用带有clangd扩展名的VSCode的clangd。在Emacs上，有LSP模式支持。</p><p>请不要客气，让我难堪我用这篇帖子做的事情：)谢谢你的阅读。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://gist.github.com/p1v0t/42a34744b5e4f5980e5f4e1c980ec859">https://gist.github.com/p1v0t/42a34744b5e4f5980e5f4e1c980ec859</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开发/">#开发</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/c++/">#c++</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/vim/">#vim</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1021919.html"><img src="http://img2.diglog.com/img/2020/9/thumb_65f7890cfcfc6b9d4afd1c78b16fabd3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021919.html">开发竞争性手机游戏的Skillz宣布将通过SPAC合并上市，估值为35亿美元</a></div><span class="my_story_list_date">2020-9-3 20:49</span></div><div class="col-sm"><div><a target="_blank" href="/story/1021835.html"><img src="http://img2.diglog.com/img/2020/9/thumb_faab1ef5b42497238bbf3a1d33a02e00.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021835.html">JIT开发I：JIT bug</a></div><span class="my_story_list_date">2020-9-3 7:7</span></div><div class="col-sm"><div><a target="_blank" href="/story/1021817.html"><img src="http://img2.diglog.com/img/2020/9/thumb_b8c27634e99712814ba89d51e062e25f.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021817.html">开发零售调度和分析软件的Legion在Stripes的带领下筹集了2200万美元的B系列资金，使其筹资总额达到3550万美元</a></div><span class="my_story_list_date">2020-9-3 4:36</span></div><div class="col-sm"><div><a target="_blank" href="/story/1021760.html"><img src="http://img2.diglog.com/img/2020/9/thumb_35e6b233735218ef39a787ff5f72c538.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021760.html">设计和开发交互式地球仪</a></div><span class="my_story_list_date">2020-9-2 21:33</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>