<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用客户端拼图协议的战斗机器人</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用客户端拼图协议的战斗机器人</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-23 22:52:13</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/2653388865fffc07e729cfb1dcb64433.png"><img src="http://img2.diglog.com/img/2020/9/2653388865fffc07e729cfb1dcb64433.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>1999年，阿里·朱尔斯(Ari Juels)和约翰·布雷纳德(John Brainard)提出了一种针对拒绝服务攻击的优雅保护，称为客户端拼图协议。他们的想法获得了专利(美国专利7197639)，这可能会阻碍其被采纳。然而，该专利已于2020年初到期，因此现在任何人都可以免费使用。它应该被使用。</p><p>客户端拼图协议并不广为人知，也没有实现，但我们确实注意到Akamai在他们的机器人管理器的专利到期后不久就学会了这个概念。Akamai增加了高级智能(备注：Clouflare似乎也在做同样的事情，参见Kasada)，但基本的客户端拼图协议很容易实现，任何人都可以不用花一分钱就能使用。</p><p>解释Juels-Brainard客户端难题协议背后的基本思想(略有简化)，重点放在Web应用程序上。</p><p>客户端拼图协议的目标是降低机器人的速度，使它们接近人类的速度。放慢它们的速度会阻止许多不同的攻击，例如Web刮除、暴力攻击和某些类型的拒绝服务。</p><p>为了实现这一点，使用了工作证明概念。现在可能很多人都在想比特币，但在比特币发明前十多年，密码文献中就已经有了工作证明的概念。事实上，阿里·朱尔斯是这一概念的先驱之一。</p><p>客户端难题协议向客户端提供密码难题，在服务其请求之前必须解决该难题。这个谜题可能只需要几分之一秒就能解开-这对合法的人类几乎没有影响，但会显著减慢机器人的速度。拼图解决方案的验证速度非常快，因此协议对服务器的影响可以忽略不计。此外，该协议完全是无状态的。</p><p>具体地说，该难题通常涉及找到密码散列函数的前映像的一部分。请参见下图。</p><p>在此构造中，使用了两级散列。首先，对客户端请求数据(查询参数/请求正文)以及服务器端机密和时间戳进行散列。这将产生散列H1，该散列被散列以产生散列H2。拼图由H2和H1的大部分部分组成。</p><p>加密散列函数被设计为抵抗前映像，因此如果给您提供h2，则查找h1将非常困难/耗时。另一方面，如果您获得h2和h1的大部分位，那么只要剩余位的数量不是太大，您就可以强行使用剩余位。您只需尝试剩余比特的每种可能性，对候选预映像进行散列，并查看散列是否与h2匹配。如果缺少k个比特，则这需要多达2k次试验。对于小k来说，这很容易做到，但需要一些计算工作。</p><p>在客户端难题协议中，h2和h1的大部分位被提供给客户端。客户端必须暴力破解剩余的比特。当客户端成功时，它会发回谜题解决方案(H1)、服务器提供的时间戳和请求数据。</p><p>现在考虑服务器如何验证结果。这是最优雅的部分，因为服务器不需要记住H2。相反，它只是通过散列h1的秘密以及客户端提供的请求数据和时间戳来重新计算h1。如果散列与客户端提供的匹配，那么问题就解决了！</p><p>只要客户不知道服务器密码，他们就不能伪造假谜题。提供假拼图的尝试很容易被捕获，并从刚才描述的计算中被拒绝。对于服务器，这种计算既快速又容易：不使用数据库的单一散列计算。类似地，客户端不能在时间戳上撒谎，因为散列计算不会检出。</p><p>时间戳的用途是什么？您可以设置必须在此之前解开谜题的过期时间。这提供了在解决方案花费太长时间时拒绝请求的选项，如果请求的响应可能会随着时间的推移而更改，这一点尤其有用。例如，考虑电子商务网站上商品的价格。没有时间戳，攻击者可以每周提供相同的谜题解决方案，而无需重新计算以获得每周的价格更新。有了时间戳，他每次都必须重新计算。</p><p>当Juels和Brainard在1999年撰写关于此协议的文章时，他们描述了如何防御TCP SYN洪水、电子邮件炸弹等威胁。从那时起，互联网蓬勃发展，今天更清楚的是，这项技术的许多应用不仅用于防止拒绝服务攻击，而且更广泛地用于阻止机器人活动，如Akamai使用它的方式。</p><p>我不是专业程序员，我只是在学习Node.js，但尽管如此，构建概念证明对我来说并不费力。您可以在GitHub上看到源代码。该PoC接受搜索查询的用户输入，并从Giphy返回与搜索查询相关的随机GIF。服务器端使用Giphy API密钥。通过使用客户端难题协议，每次通过服务器向Giphy发出请求时，客户端都需要进行计算，Giphy控制通过服务器发送到Giphy的请求的数量。</p><p>服务器端的主要函数是COMPUTE_PUSIT()和CHECK_PUSPLE_Solution()，前者用于根据原始请求计算难题，后者用于验证解决方案。客户端拥有暴力破解谜题的代码。</p><p>您可以在这里看到演示。拼图强度设置为2 17，过期时间为10秒。在我的大多数设备上，这通常只需要不到一秒的时间，除了我的旧iPad2，它可能需要几秒钟。请注意，每个请求都使用我的Giphy开发API密钥，该密钥受Giphy的速率限制。虽然我不知道速率限制设置是什么，但我指望客户端拼图协议(希望)将我的匿名可访问演示应用程序保持在最低级别。</p><p>如果您要使用我的GitHub代码，这里有几点您应该知道的：</p><p>代码在启动时从cryption.随机性字节()生成秘密，如果您只有一台后端服务器，这是很好的。如果您使用多个服务器，则应该在它们之间共享密码，以处理响应难题解决方案的服务器可能与创建难题的服务器不同的情况。</p><p>整个系统的安全性取决于秘密的强度，所以不要使用像P@55w0rd123这样愚蠢的东西。这个秘密需要很长时间，而且不能强行实施。</p><p>该程序最具娱乐性的是Giphy API密钥，您可以按照此处的指导快速免费获得该密钥。获得密钥后，将其设置为环境变量GIGPHY_API_KEY。</p><p>您还可以设置拼图强度(环境变量PUSPHY_STANCE，默认情况下为16，表示2 16努力)和过期时间(环境变量TIME_LIMIT，默认情况下为5000毫秒)。</p><p>最终，客户端JavaScript代码应该得到优化。这是因为合法用户将使用JavaScript代码，而优秀的黑客会使用自定义代码来尽可能快地解决难题。他使自己的代码比JavaScript代码快得越多，对他就越有好处(更多细节将在下面的最后一节中介绍)。要优化合法的客户端代码，重点应该放在尽可能快地生成sha256上。</p><p>速率限制非常重要，但在某些攻击场景中，速率限制不能提供足够的保护。</p><p>如果您有可匿名访问的API，则速率限制的典型方法是按IP地址进行限制。然而，现在的黑客很容易通过使用Fireprox等工具轮换他们的IP地址来绕过这一限制。黑客还可以伪造地理位置，很容易混入其中，看起来像是合法用户。因此，很难区分坏人和合法用户-您要么让坏人请求免费进入，要么冒着放弃合法用户请求的风险。</p><p>在对抗访问匿名可访问内容的恶意客户端时，如果可以确定客户端是否为恶意客户端，则速率限制是最有效的。对于一个聪明的对手，这种确定性是不存在的。</p><p>客户端难题协议通过要求每个客户端解决难题来更好地处理不确定性。合法用户(人)每秒不会发出大量请求，因此他们看不到什么影响。另一方面，恶意机器人将看到巨大的影响，因为它们被迫为其众多请求中的每一个进行计算，而且这会积累起来。使用客户端拼图协议，发出请求不再是免费的。</p><p>当然，可能有合法的机器人需要每秒执行许多请求。可以通过多种方式(APIKEY、已知IP地址等…)识别这些地址。并被列入白名单让他们通过。其他每个人都必须根据请求进行计算。</p><p>在讨论增强功能之前，我们必须先讨论限制。客户端拼图协议不会阻止机器人，它只会减慢它们的速度。恶意实体仍然可以让请求通过，但是突然它必须为每个请求“付费”，其中付费是按计算时间支付的。如果该实体具有强大的计算能力，它可能会抹去该协议提供的大部分好处。</p><p>在最初的出版物中，Juels和Brainard建议仅在服务器受到攻击时使用该协议，并根据攻击的严重程度调整参数。他们还考虑了诸如TCP SYN洪泛之类的攻击，在这种情况下，一台服务器一次只能处理这么多连接。我们的重点更多地放在应用程序层，因此我们将讨论特定于应用程序的增强功能。当然，根据严重程度调整参数仍然是有效的保护措施。</p><p>类似于Akamai/Cloudflare/Kasada，我们可能有一些关于我们对手的情报，允许我们根据请求是恶意的可能性来调整拼图强度。例如，也许我们知道攻击者正在使用特定的API密钥或用户代理头-我们可以为这些请求提供比其他请求更难的谜题。</p><p>如果我们试图防御攻击者野蛮逼迫特定目标，那么我们可以缓存失败的尝试，并在每次失败时增加这些特定目标的拼图强度。这些力量的增加应该是暂时的：足够长的时间来挫败敌人，而不是太长的时间来把好人拒之门外。</p><p>我们总是可以把已知的好客户列入白名单，让他们不费吹灰之力就能通过，而对于未知的情况则需要更高的拼图强度。</p><p>备注：虽然它会降低影响，但客户端难题协议本身并不足以防止凭据填充攻击，因为攻击者每个请求都有很大的成功概率。有关更恰当的辩护，请参阅我们的OT2FA博客。客户端拼图协议确实有助于阻止其他形式的暴力，在这些情况下，每个请求成功的可能性较小。</p><p>客户端难题协议的缺点之一是攻击者可能比合法用户拥有更多的计算资源。这就是众所周知的资源不平衡问题。导游益智游戏协议就是为解决这一差异而设计的。我还没有研究它们的实用性或知识产权方面的考虑。</p><p>在私下交流中，阿里·尤尔斯建议，客户谜题可能被用来挖掘加密货币，如Monero(具有抗ASIC的工作证明方案)，“这意味着用户实际上是在为服务付费。”在进行了一些数字运算后，他表示，不幸的是，它不会产生太多货币，因为总体来说，客户没有做大量的工作。阿里还指出，在1999年与马库斯·雅各布森(Markus Jakobson)的一篇相关论文中，他们将这一想法应用于一种名为MicroMint的加密货币协议，并对此进行了讨论。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://littlemaninmyhead.wordpress.com/2020/09/20/fighting-bots-with-the-client-puzzle-protocol/">https://littlemaninmyhead.wordpress.com/2020/09/20/fighting-bots-with-the-client-puzzle-protocol/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/机器人/">#机器人</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/客户端/">#客户端</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/bots/">#bots</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/请求/">#请求</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1025777.html"><img src="http://img2.diglog.com/img/2020/9/thumb_3512bcf22478af8d998f317a1085f34a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025777.html">
总部位于新加坡的Syfe是一家人性化的机器人顾问公司，在Valar Ventures的带领下筹集了1860万美元</a></div><span class="my_story_list_date">2020-9-23 10:20</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025722.html"><img src="http://img2.diglog.com/img/2020/9/thumb_636698625f299e1a4c8e37bad3a3c670.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025722.html">
CMU的MoonRanger机器人月球车将于2022年首次在月球上搜索水冰</a></div><span class="my_story_list_date">2020-9-23 5:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025600.html"><img src="http://img2.diglog.com/img/2020/9/thumb_1d0a18f9c813536fab29b62c10187ae7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025600.html">
微软为其Power平台带来新的机器人过程自动化功能</a></div><span class="my_story_list_date">2020-9-22 23:17</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025484.html"><img src="http://img2.diglog.com/img/2020/9/thumb_e9f26208b6195519aa381b4c1ad509fc.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025484.html">印度机器人爬树收获椰子</a></div><span class="my_story_list_date">2020-9-22 9:0</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>