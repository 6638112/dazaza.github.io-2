<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用增强CFG的剥离二值神经逆向工程 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用增强CFG的剥离二值神经逆向工程 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-06 04:13:15</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/52601fca51b6144425cff2c211e9a2fc.jpeg"><img src="http://img2.diglog.com/img/2020/12/52601fca51b6144425cff2c211e9a2fc.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>这是Nero-GNN的正式实现，该原型描述于：Yaniv David，Uri Alon和Eran Yahav，使用增强控制流图进行剥离二进制的神经逆向工程，将出现在OOPSLA中。 2020年，PDF。</p><p> 我们的评估数据集和其他资源可在此处（Zenodo）获得。这些将被使用并在下面进一步解释。</p><p>   GNN神经模型：使用过程表示来训练GNN模型以预测过程名称。</p><p>   LLVM版本10和llvmlite＆amp; llvmcpy python软件包（其他版本可能有效。3.x无效）。</p><p> 使用Linux的许可IDA-PRO安装，所有这些要求都被验证为可以在Ubuntu 20计算机上运行（甚至在Ubuntu 16上也需要更多的努力）兼容。</p><p> 对于Ubuntu 20，您可以使用此存储库中的requirements.txt文件来针对本机python3.8版本安装所有python软件包：</p><p>    IDA-python脚本（在datagen / ida / py2中）已针对与IDA-PRO 6.95捆绑在一起的python 2.7版本进行了测试，并且应与至少7.4以上的较新版本一起使用（更多信息，请参见此处）。如果没有，请提交错误。 </p><p>还需要安装jsonpickle python软件包以供此捆绑的python版本使用：</p><p>       请注意，以root用户身份安装时，IDA-PRO默认设置为安装在/opt/ida-6.95/idal64中。其他路径将需要在此处和其他脚本中进行调整。</p><p>  python3.6。 （对于将同一台Ubuntu 20计算机用于培训和数据生成，我们建议使用virtualenv）</p><p>  请注意，对于tensorflow-gpu版本1.13及更高版本，需要CUDA> = 10.1。 （有关更多信息，请参见此链接）</p><p>      我们的二进制数据集是通过将几个GNU源代码包编译成二进制可执行文件并执行彻底的清除和重复数据删除过程（在本文中详细介绍）而创建的。</p><p> 这些软件包分为三组：培训，验证和测试（每个都在其自己的目录中，该目录位于提取的档案中：培训，验证和测试代表）。</p><p> 要获得这些二进制文件的预处理表示，您可以下载我们的预处理数据集，或者从我们或任何其他二进制数据集中创建一个新的数据集。 </p><p>索引，即分析二进制文件并为其创建基于增强控制流图的表示，可以使用以下命令执行：</p><p>  其中，TRAIN是保存要建立索引的二进制文件的目录，结果放置在TRAIN_INDEXED中。</p><p> 要成功建立索引，二进制文件必须包含调试信息并遵守以下文件名结构：</p><p>   请注意，建立索引过程可能要花费几个小时，其某些结果取决于为过程建立索引选择的超时值（由--index-timeout控制，默认值为30分钟）。我们建议在具有多个CPU内核和足够RAM的计算机上运行它。如果提取了1000多个唯一的CFG路径，过程索引也将停止。</p><p>     这将从TRAIN_INDEXED中过滤并收集索引过程（应该保留索引的二进制文件以便从最后一步进行训练），并将它们存储在train.json中。</p><p>    这将预处理training（train.json），validation（validation.json）和test（test.json）文件。请注意，此步骤需要TensorFlow和此处提到的其他组件。</p><p>   提取过程表示档案将创建文件夹procedure_representations，并在其中另外两个文件夹： </p><p>raw：以上数据集中所有二进制过程的原始表示形式。每个过程在相关文件中的每一行用一行表示（training.json，validation.json和test.json）。</p><p>  用于训练模型的文件：data.dict和data.train（相应的字典和预处理的训练集样本）</p><p>  正如我们在论文中所显示的，Nero-GNN是我们方法的最佳变体，因此我们在此重点介绍。</p><p>    其中NUM_GNN_LAYERS是GNN层的数量。在本文中，我们发现NUM_GNN_LAYERS = 4的性能最佳。（training）--data和（validation）--test参数的路径可以更改为指向新的数据集。在这里，我们提供了我们使用的数据集在本文中。</p><p> 我们使用Tesla V100 GPU训练了模型。其他GPU可能需要更改GNN层数或其他暗淡以适合可用的RAM。</p><p>  此档案库中提供训练有素的模型，将其提取将创建gnn目录，该目录由以下内容组成：</p><p>     如果model_iter495是在训练期间在验证集上表现最佳的检查点（在提供的训练模型中就是这种情况）。NUM_GNN_LAYERS的值应与训练中的值相同。 </p><p>在训练和测试期间使用--no_arg标志，以训练＆＃34; no-values＆＃34;模型（如本文表4所示）</p><p> 在训练和测试过程中使用--no_api标志来训练＆＃34;模糊的＆＃34;模型（如本文表2所示）-一种不使用API​​名称的模型（假设它们被混淆了）。</p><p>  本节提供了来自测试集的示例的名称预测演练（此处进一步说明）。为便于阅读，我们直接从图形表示开始（类似于本文图2（c）所示）。其余步骤。</p><p> find可执行文件中的get_tz过程是findutils包的一部分。该过程表示为在procedure_representations / raw / test.json的第1715行找到的json。</p><p>    图节点是名为ob x的基本块。 （其中x是带有可选后缀的数字，例如，initialize）。</p><p> json包含有关节点之间的边缘以及每个节点中抽象的调用站点的数据。</p><p> 在此json中，我们看到第一个节点ob-1.initialize包含对以Egetenv标记的External api调用getenv的调用。此api调用使用已解析为具体字符串TZ的参数进行。 </p><p>使用抽象值CONST作为参数对memcpy和strlen进行其他调用。 该CONST抽象值在本文中称为STK（请参阅第14页）。  请注意，Nxmemdup是普通（内部）调用。 该名称取自调试信息，并保留在此处用于我们的调试目的，在训练/预测步骤中使用之前，将其再次删除。  我们的Nero-GNN对该程序的名称预测可以在模型预测日志文件的第876行中找到：  该行以预测代码开头：+，±或-表示完全匹配，部分匹配或不匹配。 然后，过程信息，基本事实，预测和截断的子令牌如下： </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/tech-srl/Nero">https://github.com/tech-srl/Nero</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/逆向工程/">#逆向工程</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/增强/">#增强</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/reverse/">#reverse</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/过程/">#过程</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1035160.html"><img src="http://img2.diglog.com/img/2020/11/thumb_12daea173208e336e4da0bc216649283.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1035160.html">对经典的MK4116 16K位DRAM芯片进行逆向工程</a></div><span class="my_story_list_date">2020-11-15 1:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1035029.html"><img src="http://img2.diglog.com/img/2020/11/thumb_5fab045da87c9889b82a4bedf9fe1cbe.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1035029.html">Rehex-逆向工程师的十六进制编辑器</a></div><span class="my_story_list_date">2020-11-14 9:5</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034995.html"><img src="http://img2.diglog.com/img/2020/11/thumb_d76cfaec5b1ce4b6d8f955ea9d3dfc66.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034995.html">逆向工程中的心理战</a></div><span class="my_story_list_date">2020-11-14 8:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033948.html"><img src="http://img2.diglog.com/img/2020/11/thumb_1a2a6e6cee6739506e0c8d6c85e8616a.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033948.html">对Intel 8008处理器中的超前进位电路进行逆向工程</a></div><span class="my_story_list_date">2020-11-9 7:41</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>