<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>现实世界CSS与CSS-IN-JS性能比较 Real-world CSS vs. CSS-in-JS performance comparison</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Real-world CSS vs. CSS-in-JS performance comparison<br/>现实世界CSS与CSS-IN-JS性能比较 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-09 03:27:44</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/6/8c651fc928578e6ae408dcfb5b79f8d0.jpg"><img src="http://img2.diglog.com/img/2021/6/8c651fc928578e6ae408dcfb5b79f8d0.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>CSS-in-JS has taken a solid place in front-end tooling, and it seems this trend will continue in the near future. Especially in the React world. For example, out of 11492 people who participate in  State of CSS survey in 2020 only 14.3% didn’t hear of  Styled Components (a dominant CSS-in-JS library). And more than 40% of participants have used the library.</p><p>CSS-In-JS在前端工具中取得了一个坚实的地方，似乎这一趋势将在不久的将来继续。特别是在反应世界中。例如，在2020年参加CSS调查状态的11492人中只有14.3％的人没有听到风格的组件（一个占主导地位的CSS-In-JS图书馆）。超过40％的参与者使用了图书馆。</p><p>  I wanted to see an in-depth performance comparison of CSS-in-JS libraries like Styled Components and a good old CSS for a long time. Sadly I was unable to found a comparison on a real-world project and not some simple test scenario. So I decided to do it myself. I have migrated the real-world app from Styled Components to  Linaria, which will extract CSS on build time. No runtime generation of the styles on the user’s machine.</p><p>  我希望看到CSS-In-JS库的深入性能比较，如样式组件和很长一段时间的旧CSS。可悲的是，我无法在真实世界项目中找到比较，而不是一些简单的测试场景。所以我决定自己这样做。我已将Real-World应用程序从样式组件迁移到Linaria，这将在构建时提取CSS。没有用户机器上的样式的运行时生成样式。</p><p>  A short notice, before we begin. I’m not a hater of CSS-in-JS. I admit they have great DX, and the composition model inherited from React is great. It can provide developers with some nice advantages like  Josh W. Comeau highlights in his article  The styled-components Happy Path. I also use Styled Components on several of my projects or projects I have worked on. But I wondered, what is the price for this great DX from the user’s point of view.</p><p>  在我们开始之前短暂的通知。我不是CSS-In-JS的仇恨。我承认他们有很棒的DX，并且从反应中遗传的组成模型很棒。它可以为开发人员提供一些良好的优势，如Josh W. Comeau亮点在他的文章中称为风格组件的快乐道路。我还在我工作的几个项目或项目中使用风格组件。但我想知道，来自用户的角度来看，这个伟大的DX的价格是多少。</p><p>      Don’t use runtime CSS-in-JS if you care about the load performance of your site.   Simply less JS = Faster Site. There isn’t much we can do about it. But if you want to see some numbers, continue reading.</p><p>      如果您关注您网站的负载性能，请不要使用运行时CSS-INS。简单地少JS =更快的网站。我们可以做些什么。但如果你想看到一些数字，继续阅读。</p><p>    The app I have used for the test is a pretty standard React app. Bootstrapped using Create React App project, with Redux and styled using Styled components (v5). It is a fairly large app with many screens, customizable dashboards, customer theming, and more. Since it was built with  CRA, it doesn’t have server-side rendering, so everything is rendered on the client (since it’s a B2B app, this wasn’t a requirement).</p><p>    我用于测试的应用程序是一个漂亮的标准React应用程序。使用CREATE RECK APP项目引导，使用REDUX并使用样式组件（V5）进行样式。它是一个相当大的应用程序，具有许多屏幕，可定制的仪表板，客户主题等。由于它是用CRA构建的，它没有服务器端渲染，因此所有内容都在客户端呈现（因为它是B2B应用程序，这不是一个要求）。</p><p>  I took this app and replaced the Styled Components with Linaria, which seems to have a similar API. I thought the conversion would be easy. It turned out it wasn’t that easy. It took me over two months to migrate it, and even then, I have migrated only a few pages and not the entire app. I guess that’s why there is no comparison like this 😅. Replacing the styling library was the only change. Everything else remained intact.</p><p>  我拍了这个应用程序并用Linaria替换了风格的组件，似乎有一个类似的API。我以为转换很容易。事实证明，它并不那么容易。我花了两个月了迁移它，即使那么，我也只迁移了几页，而不是整个应用程序。我想这就是为什么没有比较这样的比较。替换样式库是唯一的更改。其他一切都保持不变。</p><p>  I have used Chrome dev tools to run several tests on the two most used pages. I have always run the tests three times, and the presented numbers are an average of those 3 runs. For all the tests, I have set  CPU throttling to 4x and  network throttling to Slow 3G. I used a separate Chrome profile for performance testing without any extensions.</p><p>  我已经使用Chrome Dev工具在两个最常用的页面上运行多个测试。我始终运行三次测试，而呈现的数字是那些3运行的平均值。对于所有测试，我已经将CPU限制为4倍，网络限制为慢速3G。我使用了一个单独的镀铬型材，用于在没有任何扩展的情况下进行性能测试。 </p><p>        We will start with a network. One of the advantages of CSS-in-JS is that there are no unused styles, right? Well, not exactly. While you have active only the styles used on the page, you may still download unnecessary styles. But instead of having them in a separate CSS file, you have them in your JS bundle.</p><p>我们将从网络开始。 CSS-In-JS的一个优点是没有未使用的样式，对右？好吧，不是完全的。虽然只有页面上使用的时尚，但您仍可能下载不必要的样式。但不是在单独的CSS文件中拥有它们，而是将它们放在JS捆绑中。</p><p>  Here is a data comparison of the same home page build with Styled Components and Linaria. Size before the slash is gzipped size, uncompressed size is after it.</p><p>  以下是使用样式组件和Linaria的相同主页构建的数据比较。斜杠尺寸之前的大小尺寸，未压缩大小在它之后。</p><p>      Even though our CSS payload increased quite a lot, we are still downloading fewer data in total in both test cases (yet the difference is almost neglectable in this case). But what is more important, the sum of CSS and JS for Linaria is still smaller than the size of the JS itself in Styled Component.</p><p>      即使我们的CSS有效载荷增加了很多，我们仍然在测试用例中仍在下载更少的数据（但在这种情况下，差异几乎疏忽）。但更重要的是，Linaria的CSS和JS的总和仍然小于样式组件中的JS本身的大小。</p><p>    If we compare coverage, we get a lot of unused CSS for Linaria (around 55kB) compared with 6kB for Styled Component (this CSS is from npm package, not from the Styled Components itself). The size of the unused JS is 20kB smaller for Linaria compared to Styled Component. But the overall size of the unused assets is larger in Linaria. This is one of the trade-offs of external CSS.</p><p>    如果我们比较覆盖范围，那么与风格组件的6KB相比，我们为Linaria（约55kb左右）获得了大量未使用的CSS（此CSS来自NPM包，而不是来自风格组件本身）。与样式组件相比，Linaria的未使用JS的大小为20kb。但未使用的资产的整体规模在Linaria更大。这是外部CSS的权衡之一。</p><p>        If we are talking about performance, it would be a shame not to use Lighthouse. You can see the comparisons in the charts below (average from 3 LI runs.). Aside from Web Vitals, I have also include Main thread work (time to parse, compile and execute assets, the biggest part of this is JS, but it covers layout and styles calculation, painting, etc.) and JS Execution time. I have omitted Cumulative Layout Shift since it was close to zero, and there was almost no difference between Linaria and Styled Component.</p><p>        如果我们谈论表现，那将是一个耻辱，不要使用灯塔。您可以在下面的图表中看到比较（平均从3个LI运行）。除了Web Vitals之外，我还包括主题工作（解析，编译和执行资产的时间，这是JS的最大部分，但它涵盖了布局和样式计算，绘画等）和JS执行时间。由于它接近零，因此我省略了累积布局偏移，并且在Linaria和风格的组件几乎没有区别。</p><p>                    As you can see, Linaria is better in most of the Web Vitals (lost once in CLS). And sometimes by a large margin. For example, LCP is faster by 870ms on the home page and by 1.2s on the Search page. Not only does the page render with normal CSS much faster, but it requires fewer resources as well. Blocking time and time necessary to execute all the JS are smaller by 300ms and roughly 1.3 seconds respectively.</p><p>                    如您所见，Linaria在大多数Web Vitals（在CLS中丢失）更好。有时是大幅度的。例如，LCP在主页上的870ms更快，搜索页面上的1.2s。页面不仅呈现正常的CSS是否要快得多，但它也需要更少的资源。阻止执行所有JS所需的时间和时间较小300ms，分别为大约1.3秒。</p><p>    Lighthouse can give you many insights on the performance. But to get into the details, the performance tab in the dev tools is the best bet. In this case, the performance tab confirms the Lighthouse results. You can see the details on the charts below.</p><p>    灯塔可以为您提供对性能的许多见解。但要进入详细信息，Dev Tools中的性能选项卡是最好的选择。在这种情况下，“性能”选项卡确认了灯塔结果。您可以在下面的图表上查看详细信息。 </p><p>                    Screens build with Styled Component had more long-running tasks. Those tasks also took longer to complete, compared to the Linaria variant.</p><p>使用样式组件构建屏幕具有更长的长时间的任务。与Linaria Variant相比，这些任务也需要更长时间才能完成。</p><p>  To give you another look at the data, here is the visual comparison of the performance charts for loading the home page with Styled Component (top) and Linaria (bottom).</p><p>  为了给您另一点看数据，这里是使用样式组件（顶部）和Linaria（底部）加载主页的性能图表的可视比较。</p><p>             To compare user interaction as well, not only the page load. I have measured the performance of the drag and drop activity used to assign items into groups. The result summary is below. Even in this case, Linaria beat the runtime CSS-in-JS in several categories.</p><p>             要比较用户互动，而且不仅是页面加载。我已经测量了用于将项目分配成组的拖放活动的性能。结果摘要如下。即使在这种情况下，Linaria甚至在几个类别中击败了运行时CSS-In-JS。</p><p>               That’s it. As you can see runtime CSS-in-JS can have a noticeable impact on your webpage. Mainly for low-end devices and regions with a slower internet connection or more expensive data. So maybe we should think better about what and how we use our tooling. Great developer experience shouldn’t come at the expense of the user experience.</p><p>               就是这样。正如您可以看到运行时，CSS-In-JS可以对您的网页带来明显的影响。主要用于低端设备和地区，具有较慢的互联网连接或更昂贵的数据。所以也许我们应该更好地思考我们如何使用我们的工具。伟大的开发人员经验不应该以牺牲用户体验为代价。</p><p>  I believe we (developers) should think more about the impact of the tools we choose for our projects. The next time I will start a new project, I will not use runtime CSS-in-JS anymore. I will either use good old CSS or use some build-time CSS-in-JS alternative to get my styles out of JS bundles.</p><p>  我相信我们（开发人员）应该更多地考虑我们为项目选择的工具的影响。下次我将开始一个新项目，我不会再使用运行时css-in-js了。我将使用良好的旧CSS或使用一些构建时CSS-IN-JS替代方案来将我的样式从JS捆绑中获取。</p><p>  I think build-time CSS-in-JS libs will be the next big thing in the CSS ecosystem as more and more libs are coming out (the last one being  vanilla-extract from Seek). And big companies are heading this way as well, like Facebook with their  styling lib).</p><p>  我认为建设时间CSS-In-JS Libs将成为CSS生态系统中的下一个大事，因为越来越多的LIB来（最后一个是从Seek中提取）。和大公司也是如此，如Facebook与他们的造型lib）。</p><p>  Thanks for reading the article. If you have any suggestions or ideas how to make the article better or you simply like it, feel free to share and discuss it on Twitter.</p><p>  感谢您阅读文章。如果您有任何建议或想法如何使文章更好或简单地类似，请随时分享和讨论Twitter。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://pustelto.com/blog/css-vs-css-in-js-perf/">https://pustelto.com/blog/css-vs-css-in-js-perf/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/性能/">#性能</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/css/">#css</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/world/">#world</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>