<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>端到端思维在系统设计中的重要性</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">端到端思维在系统设计中的重要性</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-22 08:48:08</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/c79c6f846794610f6398970c9a0a238b.jpeg"><img src="http://img2.diglog.com/img/2020/10/c79c6f846794610f6398970c9a0a238b.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>I once attended a talk by Yoky Matsuoka when I was young – so young, in fact, that I don’t remember when or where the talk was.  What I do remember is her telling the story of designing a prosthetic hand.  She had encountered previous designs where the designers were so bent on creating every mechanical degree of freedom possible, that by the time the joints of the hand and all the cabling required to maneuver the hand was inserted, not only had the hand lost much of the degree of freedom it was supposed to have due to lack of maneuvering space, but there was also no room for the microcontrollers to actually control it.  Thus, the degrees of freedom were physically there, but functionally inoperable.  She, on the other hand, was determined to design a maximally functional hand, thus thinking about the design in a more end-to-end manner.  This anecdote has stuck with me ever since.</p><p>我年轻时曾参加过松冈洋子的一次演讲--事实上，我太年轻了，以至于我不记得演讲是在什么时候、在哪里进行的。但我记得的是她讲述了设计假手的故事。尽管她之前的设计中设计师们如此执着于创造每一个可能的机械自由度，以至于当插入手部关节和操纵手所需的所有电缆时，由于缺乏机动空间，这只手不仅失去了应有的自由度，而且也没有空间让微控制器真正控制它。因此，在她之前的设计中，设计师们致力于创造每一个可能的机械自由度，以至于当插入手的关节和所有操纵手所需的电缆时，这只手不仅失去了应有的自由度，因为缺乏机动空间，而且也没有空间让微控制器真正控制它。因此，自由度在身体上是存在的，但在功能上是不能操作的。另一方面，她决心设计一只功能最大的手，从而以一种更端到端的方式来考虑设计。从那以后，这件轶事就一直伴随着我。</p><p> In our field of computer architecture, I occasionally encounter proposals that miss the end-to-end picture.  I once saw a presentation from someone proposing a scheme which kept track of history in order to make future predictions.  The experiments involved keeping track of 2, 3, or 4 samples of history, and using the average of the stored history to make a prediction.  The graphs showed that a history of 3 had the best results, and so the person recommended a history of 3 and dividing the sum of the values by 3 to form the prediction.  This is a prime example of lacking end-to-end thinking – the marginal improvement of a history of 3 vs 2 or 4 could not possibly outweigh needing to implement a divider just for this predictor in the total system – the area and power impacts in comparison to a shifter make it clearly the wrong answer – but only if you look end-to-end instead of just at the results in a graph.</p><p>在我们的计算机体系结构领域，我偶尔会遇到错过端到端画面的建议。我有一次看到有人提出了一个方案，该方案通过跟踪历史来进行未来预测。这些实验涉及跟踪2个、3个或4个历史样本，并使用存储的历史的平均来进行预测。虽然图表显示历史为3的结果最好，因此，这个人推荐了一个3的历史记录，然后将这些值的总和除以3来形成预测。这是一个缺乏端到端思维的最好例子-3对2或4的历史的边际改进不可能超过仅仅为了整个系统中的这个预测器而实施除法器的需要-与移位器相比，面积和功率的影响显然是错误的答案-但只有在你看端到端而不是只看图表中的结果的情况下。</p><p> The tension here is that as systems get larger and larger, it becomes impossible to consider the entire system end-to-end the whole time.  Here at Microsoft in  Azure, we operate datacenters in more than 60 regions across the globe, comprising 160+ datacenters connected, arranged into regions, and connected by one of the  largest networks on earth.  It becomes very difficult to consider what a processor widget here might do in the context of this enormous global system.  So what is a processor architect to do?  How can one think about the sorts of problems to solve when the end to end system is many, many, many layers of abstraction broader than the proposal at hand?</p><p>这里的紧张之处在于，随着系统变得越来越大，我们不可能一直考虑整个系统端到端。在微软的Azure，我们在全球60多个地区运营数据中心，其中包括160多个数据中心，这些数据中心由160多个连接在一起的数据中心组成，这些数据中心分布在不同的地区，并由地球上最大的网络之一连接起来。在这个巨大的全球系统的背景下，很难考虑这里的处理器部件可能会做什么。那么处理器架构师应该做什么呢？当端到端系统非常多时，人们如何考虑要解决的各种问题呢？比手头的提案更宽泛的抽象的很多层次？</p><p> The following are my tips for evaluating the value of an idea, particularly when the details of the total system may be obscured (i.e., understanding the whole thing is above your pay grade).</p><p>以下是我评估一个想法价值的小贴士，特别是当整个系统的细节可能被模糊的时候(即，理解整个事情超出了你的薪酬等级)。</p><p> Consider the adjacent steps in the pipeline.  Do you know what those adjacent steps are and what they are doing?  Does the thing you are proposing make sense in the middle of this minimally expanded scope of consideration? Example:  I want to move to a 4-wide execute stage instead of 1-wide, because now you can execute 4x more instructions.</p><p>考虑一下管道中相邻的步骤。你知道那些相邻的步骤是什么吗？他们在做什么？在这个最小限度扩大的考虑范围中，你提出的事情有什么意义吗？示例：我希望移到4宽的执行阶段，而不是1宽的执行阶段，因为现在您可以多执行4倍的指令。</p><p> But actually: if your fetch stage remains at 1-wide, then going to 4-wide execute won’t help at all.  This is not thinking end-to-end.</p><p>但是实际上：如果你的FETCH阶段仍然是1宽的，那么去4宽的执行是没有任何帮助的。这不是端到端的思考。</p><p> Consider adjacent layers in the stack –  will RTL, circuit, or layout designers tell you to get out of town?  Will compiler writers to get out of their office?  Does your proposal make sense in the context of the whole development pipeline? Example: I want to propose this new widget and it will mean long wires to communicate across multiple large structures.</p><p>考虑堆栈中的邻接层-RTL、电路或布局设计人员会告诉您出城吗？编译器编写人员会让您走出办公室吗？您的建议在整个开发管道的上下文中有什么意义吗？例如：我想推荐这个新的小部件，它将意味着跨越多个大型结构的通信需要很长的线路。</p><p> But actually: if your new design implies long distances across a chip, you will have to either give up cycles, because you have to put flops in the middle of those long wires, or huge driver transistors to push the signals across the wires, costing you power and area, or both.</p><p>但实际上：如果你的新设计意味着芯片上有很长的距离，你要么必须放弃周期，因为你必须在那些长线的中间放置触发器，要么需要巨大的驱动器晶体管来推动信号通过线，这会耗费你的电力和面积，或者两者兼而有之。</p><p> Consider the next 1 (or 2) encompassing subsystems, like how it fits into the whole processor or even SoC. Example: My father was an integrated circuit designer-turned-architect, and he told me once that as a young designer he worked on a register file.  He made it his mission to make the smallest, most power efficient register file there ever was.</p><p>考虑下1个(或2个)包含的子系统，比如它如何适应整个处理器甚至SoC。我的父亲是一名集成电路设计师出身的建筑师，他有一次告诉我，年轻的时候他从事寄存器堆的工作，他把制作有史以来最小、最省电的寄存器堆作为自己的使命。</p><p> But actually: the physical area in the entire design slated for the register file was much larger than what he had come up with, so in fact, he ended up costing power because long wires had to be routed across empty space from the edges of his slot to the ports of his tiny RF.</p><p>但实际上：整个设计中用于寄存器堆的物理面积比他想出来的要大得多，所以实际上，他最终还是要耗电，因为必须通过空的空间从他的插槽边缘布线到他微小的RF的端口。</p><p> Consider the goals of the top-level system.  In other words, for many years, computer architects have considered the processor itself as the top-level system, and the goal was to scream through SPEC.  We occasionally peeked over at HPC, where the system was a collection of processors and the network that connected them.  But now, we are solidly in a world where much of the world’s compute is sitting in a large datacenter, if not in a huge collection of datacenters operated by a hyperscaler like Microsoft, and it’s not obvious our community has fully absorbed the implications of this.  In this world, a processor is a small participant in this much larger system, and in this system, there are other hugely important metrics besides performance or power (though both are still important).</p><p>想想顶层系统的目标。换句话说，多年来，计算机架构师一直认为处理器本身是顶层系统，目标是通过规范尖叫。我们偶尔会偷看一下HPC，那里的系统是处理器和连接它们的网络的集合。但现在，我们坚定地生活在这样一个世界里，世界上的大部分计算机即使不是在由微软这样的超级计算器运营的巨大数据中心集合中，也不明显我们的社区已经完全吸收了这种影响。在这个世界上，我们的大部分计算机即使不是在由微软这样的超级计算器运营的巨大数据中心集合中，也不明显已经完全吸收了这一点的影响。在这个大得多的系统中，处理器只是一个很小的参与者，在这个系统中，除了性能或功耗之外，还有其他非常重要的指标(尽管两者仍然很重要)。</p><p> In this world, where a processor is a participant in a much larger system, my advice is to consider whether a proposal is making the  platform better.  For example:</p><p>在这个世界上，处理器是一个大得多的系统的参与者，我的建议是考虑提案是否会让平台变得更好。例如：</p><p> Is it more secure?  Does your new context management technique enable workloads from multiple customers share the same platform with the confidence that their workload is secure, from either a data and performance standpoint (or both)?</p><p>它是否更安全？您的新环境管理技术是否支持来自共享同一平台的多个客户的工作负载，无论从数据和/或性能角度看，他们的工作负载都是安全的吗？</p><p> Can it reduce tail latencies?   Predictable performance is important in a datacenter environment.  It is desirable to avoid scenarios where cloud customers flood a cloud provider with same-price instances, run a characterization test to find out which instances are running on either faster machines or co-located with low-utilization neighbors, and kill the instances that are non-advantageous.  Does your new scheduling mechanism enable consistent performance regardless of co-located threads?</p><p>它能减少尾部延迟吗？可预测的性能在数据中心环境中很重要。我们希望避免这样的场景：云客户向云提供商大量提供相同价格的实例，运行特征测试以找出哪些实例运行在速度更快的机器上，或者哪些实例与利用率较低的邻居共存，并杀死那些没有优势的实例。您的新调度机制是否无论线程位于同一位置，都能实现一致的性能吗？</p><p> Does it make virtualization easier?  Some enterprise customers want to move their entire workload from datacenters they control (i.e. virtualized), into cloud environments, which mean running a virtualized environment on top of a virtualized environment.  Could your new address translation scheme facilitate this?</p><p>它是否使虚拟化变得更容易？？一些企业客户希望将其整个工作负载从他们控制的数据中心(即虚拟化)移到云环境中，这意味着在虚拟化环境之上运行虚拟化环境。您的新地址转换方案如何促进这一点？</p><p> Does it improve network performance (i.e. can it participate better in the broader platform)?  Does your new network offload engine reduce the overhead of processing network packets on the host processor?</p><p>它是否提高了网络性能(即它能否更好地参与更广泛的平台)？您的新网络卸载引擎是否降低了在主机处理器上处理网络数据包的开销？</p><p> Can it improve debuggability or availability of the platform?  Does your new debugging mechanism reduce the reliance on reproducing obscure bugs in the lab that can take millions or hours to encounter?  Does your new scheme enable security patches of host OS while minimizing disruption to guest VMs?</p><p>它能否提高平台的可调试性或可用性？您的新调试机制是否减少了对在实验室中复制可能需要数百万或数小时才能遇到的模糊错误的依赖？您的新方案是否启用了主机操作系统的安全补丁，同时最大限度地减少了对来宾VM的中断？</p><p> When a processor is no longer the top-level system to be designed, then while performance and power remain important, improved value to the larger system in terms of meta-metrics like manageability, security, debuggability, and availability should also receive top billing.  To be more general, when designing any system, it behooves the architect to look up, down, left, right, and pop out a few levels to ensure that there is consideration of end-to-end implications.  We don’t want to be like the story of the blind men with the elephant – feeling the trunk and declaring that elephants are shaped like snakes.</p><p>当处理器不再是要设计的顶层系统时，尽管性能和能力仍然很重要，但在可管理性、安全性、可调试性和可用性等度量指标方面对更大的系统的改进价值也应该是最重要的。更一般地说，当设计任何系统时，架构师理应向上、向下、向左、向右并弹出几个级别，以确保考虑到端到端的影响。我们不想像盲人与大象的故事一样-摸着鼻子，宣布大象的形状像蛇。</p><p> About the Author:  Lisa Hsu is a Principal Engineer at Microsoft in the Azure Compute group, working on strategic initiatives for datacenter deployment.</p><p>关于作者：Lisa Hsu是微软Azure Compute小组的首席工程师，致力于数据中心部署的战略计划。</p><p> Disclaimer:  These posts are written by individual contributors to share their thoughts on the Computer Architecture Today blog for the benefit of the community. Any views or opinions represented in this blog are personal, belong solely to the blog author and do not represent those of ACM SIGARCH or its parent organization, ACM.</p><p>免责声明：这些帖子是由个人撰稿人撰写的，以分享他们对今日计算机体系结构博客的看法，以造福于社区。本博客中所代表的任何观点或观点均为个人观点，仅属于博客作者，不代表ACM SIGARCH或其上级组织ACM的观点或观点。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.sigarch.org/the-importance-of-end-to-end-thinking-in-system-design/">https://www.sigarch.org/the-importance-of-end-to-end-thinking-in-system-design/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/思维/">#思维</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/系统/">#系统</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/thinking/">#thinking</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/考虑/">#考虑</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1030191.html"><img src="http://img2.diglog.com/img/2020/10/thumb_a2886c7db03f7e5e98ddf60a8289f491.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030191.html">设计模式、Smalltalk和失落的代码阅读艺术</a></div><span class="my_story_list_date">2020-10-21 6:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030011.html"><img src="http://img2.diglog.com/img/2020/10/thumb_eb045778f5e66ac1d4e88a033693afbc.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030011.html">IPhone12评论：拥有出色的摄像头、显示屏和设计，前景看好MagSafe生态系统，但电池续航时间不如iPhone11，而且价格更高</a></div><span class="my_story_list_date">2020-10-20 22:8</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030005.html"><img src="http://img2.diglog.com/img/2020/10/thumb_6190c29453fd902ddef6e49ae5861fd4.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030005.html">
3D和AR设计平台Vecary从EQT和Blueyard融资730万美元</a></div><span class="my_story_list_date">2020-10-20 20:10</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029994.html"><img src="http://img2.diglog.com/img/2020/10/thumb_256cb765288069b7be3612c98d738748.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029994.html">特斯拉在承认Model 3设计缺陷的同时大幅削减了二手车保修</a></div><span class="my_story_list_date">2020-10-20 18:15</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>