<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>一周的NixOS</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">一周的NixOS</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-08 19:37:48</div><div class="page_narrow text-break page_content"><p>Reading time: 3 minutes.  As you may have saw I on Mastodon, I am testing NixOS for over a week now and here is a few comments about how the distro works and what doesn’t work for me.</p><p>阅读时间：3分钟。正如你可能已经在Mastodon上看到的，我测试NixOS已经一个多星期了，下面是关于这个发行版如何工作以及哪些不适合我的一些评论。</p><p> First of all, everything is NixOS is declared in a configuration file located at  /etc/nixos/configuration.nix where you declare packages you want to install, services to start, udev rules, ect, you get it.</p><p>首先，所有东西都是NixOS在一个配置文件中声明的，该配置文件位于/etc/nixos/Configuration.nix，您可以在其中声明要安装的包、要启动的服务、udev规则等。</p><p> This is the first very weird thing as you don’t really install packages with the cli directly (even if you can), instead you modify the config file and rebuild the system with  nixos-rebuild switch.</p><p>这是第一件非常奇怪的事情，因为您并不是真正使用cli直接安装包(即使可以)，而是使用nixos-rebuild开关修改配置文件并重新构建系统。</p><p> NixOS is made in such a way that everything aims to be reproductible. An example: if you want to get the exact same setup as I have, you can just take  my configs repo, clone it on your NixOS installation, run  nixos-rebuild switch and voila, you will have the exact same programs as me installed in the same way with the same version (roughly).</p><p>NixOS的制作方式是一切都以可重现为目标。举个例子：如果你想得到和我完全一样的设置，你只需要获取我的配置repo，在你的NixOS安装上克隆它，运行nixos-rebuild开关，然后瞧，你就会以同样的方式安装和我完全相同的程序，用相同的版本(大致)。</p><p>  {  config ,  pkgs ,  ...  }: {  users . groups . plugdev  =  {};  users . users . jae  =  {  isNormalUser  =  true ;  extraGroups  =  [  &#34;wheel&#34;  &#34;docker&#34;  &#34;adbusers&#34;  &#34;plugdev&#34;  ];  shell  =  pkgs . zsh ;  packages  =  with  pkgs ;  [  # Games  minetest  stepmania  lutris-free  pcsx2  # Misc audio / video / image  pulseeffects  ffmpeg-full  obs-studio  inkscape  krita  # Useful software  mumble  qbittorrent  libreoffice  ledger-live-desktop  # Dev  jetbrains . idea-community  lazygit  gnome3 . zenity  insomnia  jetbrains . rider  mono  msbuild  dotnet-sdk_3  ganttproject-bin  kubectx  # SDR  rtl-sdr  gqrx  gpredict  noaa-apt  welle-io  ];  };  users . extraGroups . vboxusers . members  =  [  &#34;jae&#34;  ]; }</p><p>{config，pkgs，...}：{用户。群组。Plugdev={}；用户。用户。JAE={isNormalUser=true；ExtraGroups=[&#34；车轮&#34；&#34；码头&#34；&#34；adbusers&#34；&#34；plugdev&#34；]；外壳=包。Zsh；Packages=with pkgs；[#Games minetest step mania lutris-free pcsx2#Misc Audio/Video/Image PulseEffects ffmpeg-Full obs-studio Inkscape krita#Usful Software Mumble qbittorrent LibreOffice Ledger-live-Desktop#Dev JetBrains。Idea-社区懒鬼侏儒3。Zenity失眠JetBrains。骑手msbuild dotnet-sdk_3 ganttproject-bin kubectx#sdr rtl-sdr gqrx grecast NOAA-apt Welle-io]；}；用户。Extra Groups。Vbox用户。会员=[&#34；jae&#34；]；}。</p><p>  Creates a group named  plugdev, don’t pay attention to it, it is just a test for the Ledger Live application.</p><p>创建一个名为plugdev的组，不要注意它，它只是对Ledger Live应用程序的测试。</p><p> Tells the os that the current user is a normal one. It will create a home folder and set the default shell.</p><p>告诉OS当前用户是普通用户。它将创建一个主文件夹并设置默认外壳。</p><p>  As you may have guessed it, we are setting the default user shell to ZSH.</p><p>正如您可能已经猜到的那样，我们将默认用户外壳设置为ZSH。</p><p> packages  =  with  pkgs ;  [  # Games  minetest  stepmania  lutris-free  pcsx2  # Misc audio / video / image  pulseeffects  ffmpeg-full  obs-studio  inkscape  krita  # Useful software  mumble  qbittorrent  libreoffice  ledger-live-desktop  # Dev  jetbrains . idea-community  lazygit  gnome3 . zenity  insomnia  jetbrains . rider  mono  msbuild  dotnet-sdk_3  ganttproject-bin  kubectx  # SDR  rtl-sdr  gqrx  gpredict  noaa-apt  welle-io  ];</p><p>Packages=with pkgs；[#Games minetest step mania lutris-free pcsx2#Misc Audio/Video/Image PulseEffects ffmpeg-Full obs-studio Inkscape krita#Usful Software Mumble qbittorrent LibreOffice Ledger-live-Desktop#Dev JetBrains。Idea-社区懒鬼侏儒3。Zenity失眠JetBrains。骑手msbuild dotnet-sdk_3 ganttproject-bin kubectx#sdr rtl-sdr gqrx grecast NOAA-apt Welle-io]；</p><p>There, we are installing per-user packages because yes, NixOS supports that, any user can have its own packages that others users can’t access.</p><p>在那里，我们正在安装每个用户的包，因为是的，NixOS支持这一点，任何用户都可以拥有其他用户无法访问的自己的包。</p><p> This could be useful in a professional setting where only certain groups/users need a package. You could use the same config for everyone but only the right people access the right software.</p><p>在只有某些组/用户需要包的专业设置中，这可能很有用。您可以对每个人使用相同的配置，但只有合适的人才能访问合适的软件。</p><p> Configuring NixOS for a daily use is at the end very easy (althrough I am getting some trouble to get Ledger Live working; which is the biggest problem I’ve had so far).</p><p>最后，将NixOS配置为日常使用非常容易(尽管我在让Ledger Live工作时遇到了一些麻烦，这是我到目前为止遇到的最大问题)。</p><p> Now, let’s talk about where I got some trouble.As you may know it, I am a dev and every day I need to compile, test, run and so on.NixOS gave me some trouble to only run some programs from source such as  Element Desktop or  TeDomum IMG as the way the system is built, lots of directories are read-only and programs can’t be installed globally through NPM or PIP.I ended up using Docker to build the apps (even if it took a bit more time).</p><p>现在，让我们来谈谈我遇到麻烦的地方。正如你可能知道的，我是一名开发人员，每天我都需要编译、测试、运行等等。NixOS给我带来了一些麻烦，因为在构建系统的时候，我只能从Element Desktop或TeDomum img等源代码运行一些程序，很多目录都是只读的，不能通过NPM或PIP全局安装程序。我最终使用Docker来构建应用程序(尽管这需要更多的时间)。</p><p> Needless to say, almost every other project worked.If you want NodeJS to start a project for instance, you can just do  nix-shell -p nodejs and here you go, a shell with nodejs installed, ready to do what you want.</p><p>不用说，几乎所有其他项目都能正常运行。例如，如果您想让NodeJS启动一个项目，只需执行nix-Shell-p NodeJS，然后就可以了，一个安装了NodeJS的Shell，随时可以做您想做的事情。</p><p> At the end, NixOS brings very interesting concepts such as a really great reproducibility but new users can feel lost as its way to work is really different from conventional Linux distributions.I’ll give NixOS more time and write a follow-up in some time to see how everything went.</p><p>最后，NixOS带来了非常有趣的概念，比如非常好的重现性，但新用户可能会感到迷失，因为它的工作方式与传统的Linux发行版非常不同。我会给NixOS更多的时间，并在一段时间内写一篇后续文章，看看一切都进行得如何。</p><p> That’s all for today,I’ll see you next time!If you like my content,  don’t forget to subscribe throught RSS!</p><p>今天到此为止，下次见！如果你喜欢我的内容，别忘了通过RSS订阅！</p><p>  Talk about it on Hacker News!</p><p>在黑客新闻上谈论这件事吧！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://jae.moe/blog/2020/11/one-week-of-nixos/">https://jae.moe/blog/2020/11/one-week-of-nixos/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/nixos/">#nixos</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/week/">#week</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>