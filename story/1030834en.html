<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>通过机器学习和Slither-Simil进行高效的智能合同安全审计</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">通过机器学习和Slither-Simil进行高效的智能合同安全审计</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-24 07:33:01</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/7834e30c39db3bc92e5432823b727006.png"><img src="http://img2.diglog.com/img/2020/10/7834e30c39db3bc92e5432823b727006.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Trail of Bits has manually curated a wealth of data—years of security assessment reports—and now we’re exploring how to use this data to  make the smart contract auditing process more efficient with Slither-simil.</p><p>BITS跟踪已经手动管理了大量数据-多年的安全评估报告-现在我们正在探索如何使用这些数据通过Slither-simil提高智能合同审核流程的效率。</p><p> Based on accumulated knowledge embedded in previous audits, we set out to detect similar vulnerable code snippets in new clients’ codebases. Specifically, we explored machine learning (ML) approaches to automatically improve on the performance of Slither, our static analyzer for Solidity, and make life a bit easier for both auditors and clients.</p><p>基于先前审计中积累的知识，我们着手在新客户的代码库中检测类似的易受攻击的代码片段。具体地说，我们探索了机器学习(ML)方法，以自动改进Slither(我们的静态稳固性分析器)的性能，并使审计师和客户的工作变得更容易。</p><p>  Currently, human auditors with expert knowledge of Solidity and its security nuances scan and assess Solidity source code to discover vulnerabilities and potential threats at different granularity levels. In our experiment, we explored how much we could automate security assessments to:</p><p>目前，具有可靠性及其安全细微差别的专业知识的人类审核员扫描和评估可靠性源代码，以发现不同粒度级别的漏洞和潜在威胁。在我们的实验中，我们探索了可以在多大程度上自动化安全评估以实现以下目标：</p><p> Minimize the risk of recurring human error, i.e., the chance of overlooking known, recorded vulnerabilities.</p><p>最大限度地降低再次出现人为错误的风险，即忽略已知的、记录的漏洞的机会。</p><p> Help auditors sift through potential vulnerabilities faster and more easily while decreasing the rate of false positives.</p><p>帮助审计人员更快、更轻松地筛选潜在漏洞，同时降低误报率。</p><p>  Slither-simil, the statistical addition to Slither, is a code similarity measurement tool that uses state-of-the-art machine learning to detect similar Solidity functions. When it began as an experiment last year under the codename crytic-pred, it was used to vectorize Solidity source code snippets and measure the similarity between them. This year, we’re taking it to the next level and applying it directly to vulnerable code.</p><p>Slither-SIMIL是对Slither的统计添加，是一种代码相似性度量工具，它使用最先进的机器学习来检测类似的坚固性函数。去年，当它作为代号为Crytic-pred的实验开始时，它被用来向量化坚固性源代码片段，并测量它们之间的相似性。今年，我们将把它提升到下一个层次，并将其直接应用于易受攻击的代码。</p><p> Slither-simil currently uses its own representation of Solidity code, SlithIR (Slither Intermediate Representation), to encode Solidity snippets at the granularity level of functions. We thought function-level analysis was a good place to start our research since it’s not too coarse (like the file level) and not too detailed (like the statement or line level.)</p><p>Slither-SIMIL目前使用其自己的坚固性代码表示Slither Intermediate(Slither Intermediate Presentation，滑动中间表示)来在函数的粒度级别编码坚实度片段。我们认为函数级分析是开始研究的好地方，因为它不会太粗略(如文件级)，也不会太详细(如语句或行级)。</p><p>   In the process workflow of Slither-simil, we first manually collected vulnerabilities from the previous archived security assessments and transferred them to a vulnerability database. Note that these are the vulnerabilities auditors had to find with no automation.</p><p>在Slither-SIMIL的工作流程中，我们首先从以前归档的安全评估中手动收集漏洞，并将其传输到漏洞数据库。请注意，这些都是审计人员必须在没有自动化的情况下发现的漏洞。</p><p> After that, we compiled previous clients’ codebases and matched the functions they contained with our vulnerability database via an automated function extraction and normalization script. By the end of this process, our vulnerabilities were normalized SlithIR tokens as input to our ML system.</p><p>之后，我们编译了以前客户的代码库，并通过自动函数提取和归一化脚本将它们包含的函数与我们的漏洞数据库进行匹配。在此过程结束时，我们的漏洞被标准化的SlitIR标记作为我们ML系统的输入。</p><p> Here’s how we used Slither to transform a Solidity function to the intermediate representation SlithIR, then further tokenized and normalized it to be an input to Slither-simil:</p><p>下面是我们如何使用Slither将固态函数转换为中间表示Slither IR，然后将其进一步标记化和规范化以作为Slither-simil的输入：</p><p>     First, we converted every statement or expression into its SlithIR correspondent, then tokenized the SlithIR sub-expressions and further normalized them so more similar matches would occur despite superficial differences between the tokens of this function and the vulnerability database.</p><p>首先，我们将每个语句或表达式转换为其对应的SlitIR，然后对SlitIR子表达式进行标记化，并进一步对其进行规范化，以便尽管此函数的标记与漏洞数据库之间存在表面差异，但仍会出现更相似的匹配。</p><p>   After obtaining the final form of token representations for this function, we compared its structure to that of the vulnerable functions in our vulnerability database. Due to the modularity of Slither-simil, we used various ML architectures to measure the similarity between any number of functions.</p><p>在获得此函数的最终令牌表示形式后，我们将其结构与漏洞数据库中易受攻击的函数的结构进行了比较。由于Slither-SIMIL的模块性，我们使用了不同的ML体系结构来衡量任意数量的功能之间的相似性。</p><p>  Figure 5: Using Slither-simil to test a function from a smart contract with an array of other Solidity contracts.</p><p>图5：使用Slither-SIMIL测试来自智能合约和一组其他稳固合约的功能。</p><p> Let’s take a look at the function transferFrom from the ETQuality.sol smart contract to see how its structure resembled our query function:</p><p>让我们看看ETQuality.sol智能契约中的函数transfer From，看看它的结构与我们的查询函数有什么相似之处：</p><p>   Comparing the statements in the two functions, we can easily see that they both contain, in the same order, a binary comparison operation (&gt;= and &lt;=), the same type of operand comparison, and another similar assignment operation with an internal call statement and an instance of returning a “true” value.</p><p>比较这两个函数中的语句，我们可以很容易地看到，它们都以相同的顺序包含一个二进制比较操作(&gt；=和&lt；=)、相同类型的操作数比较，以及另一个类似的赋值操作，其中包含一个内部调用语句和一个返回“true”值的实例。</p><p> As the similarity score goes lower towards 0, these sorts of structural similarities are observed less often and in the other direction; the two functions become more identical, so the two functions with a similarity score of 1.0 are identical to each other.</p><p>随着相似性分数越低，这种结构相似性越少，而且是在相反的方向上；这两个功能变得更加相同，因此相似性分数为1.0的两个功能彼此相同。</p><p>  Research on automatic vulnerability discovery in Solidity has taken off in the past two years, and tools like  Vulcan and  SmartEmbed, which use ML approaches to discovering vulnerabilities in smart contracts, are showing promising results.</p><p>在过去的两年里，关于Solity中的自动漏洞发现的研究已经开始，像Vulcan和SmartEmbed这样的工具，它们使用ML方法来发现智能合同中的漏洞，正在显示出令人振奋的结果。</p><p> However, all the current related approaches focus on vulnerabilities already detectable by static analyzers like Slither and Mythril, while our experiment focused on the vulnerabilities these tools were not able to identify—specifically, those undetected by Slither.</p><p>然而，目前所有的相关方法都集中在静态分析器(如Slither和Mythril)已经可以检测到的漏洞上，而我们的实验则集中在这些工具无法识别的漏洞上-具体地说，就是那些没有被Slither检测到的漏洞。</p><p> Much of the academic research of the past five years has focused on taking ML concepts (usually from the field of natural language processing) and using them in a development or code analysis context, typically referred to as code intelligence. Based on previous, related work in this research area, we aim to bridge the semantic gap between the performance of a human auditor and an ML detection system to discover vulnerabilities, thus complementing the work of Trail of Bits human auditors with automated approaches (i.e.,  Machine Programming, or MP).</p><p>过去五年的大部分学术研究都集中在提取ML概念(通常来自自然语言处理领域)，并在开发或代码分析上下文中使用它们，通常称为代码智能。在此研究领域以前相关工作的基础上，我们的目标是弥合人类审计师和ML检测系统之间的语义鸿沟，以发现漏洞，从而用自动化方法(即机器编程，MP)来补充Trail of BITS人类审计师的工作。</p><p>  We still face the challenge of data scarcity concerning the scale of smart contracts available for analysis and the frequency of interesting vulnerabilities appearing in them. We can focus on the ML model because it’s sexy but it doesn’t do much good for us in the case of Solidity where even the language itself is very young and we need to tread carefully in how we treat the amount of data we have at our disposal.</p><p>我们仍然面临数据稀缺的挑战，涉及可供分析的智能合同的规模以及其中出现有趣漏洞的频率。我们可以专注于ML模型，因为它很吸引人，但在稳定的情况下，它对我们没有太大的好处，因为即使是语言本身也很年轻，我们需要谨慎对待我们拥有的大量数据。</p><p> Archiving previous client data was a job in itself since we had to deal with the different solc versions to compile each project separately. For someone with limited experience in that area this was a challenge, and I learned a lot along the way. (The most important takeaway of my summer internship is that if you’re doing machine learning, you will not realize how major a bottleneck the data collection and cleaning phases are unless you have to do them.)</p><p>存档以前的客户数据本身就是一项工作，因为我们必须处理不同的Solc版本来分别编译每个项目。对于在这一领域经验有限的人来说，这是一个挑战，我在这一过程中学到了很多东西。(我暑期实习最重要的收获是，如果你在做机器学习，你不会意识到数据收集和清理阶段的瓶颈有多大，除非你必须这样做。)。</p><p>   The pie chart shows how 89 vulnerabilities were distributed among the 10 client security assessments we surveyed. We documented both the notable vulnerabilities and those that were not discoverable by Slither.</p><p>饼图显示了89个漏洞在我们调查的10个客户端安全评估中的分布情况。我们记录了值得注意的漏洞和Slither无法发现的漏洞。</p><p>  This past summer we resumed the development of Slither-simil and SlithIR with two goals in mind:</p><p>在刚刚过去的这个夏天，我们怀着两个目标继续开发Slither-simil和Slither-simil：</p><p>  We implemented the baseline text-based model with FastText to be compared with an improved model with a tangibly significant difference in results; e.g., one not working on software complexity metrics, but focusing solely on graph-based models, as they are the most promising ones right now.</p><p>我们使用FastText实现了基于文本的基线模型，并将其与结果有明显显著差异的改进模型进行比较；例如，不研究软件复杂性度量，而只关注基于图形的模型，因为它们是目前最有前途的模型。</p><p> For this, we have proposed a slew of techniques to try out with the Solidity language at the highest abstraction level, namely, source code.</p><p>为此，我们提出了一系列在最高抽象级别(即源代码)尝试使用固态语言的技术。</p><p> To develop ML models, we considered both supervised and unsupervised learning methods. First, we developed a baseline unsupervised model based on tokenizing source code functions and embedding them in a Euclidean space (Figure 8) to measure and quantify the distance (i.e., dissimilarity) between different tokens. Since functions are constituted from tokens, we just added up the differences to get the (dis)similarity between any two different snippets of any size.</p><p>为了建立ML模型，我们同时考虑了监督和非监督学习方法。首先，我们开发了一个基于标记化源代码函数并将其嵌入欧几里得空间(图8)的基线非监督模型，以度量和量化不同标记之间的距离(即，相异度)。因为函数是由标记组成的，所以我们只需将差异相加，就可以得到任意大小的任意两个不同片段之间的(反)相似性。</p><p> The diagram below shows the SlithIR tokens from a set of training Solidity data spherized in a three-dimensional Euclidean space, with similar tokens closer to each other in vector distance. Each purple dot shows one token.</p><p>下图显示了来自在三维欧几里德空间中球化的一组训练稠度数据的SlitIR令牌，其中相似的令牌在矢量距离上彼此更接近。每个紫点显示一个代币。</p><p>   We are currently developing a proprietary database consisting of our previous clients and their publicly available vulnerable smart contracts, and references in papers and other audits. Together they’ll form one unified comprehensive database of Solidity vulnerabilities for queries, later training, and testing newer models.</p><p>我们目前正在开发一个专有数据库，其中包括我们以前的客户及其公开可用的易受攻击的智能合同，以及论文和其他审计中的参考资料。它们将共同形成一个统一的、全面的安全漏洞数据库，用于查询、以后的培训和测试较新的模型。</p><p> We’re also working on other unsupervised and supervised models, using data labeled by static analyzers like Slither and Mythril. We’re examining deep learning models that have much more expressivity we can model source code with—specifically, graph-based models, utilizing abstract syntax trees and control flow graphs.</p><p>我们还在研究其他无监督和有监督的模型，使用由Slither和Mythril等静态分析器标记的数据。我们正在研究的深度学习模型具有更强的表现力，我们可以利用抽象语法树和控制流图为源代码建模-具体地说，就是基于图形的模型。</p><p> And we’re looking forward to checking out Slither-simil’s performance on new audit tasks to see how it improves our assurance team’s productivity (e.g., in triaging and finding the low-hanging fruit more quickly). We’re also going to test it on Mainnet when it gets a bit more mature and automatically scalable.</p><p>我们期待着检查Slither-simil在新审计任务上的表现，看看它如何提高我们保证团队的工作效率(例如，在分类和更快地找到容易摘到的果实方面)。我们还将在Mainnet上测试它，当它变得更成熟和自动可伸缩时。</p><p> You can try Slither-simil now on  this Github PR. For end users, it’s the simplest CLI tool available:</p><p>你现在可以在这款Github公关上试试Slither-simil。对于最终用户，它是可用的最简单的CLI工具：</p><p> Input one or multiple smart contract files (either directory, .zip file, or a single .sol).</p><p>输入一个或多个智能合同文件(目录、.zip文件或单个.sol)。</p><p> Identify a pre-trained model, or separately train a model on a reasonable amount of smart contracts.</p><p>确定一个预先培训的模型，或单独培训一个模型，使其具有合理数量的智能合同。</p><p>   Slither-simil is a powerful tool with potential to measure the similarity between function snippets of any size written in Solidity. We are continuing to develop it, and based on current results and recent related research, we hope to see impactful real-world results before the end of the year.</p><p>Slither-simil是一种功能强大的工具，有可能测量以实心编写的任意大小的函数片段之间的相似性。我们正在继续开发它，基于目前的结果和最近的相关研究，我们希望在今年年底之前看到有影响力的现实世界结果。</p><p> Finally, I’d like to thank my supervisors Gustavo, Michael, Josselin, Stefan, Dan, and everyone else at Trail of Bits, who made this the most extraordinary internship experience I’ve ever had.</p><p>最后，我要感谢我的上级Gustavo，Michael，Josselin，Stefan，Dan，以及Trail of Bits的其他所有人，是他们让这次实习经历成为我有生以来最不平凡的经历。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.trailofbits.com/2020/10/23/efficient-audits-with-machine-learning-and-slither-simil/">https://blog.trailofbits.com/2020/10/23/efficient-audits-with-machine-learning-and-slither-simil/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/学习/">#学习</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/smart/">#smart</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1030199.html"><img src="http://img2.diglog.com/img/2020/10/thumb_37ecd395986ee9e77210d01214c6851f.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030199.html">太多的人工智能研究人员认为现实世界的问题无关紧要</a></div><span class="my_story_list_date">2020-10-21 7:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030055.html"><img src="http://img2.diglog.com/img/2020/10/thumb_feddd3c63be51cbfdf0157dd7226aed9.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030055.html">为什么深度学习能奏效，尽管它不应该奏效</a></div><span class="my_story_list_date">2020-10-20 22:43</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029997.html"><img src="http://img2.diglog.com/img/2020/10/thumb_21d3b5269f61adde3980ceb7bd5f090d.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029997.html">
数学学习平台KnowledgeHook募集1350万GB A系列向全球扩张</a></div><span class="my_story_list_date">2020-10-20 19:8</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029787.html"><img src="http://img2.diglog.com/img/2020/10/thumb_e53752bd18d47c7f19ff44e8b34448be.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029787.html">如何学习编程：成为软件工程师的路线图</a></div><span class="my_story_list_date">2020-10-19 20:54</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>