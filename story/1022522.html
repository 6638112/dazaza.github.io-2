<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我以审阅代码为生，以下是我最常见的审阅评论</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">我以审阅代码为生，以下是我最常见的审阅评论</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-07 16:51:05</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/8fa75311f67529a137d2eefabb92d983.jpeg"><img src="http://img2.diglog.com/img/2020/9/8fa75311f67529a137d2eefabb92d983.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>你的代码读起来应该和你读过的任何其他引人入胜的故事一样。它应该从介绍你的主要“人物”开始，然后建立上下文，最后应该详细解释在什么时间发生在谁身上的事情。就像“契诃夫的枪”一样，如果你引入了某种价值，它一定是有目的的。</p><p>然而，仅仅在故事中有一个人的目的是不够的，为什么一个人是这样被介绍(或命名)的，这一点也应该不言而喻。</p><p>现在您一定已经听过无数次了，“代码只写一次，读几次”。因为这是真的。我甚至记不清我必须一遍又一遍地检查同一段代码多少次。有时，也许是为了找出一个bug，有时是为了向PM解释一些功能，有时是为了向新的团队成员解释一些功能。</p><p>因此，编写一段读起来像英文文本的代码非常有意义。这样以后就更容易理解了。并不是说人们想要故意编写神秘的代码。我的观点是，人们永远不会试图从别人的角度重新解读它。</p><p>当我们开始编写代码时，我们在头脑中构建了所有这些流程图、分支和逻辑，我们只是将它们作为一个过程放入编辑器中，并开始尝试使其工作。因为只有您编写了这段代码，所以理解它不会有任何问题。你记忆犹新，你知道为什么要设置这样的条件，但对将来阅读这段代码的人来说可能不是这样的。那个人甚至可能就是你自己。</p><p>我以审查代码为生，我看到了人们在编写产品代码时会遇到的一些常见问题。我不想谈论花哨的算法和用尽可能少的行重写代码的聪明方法。我相信你自己就能找到这些。</p><p>让代码变得愚蠢，让编码器变得聪明。愚蠢的代码总是比聪明的代码好。</p><p>以下是评论中重复次数最多的一些评论。这些评论大多是关于代码的可读性和可维护性的，其中一些是为了更好地调试。</p><p>字典是最懒惰的数据结构。当然，它又快又方便。但是不要过度使用它。如果您最终将字典作为函数参数进行传递，那么您就做错了事情。字典最多只能作为局部变量保存。</p><p>这有几个原因。首先，字典对于键/值映射没有任何约定，无论是基于键的存在还是基于类型。最终，您可能会对密钥进行大量的是否存在检查。这会使您的代码难看。在静态类型语言中，虽然您可以确保键上的类型，但您仍然必须检查键是否存在。</p><p>第二个原因是它的文档不好。代码的读取器不知道预期的键和值是什么。</p><p>例如，在上面的代码片段中，您不知道incomingEvent中需要什么样的键和值。您必须逐行阅读代码才能理解每个键/值对的用途。不过，对于您来说，很难清楚地描绘出传入事件的全部组成，因为它可能有一些当前在process方法中没有使用的键。</p><p>与此形成对比的是，拥有一个简单的对象就所有字段和值在传入事件中应该存在的方面而言显示了清晰的约定。这是更好的文档。</p><p>正确的数据模型能够在代码中尽可能完美地表示现实世界中的对象。</p><p>例如，我见过使用int表示数据库中一天中的时间的实例。类似于：</p><p>然后它进行了一次复杂的计算，从(Int)时间值中找出小时和分钟。</p><p>与其这样做，不如(虽然不完美)将它们保留为字符串，比如DND_START_TIME=&#39；15：30&#39；。但是，如果可能的话，最好的想法是使用语言内置的对象来表示这一点。</p><p>类似的例子有作为整型或浮点型的货币、用于树/图的字典、用于布尔值的字符串(或整型)。</p><p>切勿更改您不拥有的任何数据。这意味着函数不应该改变它作为参数获得的值。这可能会导致灾难性的后果。例如，我曾经在一次公关中看到过这一点。</p><p>Def GET_ONLY_REQUIRED_VALIDATION(VALIDATIONS)：#放弃对`Executed`的验证，`filter_type`_=[validations.op(Key)for key in(&#39；Executed&#39；，&#39；filter_type&#39；)]返回验证。</p><p>此示例从验证字典中永久删除EXECUTED和FILTER_TYPE值。如果呼叫者没有意识到这一点，这可能会在以后导致严重的问题。</p><p>Def GET_ONLY_REQUIRED_VALIDATION(验证)：如果k不在[&#39；Executed&#39；，&#39；Filter_TYPE&#39；]中，则返回{k：v表示k，v表示validations.item()}。</p><p>这不会改变任何值，它会返回一个仅包含所需验证的新字典。</p><p>在构建API时，最好捕获所有异常并返回一个自定义异常，这样可以更好地传达异常的含义。</p><p>例如，以下几行是API的一部分，它从匹配的过滤器中返回第一个项目。</p><p>这种情况下的问题是从第一行查询返回的广告为空。在这种情况下，第二行将抛出IndexError。抛出像ItemNotFound这样的异常更好。</p><p>当函数参数在开始时没有检查None(NULL)值时，这种情况会发生很多次，当稍后在函数中使用时，它们会抛出异常，如`NoneType对象没有属性attr`(NPE)。最好在函数开始时检查NONE，并引发适当的异常或默认值为其他值。</p><p>但是，您不需要在自定义异常主体中不必要地包装相同的异常类型。如果现有异常在API上下文中仍然有意义，则可以跳过编写自定义异常类。例如，从缓存API抛出的KeyError和Value错误是有意义的。</p><p>一个函数在代码中不应该有太多的返回语句。它污染了控制流，使其更难遵循。尽量保留最多两个返回，1)第一级数据健全性检查2)最终结果。</p><p>Def COMPUTE_RESULT(a，b)：如果(a，b)中没有：返回0#某个默认值c=涉及a&amp；b的某个计算返回c。</p><p>在动态类型语言中，不检查返回值的数据类型。出于懒惰或任何其他原因，您可能会简单地在同一函数中的两个不同位置返回两种不同的数据类型。</p><p>这是一项严重的犯罪行为。不要那样做。这完全违背了所有的软件开发原则。它使整个软件的理智受到质疑；甚至可能使开发人员的理智受到质疑；)</p><p>从调试的角度来看，这是重要的问题之一。将日志放在所有意外的返回位置可以确保您可以更快地调试问题。</p><p>在上面的示例中，将一些日志放在返回之前。这将为您将来节省很多时间。</p><p>这是我注意到的另一件事，初级开发人员，有时也是高级开发人员，错过了。使用try-catch将循环体包围起来，以避免在其中一个循环体执行失败时意外中断循环。当然，除非这是你想要的那种行为。</p><p>不要使用不明确的函数或类名，因为它们要么没有任何特殊含义，要么没有表达类/函数应该做的事情。如果我命名两个函数类：ControlDatabaseQuery&amp；HandleDatabaseQuery，它们不会告诉代码的读者它们正在控制或处理的确切内容是什么。</p><p>在设计解决方案时，您可能最终会遇到当前系统状态与其应有状态不同的情况。可能是某些不能具有特定类型的值，或者是不能为空的数据容器，或者缓存中不应该出现在TTL之后的某些记录(如果它是这样设计的)，等等。</p><p>不要忽视系统的不一致状态。它们是系统中有问题的明显迹象。要么是开发人员在开发时的假设不正确，要么是某些数据已损坏。为此放置错误/信息日志，并且/或者如果您使用类似哨兵的服务，也应该在那里捕获它。</p><p>I)应该通过某个后台工作在到期时向服务注册的记录(或事件)。如果在另一个控制流中遇到a记录，而该记录在过期时间很久之后还没有注册。这是不一致状态的一个例子。</p><p>Ii)总是期望由某些终端用户输入并且没有默认值的某些字段值。有验证放入字段以检查是否为空。但是，如果字段值仍然为空，则这是另一种不一致状态。除非在数据模型中指定，否则不要在此级别采用任何默认值。您必须为此引发异常。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/@surajarya/i-review-code-for-a-living-and-these-are-my-most-common-review-comments-4c178f135c4a">https://medium.com/@surajarya/i-review-code-for-a-living-and-these-are-my-most-common-review-comments-4c178f135c4a</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/审阅/">#审阅</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/review/">#review</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1022304.html"><img src="http://img2.diglog.com/img/2020/9/thumb_9fd6286abe7526a3b5300e46203f7c88.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1022304.html">
作为其投资论文的一部分，一家风险投资公司是如何以无代码初创公司告终的</a></div><span class="my_story_list_date">2020-9-6 8:49</span></div><div class="col-sm"><div><a target="_blank" href="/story/1022280.html"><img src="http://img2.diglog.com/img/2020/9/thumb_ebb9d1a86170c0fa5837d3473f25b4fc.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1022280.html">为了先发制人，印度的15家OTT服务，包括迪士尼Hotstar、亚马逊Prime Video、Netflix和MX Player，都采用了自律代码</a></div><span class="my_story_list_date">2020-9-6 1:28</span></div><div class="col-sm"><div><a target="_blank" href="/story/1022112.html"><img src="http://img2.diglog.com/img/2020/9/thumb_945dc0427ab3bc9d34dddee4b2fb01b9.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1022112.html">为您编写更好的Python代码的LINT框架</a></div><span class="my_story_list_date">2020-9-4 22:16</span></div><div class="col-sm"><div><a target="_blank" href="/story/1022088.html"><img src="http://img2.diglog.com/img/2020/9/thumb_13ccd71b29e6b971de38c95e32fbe33f.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1022088.html">VS代码扩展我用来提高工作效率</a></div><span class="my_story_list_date">2020-9-4 18:11</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>