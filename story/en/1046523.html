<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plotnine：Python图形语法 Plotnine: Grammar of Graphics for Python</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Plotnine: Grammar of Graphics for Python<br/>Plotnine：Python图形语法 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-29 05:03:52</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/1/2fcaab111caaf83e8be647706bc81055.jpg"><img src="http://img2.diglog.com/img/2021/1/2fcaab111caaf83e8be647706bc81055.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>A translation of the visualisation chapters from “R for Data Science” to Python using Plotnine and Pandas.</p><p>使用Plotnine和Pandas将可视化章节从“ R for Data Science”翻译为Python。</p><p>    plotnine is a data visualisation package for Python based on the grammar of graphics, created by Hassan Kibirige. Its API is similar to  ggplot2, a widely successful R package by  Hadley Wickham and others.  1</p><p>    plotnine是Hassan Kibirige创建的基于图形语法的Python数据可视化程序包。它的API与ggplot2类似，后者是Hadley Wickham等人开发的非常成功的R软件包。 1个</p><p> I’m a staunch proponent of ggplot2. The underlying grammar of graphics is accompanied by a consistent API that allows you to quickly and iteratively create different types of beautiful data visualisations while rarely having to consult the documentation. A welcoming set of properties when doing exploratory data analysis.</p><p> 我是ggplot2的坚定支持者。图形的基本语法随附有一个一致的API，该API使您可以快速，迭代地创建不同类型的漂亮数据可视化，而几乎不必查阅文档。探索性数据分析时的一组受欢迎的属性。</p><p> I must admit that I haven’t tried every data visualisation package there is for Python, but when it comes to the most popular ones, I personally find them eitherconvenient but limited ( pandas),flexible but complicated ( matplotlib), orbeautiful but inconsistent ( seaborn). Your mileage may vary. plotnine, on the other hand, shows a lot of promise.I estimate it currently has a 95% coverage of ggplot2’s functionality, and it’s still actively being developed.All in all, as someone who uses both R and Python, I’m very pleased to be able to transfer my ggplot2 knowledge to the Python ecosystem.</p><p> 我必须承认，我并没有尝试过所有适用于Python的数据可视化软件包，但是当涉及到最受欢迎的软件包时，我个人发现它们既方便又有限（熊猫），灵活却复杂（matplotlib），或者既美观又不一致（ Seaborn）。你的旅费可能会改变。另一方面，plotine展示了很多前景，我估计它目前对ggplot2的功能覆盖率达到95％，并且仍在积极开发中。总而言之，作为同时使用R和Python的人，我非常很高兴能够将我的ggplot2知识转移到Python生态系统。</p><p> I figured that plotnine could use a good tutorial so that perhaps more Pythonistas would give this package a shot.Instead of writing one from scratch, I turned to the, in my opinion, best free tutorial for ggplot2:  R for Data Science by Hadley Wickham and Garrett Grolemund, published by O’Reilly Media in 2016.</p><p> 我认为plotnine可以使用一个很好的教程，以便也许更多的Pythonistas可以试一试这个包，而不是从头开始编写一个包，我转向了Hadley Wickham编写的ggplot2最佳免费教程和Garrett Grolemund，由O'Reilly Media在2016年出版。</p><p>  All I had to do was translate  2 the visualization chapters (chapter 3 and 28) from R and ggplot2 to Python and plotnine.I would like to thank Hadley, Garrett, and O’Reilly Media, for granting me permission to do so.Translating an existing text is quicker than writing a new one, and has the benefit that it becomes possible to compare both the syntax and coverage of plotnine to ggplot2.</p><p>  我要做的就是将R和ggplot2的可视化章节（第3章和第28章）翻译成Python和plotnine，我要感谢Hadley，Garrett和O'Reilly Media给予我这样做的许可。现有的文本比编写新的文本要快，并且具有可以将plotnine的语法和覆盖范围与ggplot2进行比较的优点。</p><p> However, while quicker, translating is not always straightforward.I have tried to change as little as possible to the original text while making sure that the text and the code are still in sync.In case any errors or falsehoods have been introduced due to translation, then I’m the one to blame.For example, to the best of my knowledge, neither authors have made any claims about plotnine.If you find such an error and think it is fixable, then it would be greatly appreciated if you’d let me know by  creating an issue on Github. Thank you.The section numbers in this tutorial link back to the corresponding section of the original text, in case you want to compare them.  3 Only this preface and the few footnotes scattered among the text are entirely mine.</p><p> 但是，虽然翻译速度更快，但翻译并不总是那么简单。我尝试了对原始文本进行尽可能少的更改，同时确保文本和代码仍保持同步。以防由于翻译而引入任何错误或错误之处，那么我就应该负责。例如，据我所知，没有任何作者对洛丁胺提出过任何主张。如果您发现这样的错误并认为它是可修复的，那么如果您d通过在Github上创建问题来通知我。谢谢。本教程中的章节编号链接回原始文本的相应章节，以备您进行比较。 3仅此序言和文本中散布的少量脚注完全是我的。 </p><p> This tutorial is also available as a  Jupyter notebook and an  R notebook in case you want to follow along.If you clone the  Github repository then you can find the notebooks in the  output directory.The  README contains instructions on how to run the notebooks.The Jupyter notebook is also available on  Binder, but keep in mind that the interactive version may take a while to launch.</p><p>本教程也可以作为Jupyter笔记本和R笔记本使用，如果您要继续学习的话，如果克隆Github存储库，则可以在输出目录中找到这些笔记本.README包含有关如何运行笔记本的说明。 Jupyter笔记本电脑也可在Binder上使用，但请记住，交互式版本可能需要一段时间才能启动。</p><p>      “The simple graph has brought more information to the data analyst’s mindthan any other device.” — John Tukey</p><p>      “简单的图表比其他任何设备都为数据分析师带来了更多信息。” —约翰·图基</p><p> This tutorial will teach you how to visualise your data using plotnine. Python has many packages for making graphs, but plotnine is one of the most elegant and most versatile. plotnine implements the  grammar of graphics, a coherent system for describing and building graphs. With plotnine, you can do more faster by learning one system and applying it in many places.</p><p> 本教程将教您如何使用Platenine可视化数据。 Python有许多用于制作图形的程序包，但plotnine是最优雅，功能最多的程序之一。 plotnine实现图形语法，这是用于描述和构建图形的连贯系统。使用platenine，您可以通过学习一个系统并将其应用到许多地方来更快地完成工作。</p><p> If you’d like to learn more about the theoretical underpinnings of plotnine before you start, I’d recommend reading  The Layered Grammar of Graphics.</p><p> 如果您想在开始之前进一步了解蛋氨酸的理论基础，建议阅读“图形的分层语法”。</p><p>  This tutorial focusses on plotnine. We’ll also use a little numpy and pandas for data manipulation. To access the datasets, help pages, and functions that we will use in this tutorial, import  4 the necessary packages by running this code:</p><p>  本教程着重于蛋氨酸。我们还将使用一些numpy和pandas进行数据处理。要访问我们将在本教程中使用的数据集，帮助页面和功能，请通过运行以下代码导入4个必需的程序包：</p><p>  If you run this code and get the error message  ModuleNotFoundError: No module named &#39;plotnine&#39;, you’ll need to first install it  5, then run the code once again.</p><p>  如果您运行此代码并收到错误消息ModuleNotFoundError：没有名为＆＃39; plotnine＆＃39;的模块，则需要先安装它5，然后再次运行该代码。</p><p>  You only need to install a package once, but you need to import it every time you run your script or (re)start the kernel.</p><p>  您只需要安装一个软件包，但是每次运行脚本或（重新）启动内核时，都需要将其导入。 </p><p>  Let’s use our first graph to answer a question: Do cars with big engines use more fuel than cars with small engines? You probably already have an answer, but try to make your answer precise. What does the relationship between engine size and fuel efficiency look like? Is it positive? Negative? Linear? Nonlinear?</p><p>让我们使用第一个图表来回答一个问题：大型发动机的汽车比小型发动机的汽车消耗更多的燃料吗？您可能已经有了答案，但是请尝试使答案更精确。发动机尺寸和燃油效率之间的关系是什么样的？是积极的吗？负？线性的？非线性的？</p><p>  You can test your answer with the  mpg DataFrame found in  plotnine.data. A DataFrame is a rectangular collection of variables (in the columns) and observations (in the rows).  mpg contains observations collected by the US Environmental Protection Agency on 38 models of car.</p><p>  您可以使用在plotnine.data中找到的mpg DataFrame测试答案。 DataFrame是变量（在列中）和观察值（在行中）的矩形集合。英里/加仑（mpg）包含美国环境保护署收集的有关38辆汽车的观察结果。</p><p>  manufacturer model displ year cyl trans drv cty hwy fl class0 audi a4 1.8 1999 4 auto(l5) f 18 29 p compact1 audi a4 1.8 1999 4 manual(m5) f 21 29 p compact2 audi a4 2.0 2008 4 manual(m6) f 20 31 p compact3 audi a4 2.0 2008 4 auto(av) f 21 30 p compact4 audi a4 2.8 1999 6 auto(l5) f 16 26 p compact.. ... ... ... ... ... ... .. ... ... .. ...229 volkswagen passat 2.0 2008 4 auto(s6) f 19 28 p midsize230 volkswagen passat 2.0 2008 4 manual(m6) f 21 29 p midsize231 volkswagen passat 2.8 1999 6 auto(l5) f 16 26 p midsize232 volkswagen passat 2.8 1999 6 manual(m5) f 18 26 p midsize233 volkswagen passat 3.6 2008 6 auto(s6) f 17 26 p midsize[234 rows x 11 columns]</p><p>  制造商型号显示年缸转换卡车公路等级0奥迪A4 1.8 1999 4自动（L5）F 18 29 P紧凑型1奥迪A4 1.8 1999 4手动（M5）F 21 29 P紧凑型2奥迪A4 2.0 2008 4手动（M6）F 20 31 p compact3 audi a4 2.0 2008 4 auto（av）f 21 30 p compact4 audi a4 2.8 1999 6 auto（l5）f 16 26 p compact .. ... ... ... ... .. ... ... ... ..... 229大众帕萨特2.0 2008 4 auto（s6）f 19 28 p中型230大众帕萨特2.0 2008 4手动（m6）f 21 29 p中型231大众帕萨特2.8 1999 6 auto（ l5）f 16 26 p中型232大众帕萨特2.8 1999 6手动（m5）f 18 26 p中型233大众帕萨特3.6 2008 6 auto（s6）f 17 26 p中型[234行x 11列]</p><p>  hwy, a car’s fuel efficiency on the highway, in miles per gallon (mpg). A car with a low fuel efficiency consumes more fuel than a car with a high fuel efficiency when they travel the same distance.</p><p>  高速公路上的汽车燃油效率，以英里/加仑（mpg）为单位。当相同距离行驶时，低燃油效率的汽车比高燃油效率的汽车消耗更多的燃油。</p><p>   To plot  mpg, run this code  6 to put  displ on the x-axis and  hwy on the y-axis:</p><p>   要绘制mpg，请运行以下代码6，将displ放在x轴上，将hwy放在y轴上：</p><p>   The plot shows a negative relationship between engine size ( displ) and fuel efficiency ( hwy). In other words, cars with big engines use more fuel. Does this confirm or refute your hypothesis about fuel efficiency and engine size?</p><p>   该图显示了发动机尺寸（偏移）和燃油效率（高速）之间的负相关关系。换句话说，大引擎的汽车消耗更多的燃料。这是否证实或驳斥了您关于燃油效率和发动机尺寸的假设？</p><p> With plotnine, you begin a plot with the function  ggplot().  ggplot() creates a coordinate system that you can add layers to. The first argument of  ggplot() is the dataset to use in the graph. So  ggplot(data=mpg) creates an empty graph, but it’s not very interesting so I’m not going to show it here.</p><p> 使用plotine，您可以使用ggplot（）函数开始绘图。 ggplot（）创建一个可以添加图层的坐标系。 ggplot（）的第一个参数是要在图形中使用的数据集。因此ggplot（data = mpg）创建了一个空图，但这并不是很有趣，因此我将不在此处显示。 </p><p> You complete your graph by adding one or more layers to  ggplot(). The function  geom_point() adds a layer of points to your plot, which creates a scatterplot. plotnine comes with many geom functions that each add a different type of layer to a plot. You’ll learn a whole bunch of them throughout this tutorial.</p><p>通过向ggplot（）添加一层或多层来完成图形。函数geom_point（）在绘图中添加了一层点，从而创建了一个散点图。 plotnine带有许多geom函数，每个函数都会向绘图添加不同类型的图层。在本教程中，您将学到很多。</p><p> Each geom function in plotnine takes a  mapping argument. This defines how variables in your dataset are mapped to visual properties. The  mapping argument is always paired with  aes(), and the  x and  y arguments of  aes() specify which variables to map to the x and y axes. plotnine looks for the mapped variables in the  data argument, in this case,  mpg.</p><p> plotnine中的每个geom函数都带有一个映射参数。这定义了数据集中的变量如何映射到视觉属性。映射参数始终与aes（）配对，而aes（）的x和y参数指定要映射到x和y轴的变量。 plotnine在data参数（本例中为mpg）中查找映射的变量。</p><p>  Let’s turn this code into a reusable template for making graphs with plotnine. To make a graph, replace the bracketed sections in the code below with a dataset, a geom function, or a collection of mappings.</p><p>  让我们将这段代码转换为可重复使用的模板，以使用plotine制作图表。要制作图表，请将下面代码中的方括号部分替换为数据集，geom函数或一组映射。</p><p>  The rest of this tutorial will show you how to complete and extend this template to make different types of graphs. We will begin with the  &lt;MAPPINGS&gt; component.</p><p>  本教程的其余部分将向您展示如何完成和扩展此模板以制作不同类型的图形。我们将从＆lt; MAPPINGS＆gt;开始零件。</p><p>  What happens if you make a scatterplot of  class vs  drv? Why isthe plot not useful?</p><p>  如果您绘制类vs drv散点图会怎样？为什么情节没有用？</p><p>  “The greatest value of a picture is when it forces us to notice what wenever expected to see.” — John Tukey</p><p>  “图片的最大价值在于，它迫使我们注意到人们曾经期望看到的东西。” —约翰·图基</p><p> In the plot below, one group of points (highlighted in red) seems to fall outside of the linear trend. These cars have a higher mileage than you might expect. How can you explain these cars?</p><p> 在下面的图中，一组点（以红色突出显示）似乎不在线性趋势之内。这些汽车的行驶里程比您预期的要高。你怎么解释这些车？ </p><p>  Let’s hypothesize that the cars are hybrids. One way to test this hypothesis is to look at the  class value for each car. The  class variable of the  mpg dataset classifies cars into groups such as compact, midsize, and SUV. If the outlying points are hybrids, they should be classified as compact cars or, perhaps, subcompact cars (keep in mind that this data was collected before hybrid trucks and SUVs became popular).</p><p>让我们假设这些汽车是混合动力车。检验该假设的一种方法是查看每辆汽车的等级价值。 mpg数据集的class变量将汽车分类为紧凑型，中型和SUV等组。如果离群点是混合动力车，则应将其分类为紧凑型车或微型车（请注意，此数据是在混合动力卡车和SUV流行之前收集的）。</p><p> You can add a third variable, like  class, to a two dimensional scatterplot by mapping it to an  aesthetic. An aesthetic is a visual property of the objects in your plot. Aesthetics include things like the size, the shape, or the color of your points. You can display a point (like the one below) in different ways by changing the values of its aesthetic properties. Since we already use the word “value” to describe data, let’s use the word “level” to describe aesthetic properties. Here we change the levels of a point’s size, shape, and color to make the point small, triangular, or blue:</p><p> 您可以通过将其映射到美学来向二维散点图添加第三个变量（例如class）。美观是情节中对象的视觉属性。美学包括点的大小，形状或颜色之类的东西。您可以通过更改其美学属性的值，以不同的方式显示一个点（如下所示）。由于我们已经使用“价值”一词来描述数据，所以我们使用“水平”一词来描述美学特性。在这里，我们更改点的大小，形状和颜色的级别，以使该点变小，呈三角形或呈蓝色：</p><p>  You can convey information about your data by mapping the aesthetics in your plot to the variables in your dataset. For example, you can map the colors of your points to the  class variable to reveal the class of each car.</p><p>  您可以通过将绘图中的美观映射到数据集中的变量来传达有关数据的信息。例如，您可以将点的颜色映射到class变量以显示每个汽车的类。</p><p>    To map an aesthetic to a variable, associate the name of the aesthetic to the name of the variable inside  aes(). plotnine will automatically assign a unique level of the aesthetic (here a unique color) to each unique value of the variable, a process known as  scaling. plotnine will also add a legend that explains which levels correspond to which values.</p><p>    要将美观性映射到变量，请在aes（）中将美观性名称与变量名称相关联。橡皮糖会自动为变量的每个唯一值分配唯一的美学级别（此处为唯一的颜色），此过程称为缩放。勒皮宁还将添加一个图例，以说明哪些级别对应于哪些值。</p><p> The colors reveal that many of the unusual points are two-seater cars. These cars don’t seem like hybrids, and are, in fact, sports cars! Sports cars have large engines like SUVs and pickup trucks, but small bodies like midsize and compact cars, which improves their gas mileage. In hindsight, these cars were unlikely to be hybrids since they have large engines.</p><p> 颜色表明，许多不寻常的地方是两座汽车。这些汽车似乎不是混合动力车，实际上是跑车！跑车具有大型发动机（例如SUV和皮卡车），而小型车身（例如中型和紧凑型汽车）则提高了汽油行驶里程。事后看来，这些汽车不太可能是混合动力车，因为它们具有大型发动机。</p><p> In the above example, we mapped  class to the color aesthetic, but we could have mapped  class to the size aesthetic in the same way. In this case, the exact size of each point would reveal its class affiliation. We get a  warning here, because mapping an unordered variable ( class) to an ordered aesthetic ( size) is not a good idea.</p><p> 在上面的示例中，我们将类映射到颜色美学，但是我们可以以相同的方式将类映射到尺寸美学。在这种情况下，每个点的确切大小将显示其类隶属关系。我们在这里得到警告，因为将无序变量（类）映射到有序美学（大小）不是一个好主意。</p><p>    Similarly, we could have mapped  manufacturer to the  alpha aesthetic, which controls the transparency of the points, or to the  shape aesthetic, which controls the shape of the points.  7</p><p>    同样，我们可以将制造商映射到控制点透明性的alpha美感，或控制点的形状的形状美感。 7 </p><p>   What happened to Toyota and Volkswagen? plotnine will only use 13 shapes at a time. By default, additional groups will go unplotted when you use the shape aesthetic.</p><p>丰田和大众怎么了？橡皮糖一次只能使用13种形状。默认情况下，使用形状美学时，其他组将不作图。</p><p> For each aesthetic, you use  aes() to associate the name of the aesthetic with a variable to display. The  aes() function gathers together each of the aesthetic mappings used by a layer and passes them to the layer’s mapping argument. The syntax highlights a useful insight about  x and  y: the x and y locations of a point are themselves aesthetics, visual properties that you can map to variables to display information about the data.</p><p> 对于每种美学，都可以使用aes（）将美学名称与要显示的变量相关联。 aes（）函数将图层使用的每个美学映射收集在一起，并将其传递给图层的映射参数。该语法突出显示了有关x和y的有用见解：点的x和y本身就是美观，可以将可视属性映射到变量以显示有关数据的信息。</p><p> Once you map an aesthetic, plotnine takes care of the rest. It selects a reasonable scale to use with the aesthetic, and it constructs a legend that explains the mapping between levels and values. For x and y aesthetics, plotnine does not create a legend, but it creates an axis line with tick marks and a label. The axis line acts as a legend; it explains the mapping between locations and values.</p><p> 一旦绘制了美学图，皮兰汀就会处理剩下的一切。它选择了一个合理的比例以配合美学，并构造了一个图例来解释级别和值之间的映射。对于x和y美学，plotine不会创建图例，而是创建带有刻度线和标签的轴线。轴线充当图例；它说明了位置和值之间的映射。</p><p> You can also  set the aesthetic properties of your geom manually. For example, we can make all of the points in our plot blue:</p><p> 您还可以手动设置几何图形的美学属性。例如，我们可以将图中的所有点设为蓝色：</p><p>   Here, the color doesn’t convey information about a variable, but only changes the appearance of the plot. To set an aesthetic manually, set the aesthetic by name as an argument of your geom function; i.e. it goes  outside of  aes(). You’ll need to pick a level that makes sense for that aesthetic:</p><p>   在这里，颜色不会传达有关变量的信息，而只会改变图形的外观。要手动设置美学，请按名称将美学设置为geom函数的参数；即它不在aes（）之外。您需要选择一种适合该美学的水平：</p><p>    Which variables in  mpg are categorical? Which variables are continuous?(Hint: type  ?mpg to read the documentation for the dataset). Howcan you see this information when you run  mpg?</p><p>    mpg中的哪些变量是分类的？哪些变量是连续的？（提示：键入？mpg以阅读数据集的文档）。运行mpg时如何查看此信息？</p><p>  Map a continuous variable to  color,  size, and  shape. How dothese aesthetics behave differently for categorical vs. continuousvariables?</p><p>  将连续变量映射到颜色，大小和形状。这些美学对于分类变量和连续变量的表现如何不同？ </p><p>      What happens if you map an aesthetic to something other than a variablename, like  aes(colour=&#34;displ &lt; 5&#34;)? Note, you’ll also need to specify x and y.</p><p>如果将美学映射到变量名以外的其他内容（例如aes（colour =＆＃34; displ＆lt; 5＆＃34;）），会发生什么？请注意，您还需要指定x和y。</p><p>  As you start to run Python code, you’re likely to run into problems. Don’t worry — it happens to everyone. I have been writing Python code for years, and every day I still write code that doesn’t work!</p><p>  在开始运行Python代码时，您可能会遇到问题。不用担心-每个人都会发生。我已经写了多年的Python代码，而且每天我仍然写不起作用的代码！</p><p> Start by carefully comparing the code that you’re running to the code in the book. Python is extremely picky, and a misplaced character can make all the difference. Make sure that every  ( is matched with a  ) and every  &#34; is paired with another  &#34;.</p><p> 首先，将您正在运行的代码与本书中的代码进行仔细比较。 Python非常挑剔，并且放错位置的字符可能会有所不同。确保每个（与匹配）和每个＆＃34;与另一个＆＃34;配对。</p><p> One common problem when creating plotnine graphics is to forget the  \: it has to come at the end of the line. In other words, make sure you haven’t accidentally written code like this:</p><p> 创建绘图图形时的一个常见问题是忘记\：它必须出现在行尾。换句话说，请确保您没有意外编写如下代码：</p><p>  Alternatively, if you wrap the entire expression in parentheses then you can leave out the  \:</p><p>  另外，如果将整个表达式用括号括起来，则可以省略\：</p><p>  If you’re still stuck, try the help. You can get help about any Python function by running  ?function_name. Don’t worry if the help doesn’t seem that helpful - instead skip down to the examples and look for code that matches what you’re trying to do.</p><p>  如果仍然遇到问题，请尝试帮助。您可以通过运行？function_name获得有关任何Python函数的帮助。如果帮助看起来没有帮助，请不要担心-跳到示例并查找与您尝试执行的操作匹配的代码。</p><p> If that doesn’t help, carefully read the error message. Sometimes the answer will be buried there! But when you’re new to Python, the answer might be in the error message but you don’t yet know how to understand it. Another great tool is Google: try googling the error message, as it’s likely someone else has had the same problem, and has gotten help online.</p><p> 如果这样做没有帮助，请仔细阅读错误消息。有时答案会埋在这里！但是，当您不熟悉Python时，答案可能是在错误消息中，但您还不知道如何理解它。另一个很棒的工具是Google：尝试搜索错误消息，因为其他人可能也遇到了同样的问题，并且已经获得在线帮助。 </p><p>  One way to add additional variables is with aesthetics. Another way, particularly useful for categorical variables, is to split your plot into  facets, subplots that each display one subset of the data.</p><p>添加其他变量的一种方法是美观。另一种对分类变量特别有用的方法是将绘图分成多个面，子面，每个面显示数据的一个子集。</p><p> To facet your plot by a single variable, use  facet_wrap(). The first argument of  facet_wrap() should be a formula, which you create with  ~ followed by a variable name (here “formula” is the name of a data structure in Python, not a synonym for “equation”). The variable that you pass to  facet_wrap() should be discrete.</p><p> 要通过单个变量对图进行构图，请使用facet_wrap（）。 facet_wrap（）的第一个参数应该是一个公式，该公式由〜创建，后跟一个变量名（此处“ formula”是Python中数据结构的名称，而不是“ equation”的同义词）。您传递给facet_wrap（）的变量应该是离散的。</p><p>   To facet your plot on the combination of two variables, add  facet_grid() to your plot call. The first argument of  facet_grid() is also a formula. This time the formula should contain two variable names separated by a  ~.</p><p>   要在两个变量的组合上进行绘图，请将facet_grid（）添加到绘图调用中。 facet_grid（）的第一个参数也是一个公式。这次，公式应包含两个用〜分隔的变量名。</p><p>   If you prefer to not facet in the rows or columns dimension, use a  . instead of a variable name, e.g.  + facet_grid(&#34;. ~ cyl&#34;).</p><p>   如果您不想在“行”或“列”维度中不使用任何方面，请使用。而不是变量名，例如+ facet_grid（＆＃34 ;.〜cyl＆＃34;）。</p><p>  What do the empty cells in plot with  facet_grid(&#34;drv ~ cyl&#34;) mean?How do they relate to this plot?</p><p>  使用facet_grid（＆＃34; drv〜cyl＆＃34;）的情节中的空单元格是什么意思？它们与该情节有何关系？</p><p>    What are the advantages to using faceting instead of the colour aesthetic?What are the disadvantages? How might the balance change if you had alarger dataset?</p><p>    使用分面代替颜色美学有什么好处？有什么缺点？如果您拥有更大的数据集，余额将如何变化？</p><p>  Read  ?facet_wrap. What does  nrow do? What does  ncol do? What otheroptions control the layout of the individual panels? Why doesn’t  facet_grid() have  nrow and  ncol arguments?</p><p>  阅读？facet_wrap。乌鸦做什么？ ncol是做什么的？还有哪些其他选项控制各个面板的布局？为什么facet_grid（）没有nrow和ncol参数？ </p><p>  When using  facet_grid() you should usually put the variable with moreunique levels in the columns. Why?</p><p>使用facet_grid（）时，通常应将具有更独特级别的变量放在列中。为什么？</p><p>    Both plots contain the same x variable, the same y variable, and both describe the same data. But the plots are not identical. Each plot uses a different visual object to represent the data. In plotnine syntax, we say that they use different  geoms.</p><p>    两个图都包含相同的x变量，相同的y变量，并且都描述相同的数据。但是情节并不相同。每个图都使用不同的视觉对象表示数据。用记号语法，我们说它们使用不同的几何。</p><p> A  geom is the geometrical object that a plot uses to represent data. People often describe plots by the type of geom that the plot uses. For example, bar charts use bar geoms, line charts use line geoms, boxplots use boxplot geoms, and so on. Scatterplots break the trend; they use the point geom. As we see above, you can use different geoms to plot the same data. The plot on the left uses the point geom, and the plot on the right uses the smooth geom, a smooth line fitted to the data.</p><p> 几何是绘图用来表示数据的几何对象。人们通常根据地块使用的几何类型来描述地块。例如，条形图使用条形图，折线图使用线形图，箱线图使用盒线图几何图，依此类推。散点图打破了趋势；他们使用点几何。如上所示，您可以使用不同的几何图形来绘制相同的数据。左边的图使用点几何，右边的图使用平滑几何，一条平滑的线适合数据。</p><p> To change the geom in your plot, change the geom function that you add to  ggplot().For instance, to make the plots above, you can use this code:</p><p> 要更改绘图中的几何图形，请更改添加到ggplot（）的geom函数。例如，要制作上述图形，可以使用以下代码：</p><p>  Every geom function in plotnine takes a  mapping argument. However, not every aesthetic works with every geom. You could set the shape of a point, but you couldn’t set the “shape” of a line. On the other hand, you  could set the linetype of a line.  geom_smooth() will draw a different line, with a different linetype, for each unique value of the variable that you map to linetype.</p><p>  plotnine中的每个geom函数都有一个映射参数。但是，并非每一种美学都适用于每一种几何。您可以设置点的形状，但不能设置线的“形状”。另一方面，您可以设置线的线型。 geom_smooth（）将为映射到线型的变量的每个唯一值绘制一条不同的线，并使用不同的线型。</p><p>   Here  geom_smooth() separates the cars into three lines based on their  drv value, which describes a car’s drivetrain. One line describes all of the points with a  4 value, one line describes all of the points with an  f value, and one line describes all of the points with an  r value. Here,  4 stands for four-wheel drive,  f for front-wheel drive, and  r for rear-wheel drive.</p><p>   这里的geom_smooth（）根据汽车的drv值将汽车分为三行，该值描述了汽车的传动系统。一行描述了所有值为4的点，一行描述了所有值为f的点，一行描述了所有值为r的点。在此，4代表四轮驱动，f代表前轮驱动，r代表后轮驱动。</p><p> If this sounds strange, we can make it more clear by overlaying the lines on top of the raw data and then coloring everything according to  drv.</p><p> 如果听起来很奇怪，我们可以通过在原始数据上叠加线条，然后根据drv为所有内容着色来使其更加清晰。 </p><p>  Notice that this plot contains two geoms in the same graph! If this makes you excited, buckle up. We will learn how to place multiple geoms in the same plot very soon.</p><p>注意，该图在同一图中包含两个几何！如果这使您兴奋，请系好安全带。我们将很快学习如何在同一图中放置多个几何图形。</p><p> plotnine provides over 30 geoms. The best way to get a comprehensive overview is the ggplot2 cheatsheet, which you can find at  http://rstudio.com/cheatsheets. To learn more about any single geom, use help:  ?geom_smooth.</p><p> 橡皮糖提供30多个几何图形。获得全面概述的最佳方法是ggplot2备忘单，您可以在http://rstudio.com/cheatsheets中找到该备忘单。要了解有关任何单个几何的更多信息，请使用帮助：？geom_smooth。</p><p> Many geoms, like  geom_smooth(), use a single geometric object to display multiple rows of data. For these geoms, you can set the  group aesthetic to a categorical variable to draw multiple objects. plotnine will draw a separate object for each unique value of the grouping variable. In practice, plotnine will automatically group the data for these geoms whenever you map an aesthetic to a discrete variable (as in the  linetype example). It is convenient to rely on this feature because the group aesthetic by itself does not add a legend or distinguishing features to the geoms.</p><p> 许多几何图形（例如geom_smooth（））都使用单个几何对象显示多行数据。对于这些几何，可以将组的美观度设置为分类变量以绘制多个对象。 plotnine将为分组变量的每个唯一值绘制一个单独的对象。实际上，每当您将美学映射到离散变量时（如线型示例），plotine都会自动将这些几何的数据分组。依靠此功能很方便，因为组美学本身不会为图例添加图例或区别特征。</p><p>      This, however, introduces some duplication in our code. Imagine if you wanted to change the y-axis to display  cty instead of  hwy. You’d need to change the variable in two places, and you might forget to update one. You can avoid this type of repetition by passing a set of mappings to  ggplot(). plotnine will treat these mappings as global mappings that apply to each geom in the graph. In other words, this code will produce the same plot as the previous code:</p><p>      但是，这在我们的代码中引入了一些重复。想象一下，如果您想更改y轴以显示cty而不是hwy。您需要在两个位置更改变量，而您可能会忘记更新一个。您可以通过将一组映射传递给ggplot（）来避免这种重复。 plotnine会将这些映射视为适用于图形中每个几何的全局映射。换句话说，此代码将产生与先前代码相同的图：</p><p>  If you place mappings in a geom function, plotnine will treat them as local mappings for the layer. It will use these mappings to extend or overwrite the global mappings  for that layer only. This makes it possible to display different aesthetics in different layers.</p><p>  如果将映射放置在geom函数中，则plotnine将其视为该图层的本地映射。它将仅使用这些映射来扩展或覆盖该层的全局映射。这使得可以在不同的层中显示不同的美学。</p><p>   You can use the same idea to specify different  data for each layer. Here, our smooth line displays just a subset of the  mpg dataset, the subcompact cars. The local data argument in  geom_smooth() overrides the global data argument in  ggplot() for that layer only.</p><p>   您可以使用相同的想法为每个图层指定不同的数据。在这里，我们的平滑线仅显示mpg数据集的一个子集，即小型汽车。 geom_smooth（）中的局部数据参数仅覆盖该层的ggplot（）中的全局数据参数。</p><p>    What geom would you use to draw a line chart? A boxplot? A histogram? An area chart?</p><p>    您将使用哪种几何图形绘制折线图？箱线图？直方图？面积图？ </p><p>  Run this code in your head and predict what the output will look like.Then, run the code in Python and check your predictions.</p><p>在脑海中运行此代码并预测输出结果，然后在Python中运行该代码并检查您的预测。</p><p>  What does  show_legend=False do? What happens if you remove it? Why do you think I used it earlier in the chapter?</p><p>  show_legend = False有什么作用？如果删除它会怎样？为什么您认为我在本章前面使用过它？</p><p>  You can learn which stat a geom uses by inspecting the default value for the  stat argument. For example,  ?geom_bar shows that the default value for  stat is “count”, which means that  geom_bar() uses  stat_count().  stat_count() is documented on the same page as  geom_bar(), and if you scroll down you can find a section called “Computed variables”. That describes how it computes two new variables:  count and  prop.</p><p>  您可以通过检查stat参数的默认值来了解geom使用哪个stat。例如，？geom_bar显示stat的默认值为“ count”，这意味着geom_bar（）使用stat_count（）。 stat_count（）与geom_bar（）记录在同一页面上，如果向下滚动，则可以找到一个名为“计算变量”的部分。这说明了它如何计算两个新变量：count和prop。</p><p> You can generally use geoms and stats interchangeably. For example, you can recreate the previous plot using  stat_count() instead of  geom_bar():</p><p> 通常，您可以互换使用geoms和stats。例如，您可以使用stat_count（）而不是geom_bar（）重新创建上一个图：</p><p>   This works because every geom has a default stat; and every stat has a default geom. This means that you can typically use geoms without worrying about the underlying statistical transformation. There are three reasons you might need to use</p><p>   之所以可行，是因为每个geom都有默认统计信息。每个统计信息都有一个默认的几何图形。这意味着您通常可以使用几何，而不必担心基础统计转换。您可能需要使用三个原因</p><p>......</p><p>...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://datascienceworkshops.com/blog/plotnine-grammar-of-graphics-for-python/">https://datascienceworkshops.com/blog/plotnine-grammar-of-graphics-for-python/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/grammar/">#grammar</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>