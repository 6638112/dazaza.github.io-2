<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用Bakeware将Elixir应用程序编译为单个可执行的二进制文件</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用Bakeware将Elixir应用程序编译为单个可执行的二进制文件</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-23 02:54:54</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/21054de7abd23919431e2a8a7caa1f96.png"><img src="http://img2.diglog.com/img/2020/10/21054de7abd23919431e2a8a7caa1f96.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>BAKWARE是一个新的奇妙的工具，是在一个周末为SpawnFest 2020而构建的，它将一个药剂、一个风景或一个凤凰应用程序编译成单一的可执行二进制文件(是的，就像Go-Lang！)。分发我们的应用程序非常有用，特别是当它们是命令行工具或Scen应用程序时。</p><p>对于大多数Phoenix应用程序部署来说，这个工具可能并不重要，但我认为有时候拥有一个Phoenix/Phoenix LiveView应用程序(以及所有需要的资产)可能真的很有用！以单一且易于共享的二进制形式。</p><p>让我们看看如何在Phoenix LiveView应用程序中使用它。我们将要看到的也适用于CLI和Scene应用程序。</p><p>目前在https.pm上还没有官方的库，所以让我们首先从它的GitHub repo，spawnfest/bakeware下载Bakeware的代码。</p><p>$git将https://github.com/spawnfest/bakeware.gitCloning克隆到&#39；BAKWARE&#39；.$ls BAKEWARE/BAKEWARE生成文件自述文件.md资产库混合.exs混合.lock源测试。</p><p>在BAKWARE/Examples文件夹中，您还可以找到其他有用的示例。我们需要的库代码位于bakeware/bakeware目录中。</p><p>要查看Bakeware的运行情况，让我们创建一个名为Counter的新Phoenix项目，该项目支持LiveView，但不支持ecto。</p><p>在计数器Phoenix项目的目录中，我们创建了一个lib/count_web/live/counter_live.ex文件，我们在其中定义了一个CounterWeb.CounterLive实时视图。您可以简单地复制/粘贴下面的模块代码。</p><p>会话计数器：#lib/counter_web/live/counter_live.exdefmodule_VIEW@Iml true def mount(_params，_Session，Socket)do{：OK，Assign(Socket，Counter：0)}End@Impl true def Render(Assigns)do~L&#34；&#34；&#34；&lt；h1&lt；计数器：&lt；%=@Count%gt；&lt；/h1&gt；&lt；按钮phx-click=&#34；dec&#34；&gt；-&lt；/button&gt；&lt；button phx-click=&#34；inc&#34；&gt；+&lt；/button&gt；&#34；&#34；&#34；end@impl true def handle_event(&#34；inc&34；，_，socket)do{：无回复，更新(套接字，：计数器，&amp；&amp；1+1)}end@impl true def Handle_event(&#34；Dec&#34；，_，Socket)do{：无回复，更新(Socket，：Counter，&amp；&amp；1-1)}endend。</p><p>#lib/count_web/router.exdefmodule CounterWeb.Router Do Use CounterWeb，：Router...。范围&#34；/&#34；，CounterWeb do PIPE_THROUGH：Browser LIVE&#34；/&#34；，CounterLive，：index End。</p><p>好了，我们现在有了一个简单的LiveView计数器应用程序，可以用Bakeware编译。</p><p>要使用BAKWARE WE，只需更改计数器Phoenix项目的Mix.exs文件。</p><p>#Mix.exsdefmodule Coun.MixProject do def project do[APP：：Counter，...。发布：[baked_counter：[Steps：[：Assemble，&amp；Bakeware.Assembly/1]，strie_ams：Mix.env()==：prod，overwrite：true]]End Defp Alias do[Assets：[&#34；cmd NPM run Deploy--Prefix Assets&#34；]，Release：[&#34；Assets&#34；，&#34；phx.digest&#34；，&#34；Release&#34；]，Setup：[&#34；Deps.Get&#34；]，Release：[&#34；Assets&#34；，&#34；phx.digest&#34；，&#34；Release&#34；]，Setup：[&#34；Deps.Get&#34；]；，&#34；cmd NPM安装--prefix sets&#34；]]end defp deps do[...{：bakeware，path：&#34；../bakeware/bakeware&#34；，run：false}]endend。</p><p>我们首先添加：bakeware依赖项，将：path指向本地bakerware子文件夹，并将：runtime选项设置为false。</p><p>然后，我们添加：Release和：Assets别名，它们缩短了构建发行版所需键入的命令列表。例如，：release别名运行Mix Assets、Mix phx.digest和Mix Release。</p><p>最重要的是，我们在project/0返回的关键字列表中添加了：release选项。我们构建的唯一版本名为baked_counter，并且我们将[：Assemble，&amp；Bakeware.Assemble/1]设置为组装版本时要执行的步骤列表。我们设置了另外两个选项：overwrite：true(如果有现有的发布版本，则将其覆盖)和：strie_beams，仅当环境为PROD时才为true(控制是否应该删除BEAM文件的调试信息、文档块和其他不必要的元数据)。</p><p>当设置SERVER：TRUE时，Web服务器在端点监控树启动时启动。我们还可以添加CHECK_ORIGURCE：FALSE，这将禁用对源头的检查。</p><p>我们已经准备好构建版本了。在运行混合任务之前，我们需要加密_KEY_BASE环境变量。</p><p>然后，我们运行安装和发布混合任务，将MIX_ENV环境变量设置为PROD。</p><p>$MIX_ENV=生产混合设置...$MIX_ENV=生产混合版本...*正在组装烘焙软件BAKED_COUNT BAKWARE已成功汇编可执行文件\at_build/prod/rel/bakeware/baked_counter。</p><p>当我们运行它时，我们看到我们的服务器正确启动，为Web应用程序资产(在本例中只有javascript、CSS和Phoenix Framework徽标)提供服务。</p><p>$./_build/prod/rel/bakeware/baked_counterbakeware：启动&#39；/Users/alvise/Documents/poeticoding/bakeware/code/counter/./_build/prod/rel/bakeware/baked_counter&#39；(cachedir=/Users/alvise//Library/Caches/Bakeware)...bakeware：缓存无效。正在解压...烘焙软件：运行/Users/alvise//Library/Caches/Bakeware/6ea5f818ebb68300b8d953d54e082779006802152906cd90dc43caeaefc9a19f/start...16:49:25.455[INFO]运行计数器Web.Endpoint，牛仔2.8.0位于：4,000(HTTP)16：49：25.456[INFO]访问计数器Web.Endpoint位于http://example.com。</p><p>由Bakeware构建的可执行二进制文件将整个发行版压缩在其中。当我们运行它时，它会提取缓存文件夹中的所有内容，并启动应用程序。</p><p>为了优化启动时间，Bakeware维护提取的二进制文件和资源的缓存。这样，我们第二次运行它时，速度会更快，因为它不需要解压缩任何东西。</p><p>在这种情况下，我用的是Mac电脑。如果我们进入~/Library/Caches/Bakeware/6ea5f...。文件夹，我们找到解压的版本。</p><p>让我们在另一台Mac上尝试一下baked_counter。如果您的应用程序是在Linux上构建的，那么它应该可以在其他类似的Linux环境下运行。Windows支持即将到来(请看本文末尾)。</p><p>我是用我的MacBook Pro和Catalina(10.15.7)编译的，所以看看它是否能在稍微老一点的MacOS版本上运行会很好，比如Mojave(10.14)。我没有另一台Mac，所以我使用MacOS10.14的远程Macmini，由MacinCloud托管，实行现收现付计划。</p><p>它成功了！！它是否兼容多种操作系统版本？Well…。这取决于不同的东西。当我们构建一个发行版时，这应该运行在具有相同操作系统和类似环境的目标机器上，比如C运行时和Erlang运行时引用的其他库，以及应用程序中的任何NIF和端口。</p><p>这是一个刚开始一个月的项目，团队计划做很多其他的事情，例如：</p><p>你认为烘焙用品会对你有帮助吗？也许是为了用长生不老药写的CLI？或者是带有LiveView的风景或凤凰应用程序？让我知道你的想法！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.poeticoding.com/compile-elixir-applications-into-single-executable-binaries-with-bakeware/">https://www.poeticoding.com/compile-elixir-applications-into-single-executable-binaries-with-bakeware/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/编译/">#编译</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/二进制/">#二进制</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/elixir/">#elixir</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/bakeware/">#bakeware</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1030616.html"><img src="http://img2.diglog.com/img/2020/10/thumb_5b552713e2b268cc98eb7ba4b741bd2d.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030616.html">苹果开始隐藏其Mac应用程序的流量</a></div><span class="my_story_list_date">2020-10-23 1:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030597.html"><img src="http://img2.diglog.com/img/2020/10/thumb_e5af8a548c3bdd923adf907e1c5c862a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030597.html">PS5在发布时将缺少一些PS4视频流应用程序</a></div><span class="my_story_list_date">2020-10-23 0:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030591.html"><img src="http://img2.diglog.com/img/2020/10/thumb_774914de6bb18c065982d36c366149e8.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030591.html">亲身体验华为新款Mate 40 Pro：令人难以置信的摄像头和强大的处理器，但应用程序选择很糟糕，很难推荐这款手机</a></div><span class="my_story_list_date">2020-10-23 0:19</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030586.html"><img src="http://img2.diglog.com/img/2020/10/thumb_c517ee5710b387178bb357994fcc873c.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030586.html">Facebook监督委员会表示，目前正在接受来自已用尽公司上诉程序的用户和Facebook本身的案件进行审查</a></div><span class="my_story_list_date">2020-10-22 23:56</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>