<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我如何建造世界上第一个超声波扫描仪 How I built the world's first 3D ultrasonic scanner</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">How I built the world's first 3D ultrasonic scanner<br/>我如何建造世界上第一个超声波扫描仪 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-05-10 07:44:27</div><div class="page_narrow text-break page_content"><p>Here&#39;s how I built the first ultrasonic 3d scanner in the world that works in the air, using off-the-shelf components (&lt; $100).   1</p><p>这里＆＃39;我如何在空中工作的世界中建立第一个超声波3D扫描仪，使用搁板的组件（＆lt; $ 100）。 1</p><p> Four years ago, I was 15 and wanted to build an autonomous drone to deliver me Coke cans. For that, I needed an accurate 3D map of the surroundings of my drone to avoid walls and objects in its way. Lidars were too expensive and SLAM  2 didn&#39;t work well. There were ultrasonic sensors, but they could only give out the distance to the nearest object in a 40° cone, which wasn&#39;t enough for me.</p><p> 四年前，我15岁，想要建立一个自主的无人机来提供焦炭罐头。为此，我需要一个准确的3D地图，我的无人机周围环境避免墙壁和物体。 Lidars太昂贵了，猛烈2点＆＃39; T良好。有超声波传感器，但它们只能在40°锥形中展开到最近物体的距离，这对我来说是足够的。</p><p> But, if humans can locate the exact direction of a sound, why can&#39;t an ultrasonic sensor do it too? That would allow me to scan in 3d.</p><p> 但是，如果人类可以找到声音的确切方向，为什么可以＆＃39; t一个超声波传感器也这样做？这将允许我扫描3D。</p><p>  A transmitter emits a wave, which bounces on objects, and two receivers triangulate the echo to put it on a map. But, this only works well for one object. As soon as there&#39;s a second one at the wrong spot, you can&#39;t tell apart one&#39;s echo from the other&#39;s.  3</p><p>  发射机发出波浪，它在对象上反弹，两个接收器三角形转向将其放在地图上。但是，这对于一个对象来说才能很好。一旦在错误的地方，你就可以＆＃39; t＆＃39; t＆＃39;从另一个＆＃39; s的回声。 3.</p><p> A few guys built scanners based on that. They work well for spotting fingers for a virtual keyboard, but can&#39;t handle more than a few objects.</p><p> 一些人建立了扫描仪。它们适用于虚拟键盘的手指，但可以＆＃39; t处理多于几个物体。</p><p>  What saved me was the principle of interference. Let&#39;s say we have two sound waves in space, let&#39;s call them        F 1 ( M ) F_1(M)     F        1 ​    ( M ) and        F 2 ( M ) F_2(M)     F        2 ​    ( M ), where        F 1 ( M ) F_1(M)     F        1 ​    ( M ) returns how far the first wave moves the particles at point M.</p><p>  拯救了我的是干扰原则。假设我们在空间中有两个声波，让＆＃39; s调用它们f 1（m）f_1（m）f 1（m）和f 2（m）f_2（m）f 2）（ m），其中f 1（m）f_1（m）f 1（m）返回第一波在点M处移动粒子的距离。</p><p> F 1 ( M ) F_1(M)     F        1 ​    ( M ) can be positive or negative. When you see waves on the water, there are places where the water line is below its average—       F 1 ( M ) F_1(M)     F        1 ​    ( M ) negative—and places where the water line is above the average—       F 1 ( M ) F_1(M)     F        1 ​    ( M ) positive. Now, if we call F(M) the &#34;final&#34; displacement of the particles at the point M, we&#39;re going to have       F ( M ) =  F 1 ( M ) +  F 2 ( M ) F(M) = F_1(M) + F_2(M)    F ( M )  =     F        1 ​    ( M )  +     F        2 ​    ( M ).</p><p> f 1（m）f_1（m）f 1（m）可以是正的或阴性的。当您看到水上的波浪时，有水线低于其平均-f 1（m）f_1（m）f 1（m）负的地方，并且水管线高于平均-f 1的地方（m）f_1（m）f 1（m）阳性。现在，如果我们打电话给f（m）＆＃34;最终＆＃34;颗粒在点m，we＆＃39;重新进入f（m）= f 1（m）+ f 2（m）f（m）= f_1（m）+ f_2（m）f（m）（m） ）= f 1（m）+ f 2（m）。 </p><p> But what happens in a situation where        F 1 ( M ) = −  F 2 ( M ) F_1(M) = -F_2(M)     F        1 ​    ( M )  =    −  F        2 ​    ( M )? Well       F ( M ) = 0 F(M) = 0    F ( M )  =    0! Particles don&#39;t move in M even though there are two non-zero waves there. This phenomenon is called destructive interference. Interferences rule how all wave sources radiate in space. The lightning patterns on the surface of the water, the equations ruling mirrors, lenses and antennas all derive from this superposition principle.</p><p>但是在f 1（m）=  -  f 2（m）f_1（m）= -f_2（m）f 1（m）=  -  f 2（m）的情况下会发生什么？嗯f（m）= 0 f（m）= 0 f（m）= 0！颗粒在＆＃39; t在m中移动，即使存在两个非零波。这种现象称为破坏性干扰。干扰统治所有波源在空间中的辐射。水面上的闪电模式，等式统治镜，透镜和天线都来自该叠加原理。</p><p> Now it turns out that if you arrange a lot of emitters regularly in a plane, the wave will stay constrained inside of a beam like the one of a lighthouse.The following arrangement of emitters, all in phase:</p><p> 事实证明，如果您在平面中定期安排大量发射器，则波浪将保持像灯塔之一的梁内部的限制。以下排除者的排列，所有相位：</p><p>    The real miracle is that if you delay each emitter&#39;s emission time by a linear amount       n ϕ n\phi    n ϕ, for instance like that:</p><p>    真正的奇迹是，如果你延迟每个发射器＆＃39; s的线性量nφn \ phinφ，例如：</p><p> [ E ( t + ϕ ) ] [E(t+\phi)]    [ E ( t  +    ϕ )]       [ E ( t + 2 ϕ ) ] [E(t+2\phi)]    [ E ( t  +    2 ϕ )]       [ E ( t + 3 ϕ ) ] [E(t+3\phi)]    [ E ( t  +    3 ϕ )]       [ E ( t + 4 ϕ ) ] [E(t+4\phi)]    [ E ( t  +    4 ϕ )]       [ E ( t + 5 ϕ ) ] [E(t+5\phi)]    [ E ( t  +    5 ϕ )]</p><p> [E（t +φ）] [e（t +φ）] [e（t +2φ）] [e（t + 2 \ phi）] [e（t + 2φ ）[e（t + 3φ）] [e（t +3φ）] [e（t +4φ）] [e（t + 4 \ phi）] [ E（t +4φ）] [e（t +5φ）] [e（t + 5 \ phi）] [e（t +5φ）]</p><p> Then, the angle at which the beam will point will be proportional to       ϕ \phi    ϕ!If we control       ϕ \phi    ϕ, we control where the beam points at!</p><p> 然后，光束将点的角度将与φ\phiφ成比例！如果我们控制φ\phiφ，我们控制光束点的位置！</p><p>      The problem is that if the emitters are too far apart, there won&#39;t be one but three beams. With three beams, scanning is impossible. The emitters have to be as close as half the wavelength to avoid sending sound to the wrong place.</p><p>      问题是，如果发射器相距太远，那么赢得＆＃39; t是三个梁。有三个光束，扫描是不可能的。发射器必须尽可能靠近波长的一半，以避免向错误的地方发送声音。</p><p> But, commercial ultrasonic transducers are made larger than a wavelength to &#34;pinch&#34; the radiation pattern. They&#39;re mostly used for car parking sensors.</p><p> 但是，商业超声换能器比波长大于＆＃34;捏＆＃34;辐射模式。他们主要用于停车传感器。 </p><p> I searched on Aliexpress and Banggood for hours, there was no way to find ultrasonic transducers small enough.</p><p>我在Aliexpress和Banggood上搜索了几个小时，没有办法找到足够的超声波传感器。</p><p> After entire evenings spent trying to understand why two additional beams would appear when the emitters were too far apart, some blinking flash of intuition stroke me.</p><p> 在整个晚上都花了试图理解为什么当发射器相距太远时会出现两个额外的梁，一些闪烁的直觉闪现了我。</p><p> If I imagine my emitters as plates all touching each other, the wave that they produce can only go in the direction of the beam. There can be no second and third beams on the sides. It&#39;s one of these intuitions that are hard to explain.</p><p> 如果我想象我的发射器就像互相接触一样，它们产生的波浪就可以朝着梁的方向朝向梁。侧面可以没有第二和第三梁。它＆＃39;难以解释的这些直觉之一。</p><p> Until now, my simulation and almost all the ones you can find online assume that the emitters are dots with zero radii. And by simulating these sources not as dots but as &#34;plates&#34; (ie, 10 dots in phase put next to each other), the sonar works!</p><p> 到目前为止，我的模拟和几乎所有您可以在线找到的模拟假设发射器是零半径的点。并通过模拟这些来源，而不是像＆＃34;盘子＆＃34; （即，10个单位彼此放在彼此相邻），声纳工作！</p><p> There&#39;s still a second beam that appears at high angles, and the max scanning angle is lower than if my emitters were closer than half a wavelength. But it should be able to work!</p><p> ＆＃39; s仍然是高角度的第二梁，并且最大扫描角度低于如果我的发射器更近于半波长。但它应该能够工作！</p><p>   I planned to make a 10x10 grid of 10mm transducers. I thought that driving a phased array would be similar to driving an array of LEDs.</p><p>   我计划制作10毫米换能器的10x10格。我认为驾驶相控阵将类似于驾驶阵列LED。</p><p> I bought hundreds of transducers for $50 on Aliexpress.To me, all I needed was 74HC595 Shift Registers (that&#39;s what they use for driving many LEDs) and an NPN transistor to convert the 5V of the shift registers to the 40V of the ultrasonic transducers. Then, I&#39;ll solder hundreds of these components on a protoboard. I had already built rocket parachute timers on protoboards. I thought it would be the same 🙄.</p><p> 我在Aliexpress上购买了数百美元的换能器。在我身上，我所需要的所有情况是74小时595班次寄存器（它们用于驱动许多LED的东西）和NPN晶体管，以将移位寄存器的5V转换为40V超声换能器。然后，我＆＃39; LL焊料数百种这些组件在Protoboard上。我已经在Protoboards上建造了火箭降落伞定时器。我以为它会是一样的。 </p><p> After I received my components, I tried to make an ultrasonic transducer work. When D13 is HIGH, current flows in the transistor and opens it to the alimentation next to it.</p><p>我收到了我的组件后，我试图制作超声波传感器工作。当D13高电平时，电流在晶体管中流动，并打开它到它旁边的共激节。</p><p> If you&#39;ve already done electronics before, you&#39;ve probably laughed out very hard.An ultrasonic transducer is roughly equivalent to a capacitor.A capacitor is like a water reservoir, except for electrons.Therefore, to drive it the circuit needs to empty and to fill that capacitor 40 000 times per second. The NPN capacitor here only cuts out the alimentation of the capacitor, but there&#39;s nothing to discharge it.</p><p> 如果你之前已经做过电子产品，你可能很难笑。超声换能器大致相当于电容器。电容器就像一个水库，除了电子。因此，推动它电路需要空，并填充每秒40 000次电容器。这里的NPN电容器仅切出电容器的消解，但是没有任何东西可以排出它。</p><p> It took me a few days to understand the issue, I then tried another circuit, the half-bridge: When D13 is HIGH, the top transistor is open and the bottom transistor is closed. Current goes from the capacitor to the ground, the capacitor gets discharged.When D13 is LOW, the top transistor is closed and the bottom transistor is open. Current goes from the 40V to the capacitor.</p><p> 我花了几天了解这个问题，然后尝试了另一个电路，半桥：当D13高时，顶部晶体管打开，底部晶体管关闭。电流从电容到地，电容器放电。当D13低时，顶部晶体管闭合，底部晶体管打开。电流从40V到电容器。</p><p> But, In practice, this circuit only works with supply voltages lower than the voltage of the Arduino signal, 5V in my case. The reason for that (and it took me 5 days to figure it out) is that PNP transistors (the kind of the top transistor) are closed when current flows from the top pin to the left pin, and 5V (my Arduino&#39;s voltage) isn&#39;t enough to stop a voltage from a 40V source to induce a current. I needed to drive it with a 40V signal, which meant ANOTHER transistor!   5</p><p> 但是，在实践中，该电路仅适用于电源电压低于Arduino信号的电压，在我的情况下为5V。其中（它花了5天的原因）是PNP晶体管（顶晶体管的种类）当电流从顶部引脚流到左销时，5V（我的Arduino＆＃39; S电压）ISN＆＃39; t足以阻止40V源的电压诱导电流。我需要用40V信号驱动它，这意味着另一个晶体管！ 5.</p><p> Here, the leftmost NPN transistor drives the PNP. The consequence of that is that I need three transistors, three resistors and two Arduino pins for each transducer. That&#39;s 300 transistors and 200 Arduino pins ie 200/8 = 25 shift register pins. That&#39;s too much to fit close to the transducers.</p><p> 这里，最左侧的NPN晶体管驱动PNP。结果是我需要三个晶体管，三个电阻和两个换能器的两个arduino引脚。那个＆＃39; s 300晶体管和200 arduino引脚，即200/8 = 25档寄存器销。那个＆＃39;太多，以靠近换能器。</p><p>  Though, with a functional transmitter, I could get my first beam. I connected 8 emitters in parallel to a half-bridge and got a beam! The emitter is the green light on the bottom. Blue is low signal, white/red/purple is high signal.I used a Teensy 3.2 which shows the signal intensity as a color on a LED. Then, I took a long-exposure photo while making the teensy travel in the beam.   6</p><p>  虽然，使用功能变送器，我可以得到我的第一束。我连接8个发射器并联到半桥并获得梁！发射器是底部的绿灯。蓝色是低信号，白色/红色/紫色是高信号。我使用了Teensy 3.2，它显示了信号强度作为LED上的颜色。然后，我在束中的青铜行驶时拍了一张长时间的照片。 6.</p><p>    Then, I tried to build a half-bridge directly from shift registers. I bought shift registers to replace the PNP transistors and shift registers to replace the NPNs. Those were respectively TPIC9B585Ns and MIC5891s.</p><p>    然后，我试图直接从移位寄存器构建半桥。我购买了移位寄存器以替换PNP晶体管和移位寄存器以替换NPN。那些分别是TPIC9B585NS和MIC5891S。 </p><p> It sort of worked, but the timings were different between both shift registers. Because of that, there would be times were both shift registers would be allowing current to pass, which resulted in a short circuit. The MIC5891s had bad timings at high frequencies, so I got back to the drawing board.</p><p>它有点工作，但两个班次寄存器之间的时间不同。因此，有时换档寄存器都会允许电流通过，从而导致短路。 MIC5891S在高频下具有差的定时，因此我回到了绘图板。</p><p>  Finally, I realized that both NPNs (the one driving the top PNP and the one putting the capacitor to the ground to empty it) could be replaced by an open-drain shift register (which worked well in my latest experiment). So I finally settled on that. I would only need two shift register pins, a transistor and a resistor for each transducer. That amounts to 25 shift registers, 100 transistors and 100 resistors to solder.</p><p>  最后，我意识到，两个NPNS（驱动顶部PNP的一个驱动电容器到接地为清空器的一个驱动电容器）可以由开漏换档寄存器（在我最新的实验中工作得很好）取代。所以我终于解决了这一点。对于每个换能器，我只需要两个移位寄存器引脚，晶体管和电阻器。该量为25次移位寄存器，100个晶体管和100个焊料电阻。</p><p> I quickly realized that there would be way too many components to manually solder. I had to design a PCB.</p><p> 我很快意识到有太多的组件来手动焊接。我必须设计一个PCB。</p><p> I had never done any EDA before, so I started to learn and use KiCad. Two days later, I had my PCB ready to be manufactured!</p><p> 我以前从未做过任何EDA，所以我开始学习和使用KICAD。两天后，我的PCB准备被制造！</p><p> With jlcpcb.com I had my 10 PCBs a week later for $20, including $18 for the fast shipping.I hated using a Chinese company for a job that could be done in France, but no local companies were offering the same service.</p><p> 使用JLCPCB.COM我每周有10个PCB，以20美元的价格为20美元，包括快速送货的18美元。我讨厌在法国可以在法国完成的工作，但没有当地公司提供相同的服务。</p><p>  After an evening of soldering the       8 ∗ 25 + 2 ∗ 100 + 3 ∗ 100 = 700 8*25+2*100+3*100=700    8  ∗    25  +    2  ∗    100  +    3  ∗    100  =    700 pins of my PCBs, I hooked up the Teensy and... It didn&#39;t work.I had forgotten to set a pin to the ground on each of the TPICs 😐. After adding 25 wires to my PCBs, it worked!</p><p>  在一个晚上焊接8 * 25 + 2 * 100 + 3 * 100 = 700 8 * 25 + 2 * 100 + 3 * 100 = 700 8 * 25 + 2 * 100 + 3 * 100 = 700 =我的PCB的700销，我挂了teensy和...它没有工作。我已经忘记将PIN放在每个TPICS上的地面上。在我的PCB中加入25个电线后，它运作了！</p><p>  Then, I had to tightly pack my 100 emitters in a 10x10 grid and connect all of them to my half-bridges. I started with only 40.  From bottom to top: Teensy 3.6 which generates the signals, TS1080 to convert the 3.3V signals to 5V, half-bridge PCBs, transducers. All wires are soldered a l&#39;arrache to the transducers through headers so I can replace or change the polarity of individual transducers easily.</p><p>  然后，我不得不将我的100个发射器紧紧地包装在10x10网格中，并将所有排放物连接到我的半桥。我从底部到顶部开始：青少年3.6，它产生信号，TS1080将3.3V信号转换为5V，半桥PCB，传感器。所有导线都焊接了L＆＃39;通过标头到换能器到换能器，所以我可以轻松替换或改变各个换能器的极性。 </p><p>  I started doing experiments with beamforming on the reception side for additional precision. I googled for &#34;audio amplifier&#34; and used the first schematic I found. I removed the caps because they&#39;re always useless and built this 9x directional receiver with LM386s.  Of course, the signal it gave was too noisy to be used. I had a couple of spare HC-SR04. I wired one and used an oscilloscope probe to look for the analog signal after amplification. I found it and soldered it to the teensy.</p><p>我开始在接待侧进行光束成形进行实验以获得额外的精度。我为＆＃34 Googled;音频放大器＆＃34;并使用了我发现的第一个原理图。我删除了帽子，因为它们＆＃39;重新毫无用处，并用LM386S建立这个9x定向接收器。当然，它给出的信号太吵了。我有几个备用的HC-SR04。我有线了一个并使用示波器探头在放大后寻找模拟信号。我发现它并将其焊接到了teensy。</p><p>   My transducers are directly driven by 25 shift registers. To drive a shift register, there are three pins: CLOCK, LATCH and DATA. To write a series of bits to a shift register, the algorithm is the following:</p><p>   我的传感器直接由25次移位寄存器驱动。要驱动移位寄存器，有三个引脚：时钟，锁存器和数据。要将一系列位写入移位寄存器，该算法如下：</p><p> Write the first bit on the DATA pin (+5V if you want the first pin of the shift register to be connected to the ground, +0V otherwise)</p><p> 在数据引脚上写入第一位（如果希望将移位寄存器的第一个引脚连接到地面，则否则返回返回寄存器，否则）</p><p>             LATCH HIGH (this tells the shift register to change its output, sort of like a buffer swap in a video game.</p><p>             锁存高（这告诉Shift寄存器更改其输出，类似于视频游戏中的缓冲区交换。</p><p> Therefore to change the values in a shift register, I need       8 ∗ 3 + 2 = 26 8*3+2=26    8  ∗    3  +    2  =    26 writes on pins.My transducers work at 40khz, but I&#39;d like to have 40 positions for my beam, which means an update rate of       40 k h z ∗ 40 = 1.6 M h z 40khz*40=1.6Mhz    40 kh z  ∗    40  =    1.6 M h z. I need 21 Teensy writes for 1 shift register write, which is       1.6 M h z ∗ 21 = 33.6 M h z 1.6Mhz*21=33.6Mhz    1.6 M h z  ∗    21  =    33.6 M h zThere are 25 shift registers, so I need to update my output pins at       33.6 M h z ∗ 25 = 840 M h z 33.6Mhz*25=840Mhz    33.6 M h z  ∗    25  =    840 M h z.</p><p> 因此要在移位寄存器中更改值，我需要8 * 3 + 2 = 26 8 * 3 + 2 = 26 8 * 3 + 2 = 26在引脚上写入。换能器在40khz工作，但是我喜欢对于我的光束有40个位置，这意味着更新率为40kHz * 40 = 1.6 M Hz 40kHz * 40 = 1.6MHz 40kH Z * 40 = 1.6 m H z。我需要21个Teensy写入1个移位寄存器写入，即1.6 M Hz * 21 = 33.6 M Hz 1.6MHz * 21 = 33.6MHz 1.6 M Hz * 21 = 33.6 M H ZTHERE是25次移位寄存器，所以我需要更新我的输出引脚33.6 M Hz * 25 = 840 M Hz 33.6MHz * 25 = 840MHz 33.6 M Hz * 25 = 840 m H Z.</p><p> Ouch! That&#39;s going to be hard for a 600Mhz microcontroller! For that sort of requirement, engineers usually use FPGAs. An FPGA is a programmable logic chip that goes much faster for that kind of work. But, I had none on hand so I stayed with the Teensy 3.6.</p><p> 哎哟!那个＆＃39;对于600MHz微控制器来说将很难！对于那种要求，工程师通常使用FPGA。 FPGA是一种可编程逻辑芯片，对于这种工作更快。但是，我手头没有，所以我住在teensy 3.6。</p><p> The advantage of the Teensy is that the digital output values are stored in 32bits registers. I can change all of the pins in parallel using just a couple of instructions. By changing all pins in parrallel, my code &#34;only&#34; needs to run at 33.6Mhz. By pre-computing and storing the register values, I was able to go to that speed easily.</p><p> 青少年的优点是数字输出值存储在32bits寄存器中。我可以使用几个指令并行更改所有引脚。通过改变所有引脚，以平行，我的代码＆＃34;只有＆＃34;需要在33.6MHz上运行。通过预先计算和存储寄存器值，我能够轻松地转到该速度。 </p><p>    The PC tells through the serial port to the Emitter to emit in a specific place (ex: 40° vertical, -20° horizontal), and at the same time tells the receiver to start listening.Once the receiver hears the emitter&#39;s PING, it starts recording. After a few milliseconds, it dumps the data on the serial port.</p><p>PC通过串行端口到发射器中的特定位置发射（例如：40°垂直，水平-20°），并且同时告诉接收器开始收听。接收器听到发射器＆＃39; s ping，它开始录制。在几毫秒之后，它将数据转储串行端口上的数据。</p><p>  S i g n a l ↦ B a n d p a s s   f i l t e r ↦ H i l b e r t    T r a n s f o r m ↦ S ( t ) = t ∗ S ( t ) ↦ T h r e s h o l d i n g Signal \mapsto Bandpass\,filter \mapsto Hilbert\;Transform \mapsto S(t) = t*S(t) \mapsto Thresholding    S i g na l  ↦    B an d p a ss  f i lt er  ↦    H i l b er t  T r an s f or m  ↦    S ( t )  =    t  ∗    S ( t )  ↦    T h res h o l d in g</p><p>  S IGNAL↦Bandpass滤波器↦HILBERTt ransform↦s（t）= t * s（t）↦t hreshold信号\ mapsto带通\，过滤器\ mapsto hilbert \;变换\ mapsto s（t）= t * s（ t）\ Mapsto阈值S Ig NaL↦B一种DPA SS FI LT ER↦HILBERT r A SF或M = S（t）= t * s（t）↦↦↦↦res</p><p> Afterward, all points above a threshold are written as echos and are saved to a file.After launching gnuplot, I got my first 3D Images  Here, the receiver is on top at the left  The room roughly as I scanned it for the first time  Close up on that bird, viewed from the right side  3D Scan of the whole room. We can see the bird on the front, the wall behind and elements of the wall. The emitter is the red circle on the left  Zoom on the bird. The legs and most of the torso aren&#39;t visible because they&#39;re out of the sensor&#39;s field of view</p><p> 之后，阈值上方的所有点都被写为回声，并将其保存到文件中。在启动Gnuplot时，我在此处获得了我的第一个3D图像，接收器在左侧房间的顶部，因为我第一次扫描它第一次扫描它从整个房间的右侧3D扫描从右侧3D扫描中查看。我们可以看到前面的鸟，墙后面和墙的元素。发射器是左边的红色圆圈放大鸟。腿和大多数躯干aren＆＃39; t可见，因为它们＆＃39;从传感器中退出和＃39;的视野</p><p>  Sometimes the acoustic wave does Emitter -&gt; First Object -&gt; Second Object -&gt; Receiver, so there is sometimes a &#34;ghost echo&#34; behind objects.</p><p>  有时声波是发射器 - ＆gt;第一个对象 - ＆gt;第二个对象 - ＆gt;接收器，所以有时候有一个＆＃34;鬼回声＆＃34;背后的物体。</p><p> The scan speed is a few milliseconds for a single point, a minute for a full room at full resolution and a second for a 2D plane at full resolution. While enough for a drone that only needs 2D maps most of the time, it could be too slow for some applications.</p><p> 扫描速度为单点几毫秒，为全部分辨率为一分钟，为全部分辨率为一秒钟，全分辨率为2D平面。虽然足够无人机只需要2D地图​​的无人机，但对于某些应用来说，它可能太慢了。</p><p> I have solutions for each one of these problems but will keep them for myself 😉. I plan to develop this scanner into a useful commercial solution next year.</p><p> 我对这些问题中的每一个都有解决方案，但会让他们成为自己♥。我计划明年将此扫描仪发展成为一个有用的商业解决方案。</p><p>  Getting there was not easy, but could have been doable for a long time. Here are still a few hypotheses:</p><p>  到达那里并不容易，但很长一段时间都可能是可行的。这仍然是一些假设： </p><p> Many who tried to build ultrasonic scanners had only two receivers and tried to correlate the signals. I didn&#39;t go that route because the maths were too complicated and because of its topological limitations. here, not being good enough at maths helped me.</p><p>许多试图构建超声波扫描仪的人只有两个接收器，并试图将信号相关联。我没有去那条路线，因为数学太复杂，因为它的拓扑限制。在这里，在数学上不够好，帮助了我。</p><p> The phased array beamforming seems impossible when you do the usual calculations. But as I didn&#39;t know how to do the usual calculations I did a computer model. It allowed me to be more precise than the usual calculations. This computer model helped me see something the math guys couldn&#39;t.</p><p> 当您执行通常的计算时，相位阵列波束成形似乎是不可能的。但正如我所说的那样，我知道如何做我做电脑模型的平时计算。它允许我比通常的计算更精确。这台计算机模型帮助我看到数学家伙无法＆＃39; t。</p><p> For those who still went the phased array route, none of them was crazy enough to go 3D and go from 10 to 100 transducers. My lack of electronics knowledge helped me here. The &#34;usual&#34; solutions weren&#39;t small enough. But because I didn&#39;t know how hard it would be, I still started. And once I started building the thing, I had to finish it. It pushed me to come up with quite innovative designs that I&#39;m proud of. If I had stayed at the first thinking stage where I designed the circuits to power the transmitter, I would never have built it. When doing new projects or when your knowledge is limited you can&#39;t predict how things will turn out. It&#39;s better to start working on the easy things and move forward bit by bit. Planning everything is impossible.</p><p> 对于那些仍然去序列的阵列路线的人来说，他们都没有足够疯狂的时间去3D，从10到100个传感器。我缺乏电子知识帮助我这里。 ＆＃34;常见的＆＃34;解决方案Weren＆＃39; t小。但是因为我没有知道它是多么努力，我仍然开始了。一旦我开始建造这件事，我必须完成它。它让我想出了我骄傲的相当创新的设计。如果我留在第一款舞台上，我设计了电路供电的电路，我永远不会建造它。在进行新项目或当您的知识限制时，您可以＆＃39; t预测事情将如何结果。它更好地开始在简单的事情上工作并按比特向前移动。规划一切都是不可能的。</p><p> Because I&#39;m alone, I don&#39;t have to ask anyone&#39;s opinion before trying less-traveled roads. I guess that if I had been working at a company, no manager would have approved any of my technical choices.</p><p> 因为我单独，我不必在尝试较少的道路之前问任何人和＃39;＆＃39;我想如果我一直在公司工作，那么没有经理将批准我的任何技术选择。</p><p> If you&#39;ve built something similar, reach out to me! I&#39;ll add you to the article to correct my lie.</p><p> 如果你建造了类似的东西，就可以了解我！我＆＃39; ll将您添加到文章中以纠正我的谎言。</p><p>  I&#39;ve published all code and schematics  on github. If you need any help building the device, email me or open a github issue and I&#39;ll write documentation.</p><p>  我在github上发表了所有代码和原理图。如果您需要任何帮助构建设备，请发送电子邮件给我或打开GitHub问题和i＆＃39; ll写文档。</p><p> My device can help with experiments around radars, beamforming and phased arrays. If you want me to send you one, email me!</p><p> 我的设备可以帮助雷达，波束形成和相控阵的实验。如果你想让我寄给你一个，给我发电子邮件！ </p><p> I searched a bit online for people who did close things. A few guys investigated the principle on hackaday.io, but only a few of them succeeded to build a 2D scanner. None could handle two objects in the same sphere though. There are a few researchers who did articles on the subject, including a team that built a working 2d scanner. Email me if I&#39;m wrong on this.  ↩</p><p>我在线搜索了靠近事情的人。几个人调查了Hackaday.io的原则，但其中只有一些人成功地建造了一个2D扫描仪。无可以在同一个领域中处理两个物体。有一些研究人员是关于该主题的文章，包括建立工作2D扫描仪的团队。如果我在这个问题上给我发电子邮件。 ↩</p><p> Simultaneous Localization and Mapping, basically using a camera to compute a 3D map of the world.  ↩</p><p> 同时本地化和映射，基本上使用相机来计算世界的3D地图。 ↩</p><p> I was proud of my billion-dollar idea, so I showed a drawing of the principle to one of my friends. In a minute, he destroyed it all. &#34;Hey, what happens if a second duck comes here, how do you know if the ducks are side by side or one in front of the other??&#34;. I was pissed. I was thinking of doing it for a school project. Instead, we built an acoustic levitation rig.  ↩</p><p> 我为十亿美元的想法感到骄傲，所以我向我的一个朋友展示了一个原则。在一分钟内，他摧毁了这一切。 ＆＃34;嘿，如果一只第二只鸭子来到这里，你怎么知道鸭子是侧面还是在另一鸭子前面的一个？＆＃34;我生气了。我正在考虑为学校项目做这件事。相反，我们建造了一个声学悬浮钻机。 ↩</p><p>  Courtesy of the Arduino forums and the electronics section of StackOverflow for providing wrong schematics. Don&#39;t trust everything you see on the internet :S  ↩</p><p>  由Arduino论坛和Sackoverflow的电子部分提供提供错误的原理图。不要相信你在互联网上看到的一切：s↩</p><p> Credits to  CNLohr for this technique, which he used to visualize Wifi signals with an ESP8226.  ↩</p><p> 对这种技术的CNLOHR学分，他用于用ESP8226可视化WiFi信号。 ↩ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.alextoussaint.com/2021-04-28_How-I-built-an-ultrasonic-3d-scanner.html">https://www.alextoussaint.com/2021-04-28_How-I-built-an-ultrasonic-3d-scanner.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/建造/">#建造</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/built/">#built</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/寄存器/">#寄存器</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>