<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>了解有关事务隔离级别的信息</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">了解有关事务隔离级别的信息</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-06 03:47:49</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/7/aae2272ce518408c1753a6dc17848808.jpg"><img src="http://img.diglog.com/img/2020/7/aae2272ce518408c1753a6dc17848808.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>数据库无处不在，而且它们会一直存在。如果您对关系数据库比较熟悉，那么您可能对事务比较熟悉。在使用数据库时，事务是非常强大的工具。它们允许多个用户在处理同一数据库时很好地相互配合。然而，随着越来越多的用户连接到同一个数据库，您迟早会遇到性能问题。</p><p>尽管交易很强大，但它是一把双刃剑。如果使用不当，它们可能会耗尽您的数据库资源。事务隔离级别是微调I(隔离)位ACID(原子性、一致性、隔离性、持久性)的一种方式。如果您愿意在隔离的实际含义上做出妥协，则可以增加并发性。</p><p>首先，会出什么问题呢？假设每个语句都遵守ACID原则(确实如此)，当不同用户同时运行多个语句时，您可能会遇到如下问题：</p><p>脏读取-数据在更新过程中被读取。例如：Bob更改了一行，这是事务的一部分。Alice读取该行并获取保存在数据库中的数据。然后，Bob回滚事务。在这种情况下，Alice拥有技术上不存在的数据。</p><p>不可重复读取-后续读取不会返回一致的结果。例如：Alice启动一个读取一行数据的事务。Bob更改该行并提交更改。当在同一事务中时，Alice再次读取同一行，并获得数据的新值。</p><p>幻影读取-后续SELECT语句可能返回不同的结果。例如：Alice使用返回多行的WHERE子句运行SELECT语句。Bob插入一个与Alice之前运行的语句的WHERE子句相匹配的行，并提交结果。Alice运行与她之前运行的相同的SELECT语句，现在她得到了新的行。</p><p>我们看到了可能会出错的地方，现在让我们看看我们如何才能防御它。首先是工具：数据库锁。一旦事务获取了对资源的锁定，它们就可以通过阻止其他事务获取其锁定来限制其他事务对该相同资源的访问。这一点，再加上每个事务在进行操作之前都需要获取适当的锁的事实，为我们提供了一个相当全面的可以操作的机制。</p><p>页级：这是一个中间锁(在行和表之间)，适用于页-表行的子集，通常是在单个磁盘操作中可以从磁盘读取的数据量。</p><p>共享锁定，也称为读锁定。当事务想要读取数据(即SELECT操作)时，通常会请求资源上的共享锁。多个事务可以获取对资源的共享锁定，这意味着多个事务可以同时读取数据。</p><p>排他锁，也称为写锁。排他锁一次只能由单个事务获取。如果存在另一个拥有资源锁(共享或独占)的事务，则该事务将等待另一个事务释放锁。当一个事务持有排他锁时，任何其他事务都不能获取对该资源的任何锁(共享的或独占的)。</p><p>更新锁是排他锁更宽松的版本。可以在具有共享锁的对象上获取更新锁。当事务准备好更新对象时，它会将更新锁转换为排他锁。请注意，可以在具有共享锁的对象上获取更新锁，但不能在具有更新锁的对象上获取共享锁。</p><p>事务利用这些锁来实现不同的隔离级别。在非常高的级别上，隔离级别是平衡并发性和隔离的一种方式。隔离级别越高，锁的限制性就越强，因此获得所述锁需要等待的事务就越多，这将导致事务总数减少。正如他们所说，天下没有免费的午餐。以下是事务隔离级别：</p><p>这是最宽松的隔离级别。它允许当前事务读取其他事务尚未提交的数据。事务不会获取任何资源锁。这可能会导致读取正在被其他事务修改的内容。</p><p>事务只能读取已提交的数据。该事务在读取资源时获取共享锁，并在读取语句完成后立即释放它们。这意味着我们只读取已完成更新的数据，但是因为我们在每条指令之后释放锁，所以在后续读取时可能会得到不同的结果。</p><p>当事务想要读取资源时，它会获取共享锁，并将锁保持到事务结束。因为我们在整个事务中保持共享锁，所以我们确保所有读取都返回相同的数据，因为我们要防止其他事务在事务结束之前修改数据。</p><p>事务内的所有读取都返回事务开始时可用的数据。这就好像事务在开始时拍摄数据的快照，并在整个事务中使用该快照。它在功能上类似于下面描述的可序列化级别，但它使用了一种略有不同的机制来实现这一点。</p><p>这是可用的最高隔离级别。事务获取需要读取的资源的读锁定，并在事务持续时间内保留它们，从而确保数据在读取后在事务持续时间内保持不变。它还在更新数据时获取排他锁，并在事务结束时释放它们。此外，事务会对当前事务中匹配条件的任何行设置行范围锁，这样我们就可以避免幻影读取。</p><p>总而言之，每次在代码中使用事务时，都应该花点时间考虑所需的适当隔离级别。您可以将所有内容都设置为可序列化，然后就到此为止，但在大多数情况下，不需要这么强的限制，这样只会给数据库带来不必要的延迟。对于大多数情况，在提交读取和可重复读取之间进行选择就足够了。把这张桌子牢记在心，因为它会帮助你做出决定。始终使用您的应用程序可以承受的最宽松的隔离级别。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://lanraccoon.com/2020/learn-about-transaction-isolation-levels/">https://lanraccoon.com/2020/learn-about-transaction-isolation-levels/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/事务/">#事务</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>