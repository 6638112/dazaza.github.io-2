<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>可视化40M信号塔 Visualization of 40M Cell Towers</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Visualization of 40M Cell Towers<br/>可视化40M信号塔 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-18 03:07:22</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/394f455c31f86cf2086d92341dffa64e.png"><img src="http://img2.diglog.com/img/2021/2/394f455c31f86cf2086d92341dffa64e.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>OpenCelliD is the world&#39;s largest 	open database of cell towers with a license	 CC BY-SA 4.0</p><p>OpenCelliD是世界上最大的使用许可证打开手机发射塔数据库CC BY-SA 4.0</p><p>    This tabular data[1] has ~40 million rows and 6 columns in it but only 3	columns (latitude, longitude, and type) are used in this visualization.</p><p>    该表格数据[1]包含约4000万行和6列，但只有3个在此可视化中使用列（纬度，经度和类型）。</p><p>       [1] Structure of input data.  Above table data is read line by line and grouped by their location info.	Grouping is done as if they were  XYZ Tiles.</p><p>       [1]输入数据的结构。上表数据逐行读取，并按其位置信息分组。就像它们是XYZ Tiles一样完成分组。</p><p>  First, empty 2d integer arrays for each tile are created and its elements are 	initialized with value = 0. 	Those values hold a counter that shows the number of rows that 	geographically contained in that pixel.	Every row increases the relevant counter by one[2]. 	After iterating all rows with this method, we end up with a bunch of	integer values (in different 2d arrays) that represent row counts per region.</p><p>  首先，为每个图块创建空的2d整数数组，其元素为用值= 0初始化。这些值包含一个计数器，该计数器显示的行数在地理上包含在该像素中。每行将相关计数器增加一个[2]。使用此方法迭代所有行之后，我们最终得到了一堆整数值（在不同的2d数组中），它们表示每个区域的行数。</p><p>       [2] Each row increases relevant counter.  In order to achieve city-level resolution for visualization, tiles up to	zoom level 9 should be generated. 	 	For XYZ tiles, the number of tiles per zoom level is 4^zoom.	Therefore, for zoom levels between 0 to 9, the number of tiles that should be generated 	becomes 4^0 + 4^1 + 4^2 + .. + 4^9 which equals to 349525.	Every tile has 256x256 integer values.	Even with using 32 bit-sized integer values, 	one tile occupies 256 * 256 * 32 bit = 256 kilobytes of storage,	and  349525 tiles occupies  87 gigabytes of storage which is 	definitely not acceptable.</p><p>       [2]每行增加相关的计数器。为了达到城市级别的可视化分辨率，应生成缩放级别9。对于XYZ拼贴，每个缩放级别的拼贴数为4 ^ zoom。因此，对于介于0到9之间的缩放级别，应生成的图块数量变为4 ^ 0 + 4 ^ 1 + 4 ^ 2 + .. + 4 ^ 9，等于349525。每个图块都有256x256整数值。即使使用32位大小的整数值，一个图块占用256 * 256 * 32位= 256 KB的存储空间，349525磁贴占用87 GB的存储空间，绝对不能接受。</p><p>  To solve this size problem every tile blob is compressed independently	with a modern compression algorithm 	 brotli.	Despite being slow to encode, brotli has a fast decoding speed and high compression ratio	compared to older compression methods like gzip. Additionally, 	brotli-compressed-data is  	natively decodable with all modern browsers.	Since there are no cell towers in oceans or uninhabitable areas, tiles for those regions 	are full of zero values or very sparse. Due to this high redundancy,	compression performed extremely well for those regions (256kb compressed to 20~100bytes).</p><p>  为了解决此大小问题，每个图块Blob均独立压缩采用现代压缩算法布罗特利。尽管brotli编码速度较慢，但​​其解码速度快且压缩率高与较旧的压缩方法（例如gzip）相比。此外，brotli-compressed-data是所有现代浏览器均可本地解码。由于在海洋或不宜居住的地区没有手机信号塔，因此这些地区的瓷砖充满零值或非常稀疏。由于这种高冗余度，这些区域的压缩效果非常好（256kb压缩到20〜100bytes）。</p><p>  In order to simplify the algorithm, it is described as if there was only one  counter value in each pixel, but there are 4 counter values per pixel each holding number of row counts for different cell tower types[3]</p><p>  为了简化算法，它被描述为好像只有一个 每个像素中的计数器值，但每个像素中有4个计数器值 持有不同蜂窝塔类型的行数[3] </p><p>       [3] Every pixel stores more than one channels (counter)  Even though these tiles are stored like XYZ tiles, they are not  valid XYZ tiles.Since these blobs are just brotli-compressed-integer-arrays. Visualization requires a blob to image conversion. This conversion is done by client side javascript and HTML5 Canvas API.</p><p>[3]每个像素都存储一个以上的通道（计数器），即使这些图块像XYZ图块一样存储，但并非 有效的XYZ区块。由于这些Blob只是brotli-compressed-integer-arrays。 可视化要求从blob到图像的转换。此转换是 由客户端javascript和HTML5 Canvas API完成。</p><p>  Underlying map displaying library in this visualization is  leaflet. Kudos to leaflet author(s) for writing such a well documented and extendable map library, I was able to write a custom tile layer for leaflet that  intercepts the image tile requests made by leaflet and redirects those image tile requests to an image generating (client-side) web worker that  works like a tile server. Web worker follows a simple algorithm for image generation. It reads the row count values pixel by pixel and generates a color for that pixel (higher the row count lighter and more opaque the pixel color).</p><p>  此可视化中的基础地图显示库为  传单。 传单作者对编写如此有据可查且可扩展的文档表示敬意 地图库，我能够为传单编写一个自定义的图块层 拦截传单发出的图像平铺请求并将其重定向 图像图块向图像生成（客户端）网络工作者发出的请求 像磁贴服务器一样工作。网络工作者遵循一种简单的算法来生成图像。 它逐像素读取行计数值，并为此生成颜色 像素（行计数越高，像素颜色越不透明）。</p><p>  To summarize, this was a fun project for me to work on and I learned a lot  about data compression and multi-threading while working on this.  By off-loading compute-intensive tasks to web-workers, very impressive visualizations can be made even without sacrificing a single FPS drop on UI thread.</p><p>  总而言之，这对我来说是一个有趣的项目，我学到了很多东西 有关数据压缩和多线程处理的信息。 通过将计算密集型任务卸载到Web工作者，非常令人印象深刻的可视化 即使不牺牲UI线程上的单个FPS也可以实现。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://alpercinar.com/open-cell-id/">https://alpercinar.com/open-cell-id/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/可视化/">#可视化</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/信号/">#信号</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cell/">#cell</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/图块/">#图块</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>