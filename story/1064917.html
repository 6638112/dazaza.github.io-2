<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>去1.17 beta </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">去1.17 beta </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-11 02:59:19</div><div class="page_narrow text-break page_content"><p>1.17尚未释放1.17。这些是正在进行的工作发布说明。 GO 1.17预计将于2021年8月发布。</p><p>   从切片到数组指针的转换：[] t的表达式现在可以转换为阵列指针类型* [n] t。如果a是这种转换的结果，则在范围内的相应指标是指相同的基础元素：＆amp; a [i] ==＆amp; s [i] 0 <= i＆lt; N.如果LEN（S）小于N.，则转换速度</p><p>  UNSEAFE.ADD：UNSEAK.ADD（PTR，LEN）将LEN添加到PTR并返回更新的指针UNSEW.POINTER（UINTPTR（PTR）+ UINTPTR（LEN））。</p><p>  UNSEASE.SLICE：对于类型* T的表达式PTR，UNSEAKE.SLICE（PTR，LEN）返回一片类型[] T的底层数组在PTR处启动，其长度和容量是LEN。</p><p> 添加了这些增强功能以​​简化符合不安全的书写代码.Pointer＆＃39; S安全规则，但规则保持不变。特别是，正确使用UNSAWE.POINTER的现有程序仍然有效，并且使用UNSEASE.ADD或UNSEAFE.SLICE时仍必须遵循规则。</p><p> 请注意，从切片到数组指针的新转换是第一种在运行时可以恐慌的情况。应更新假设类型转换的分析工具，应该更新，以考虑这种可能性。</p><p>   如在Go 1.16发行说明中宣布，Go 1.17需要Macos 10.13高塞拉或更高版本;已停止对以前版本的支持。 </p><p>Go 1.17在Windows（Windows / ARM64端口）上增加了64位ARM架构的支持。此端口支持CGO。</p><p>   在GO 1.16中，OpenBSD上的64位X86和64位ARM架构（OpenBSD / AMD64和OpenBSD / ARM64端口）系统调用是通过LIBC进行的，而不是直接使用机器指令。在Go 1.17，这也在OpenBSD上的32位X86和32位ARM架构上进行（OpenBSD / 386和OpenBSD / ARM端口）。这可确保与未来OpenBSD版本的转发兼容性，特别是OpenBSD 6.9，这需要通过Libc进行系统调用以获取非静态Go二进制文件。</p><p>  GO程序现在在所有操作系统上维护在64位ARM架构上的堆栈帧指针。以前，它仅在Linux，MacOS和iOS上维护堆栈帧指针。</p><p>    如果模块在其go.mod文件中指定了1.17或更高版本，则其传递要求现在懒惰地加载，避免需要下载或读取Go.mod文件以获取其他无关依赖项。为了支持延迟加载，在Go 1.17模块中，Go命令在Go.mod文件中保持明确的要求，每个依赖项都提供了通过模块内的任何包或测试中的任何包裹导入的任何程序包。有关详细信息，请参阅设计文档。</p><p> 由于Go.mod文件中的其他显式要求的数量可能是大量的，因此在GO 1.17模块中，对间接依赖项的新添加要求在包含直接依赖的块的单独要求块中维护。</p><p> 为了促进升级到延迟加载，Go Mod整洁子命令现在支持-go标志来设置或更改Go.mod文件中的Go版本。要为现有模块启用延迟加载，而无需更改所选版本的依赖项，请运行：</p><p>  默认情况下，Go Mod整洁验证与主模块相关的所选版本的依赖关系是与先前的Go释放（Go 1.16用于Spsecifies Go 1.17）的相同版本，并保留Go.Sum条目即使对于其他命令通常不需要的依赖项，也需要该释放。 </p><p>-compat标志允许覆盖该版本来支持较旧的（或仅更新）版本，最多于Go.mod文件中的Go指令指定的版本。仅为Go 1.17模块进行Go 1.17，而不保存校验和（或检查一致性）Go 1.16：</p><p>  请注意，即使主模块与-compat = 1.17整合，需要从Go 1.16或更早的模块中需要模块的用户仍然可以使用它，只要软件包仅使用兼容的语言和库功能即可。</p><p>  模块作者可以通过添加//弃用：评论到go.mod，然后标记新版本来弃用模块。如果不推荐使用要在命令行中命名的软件包所需的模块，请立即打印警告。 go list -m -u打印所有依赖项的弃弃（使用-f或-json显示完整消息）。 Go命令认为不同的主要版本是不同的模块，因此可以使用此机制，例如，为用户提供新的主要版本的迁移指令。</p><p>  弃用Go Get -Insecure标志并已删除。要允许在获取依赖项时使用不安全方案，请使用GoIsecure环境变量。如果您需要该功能，则绕过模块总和验证，请绕过模块总和验证，使用goprivate或gonosumdb。有关详细信息，请参阅GO帮助环境。</p><p>  如果主模块＆＃39; s go.mod文件不包含go指令并且go命令无法更新go.mod文件，则Go命令现在假定Go 1.11而不是当前版本。 （Go Mod Init从1.12开始自动添加Go指令。）</p><p> 如果模块依赖项缺少显式go.mod文件，或者它的go.mod文件不包含Go指令，则Go命令现在假定该依赖性而不是当前版本。 （GoPath模式中开发的依赖项可能缺少Go.mod文件，并且vendor / modules.txt必须迄今为止从未记录过依赖关系和＃39所示的Go版本; Go.mod文件。）</p><p>  如果主模块指定Go 1.17或更高版本，则Go Mod供应商现在使用每个Vendored模块指示的Go版本以其自己的Go.mod文件注释给vendor / modules.txt。在从助源代码中构建模块＆＃39; s软件包时使用注释版本。 </p><p>如果主模块指定Go 1.17或更高版本，则of Mod供应商现在省略Go.mod和go.sum文件，用于vendered依赖项，否则可能会干扰go命令在供应商树中调用时识别正确的模块根目录的能力。</p><p>  默认情况下，Go命令禁止SSH密码提示和Git凭证管理器在使用SSH获取Git存储库时提示，因为它已经为其他Git密码提示进行了。使用受密码保护SSH的私有GIT Repos验证的用户可以配置SSH代理以启用Go命令以使用受密码保护的SSH键。</p><p>  在没有参数的情况下调用Go Mod下载时，它将不再将下载的模块内容保存到go.sum。它仍可能更改Go.mod和go.sum需要加载构建列表。这与1.15中的行为相同。要为所有模块保存和，请使用Go Mod下载全部。</p><p>  Go命令现在了解// go：构建行并更喜欢它们超过// +构建线。新的语法使用布尔表达式，就像go一样，并且应该减少错误。正如此版本所示，新语法完全支持，并且应该更新所有Go文件，以具有相同含义的两种表单。为了帮助迁移，GOFMT现在自动同步两种形式。有关语法和迁移计划的更多详细信息，请参阅https://golang.org/design/draft-gobuild。</p><p>   GOFMT（和GO FMT）现在同步// GO：使用// +构建行构建行。如果文件只有// +构建行，则它们将被移动到文件中的相应位置，并匹配// go：将添加构建线。否则，// +构建线将基于任何现有// go覆盖：构建行。有关更多信息，请参阅https://golang.org/design/draft-gobuild。 vet工具现在验证// go：build和// +构建行位于文件的正确部分并彼此同步。如果他们aren＆＃39; t，gofmt可用于修复它们。有关更多信息，请参阅https://golang.org/design/draft-gobuild。</p><p>  兽医工具现在警告呼叫信号。通过将传入信号发送到未禁止的通道。使用无缓冲的频道风险丢失在它们上发送的信号作为信号。发送到通道时不会阻止。例如：</p><p> C：= make（Chan OS.Signal）//在读取频道的C中发送信号//信号。//此信号可以丢弃，因为C是不禁止的。徽章.Notify（C，OS.interruct） </p><p>信号的用户.Notify应该使用具有足够缓冲空间的通道来跟上预期的信号速率。</p><p>  vet工具现在警告了名为的方法，它是或揭示实现具有不同签名的错误接口的类型，这些类型与错误包的预期相同的错误接口。错误。{如，unwrap}函数期望实现这样的方法是（错误）bool，分别为（接口{}）bool或unwrap（）错误。函数错误。{如，unwrap}将忽略具有相同名称但不同签名的方法。例如：</p><p> 键入myError struct {提示字符串} func（m myError）错误（）字符串{...} // myError实现错误.Func（MyError）是（target接口{}）bool {...} //目标是界面{而不是Error.func foo（）bool {x，y：= myError {＆＃34; a＆＃34;}，myerror {＆＃34; b＆＃34;返回错误.is（x，y）//返回false作为x！= y和myError没有`是（错误）bool`功能。}</p><p>  封面工具现在使用来自golang.org/x/tools/cover的优化解析器，当解析大覆盖配置文件时可能明显更快。</p><p>  Go 1.17实现了一种通过寄存器而不是堆栈传递函数参数和结果的新方法。在64位X86架构（Linux / AMD64，Darwin / AMD64，Windows / AMD64端口）上为Linux，MacOS和Windows启用了此工作。对于代表性的GO包和程序，基准测试显示了大约5％的性能提高，并且二元尺寸的典型降低约为2％。</p><p> 此更改不会影响任何安全GO代码的功能。它可以影响兼容性指南之外的代码，影响最小。为了保持与现有装配函数的兼容性，有时会使用适配器功能在新的寄存器的调用约定和基于堆栈的呼叫约定（也称为ABI包装）之间进行转换。除了用于进入其地址的装配功能外，这对用户来说主要是不可见的。使用reflect.valueof（fn）.pointer（）（或类似方法，如通过不安全.pointer），以获取装配函数的地址现在将返回abi包装器的地址。除了专用汇编代码外，这主要是无害的（例如访问线程本地存储或需要特殊的堆栈对齐）。现在将通过Func值间接调用的装配函数通过ABI包装器进行，这可能会导致非常小的性能开销。此外，从程序集中调用Go函数现在可以通过ABI包装，具有非常小的性能开销。</p><p> 从运行时的堆栈迹线的格式（在发生未捕获的恐慌时打印或调用runtime.stack时）。以前，函数参数基于内存布局打印为十六进制单词。现在，源代码中的每个参数都是单独打印的，用逗号分隔。 Crace括号分隔串字键入（结构，阵列，字符串，切片，interface和复杂）参数。一种警告是，只有在寄存器中且不存储到存储器的参数的值可能是不准确的。结果（通常是不准确的）不再打印。 </p><p>现在可以内向包含闭包的功能。这种变化的一个效果是具有封闭件的功能实际上可以为函数内衬的每个地方产生不同的闭合功能。因此，这种变化可以揭示通过指针值（错误地）进行比较的错误（错误地）。 go函数是根据定义不可比较的。</p><p>   运行时/ CGO软件包现在提供了一个新的工具，允许将任何GO值转换为可用于在C之间传递值的安全表示，并安全地转到。有关更多信息，请参阅运行时/ cgo.handle。</p><p>  与始终一样，与兼容兼容性的Go 1承诺进行了各种次要的更改和更新。</p><p> 新方法file.openraw，writer.createraw，writer.copy为性能是主要问题的情况提供支持。</p><p> Writer.Writerune方法现在为负符号值写入替换字符U + FFFD，因为它为其他无效符号。</p><p> Buffer.Writerune方法现在为负符号值写入替换字符u + fffd，因为它为其他无效符号。</p><p> 保证NewReader函数返回新类型阅读器的值，并保证类似NewWriter以返回新类型编写器的值。这些新类型都实现了允许重用读取器或写入器的重置方法（Reader.Reset，Writer.Reset）。 </p><p>Crypto / ED25519包已被重写，所有操作现在大约是AMD64和ARM64上的两倍。可观察的行为尚未改变。</p><p> Curveparams方法现在可用时自动调用更快和更安全的专用实现（P-224，P-256和P-521）。请注意，这是一种最佳方法，应用程序应避免使用通用，而不是恒定时间Curveparams方法，而是使用诸如P256等专用曲线实现。</p><p>  已经使用Fiat-Crypto项目生成的代码重写P521曲线实现，该项目基于算术运算的正式验证模型。它现在是恒定的时间，在AMD64和ARM64上快三倍。可观察的行为尚未改变。</p><p> Crypto / Rand包现在使用MacoS上的Getentropy Syscall和Solaris，Illumos和DragonflyBSD上的Getrandom Syscall。</p><p> New Conn.HandShakeContext方法允许用户控制取消In-progrest TLS握手。通过新的ClientHelloInfo.context和CertificateRequestinfo.context方法可以从各种回调访问提供的上下文。握手完成后取消上下文没有效果。</p><p>  当设置CONFIG.NEXTPROTOS时，服务器现在强制执行配置协议和客户端通告的协议之间存在重叠，如果有的话。如果没有重叠，则根据RFC 7301的要求，使用No_Application_Protocol警报关闭连接。</p><p>  Critepto / TLS包现在完全处理密码套件订购。目前，考虑到本地和对等的硬件，根据其安全性，性能和硬件支持来排序密码套件。 CONFIG.CIPHERSUITES字段的顺序现已忽略，以及CONFIG.PREFERSERVERCIPHERSUITES字段。请注意，CONFIG.CIPHERSUITES仍然允许应用程序选择TLS 1.0-1.2的CIPHIAT SUIDES启用。 </p><p>由于基本块大小相关的弱点，3DES密码套件已被移​​动到Inecureciphersuites。由于上面的密码套件订购更改，它们仍然默认实现，但仅作为最后的手段。</p><p> CreateCertificate现在如果提供的私钥并不匹配父钥匙，则返回错误，如果有的话，则匹配父母＆＃39;结果证书未能验证。</p><p>    Parsecertificate已被重写，现在消耗较少的资源〜70％。除了错误消息外，可观察行为尚未改变。</p><p>  在BSD系统上，现在搜索/ etc / ssl / certs以获得可信根。这为FreeBSD 12.2+中的新系统可信证书商店添加了支持。</p><p> 如果此字段中的类型实现IO.closer接口，则DB.Close方法现在关闭连接器字段。</p><p>  新的nullint16和nullbyte structs表示可能为null的INT16和字节值。这些可以用作扫描方法的目的地，类似于unullstring。</p><p>  Binary.Uvarint将在10个字节后停止读取以避免浪费的计算。如果需要超过10个字节，则返回的字节计数为-11。在读取错误编码的Varints时，之前的Go版本可能会返回更大的负计数。 </p><p>新reader.fieldPOS方法返回与读取最近返回最近返回的记录中给定字段的开头的行和列。</p><p>  新的context.tooltags字段包含适合当前Go Toolchain配置的构建标记。</p><p> 源和节点函数现在同步// go：使用// +构建行构建行。如果文件只有// +构建行，则它们将被移动到文件中的相应位置，并匹配// go：将添加构建线。否则，// +构建线将基于任何现有// go覆盖：构建行。有关更多信息，请参阅https://golang.org/design/draft-gobuild。</p><p>  数学包现在定义了三个常量：maxuint，maxint和minint。对于32位系统，它们的值分别为2 ^ 32-1,2 ^ 31  -  1和-2 ^ 31。对于64位系统，它们的值分别为2 ^ 64-1,2 ^ 63-1和-2 ^ 63。</p><p> 在UNIX系统上，现在可以从本地系统读取MIME类型的表格＆＃39; S共享MIME-INFO数据库。</p><p> 新方法IP.isprivate报告地址是根据RFC 1918的私有IPv4地址，或根据RFC 4193的本地IPv6地址。</p><p>  Go DNS解析器现在仅在解析IPv4-only或IPv6网络的地址时发送一个DNS查询，而不是查询两个地址系列。 </p><p>PARSEIP和PARSecidr函数现在拒绝包含带有前导零的十进制组件的IPv4地址。这些组件始终被解释为十进制，但有些操作系统将它们视为八进制。如果使用GO应用程序用于验证其原始表单使用的IP地址，则此错位可能会导致安全问题，然后使用其原始表单使用的非Go应用程序，该应用程序将其解释为八进制的组件。通常，建议在验证后始终重新编码值，这避免了这类解析器错位问题。</p><p> NET / HTTP软件包现在在客户端或服务器中执行TLS握手时使用新的（* tls.conn）.handshakecontext。</p><p>  将服务器ReadTimeout或WriteTimeout字段设置为负值，现在没有超时而不是立即超时。</p><p> OrkeTereCorder.WriteHiteHerder＆gt;现在，当提供的代码不是有效的三位HTTP状态代码时，恐慌。这符合responswriter＆gt的行为。网络/ HTTP包中的实现。</p><p>  文件.WriteString方法已被优化，以不再制作输入字符串的副本。</p><p> new structfield.isexported和方法.Xported方法报告是否导出了结构字段或类型方法。它们提供了更可读的替代方案来检查PKGPath是否为空。</p><p>  新的VisibleFields函数以STRUCT类型返回所有​​可见字段，包括匿名结构成员内的字段。 </p><p>Strconv封装现在使用ULF ADAMS＆＃39; sRyū算法来格式化浮点数。 该算法在大多数输入上提高性能，并且在最坏情况的输入上更快地超过99％。  新QuoteDPrefix函数在输入开始时返回引用的字符串（如uTuquate）。  Builder.Writerune方法现在为负符号值写入替换字符U + FFFD，因为它为其他无效符号。  GetQueuedCompletionStatus和PostQueuedCompletionStatus函数现在已被弃用。 这些函数具有不正确的签名，并在golang.org/sys/windows包中取代等效项。  在UNIX的系统上，现在使用阻塞的信号设置子进程的进程组。 这避免了当父级在Backgro时向孩子发送Sigttou  ...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://tip.golang.org/doc/go1.17">https://tip.golang.org/doc/go1.17</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/beta/">#beta</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>