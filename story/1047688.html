<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Facebook工程：自动根本原因分析 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Facebook工程：自动根本原因分析 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-10 04:10:47</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/2f7e11868f60373d2bf0f48c40a00a9c.png"><img src="http://img2.diglog.com/img/2021/2/2f7e11868f60373d2bf0f48c40a00a9c.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>根本原因分析（RCA）是修复任何错误的重要组成部分。毕竟，如果不深究问题，就无法解决问题。但是RCA并不总是那么简单，尤其是在像Facebook这样的规模上。当数十亿人在各种平台和设备上使用应用程序时，单个错误可以自行创建多个不同的问题，并且多个错误可以同时发生。</p><p> 曾经有一段时间，应召唤的工程师不得不花费数小时甚至数天的时间来手动梳理错误报告，寻找可以帮助他们调试的模式。今天，他们可以使用Minesweeper，这是我们为使RCA自动化而开发的一种技术，可以根据其症状识别错误的原因。</p><p> 基于Minesweeper的RCA是完全自动化和可扩展的，它以正式的统计概念为基础。我们使用Facebook应用程序的真实错误报告对Minesweeper进行的评估证明，它可以在几分钟内对成千上万的报告执行RCA，并且可以以85％的准确性确定错误的根本原因。</p><p> 自开发以来，Minesweeper已成为Facebook抵御错误的第一道防线，并帮助我们防止了潜在的大规模中断影响我们应用程序上的人员。</p><p>  每当有人通过Facebook应用程序报告错误时，错误报告系统通常会捕获该人在遇到该错误之前在该应用程序中执行的动作（或“事件”）的时间顺序跟踪。其想法是获取可能导致错误发生的原因的快照，例如以下示例：</p><p>  扫雷器扫描这些痕迹以寻找可能指出错误原因的独特模式。将包含错误的跟踪（测试组）与不包含错误的跟踪（对照组）进行比较。扫雷器发现了与对照组相比在统计学上与测试组不同的事件模式。这些模式可能与错误相关，因此可以指出其根本原因。</p><p> 这是一个例子。假设（假设）有10个人正在使用Facebook应用程序。其中有五个人报告问题，并且在应用程序中跟踪了八个可能的事件（a，b，…到h）。在这些事件上，我们总共有10条痕迹，在测试组（T）中有5条来自遇到该bug的人，在对照组（C）中有5条来自其余没有发现该错误的人。 </p><p>将Minesweeper应用于这些迹线时，首先要提取T和C中的顺序模式。顺序模式只是发生的事件的时间顺序，但不一定是一个接一个的发生（即，在它们之间可能存在其他不重要的事件）。</p><p>     系统可以在此处提取的模式的一个示例是→c。对于每个模式，它计算在每个组（T和C）中出现的迹线数。在上面的示例中，此模式在T中出现了两次（t 1和t 2），因此在T中的支持为2。在这种情况下，在C中的支持也为2（t 7和t 8）。请注意，模式空间本质上是组合的，因此使用能够有效搜索该空间而不会发生指数爆炸的算法至关重要。</p><p> 提取所有模式及其在T和C中的支持后，系统将执行统计隔离。对于每个模式P，它使用其支持来计算精度和召回率：</p><p>  非正式地，精度描述了P在检测给定迹线是否在测试组而不是对照组中的精确度，而召回率则描述了测试组P可以覆盖多少。例如，图案b的精度为0.75，因为它总共出现在四条迹线上，其中三条在测试组中（即，它对测试组有75％的特异性）。召回率也为0.6，因为它出现在测试组的五分之三的痕迹中（即，它覆盖了测试组的60％）。</p><p> F1分数是两者的谐波平均值0.67。系统以这种方式计算所有模式的F1得分，并返回按F1得分排名的所有模式的列表，如下表所示。</p><p>  在此示例中，结果显示模式b→c是排名最高的。在实际情况下，调试报告的工程师可以推断出按该顺序发生的事件b和c是可疑的，应进行仔细检查。</p><p>  为了使Minesweeper能够在Facebook的规模和复杂性下工作，我们从数据挖掘社区借鉴了一个想法-顺序模式挖掘-来帮助跟踪事件在跟踪中出现的顺序。 </p><p>在Facebook上，遇到成千上万与错误相关的痕迹并不罕见。为了解决这个问题，我们利用了PrefixSpan算法，该算法在顺序模式挖掘中非常高效，因此众所周知。为了根据模式对测试组的独特性对模式进行排序，从而对RCA有用，我们基于模式的精度和召回率利用了上述统计方法。最后，为了从可用性的角度使Minesweeper变得实用，我们解决了一些以人为中心的挑战，例如避免使用类似于解释根本原因的“冗余”模式。</p><p>    Minesweeper在帮助Facebook的工程师分析和诊断回归（一组崩溃或错误报告中的突然尖峰）方面发挥了重要作用，在几分钟之内就可以提供洞察力，而这可能需要几天才能收集。由于Facebook应用程序的复杂性和产品发布周期，通常会同时进行多次回归，尤其是在发布新版本之后。但多亏了Minesweeper，从事面向用户回归的工程师可以对它们进行及时分析，从而使他们减少和减轻对Facebook服务的干扰比以往更加容易。</p><p> 我们的论文“基于应用遥测的可扩展统计根本原因分析”提供了更多技术信息。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://engineering.fb.com/2021/02/09/developer-tools/minesweeper/">https://engineering.fb.com/2021/02/09/developer-tools/minesweeper/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/facebook/">#facebook</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/工程/">#工程</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/模式/">#模式</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1047609.html"><img src="http://img2.diglog.com/img/2021/2/thumb_7c108cce8d75532a0f4a04e4269d2c47.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047609.html">Shopify即将将其结帐和付款处理服务Shop Pay带到今天的Instagram和未来几周的Facebook商店中 </a></div><span class="my_story_list_date">2021-2-9 23:35</span></div><div class="col-sm"><div><a target="_blank" href="/story/1047606.html"><img src="http://img2.diglog.com/img/2021/2/thumb_d346c4ed9741a51f1329caceb4892d8a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047606.html">Facebook起诉“失去对用户数据的控制” </a></div><span class="my_story_list_date">2021-2-9 23:34</span></div><div class="col-sm"><div><a target="_blank" href="/story/1047593.html"><img src="http://img2.diglog.com/img/2021/2/thumb_afb4346fdac3dcde7705b21836b5802f.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047593.html">欧盟看起来将跟随澳大利亚的要求，要求谷歌和Facebook为新闻报道付费 </a></div><span class="my_story_list_date">2021-2-9 22:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1047592.html"><img src="http://img2.diglog.com/img/2021/2/thumb_66f02b3d4400930525a627d2bf6ae2c8.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047592.html">Shopify将其付款选项Shop Pay扩展到其在Facebook和Instagram上的商家 </a></div><span class="my_story_list_date">2021-2-9 22:51</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>