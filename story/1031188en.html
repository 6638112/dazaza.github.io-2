<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>为什么set-e(或set-o errexit或trap err)没有执行我预期的操作？</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">为什么set-e(或set-o errexit或trap err)没有执行我预期的操作？</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-26 11:45:30</div><div class="page_narrow text-break page_content"><p>Once upon a time, a man with a dirty lab coat and long, uncombed hair  showed up at the town police station, demanding to see the chief of  police. &#34;I&#39;ve done it!&#34; he exclaimed. &#34;I&#39;ve built the perfect  criminal-catching robot!&#34;    The police chief was skeptical, but decided that it might be worth  the time to see what the man had invented. Also, he secretly thought,  it might be a somewhat unwise move to completely alienate the mad  scientist and his army of hunter robots.    So, the man explained to the police chief how his invention could tell  the difference between a criminal and law-abiding citizen using a  series of heuristics. &#34;It&#39;s especially good at spotting recently  escaped prisoners!&#34; he said. &#34;Guaranteed non-lethal restraints!&#34;    Frowning and increasingly skeptical, the police chief nevertheless  allowed the man to demonstrate one robot for a week. They decided that  the robot should patrol around the jail. Sure enough, there was a  jailbreak a few days later, and an inmate digging up through the  ground outside of the prison facility was grabbed by the robot and  carried back inside the prison.    The surprised police chief allowed the robot to patrol a wider area.  The next day, the chief received an angry call from the zookeeper.  It seems the robot had cut through the bars of one of the animal cages,  grabbed the animal, and delivered it to the prison.    The chief confronted the robot&#39;s inventor, who asked what animal it  was. &#34;A zebra,&#34; replied the police chief. The man slapped his head and  exclaimed, &#34;Curses! It was fooled by the black and white stripes!  I shall have to recalibrate!&#34; And so the man set about rewriting the  robot&#39;s code. Black and white stripes would indicate an escaped  inmate UNLESS the inmate had more than two legs. Then it should be  left alone.    The robot was redeployed with the updated code, and seemed to be  operating well enough for a few days. Then on Saturday, a mob of  children in soccer clothing, followed by their parents, descended  on the police station. After the chaos subsided, the chief was told  that the robot had absconded with the referee right in the middle of  a soccer game.    Scowling, the chief reported this to the scientist, who performed a  second calibration. Black and white stripes would indicate an escaped  inmate UNLESS the inmate had more than two legs OR had a whistle on  a necklace.    Despite the second calibration, the police chief declared that the robot  would no longer be allowed to operate in his town. However, the news  of the robot had spread, and requests from many larger cities were  pouring in. The inventor made dozens more robots, and shipped them off  to eager police stations around the nation. Every time a robot grabbed  something that wasn&#39;t an escaped inmate, the scientist was consulted,  and the robot was recalibrated.    Unfortunately, the inventor was just one man, and he didn&#39;t have the  time or the resources to recalibrate EVERY robot whenever one of them  went awry. The robot in Shangri-La was recalibrated not to grab a  grave-digger working on a cold winter night while wearing a ski mask,  and the robot in Xanadu was recalibrated not to capture a black and  white television set that showed a movie about a prison break, and so  on. But the robot in Xanadu would still grab grave-diggers with ski  masks (which it turns out was not common due to Xanadu&#39;s warmer climate),  and the robot in Shangri-La was still a menace to old televisions (of  which there were very few, the people of Shangri-La being on the average  more wealthy than those of Xanadu).    So, after a few years, there were different revisions of the  criminal-catching robot in most of the major cities. In some places,  a clever criminal could avoid capture by wearing a whistle on a string  around the neck. In others, one would be well-advised not to wear orange  clothing in certain rural areas, no matter how close to the Harvest  Festival it was, unless one also wore the traditional black triangular  eye-paint of the Pumpkin King.    Many people thought, &#34;This is lunacy!&#34; But others thought the robots  did more good than harm, all things considered, and so in some places  the robots are used, while in other places they are shunned.    The end.</p><p>从前，一个身穿脏兮兮的实验服、留着蓬乱长发的男子出现在镇上的派出所，要求见警察局长。“我做到了！”他喊道。我已经建造了一个完美的抓捕罪犯的机器人！&34；警察局长对此表示怀疑，但他认为也许值得花时间看看这个人发明了什么。此外，他暗自想，完全疏远这位疯狂的科学家和他的猎人机器人大军可能是一个有点不明智的举动。因此，这名男子向警察局长解释了他的发明如何使用一系列启发式方法来区分罪犯和守法公民。它特别擅长发现最近越狱的囚犯！他说。警察局长虽然眉头紧锁，越来越怀疑，但还是允许这名男子在一周内展示一台机器人，并保证不会造成致命的束缚。他们决定让机器人在监狱周围巡逻。果不其然，几天后发生了一起越狱事件，一名在监狱设施外挖掘地面的囚犯被机器人抓住并抬回监狱内。大吃一惊的警察局长允许机器人在更大范围内巡逻。第二天，园长接到动物园管理员打来的愤怒电话。看起来机器人切断了其中一个动物笼子的栅栏，抓住了动物，并把它送到了监狱。酋长质问机器人的发明者，发明者问它是什么动物。一匹斑马，警察局长回答说。那人拍了拍他的头，喊道：诅咒！它被黑白条纹愚弄了！我将不得不重新校准！就这样，那个人开始重写机器人的代码。黑白条纹表明囚犯逃跑了，除非囚犯有两条腿以上。那就别管它了。机器人被重新部署了更新的代码，看起来几天来运行得足够好。然后在周六，一群身穿足球服的孩子，在他们的父母的跟随下，袭击了警察局。在混乱平息后，酋长被告知，机器人在足球比赛进行到一半时和裁判一起潜逃了。酋长怒目而视，向科学家报告了这一点，科学家进行了第二次校准。黑白条纹表明囚犯逃跑了，除非囚犯有两条以上的腿或项链上有哨子。尽管进行了第二次校准，警察局长还是宣布，该机器人将不再被允许在他所在的城镇活动。然而，机器人的消息已经传开，来自许多大城市的请求蜂拥而至。这位发明家又制造了几十个机器人，并将它们运往全国各地急切的警察局。每次机器人抓到不是逃犯的东西时，都会咨询科学家，并对机器人进行重新校准。不幸的是，发明者只有一个人，他没有时间或资源来重新校准每一个机器人，每当它们中的一个出了问题。香格里拉的机器人被重新校准为不抓取在寒冷冬夜工作的掘墓人，同时戴着滑雪面罩；世外桃源的机器人被重新校准为不抓取播放越狱电影的黑白电视机，以此类推。但世外桃源的机器人仍然会抓住戴着滑雪面具的掘墓人(事实证明，由于世外桃源气候变暖，这种情况并不常见)，而香格里拉的机器人仍然是旧电视的威胁(旧电视机很少，香格里拉的人平均比世外桃源的人更富有)。所以，几年后，抓捕罪犯的机器人在大多数大城市都有不同的版本。在一些地方，聪明的罪犯可以通过在脖子上系上一个哨子来避免被捕。在另一些地方，人们最好不要在某些农村地区穿橙色的衣服，无论那天离丰收节有多近，除非你也涂了南瓜王传统的黑色三角形眼妆。许多人认为，这太疯狂了！但也有人认为，从各方面考虑，机器人利大于弊，所以在一些地方使用机器人，而在另一些地方则避开它们。结束了。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://mywiki.wooledge.org/BashFAQ/105">http://mywiki.wooledge.org/BashFAQ/105</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/预期/">#预期</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/set/">#set</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/机器人/">#机器人</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>