<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>斑德旋转和0.17释放 Pyodide Spin Out and 0.17 Release</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Pyodide Spin Out and 0.17 Release<br/>斑德旋转和0.17释放 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-23 04:31:39</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/4/5fd7c99e45ac4a8076a239e6cb90eb81.png"><img src="http://img2.diglog.com/img/2021/4/5fd7c99e45ac4a8076a239e6cb90eb81.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>We are happy to announce that Pyodide has become an independent and community-driven project. We are also pleased to announce the 0.17 release for Pyodide with many new features and improvements.</p><p>我们很乐意宣布，斑德已成为一个独立和社区驱动的项目。我们也很高兴地宣布为粘性的0.17释放，具有许多新功能和改进。</p><p> Pyodide consists of the CPython 3.8 interpreter compiled to WebAssembly which allows Python to run in the browser. Many popular scientific Python packages have also been compiled and made available. In addition, Pyodide can install any Python package with a pure Python wheel from the Python Package Index (PyPi). Pyodide also includes a comprehensive foreign function interface which exposes the ecosystem of Python packages to Javascript and the browser user interface, including the DOM, to Python.</p><p> Pyodide由CPython 3.8解释器编译成WebasseMbly，它允许Python在浏览器中运行。许多流行的科学Python软件包也已编译并提供。此外，Pyodide可以使用Python包索引（PYPI）的纯Python轮安装任何Python包。 Pyodide还包括一个全面的外函数界面，它将Python软件包的生态系统暴露给JavaScript和浏览器用户界面，包括DOM到Python。</p><p> You can try out the latest version of Pyodide in a  REPL directly in your browser.</p><p> 您可以直接在浏览器中尝试最新版本的Pyodide。</p><p>  We are happy to announce that Pyodide now has a new home in a separate GitHub organisation ( github.com/pyodide) and is maintained by a volunteer team of contributors. The project documentation is available on  pyodide.org.</p><p>  我们很高兴地宣布，Pyodide现在在单独的GitHub组织（GitHub.com/pyodide）中有一个新的家园，并由派遣国志愿者队维护。 Pyodide.org上有项目文档可用。</p><p> Pyodide was originally developed inside Mozilla to allow the use of Python in  Iodide, an experimental effort to build an interactive scientific computing environment for the web.  Since  its initial release and announcement, Pyodide has attracted a large amount of interest from the community, remains actively developed, and is used in many projects outside of Mozilla.</p><p> 斑岩最初是在Mozilla内开发的，以允许在碘化物中使用Python，这是一种实验努力为网络构建互动科学计算环境。自初始发布和公告以来，Pyodide引起了社区的大量兴趣，仍然积极开发，并用于Mozilla以外的许多项目。</p><p> The core team has approved a transparent  governance document  and has a  roadmap for future developments. Pyodide also has a  Code of Conduct which we expect all contributors and core members to adhere to.</p><p> 核心团队已批准透明的治理文件，并具有未来发展的路线图。 Pyodide还有一个行为准则，我们希望所有贡献者和核心成员都坚持。</p><p> New contributors are welcome to participate in the project development on Github. There are many ways to contribute, including code contributions, documentation improvements, adding packages, and using Pyodide for your applications and providing feedback.</p><p> 欢迎新贡献者参加GitHub上的项目开发。有许多方法可以贡献，包括代码贡献，文档改进，添加包，以及使用Pyodide进行应用程序并提供反馈。 </p><p>     The type translations module was significantly reworked in v0.17 with the goal that round trip translations of objects between Python and Javascript produces an identical object.</p><p>类型的翻译模块在V0.17中得到了大大重新改造，目标是Python和JavaScript之间对象的往返翻译产生相同的对象。</p><p> In other words, Python -&gt; JS -&gt; Python translation and JS -&gt; Python -&gt; JS translation now produce objects that are  equal to the original object. (A couple of exceptions to this remain due to unavoidable design tradeoffs.)</p><p> 换句话说，python  - ＆gt; JS  - ＆gt; Python翻译和js  - ＆gt; Python  - ＆gt; JS转换现在生成等于原始对象的对象。 （由于不可避免的设计权衡，这仍然存在几例。）</p><p> One of Pyodide’s strengths is the foreign function interface between Python and Javascript, which at its best can practically erase the mental overhead of working with two different languages. All I/O must pass through the usual web APIs, so in order for Python code to take advantage of the browser’s strengths , we need to be able to support use cases like generating image data in Python and rendering the data to an HTML5 Canvas, or implementing event handlers in Python.</p><p> Pyodide的优势之一是Python和JavaScript之间的外函数接口，其最佳可以几乎可以删除使用两种不同语言的精神开销。所有I / O必须通过通常的Web API，因此为了使Python代码利用浏览器的优势，我们需要能够支持使用像在Python中生成图像数据的用例并将数据呈现为HTML5画布，或在Python中实现事件处理程序。</p><p> In the past we found that one of the major pain points in using Pyodide occurs when an object makes a round trip from Python to Javascript and back to Python and comes back different. This violated the expectations of the user and forced inelegant workarounds.</p><p> 在过去，我们发现，当一个对象从Python到JavaScript并回到Python并回来不同时，使用粘合剂中的一个主要疼痛点发生一个主要的疼痛点。这违反了用户的期望和强制厌资格的解决方法。</p><p> The issues with round trip translations were primarily caused by implicit conversion of Python types to Javascript. The implicit conversions were intended to be convenient, but the system was inflexible and surprising to users. We still implicitly convert strings, numbers, booleans, and None. Most other objects are shared between languages using proxies that allow methods and some operations to be called on the object from the other language. The proxies can be converted to native types with new explicit converter methods called  .toJs and  to_py.</p><p> 往返翻译的问题主要是由Python类型的隐性转换为JavaScript引起的。隐式转换旨在方便，但系统对用户来说是不灵活和令人惊讶的。我们仍然隐含地转换字符串，数字，布尔值，而不是。使用允许方法和某些操作从其他语言调用的代理在语言之间共享大多数其他对象。可以将代理转换为本机类型，具有名为.tojs和to_py的新的显式转换器方法。</p><p>    &gt;&gt;&gt; from js import x # import x from global Javascript scope&gt;&gt;&gt; type(x)&lt;class &#39;JsProxy&#39;&gt;&gt;&gt;&gt; x[0]    # can index x directly&#39;a&#39;&gt;&gt;&gt; x[1] = &#39;c&#39; # modify x&gt;&gt;&gt; x.to_py()   # convert x to a Python list[&#39;a&#39;, &#39;c&#39;]</p><p>    ＆gt;＆gt;＆gt;来自js导入x＃导入x来自全局javascript范围和gt;＆gt;型（x）＆lt;类＆＃39; Jsproxy＆＃39;＆gt;＆gt;＆gt; x [0]＃可以直接索引x＆＃39; a＆＃39;＆gt;＆gt; X [1] =＆＃39; C＆＃39; ＃修改x＆gt;＆gt;＆gt; x.to_py（​​）＃将x转换为python列表[＆＃39; a＆＃39;＆＃39; c＆＃39;]</p><p> Several other conversion methods have been added for more complicated use cases. This gives the user much finer control over type conversions than was previously possible.</p><p> 添加了几种其他转换方法以进行更复杂的用例。这使用户更精细地控制类型转换而不是以前可能的。 </p><p> For example, suppose we have a Python list and want to use it as an argument to a Javascript function that expects an Array.  Either the caller or the callee needs to take care of the conversion. This allows us to directly call functions that are unaware of Pyodide.</p><p>例如，假设我们有一个Python列表，并且希望将其用作预期数组的JavaScript函数的参数。呼叫者或海尔利需要照顾转换。这允许我们直接呼叫不知道粘性的功能。</p><p> Here is an example of calling a Javascript function from Python with argument conversion on the Python side:</p><p> 以下是将Python调用JavaScript函数的示例，在Python Side上具有参数转换：</p><p> function jsfunc(array) { array.push(2); return array.length;}pyodide.runPython(`from js import jsfuncfrom pyodide import to_jsdef pyfunc(): mylist = [1,2,3] jslist = to_js(mylist) return jsfunc(jslist) # returns 4`)</p><p> 函数jsfunc（array）{array.push（2）; return array.length; length;} pyodide.runpython（来自js导入jsfuncfrom pyodide导入to_jsdef pyfunc（）：mylist = [1,2,3] jslist = to_js（mylist）return jsfunc（jslist）＃返回返回4`）</p><p> This would work well in the case that  jsfunc is a Javascript built-in and  pyfunc is part of our codebase. If  pyfunc is part of a Python package, we can handle the conversion in Javascript instead:</p><p> 在jsfunc是内置javascript的情况下，这将运作良好，并且pyfunc是我们的代码库的一部分。如果pyfunc是python包的一部分，我们可以在javascript中处理转换：</p><p>    Another major new feature is the implementation of a Python event loop that schedules coroutines to run on the browser event loop. This makes it possible to use asyncio in Pyodide.</p><p>    另一个主要的新功能是实现一个Python事件循环，该循环计划在浏览器事件循环上运行的coroutines。这使得可以在Pyodide中使用异步。</p><p> Additionally, it is now possible to await Javascript Promises in Python and to await Python awaitables in Javascript. This allows for seamless interoperability between asyncio in Python and Javascript (though memory management issues may arise in complex use cases).</p><p> 此外，现在可以等待Python中的JavaScript并等待在JavaScript中等待Python。这允许在Python和JavaScript中的Asyncio之间的无缝互操作性（尽管在复杂的用例中可能出现内存管理问题）。</p><p> Here is an example where we define a Python async function that awaits the Javascript async function “fetch” and then we await the Python async function from Javascript.</p><p> 以下是一个示例，在其中我们定义了一个Python异步函数，该函数等待JavaScript async函数“fetch”，然后我们等待来自javascript的python异步函数。 </p><p> pyodide.runPython(`async def test(): from js import fetch # Fetch the Pyodide packages list r = await fetch(&#34;packages.json&#34;) data = await r.json() # return all available packages return data.dependencies.object_keys()`);let test = pyodide.globals.get(&#34;test&#34;);// we can await the test() coroutine from Javascriptresult = await test();console.log(result);// logs [&#34;asciitree&#34;, &#34;parso&#34;, &#34;scikit-learn&#34;, ...]</p><p>pyodide.runpython（`async def test（）：从js导入fetch＃fetch the pyodide包列表r = await fetch（＆＃34; packages.json＆＃34;）data = await r.json（）＃返回所有可用包返回data.dependencies.object_keys（）`）;让test = pyodide.globals.get（＆＃34;测试＆＃34;）; //我们可以等待javascriptresult = await test（）的coroutine;控制台。日志（结果）; //日志[＆＃34; asciitree＆＃34;＆＃34; acco＆＃34 ;,＆＃34; scikit-learn＆＃34; ...]</p><p>  Errors can now be thrown in Python and caught in Javascript or thrown in Javascript and caught in Python. Support for this is integrated at the lowest level, so calls between Javascript and C functions behave as expected. The error translation code is generated by C macros which makes implementing and debugging new logic dramatically simpler.</p><p>  现在可以在Python中抛出错误，并捕获JavaScript或抛出JavaScript并捕获在Python中。对此的支持是集成在最低级别，因此JavaScript和C函数之间的呼叫按预期行为。错误转换代码由C宏生成，这使得实现和调试新的逻辑更简单。</p><p>  function jserror() { throw new Error(&#34;ooops!&#34;);}pyodide.runPython(`from js import jserrorfrom pyodide import JsExceptiontry: jserror()except JsException as e: print(str(e)) # prints &#34;TypeError: ooops!&#34;`);</p><p>  函数JSError（）{抛出新错误（＆＃34; ooops！＆＃34;）;} pyodide.runpython（来自js导入jserrorfrom pyodide导入jsexceptiontry：jserror（）除了作为e：print的e：print（str（e）） #pings＆＃34; typeerror：ooops！＆＃34;`）;</p><p>  Pyodide uses the  Emscripten compiler toolchain to compile the CPython 3.8 interpreter and Python packages with C extensions to WebAssembly. In this release we finally completed the migration to the latest version of Emscripten that uses the upstream LLVM backend. This allows us to take advantage of recent improvements to the toolchain, including significant reductions in package size and execution time.</p><p>  Pyodide使用EMScripten编译器工具链接来编译CPython 3.8解释器和Python软件包，将C扩展到Webassembly。在此版本中，我们最终完成了迁移到使用上游LLVM后端的最新版本的EMScripten。这使我们能够利用最近对工具链的改进，包括封装大小和执行时间的显着缩短。</p><p> For instance, the SciPy package shrank dramatically from 92 MB to 15 MB so Scipy is now cached by browsers. This greatly improves the usability of scientific Python packages that depend on scipy, such as scikit-image and scikit-learn. The size of the base Pyodide environment with only the CPython standard library shrank from 8.1 MB to 6.4 MB.</p><p> 例如，SciPy包从92 MB缩小到15 MB，因此SCIPY现在被浏览器缓存。这极大地提高了依赖于Scipy的科学Python软件包的可用性，例如Scikit-Image和Scikit-Learn。仅具有CPython标准库的基础曲面环境的大小从8.1 MB缩小到6.4 MB。</p><p> On the performance side, the latest toolchain comes with a 25% to 30% run time improvement:</p><p> 在性能方面，最新的工具链有25％至30％的运行时间改进：</p><p> Performance ranges between near native to up to 3 to 5 times slower, depending on the benchmark.  The above benchmarks were created with Firefox 87.</p><p> 根据基准测试，在近3至5倍之间的性能范围较慢。以上基准测试是使用Firefox 87创建的。 </p><p>   Added support for relative URLs in micropip and loadPackage, and improved interaction between micropip and loadPackage</p><p>添加了对MicroPIP和LoadPackage中的相对URL的支持，并改进了微皮和载荷之间的交互</p><p>  Added systematic error handling to the C code, including automatic adaptors between Javascript errors and CPython errors</p><p>  添加到C代码的系统错误处理，包括JavaScript错误和CPython错误之间的自动适配器</p><p> Added internal consistency checks to detect memory leaks, detect fatal errors, and improve ease of debugging</p><p> 添加了内部一致性检查以检测内存泄漏，检测到致命错误，并提高轻松调试</p><p>   Mozilla has made the difficult decision to wind down the Iodide project. While  alpha.iodide.io will continue to be available for now (in part to provide a demonstration of Pyodide’s capabilities), we do not recommend using it for important work as it may shut down in the future. Since iodide’s release, there have been  many efforts at creating interactive notebook environments based on Pyodide which are in active development and offer a similar environment for creating interactive visualizations in the browser using python.</p><p>   Mozilla使得艰难决定沿着碘化项目卷积。虽然alpha.iodide.io现在将继续使用（部分是为了提供Pyodide的能力的演示），但我们不建议将其使用它以便在未来关闭。自从碘化物版本以来，在创建基于Pyodide的交互式笔记本环境中，在主动开发中创建了许多努力，并提供了使用Python在浏览器中创建交互式可视化的类似环境。</p><p>  While many issues were addressed in this release, a number of other major steps remain on the roadmap. We can mention</p><p>  虽然在此版本中解决了许多问题，但在路线图上存在许多其他主要步骤。我们可以提及</p><p> Better project sustainability, for instance, by seeking synergies with the conda-forge project and its tooling.</p><p> 例如，更好的项目可持续性通过寻求与公务员伪造项目及其工具的协同作用。</p><p>    Dexter Chua and  Joe Marshall for improving the build setup and making Emscripten migration possible.</p><p>    Dexter Chua和Joe Marshall改进构建设置并使Emscripten迁移成为可能。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://hacks.mozilla.org/2021/04/pyodide-spin-out-and-0-17-release/">https://hacks.mozilla.org/2021/04/pyodide-spin-out-and-0-17-release/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/斑德/">#斑德</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pyodide/">#pyodide</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>