<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>环形缓冲区伐木，趣味盎然，利润丰厚</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">环形缓冲区伐木，趣味盎然，利润丰厚</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-28 14:24:55</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/7/a35ff4de436a85b63c78adc2d61ba93f.jpg"><img src="http://img.diglog.com/img/2020/7/a35ff4de436a85b63c78adc2d61ba93f.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>日志记录并不便宜，因此当我们将代码部署到生产环境中时，通常会禁用调试级别日志(或更低级别)。当事情进展顺利时，这不是问题。但是，当错误日志弹出时，与代码中发生的事情相关的大部分上下文都会丢失。关于堆栈跟踪的一行内容通常是不够的。如果能对失败时发生的事情有一个更详细的描述，那就太好了。如果我们打开了这些调试和跟踪日志就好了。</p><p>嗯，我们不买是有原因的。简单地说，它很贵。通常，调试和跟踪级别的日志比所有其他日志级别的总和多一个数量级。因此，如果我们要将其全部记录下来，我们将不得不多花几倍的钱。</p><p>这是围绕这一端的大多数谈话的地方。选项2不能启动，所以我们选择选项1。如果出现错误，我们尝试在调试开始时在本地复制错误，并从那里开始工作。</p><p>幸运的是，这是一种错误的二分法。我们还有第三个选择。使用环形缓冲区存储调试日志，并在发生错误时刷新它。</p><p>这项技术在概念上很简单。这只需要一句话来描述，并且记录的方式没有太多改变。我们仍然使用相同的日志库和相同的日志软件模式，但现在当出现问题时，我们可以访问日志中更多的信息。</p><p>你可以既吃蛋糕又吃蛋糕。您可以避免冗长的日志记录，同时在重要的时候可以访问这些冗长的日志。</p><p>假设我们正在为我们的在线小工具商店构建一个Django后端，并说下面的伪代码中的某个地方有一个bug。</p><p>#Handle the order def handle_order_post_request(Req)：Customer=Get_Customer(Req)if not is_Authorized_Customer(Customer)：return HttpStatusUnAuthorized()Orders=Get_Orders(Req)VERIFY_PRICES(ORDERS)#验证价格是否为最新VERIFY_INSTORY(ORDERS)#如果缺货CHECKOUT_INFO=PROCESS_ORDER(ORDER)SAVE_CHECKOUT(CHECUOUT_INFO)RETURN HttpStatusOk，则从结账中删除。Order(Orders：List[OrderItems])-&gt；CheckoutInfo：记录器.debug(&#34；总价：%d&#34；，order.price)TOTAL_PRICE=SUM([Order.Price for Orders in Orders])MOST_EXPICAL_ITEM=max(Orders，Key=lambda Order：Order.Price)return CheckoutInfo(TOTAL_PRICE，MOST_EXPICAL_ITEM，)</p><p>我一直在构建这个python工具，它让您无需重启即可在运行的python中动态插入新日志。查看GitHub上的回购。</p><p>如果您知道我错过的任何其他链接，或者只是想联系，请给我发电子邮件到&lt；my-first-name&gt；@&lt；my-last-name&gt；.com</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://yiblet.com/posts/ring-buffer-logging">https://yiblet.com/posts/ring-buffer-logging</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/缓冲区/">#缓冲区</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/buffer/">#buffer</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/orders/">#orders</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>