<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Linux NIC统计数据的通用接口 Common interface for Linux NIC statistics</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Common interface for Linux NIC statistics<br/>Linux NIC统计数据的通用接口 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-26 10:31:45</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/4/8f9a4053331ce29fc1f12634327b8152.png"><img src="http://img2.diglog.com/img/2021/4/8f9a4053331ce29fc1f12634327b8152.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>In Linux 5.13 ethtool gains an interface for querying IEEE and IETF statistics. This removes the need to parse vendor specific strings in ethtool -S.</p><p>在Linux 5.13 Ethtool获得了查询IEEE和IETF统计信息的接口。这会删除在ethtool -s中解析供应商特定字符串的需要。</p><p>  Linux has two sources of NIC statistics, the common interface stats (which show up in ifconfig, ip link, sysfs and few other places) and ethtool -S. The former – common interface stats – are a mix of basic info (packets, bytes, drops, errors in each direction) and a handful of lower level stats like CRC errors, framing errors, collisions or FIFO errors. Many of these statistics became either irrelevant (collisions) or semantically unclear (FIFO errors) in modern NICs.</p><p>  Linux有两个NIC统计来源，公共接口统计数据（IFConfig，IP链路，SYSF和少数其他地方）和ethtool -s。前常见的接口统计数据 - 是基本信息（数据包，字节，丢弃，每个方向错误）的混合，以及少数较低级别的统计数据，如CRC错误，框架错误，碰撞或FIFO错误。许多这些统计数据都变得无关（碰撞）或现代NIC中的语义上不清楚（FIFO错误）。</p><p> This is why deployments increasingly depend on ethtool -S statistics for error tracking. ethtool -S is a free form list of stats provided by the driver. It started out as a place for drivers to report custom, implementation specific stats, but ended up also serving as a reporting place for new statistics as the networking standards developed.</p><p> 这就是为什么部署越来越依赖于Ethtool -s统计错误跟踪。 ethtool -s是驱动程序提供的统计数据列表。它开始作为驾驶员报告定制，实施特定统计数据的地方，但最终还应作为新统计数据的报告地点作为开发的网络标准。</p><p> Sadly there is no commonality in how vendors name their ethtool statistics. The spelling and abbreviation of IEEE stats always differ, sometimes the names chosen do not resemble the standard names at all (reportedly because vendors consider those names “too confusing” for the users). This forces infrastructure teams to maintain translations and custom per-vendor logic to scrape ethtool -S output.</p><p> 遗憾的是，供应商如何命名其ethtool统计数据没有共同。 IEEE统计数据的拼写和缩写总是不同的，有时选择的名称并不类似于所有标准名称（据报道，因为供应商认为用户对用户“太令人困惑”）。这支强制基础架构团队维护翻译和自定义Per-供应商逻辑以刮掉Ethtool -s输出。</p><p>  Starting with Linux 5.6 Michal Kubecek has been progressively porting ethtool from ioctls to a more structured and extensible netlink interface. Thanks to that we can now augment the old commands to carry statistics. When user specifies  -I | --include-statistics on the command line (or the appropriate flag in netlink) kernel will include relevant statistics in its response, e.g. for flow control:</p><p>  从Linux开始5.6 Michal Kubecek从IOCTLS逐步移植到一个更具结构化和可扩展的NetLink接口。由于我们现在可以增强旧命令来携带统计数据。当用户指定-i | - 指令行的统计信息（或NetLink中的适当标志）内核将包括其响应中的相关统计数据，例如，对于流量控制：</p><p> # ethtool -I -a eth0 Pause parameters for eth0: Autonegotiate: off RX: off TX: on Statistics: tx_pause_frames: 25545561 rx_pause_frames: 0</p><p> #ethtool -i -a eth0 eth0 ech0 ech0 ech0暂停参数：easonegotiate：关闭rx：关闭tx：统计：tx_pause_frames：25545561 rx_pause_frames：0</p><p> General statistics such as PHY and MAC counters are now available via ethtool -S under standard-based names though a new  --groups switch, e.g.:</p><p> PHY和MAC计数器等常规统计数据现在可以通过基于标准的名称来通过ethtool -s，虽然新的 -  groups switch，例如： </p><p> # ethtool -S eth0 --groups eth-mac Standard stats for eth0: eth-mac-FramesTransmittedOK: 902623288966 eth-mac-FramesReceivedOK: 28727667047 eth-mac-FrameCheckSequenceErrors: 1 eth-mac-AlignmentErrors: 0 eth-mac-OutOfRangeLengthField: 0</p><p>#Ethtool -s eth0  -  eth0的eth-mac标准统计数据0.</p><p>   Admittedly the new interface is quite basic. It mostly includes statistics provided in IEEE or IETF standards, and NICs may report more interesting data. There is also no metadata about “freshness” of the stats here, or filtering built into the interface.</p><p>   允许新的界面非常基本。它主要包括IEEE或IETF标准中提供的统计信息，NIC可能会报告更有趣的数据。这里也没有关于“新鲜度”的元数据，或内置在接口中的过滤。</p><p> The starting point is based on fulfilling immediate needs. We hope the interfaces will be extended as needed. Statistics can be made arbitrarily complex, so after a couple false-starts with complex interfaces we decided to let the use cases drive the interface.</p><p> 起点是基于满足即时需求。我们希望界面将根据需要扩展。统计数据可以任意复杂，因此在几个假的界面之后，我们决定让用例驱动接口。</p><p> It’s also very useful to lean on the standards for clear definition of the semantics. Going forward we can work with vendors on codifying the definitions of other counters they have.</p><p> 依靠明确定义语义的标准也非常有用。向前发展我们可以在编纂他们拥有的其他柜台的定义上的供应商合作。</p><p>   30.3.2.1.5 aSymbolErrorDuringCarrier 30.3.1.1.2 aFramesTransmittedOK 30.3.1.1.3 aSingleCollisionFrames 30.3.1.1.4 aMultipleCollisionFrames 30.3.1.1.5 aFramesReceivedOK 30.3.1.1.6 aFrameCheckSequenceErrors 30.3.1.1.7 aAlignmentErrors 30.3.1.1.8 aOctetsTransmittedOK 30.3.1.1.9 aFramesWithDeferredXmissions 30.3.1.1.10 aLateCollisions 30.3.1.1.11 aFramesAbortedDueToXSColls 30.3.1.1.12 aFramesLostDueToIntMACXmitError 30.3.1.1.13 aCarrierSenseErrors 30.3.1.1.14 aOctetsReceivedOK 30.3.1.1.15 aFramesLostDueToIntMACRcvError 30.3.1.1.18 aMulticastFramesXmittedOK 30.3.1.1.19 aBroadcastFramesXmittedOK 30.3.1.1.20 aFramesWithExcessiveDeferral 30.3.1.1.21 aMulticastFramesReceivedOK 30.3.1.1.22 aBroadcastFramesReceivedOK 30.3.1.1.23 aInRangeLengthErrors 30.3.1.1.24 aOutOfRangeLengthField 30.3.1.1.25 aFrameTooLongErrors 30.3.3.3 aMACControlFramesTransmitted 30.3.3.4 aMACControlFramesReceived 30.3.3.5 aUnsupportedOpcodesReceived 30.3.4.2 aPAUSEMACCtrlFramesTransmitted 30.3.4.3 aPAUSEMACCtrlFramesReceived 30.5.1.1.17 aFECCorrectedBlocks 30.5.1.1.18 aFECUncorrectableBlocks</p><p>   30.3.2.1。 1.1。 19 aBroadcastFramesXmittedOK 30.3.1.1.20 aFramesWithExcessiveDeferral 30.3.1.1.21 aMulticastFramesReceivedOK 30.3.1.1.22 aBroadcastFramesReceivedOK 30.3.1.1.23 aInRangeLengthErrors 30.3.1.1.24 aOutOfRangeLengthField 30.3.1.1.25 aFrameTooLongErrors 30.3.3.3 aMACControlFramesTransmitted 30.3.3.4 aMACControlFramesReceived 30.3.3.5 aUnsupportedOpcodesReceived 30.3.4.2 apausemacctrlframestransmited 30.3.4.3 apausemacctrlframesreceiv ed 30.5.1.1.17 afeccritectblocks 30.5.1.1.18 afecuncorreberableblocks</p><p>  etherStatsUndersizePkts etherStatsOversizePkts etherStatsFragments etherStatsJabbers etherStatsPkts64Octets etherStatsPkts65to127Octets etherStatsPkts128to255Octets etherStatsPkts256to511Octets etherStatsPkts512to1023Octets etherStatsPkts1024to1518Octets (incl. further stats for jumbo MTUs)</p><p>  etherstandersizepkts etherstatspareizepkts etherstatsfragents etherstatsjabbers etherstatpkts64octets ethstspkts65to127octets etherstatspkts128to27octets etherstatspkts2550tets etherstatspkts512to1023octets etherstatspkts1024to1518octets（包括jumbo mtus的其他统计数据） </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://people.kernel.org/kuba/common-interface-for-nic-statistics">https://people.kernel.org/kuba/common-interface-for-nic-statistics</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/nic/">#nic</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/interface/">#interface</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/统计数据/">#统计数据</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>