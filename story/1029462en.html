<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Linux5.10将有一个完全无锁的环形缓冲区</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Linux5.10将有一个完全无锁的环形缓冲区</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-18 00:09:33</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/77689af27dcaa45fd1b3199b9686015f.jpg"><img src="http://img2.diglog.com/img/2020/10/77689af27dcaa45fd1b3199b9686015f.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Jump to navigation Jump to search Linus Torvalds has merged a set of printk() patches by John Ogness that make the kernel ring buffer (what you see if you type  dmesg) fully lock-less. This is a big improvement that allows messages to be stored and read without the need for temporary per-CPU buffers with no risk of deadlocks.</p><p>跳转到导航跳转到搜索Linus Torvalds已经合并了John Ogness的一组printk()补丁，这些补丁使内核环形缓冲区(如果您输入dmesg会看到的)完全无锁。这是一个很大的改进，它允许存储和读取消息，而不需要每个CPU的临时缓冲区，没有死锁风险。</p><p>  Video Copyright 2019 John Ogness / Linux Plumbers Conference 2019. Licensed under the  Creative Commons Attribution (CC BY) license. Slides:  Lpc2019 jogness printk.pdf</p><p>视频版权所有2019 John Ogness/Linux Plumbers Conference 2019。根据知识共享署名(CC BY)许可。幻灯片：Lpc2019慢跑printk.pdf。</p><p> The ring buffer is a central part of the Linux kernel. Drivers, sub-systems and a wide range of functionality use  printk() to to share errors and general messages about what&#39;s going on. You can see it&#39;s contents by typing  dmesg or  sudo dmesg in a terminal.</p><p>环形缓冲区是Linux内核的核心部分。驱动程序、子系统和广泛的功能使用printk()来共享有关正在进行的操作的错误和一般消息。您可以通过在终端中键入dmesg或sudo dmesg来查看它的内容。</p><p> John Ogness gave a 57 minute long video titled &#34; Why is printk() so complicated?&#34; detailing the history of the Linux kernel&#39;s ring buffer since  Linux 0.01 ( Linux-0.01.tar.gz) was released in 1991 to 2019 at the 2019 Linux Plumbers Conference. He pointed out the problems with the long-used  printk() implementation and proposed a set of ideas for improving  printk() and the kernel&#39;s ring buffer functionality at that conference. Some of of his work has now been merged to the Linux git tree, ensuring that it will be a part of Linux 5.10 when it gets released in a few months time.</p><p>约翰·奥格尼斯做了一段57分钟的视频，题目是“为什么printk()如此复杂？”详细介绍了自1991年Linux 0.01(linux-0.01.tar.gz)在2019年Linux Plumbers Conference上发布以来，Linux内核环形缓冲区的历史。他指出了长期使用的printk()实现的问题，并在那次会议上提出了一套改进printk()和内核的环形缓冲区功能的想法。他的一些工作现在已经合并到Linux git树中，以确保它在几个月后发布时将成为Linux5.10的一部分。</p><p> Linus Torvalds has  merged the first in a series of patches written by John Ogness in order to make  printk() more modern, secure and functional.</p><p>Linus Torvalds合并了John Ogness编写的一系列补丁中的第一个，目的是使printk()更现代、更安全、更实用。</p><p> &#34; The big new thing is the fully lockless ringbuffer implementation, including the support for continuous lines. It will allow to store and read messages in any situation wihtout the risk of deadlocks and without the need of temporary per-CPU buffers.</p><p>最大的新特性是完全无锁的环形缓冲区实现，包括对连续行的支持。它将允许在任何情况下存储和读取消息，而不会有死锁的风险，也不需要每个CPU的临时缓冲区。</p><p> The access is still serialized by logbuf_lock. It synchronizes few more operations, for example, temporary buffer for formatting the message, syslog and kmsg_dump operations. The lock removal is being discussed and should be ready for the next release. &#34;</p><p>访问仍由logbuf_lock序列化。它只同步少量操作，例如格式化消息的临时缓冲区、syslog和kmsg_dump操作。正在讨论解除锁定的问题，应该已经为下一个版本做好了准备。&#34；</p><p> The remaining use of  logbuf_lock will be addressed when Linux 5.10 is released and the Linux 5.11 merge window opens up around Christmas-time.</p><p>当Linux5.10发布并且Linux5.11合并窗口在圣诞节前后打开时，将解决logbuf_lock的剩余使用问题。</p><p>   LinuxReviews welcomes  all comments. If you do not want to be anonymous,  register or  log in. It is free.</p><p>LinuxReviews欢迎所有评论。如果您不想匿名，请注册或登录。这是免费的。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://linuxreviews.org/Linux_5.10_Will_Have_A_Fully_Lock-Less_Ring_Buffer">https://linuxreviews.org/Linux_5.10_Will_Have_A_Fully_Lock-Less_Ring_Buffer</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/环形/">#环形</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/lock/">#lock</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/printk/">#printk</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1029305.html"><img src="http://img2.diglog.com/img/2020/10/thumb_fdc7924ed83b36d7b9e6818dd78a8c39.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029305.html">您现在可以在Linux上安装Microsoft Windows计算器</a></div><span class="my_story_list_date">2020-10-17 3:32</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029255.html"><img src="http://img2.diglog.com/img/2020/10/thumb_9cf8e4e420c8b80c3b0818a611aa173b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029255.html">苹果是否放弃了广泛使用的Linux开源打印系统CUPS？看起来是这样</a></div><span class="my_story_list_date">2020-10-16 23:9</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029043.html"><img src="http://img2.diglog.com/img/2020/10/thumb_d82f6d51c50938e047f329bb6f89368c.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029043.html">在使用Windows 10年后，我转而使用Linux</a></div><span class="my_story_list_date">2020-10-16 0:6</span></div><div class="col-sm"><div><a target="_blank" href="/story/1028901.html"><img src="http://img2.diglog.com/img/2020/10/thumb_a4960d882e3135d59003a233452795e7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1028901.html">谷歌和英特尔警告Linux中存在严重的蓝牙安全漏洞</a></div><span class="my_story_list_date">2020-10-15 5:28</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>