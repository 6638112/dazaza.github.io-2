<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GTK4用于图形用户界面 GTK4 for Graphical User Interfaces</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">GTK4 for Graphical User Interfaces<br/>GTK4用于图形用户界面 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-04 12:17:29</div><div class="page_narrow text-break page_content"><p>This book gives an introduction into design and creation of graphical user interfacesusing the GTK widget tool kit and the Nim programming language. The book has itsfocus on the Linux operating system (OS). While the Nim programming language does support allmayor operating systems, GTK has it main emphasis on the Linux OS. Windows and macOS aresupported by GTK, but without true native look and feel. Android and iOS is notsupported by GTK, but there is some early experimental support for the  Libremmobile devices manufactured by the  Purism company. As GTK is compact and hasa modular design, it can be also used on devices with restricted resources like the Raspberry Pi family. While GTK is generally not used to create webapplications, it may be possible to run GTK applications locally in a web browser byusing the broadway GTK backend.</p><p>本书介绍了如何使用GTK小部件工具包和Nim编程语言来设计和创建图形用户界面。这本书的重点是Linux操作系统（OS）。尽管Nim编程语言确实支持所有主流操作系统，但GTK却主要将重点放在Linux OS上。 GTK支持Windows和macOS，但没有真正的本机外观。 GTK不支持Android和iOS，但是Purism公司生产的Libremmobile设备有一些早期的实验支持。由于GTK紧凑且具有模块化设计，因此它也可以用于资源有限的设备（如Raspberry Pi系列）。尽管通常不使用GTK创建Web应用程序，但可以通过使用百老汇GTK后端在Web浏览器中本地运行GTK应用程序。</p><p> The examples in this book uses the Nim implementation of the team around Mr. A. Rumpfin version v1.4, the first GTK 4 version that is available in late 2020 andthe Nim GTK bindings provided by the  gintro package in version0.8.4. For other Nim implementations or different GTK bindingsmodifications of the provided examples can be necessary.</p><p> 本书中的示例使用了围绕A.Rumpfin先生v1.4版本的团队的Nim实现，该版本是2020年末推出的第一个GTK 4版本，以及gintro软件包在0.8.4版中提供的Nim GTK绑定。对于其他Nim实施或不同的GTK绑定，可能需要对提供的示例进行修改。</p><p> GTK is the name of a toolkit for the design and the creation of graphical userinterfaces (GUIs) that allows users to interact with computer programs by use ofgraphical elements like buttons, sliders, drop-down menus and input fields. Theseelements are called widgets. Widgets can be grouped to build larger entities likefile or message dialogs. The top level widget is generally a rectangular containercalled a window that contains all the other widgets. The initial release of GTKappeared in the year 1998 named  GIMP tool kit and was labeled GTK+. As theName GTK implies it was closely bound to the famous  GIMP drawing program (GNUimage manipulation program) and was intended to replace the older Motif Unix GUI forGIMP.</p><p> GTK是用于设计和创建图形用户界面（GUI）的工具箱的名称，它允许用户通过使用图形元素（例如按钮，滑块，下拉菜单和输入字段）与计算机程序进行交互。这些元素称为小部件。可以将小部件分组以构建更大的实体，例如文件或消息对话框。顶层窗口小部件通常是一个矩形容器，称为一个包含所有其他窗口小部件的窗口。 GTK的最初版本出现在1998年，名为GIMP工具包，并标记为GTK +。正如TheName GTK所暗示的那样，它已与著名的GIMP绘图程序（GNUimage操作程序）紧密绑定，并旨在代替较早的Motif Unix GUI for GIMP。</p><p> Graphical user interfaces were introduced already a few decades after the inventionof computers with the goal to simplify the interaction between humans and computersby replacing the traditional terminal based textual user interfaces. GUIs allowedeven untrained people the intuitive interaction with computers without the need tolearn and remember many textual command. Closely coupled to graphical user interfacesis the computer mouse, a small gadget that rests on the table and maps its movementsto a pointer drawn on the computer screen allowing the interaction with the widgets.Today the computer mouse is often supported or substituted by touch pads or touchdisplays.</p><p> 图形用户界面是在计算机发明之后几十年引入的，其目的是通过取代传统的基于终端的文本用户界面来简化人与计算机之间的交互。 GUI甚至允许未经培训的人员与计算机进行直观的交互，而无需学习和记住许多文本命令。与图形用户界面紧密相连的是计算机鼠标，它是一个固定在桌子上的小工具，可以将其移动映射到计算机屏幕上绘制的指针，以便与小部件进行交互。如今，计算机鼠标通常由触摸板或触摸显示器支持或代替。</p><p> After the release of GTK that toolkit was used by other software too, and in 2002Version 2.0 of GTK appeared. GTK 2 had already a more modular design and was notthat tight couple to GIMP. In 2011 GTK 3.0 appeared, which provided many newfeatures. Most important was a new customizable design supported by  cascadingstyle sheets (CSS), and the use of libraries like  cairo for drawing thegraphical elements and of  pango for font rendering. In late 2020 officialrelease of GTK 4 will appear, which has again an improved internal design, animproved  application programming interface (API) and which supports OpenGL and  Vulkan hardware drawing for the widgets to maximizeperformance while keeping CPU load low.</p><p> GTK发行后，该工具包也被其他软件使用，并且在2002年出现了GTK 2.0版。 GTK 2已经有了更多的模块化设计，并且与GIMP没有那么紧密的联系。在2011年出现了GTK 3.0，它提供了许多新功能。最重要的是由层叠样式表（CSS）支持的新的可定制设计，以及使用诸如cairo之类的库来绘制图形元素，以及使用pango的库来字体呈现。 2020年末将发布GTK 4正式版，该版本再次具有改进的内部设计，改进的应用程序编程接口（API），并支持OpenGL和Vulkan硬件绘图以使小部件最大化性能，同时保持较低的CPU负载。</p><p>  While GTK can be used on Windows and macOS computers, it is generally used on Linux,and there often in conjunction with the  Gnome desktop environment. The Gnomefoundation is the most important supporter of GTK development. GTK does not supportthe Android or iOS operating systems for mobile devices. The GTK related libraries uses theLGPL software license, while the Nim compiler and most of Nim’s external packages areusing the MIT software license. Both licenses allows the creation of proprietaryclosed source software, as long as for the LGPL licensed libraries dynamic linking isused.</p><p>  GTK可以在Windows和macOS计算机上使用，但通常在Linux上使用，并且通常与Gnome桌面环境结合使用。 Gnomefoundation是GTK开发的最重要支持者。 GTK不支持用于移动设备的Android或iOS操作系统。与GTK相关的库使用LGPL软件许可证，而Nim编译器和大多数Nim的外部软件包都使用MIT软件许可证。这两个许可证都允许创建专有的封闭源代码软件，只要使用LGPL许可库的动态链接即可。</p><p> Like most traditional GUI toolkits GTK uses a retained mode, where the graphicalscene is updated and redrawn only when necessary. In contrast to retained mode GUIsin the last years immediate mode GUIs has become popular. These GUIs often have theirorigin in simple GUIs for games and redraw the whole scene permanently, generallysynchronized with the screen refresh rate. The permanent redraws create some CPU loadof course, but for games that does generally not matter, as CPU and GPU load aredominated by the game itself, and with OpenGL or Vulkan hardware support drawing theGUI does not cause high CPU load. And finally the modern retained mode GUIs like GTKare not really that static any more as they contain many animations. So thedistinction between retained and immediate mode GUIs is not that sharp.</p><p> 像大多数传统的GUI工具包一样，GTK使用保留模式，该模式仅在必要时更新和重绘图形场景。与过去几年的保留模式GUI相比，即时模式GUI变得很流行。这些GUI通常在游戏的简单GUI中具有其来源，并永久地重新绘制整个场景，通常与屏幕刷新率同步。永久性重绘当然会产生一些CPU负载，但是对于游戏来说通常并不重要，因为CPU和GPU负载由游戏本身决定，并且使用OpenGL或Vulkan硬件支持绘制时，GUI不会导致CPU负载过高。最后，像GTK这样的现代保留模式GUI不再真正静态，因为它们包含许多动画。因此，保留模式GUI和即时模式GUI之间的区别不是那么明显。 </p><p>  Initialy GTK+, the GIMP tool kit. The GTK module builds the core of the GTKwidget tool kit and contains all the widgets.</p><p>最初是GTK +，GIMP工具包。 GTK模块构建了GTKwidget工具套件的核心，并包含所有小部件。</p><p>      The GObject module provides an API for  object orientated programming (OOP) in theC programming language.</p><p>      GObject模块为使用C编程语言的面向对象编程（OOP）提供了API。</p><p>      The GTK Scene Graph Kit is used to optimize the drawing and the widget refresh.</p><p>      GTK Scene Graph Kit用于优化图形和小部件刷新。</p><p> Other GTK related modules are  GtkSourceView for advanced text layout supportas used for text editors like  gedit, the  rsvg module for support of scaleable vector graphics (SVG) and the  VTE module for the creationof terminal windows. GtkSourceView and VTE are not yet available for GTK4.</p><p> 其他与GTK相关的模块包括用于高级文本布局支持的GtkSourceView（用于gedit等文本编辑器），用于支持可缩放矢量图形（SVG）的rsvg模块以及用于创建终端窗口的VTE模块。 GtkSourceView和VTE尚不适用于GTK4。</p><p>   For Linux there is one more abstraction layer between the GTK toolkit and thecomputer hardware, which is the  wayland display server, a modernimplementation of the original  X Window System.</p><p>   对于Linux，GTK工具包和计算机硬件之间还有一个抽象层，即路标显示服务器，是原始X Window系统的现代化实现。</p><p> All these components are written in the C programming language. C is a very old,restricted and sometimes unsecure language, which can lead to very verbose code,which is difficult to maintain. As GTK has an object-orientated design, but Clanguage does not support OOP style, a whole object system called  gobject waswritten for GTK from scratch. And as C does not support high level data structureslike resizeable strings, hash maps, asynchronous in out operations and much moreimportant functionality which modern languages generally provide, this was alsowritten from scratch and is provided in supporting libraries like  glib and gio. As C does not support automatic memory management, in GTK it issometimes necessary to release memory manually, which may lead to the well knownproblems like memory leaks or use after free issues.</p><p> 所有这些组件都是用C编程语言编写的。 C是一种非常古老的，受限制的，有时甚至是不安全的语言，它会导致非常冗长的代码，难以维护。由于GTK具有面向对象的设计，但是Clanguage不支持OOP样式，因此从头开始为GTK编写了一个名为gobject的整个对象系统。而且由于C不支持高级数据结构，如可调整大小的字符串，哈希图，异步输入输出操作以及现代语言通常提供的更重要的功能，因此它也是从头开始编写的，并在支持glib和gio的库中提供。由于C不支持自动内存管理，因此在GTK中有时需要手动释放内存，这可能会导致众所周知的问题，例如内存泄漏或释放问题后使用。</p><p> It seems to be obvious that all these bloated legacy stuff is nearly unmaintainableconsidering the tiny GTK and Gnome community. And today, when we have so many nicemodern programming languages available, nearly no one intends to write apps in C.When we take into account the fact that GTK does not even supports the popularAndroid OS for mobile devices, we may ask why we should care for GTK at all still.</p><p> 显然，考虑到很小的GTK和Gnome社区，所有这些肿的旧东西几乎是无法维护的。今天，当我们有这么多现代的编程语言可用时，几乎没有人打算用C编写应用程序。考虑到GTK甚至不支持流行的移动设备Android OS的事实，我们可能会问为什么我们应该关心对于GTK来说仍然如此。 </p><p> Indeed a popular competitor of GTK is the Qt GUI toolkit with its KDE Linux desktopenvironment. Qt appeared already in 1995 with a license model not well suited forfree open source software (FOSS), and is now available in version 6 withmuch less restricted licenses. Qt is written in C++ and is unfortunately even muchmore bloated than GTK, and it uses a so called meta object compiler (MOC) as someform of C++ preprocessor. Qt is really very large and includes a lot stuff which isnot really GUI related like network, web and database functionality or support formany custom data types. All that is also available by modern C++ or specializedlibraries, so Qt can be regarded as a bloated application framework that is nearly awhole operating system. The advantage of Qt is that it is active developed and supports allimportant operating systems including the mobile Android and iOS systems with a native look andfeel.</p><p>的确，GTK的流行竞争对手是带有KDE Linux桌面环境的Qt GUI工具箱。 Qt早在1995年就出现了，它的许可证模型不太适合免费的开源软件（FOSS），现在可以在版本6中使用，而受限制的许可证要少得多。 Qt是用C ++编写的，不幸的是，它比GTK膨胀得多，它使用所谓的元对象编译器（MOC）作为某种形式的C ++预处理程序。 Qt确实很大，包含很多与GUI无关的东西，例如网络，Web和数据库功能或支持任何自定义数据类型。所有这些都可以通过现代C ++或专门的库获得，因此Qt可以被视为几乎整个操作系统上都a肿的应用程序框架。 Qt的优点是它是主动开发的，并支持所有重要操作系统，包括具有原生外观的移动Android和iOS系统。</p><p> As the proprietary operating systems like Windows, macOS, Android and iOS have all their ownnative GUI, we do not need a separate toolkit when we plan to develop apps for onlyone of these systems. And indeed users generally prefer apps that only use the nativeGUI and avoid additional layers like GTK or Qt.</p><p> 由于诸如Windows，macOS，Android和iOS之类的专有操作系统都具有其自己的本地GUI，因此当我们计划仅为其中一个系统开发应用程序时，我们不需要单独的工具包。实际上，用户通常偏爱仅使用nativeGUI且避免使用GTK或Qt等附加层的应用程序。</p><p> For many Windows or macOS users GTK has the disadvantage that GTK draws all itwidgets itself, it does not use the native graphical elements of the proprietarysystems. GTK allows theming by use of cascading style sheets (CSS) so it can be tunedto look not too strange on Windows and macOS, but look and feel generally does notreally map to native apps. Qt draws its widgets itself on Linux, but can try to usenative elements on Windows or macOS since version 4.0, which may provide a morenative look and feel.</p><p> 对于许多Windows或macOS用户，GTK的缺点是GTK会自己绘制所有itwidget，它不使用专有系统的本机图形元素。 GTK允许使用级联样式表（CSS）进行主题设置，因此可以将其调整为在Windows和macOS上看起来不太奇怪，但外观通常并不映射到本机应用程序。 Qt在Linux上自己绘制其窗口小部件，但从4.0版开始，可以尝试在Windows或macOS上使用本机元素，这可能会提供更本机的外观。</p><p> One more important GUI toolkit is  wxWidgets, which uses GTK on Linux andnative GUI elements on Windows and macOS. Some people like wxWidgets as it is areally cross platform GUI toolkit with native look and feel, but at least for Linuxit is just one more layer on top of GTK. And it does not support the mobile operating systemsAndroid and iOS.</p><p> 一个更重要的GUI工具包是wxWidgets，它在Linux上使用GTK，在Windows和macOS上使用本机GUI元素。有些人喜欢wxWidgets，因为它实际上是具有本机外观的跨平台GUI工具包，但至少对于Linuxit而言，它只是GTK之上的另一层。而且它不支持移动操作系统Android和iOS。</p><p> Beside the large toolkits Qt and GTK there exists many more smaller ones, as thealready mentioned wxWidgets, the FLTK toolkit written in C++, or the old and plainones like LessTif or TK.</p><p> 除了大型工具箱Qt和GTK之外，还有许多其他小型工具箱，例如已经提到的wxWidgets，用C ++编写的FLTK工具箱，或诸如LessTif或TK之类的老旧俗名。</p><p> And finally we have always the option not to use a GUI toolkit at all but to create aGUI based on HTML and JavaScript which can be used with web browsers.</p><p> 最后，我们始终可以选择完全不使用GUI工具包，而是基于HTML和JavaScript创建可与Web浏览器一起使用的GUI。</p><p> The fact that GTK is written in C and so is very hard to maintain is at the same timea large benefit: As C is a simple languages without advanced concepts like classes,templates, inheritance or automatic memory managements it is generally very easy tocreate bindings to C libraries from other programming languages. For GTK this fact iseven supported by the GTK  gobject-introspection database which allows tocreate bindings to all the GTK related libraries in a semi-automatic process.</p><p> GTK是用C编写的，因此很难维护，这同时带来了很大的好处：由于C是一种简单的语言，没有类，模板，继承或自动内存管理等高级概念，因此通常很容易创建与其他编程语言的C库。对于GTK，GTK gobject-introspection数据库甚至支持该事实，该数据库允许在半自动过程中创建与所有GTK相关库的绑定。 </p><p> So the majority of all the new modern computer programming languages have bindings tothe GTK toolkit. For Qt which is written in C++ it is much more difficult to createbindings, as C concepts like C classes, templates and the MOC preprocessor makesautomatic bindings generation difficult.</p><p>因此，大多数新的现代计算机编程语言都具有与GTK工具包的绑定。对于用C ++编写的Qt，创建绑定要困难得多，因为C类，模板和MOC预处理器等C概念使自动生成绑定变得困难。</p><p> So Qt is mostly used direct from C++, or its well supported Python bindings areused. Qt language bindings for many other programming languages exists, but it ishard to keep them up to date. Sometimes Qt GUIs are also created with  QML,which allows to create user interfaces in a declarative manner. QML bindings areavailable for various programming languages.</p><p> 因此，Qt通常直接从C ++中使用，或者使用其受支持的Python绑定。存在许多其他编程语言的Qt语言绑定，但是很难使它们保持最新。有时Qt GUI也使用QML创建，它允许以声明的方式创建用户界面。 QML绑定可用于各种编程语言。</p><p> While GTK is still used often directly from C, it provides a larger set of officialsupported languages bindings which include C++ (gtkmm), JavaScript, Python, Rust,Perl and Vala. D and Go are also well supported, and for many other programminglanguages at least bindings for a subset of GTK exists.</p><p> 尽管GTK仍经常直接从C使用，但它提供了一组官方支持的语言绑定，包括C ++（gtkmm），JavaScript，Python，Rust，Perl和Vala。 D和Go也得到很好的支持，对于许多其他编程语言，至少存在GTK子集的绑定。</p><p> In this book we will use gobject-introspection based bindings to write GTK apps inthe Nim programming languages. Nim is a modern compiled statically typed language,that can generate fast native executables from clean high level source code. As Nimdoes not enforce OOP design with inheritance as languages like Java do, our Nimexamples follow the original C examples provided by GTK core developers. Some othermodern languages like Go or Rust use generally a similar approach and do not enforceOOP and inheritance, while classical OOP languages like Java, Python or Rubygenerally enforce the use of classes and inheritance for GTK apps. C++ with itsgtkmm GTK bindings also push its users to OOP design.</p><p> 在本书中，我们将使用基于gobject-introspection的绑定以Nim编程语言编写GTK应用程序。 Nim是一种现代的编译静态类型语言，可以从干净的高级源代码生成快速的本机可执行文件。由于Nimdoes不会像Java这样的语言通过继承来强制OOP设计，因此我们的Nimexamples遵循了GTK核心开发人员提供的原始C示例。一些其他现代语言（例如Go或Rust）通常使用类似的方法，并且不强制执行OOP和继承，而传统的OOP语言（例如Java，Python或Ruby）通常强制对GTK应用程序使用类和继承。带有gtkmm GTK绑定的C ++也将其用户推向了OOP设计。</p><p> We will use for this book semi-automatic generated GTK 4 and GTK 3 bindings whichare generated by the  gintro package, where g stands for all the gtk relatedlibraries and intro for introspection as the bindings are generated by use ofgobject-introspection.</p><p> 在本书中，我们将使用由gintro软件包生成的半自动生成的GTK 4和GTK 3绑定，其中g代表所有与gtk相关的库，而intro代表自省，因为绑定是通过使用gobject-introspection生成的。</p><p> You should be aware that for the Nim programming language many more GUI toolkits areavailable, some based also on GTK but with a different API design, and some based onother libraries or written directly in Nim like the NimX module.</p><p> 您应该注意，对于Nim编程语言，还有更多的GUI工具箱可用，其中一些也基于GTK但具有不同的API设计，而另一些基于其他库或直接用Nim编写，例如NimX模块。</p><p>  Some of these bindings may currently not compile with the latest Nim compiler or maynot support the new  ARC memory management. But we recommend to investigatethem before you decide to use gintro, maybe one of them fits better you needs. wNimshould be a good choice when you intent to develop for windows only, nimx may be themost fun as it is pure Nim, fidget looks really nice, nigui supports native look forWindows, and finally nimgui is a bindings to the dear imgui immediate mode library.Most of above bindings are hosted at github, you can use github, google or nimblesearch to locate the packages.</p><p>  这些绑定中的某些当前可能无法使用最新的Nim编译器进行编译，或者可能不支持新的ARC内存管理。但是我们建议您在决定使用gintro之前进行调查，也许其中之一更适合您的需求。当您仅打算为Windows开发时，wNim应该是一个不错的选择，nimx可能是最有趣的，因为它纯粹是Nim，fdget看起来非常不错，nigui支持Windows的本机外观，最后nimgui是对亲爱的imgui立即模式库的绑定。以上大多数绑定都托管在github上，您可以使用github，google或nimblesearch来找到软件包。 </p><p> Note that we assume for this book that you are already familiar with computerprogramming in general and with the Nim programming language. At least you should beable to open a terminal window and to enter and execute some commands. Some basicknowledge of the C language would also help, as we sometimes use C code as a startingpoint for our Nim programs.</p><p>请注意，对于本书，我们假设您已经熟悉计算机程序设计和Nim编程语言。至少您应该能够打开终端窗口并输入并执行一些命令。一些C语言的基本知识也将有所帮助，因为我们有时会使用C代码作为Nim程序的起点。</p><p> GTK is an event driven toolkit. That is we create widgets like buttons or text entryfields and connect them with one or multiple functions, which are then automaticallycalled when an input event like a button press or a text entry is discovered by GTK.</p><p> GTK是事件驱动的工具箱。也就是说，我们创建了诸如按钮或文本输入字段之类的小部件，并将它们与一个或多个功能相关联，然后当GTK发现诸如按钮按下或文本输入之类的输入事件时，将自动调用这些小部件。</p><p> For creating a GUI we create and arrange all our widgets, and then connect widgetactions with our handler functions, called callbacks. The callback can performarbitrary tasks, this includes modifying the GUI by changing the appearance ofwidgets, or by removing widgets or by adding new widgets.</p><p> 为了创建GUI，我们创建并安排了所有小部件，然后将小部件动作与我们的处理函数（称为回调）连接起来。回调可以执行任意任务，这包括通过更改小部件的外观，删除小部件或添加新的小部件来修改GUI。</p><p> Generally GTK does manage the actual layout of the widgets automatically for us, thatis widgets are automatically arranged and resized to create a clean nice look, andwhen we resize the top level window or add or remove widgets, the layout adaptsitself automatically. This behavior is archived by the boxes in boxes conceptrepresented by GtkBox — we create vertical or horizontal boxes, which we can fillwith widgets, and we can put these boxes again in other larger boxes in a recursivemanner. In this way we can specify the desired layout, but the concrete layout isdone automatically. For example buttons can resize automatically when the label textor font size change. The horizontal or vertical boxes are supported by twodimensional grids or by special containers like header bars. We can tune the layoutby specifying margins or distances between widgets, or we can modify the visualappearance with CSS. But generally we do not create layouts where we specify exactpixel positions for GUI elements. GTK also offers a fixed positioning and sizingmodel, using the GtkFixed and the GtkLayout containers, but that is used only in rarecases. Recently GTK also got a new constraint-based layout manager developed byEmmanuele Bassi, which may allow to easily create even more flexible layouts.</p><p> 通常，GTK会自动为我们管理窗口小部件的实际布局，即窗口小部件会自动排列和调整大小以创建干净漂亮的外观，并且当我们调整顶层窗口的大小或添加或删除窗口小部件时，布局会自动适应自身。此行为由GtkBox代表的概念的盒子中的盒子来归档-我们创建垂直或水平盒子，我们可以填充小部件，然后可以递归方式将这些盒子再次放入其他较大的盒子中。这样，我们可以指定所需的布局，但具体布局会自动完成。例如，当标签文本或字体大小更改时，按钮可以自动调整大小。水平或垂直框由二维网格或特殊的容器（如标题栏）支撑。我们可以通过指定小部件之间的边距或距离来调整布局，也可以使用CSS修改外观。但是通常，我们不会在为GUI元素指定精确像素位置的位置上创建布局。 GTK还使用GtkFixed和GtkLayout容器提供了固定的定位和大小调整模型，但这仅在极少数情况下使用。最近，GTK还获得了由Emmanuele Bassi开发的新的基于约束的布局管理器，该管理器可以轻松创建更灵活的布局。</p><p> We can create the desired widgets directly in our Nim source code, for example by acall of  newButton(&#34;Sort List&#34;), or we can decide to create all the widgetsin a declarative fashion in external XML files. In the XML files we can arrange andgroup all of our widgets in hierarchical layouts, and we can attach attributes likesize, color or textual labels to the widgets. We can create that XML file manually,or we can decide to use the interactive  Glade tool to create the XML file.</p><p> 我们可以直接在我们的Nim源代码中创建所需的小部件，例如通过调用newButton（＆＃34; Sort List＆＃34;），或者我们可以决定以声明的方式在外部XML文件中创建所有小部件。在XML文件中，我们可以按分层布局安排和分组所有小部件，并且可以将属性（例如大小，颜色或文本标签）附加到小部件。我们可以手动创建该XML文件，也可以决定使用交互式Glade工具来创建XML文件。</p><p> Using XML files and the Glade tool may appear simpler, more intuitive and moreflexible. When we create GTK programs directly in the C languages that may be true,as C is a cryptic and verbose languages, which makes changes really difficult. Forhigh level languages like Nim or Python that is not really the case, so it is notalways clear if use of external XML files really have a benefit. XML based layoutshave the advantage that the GUI layout can be modified without recompiling theprogram source code, so even users that do not have the source code of a program canmodify the GUI layout. But this is only an advantage when we do ship our softwarewithout source code, and when we use the XML files in its original form as externaltext files. But in most cases we integrate the XML files again into our mainexecutable to simplify the deployment. An additional disadvantage of the use of XMLfiles is that the Glade tool may not support all widget types and their propertieswell, so that manual modifications of the XML files can be necessary.</p><p> 使用XML文件和Glade工具可能看起来更简单，更直观，更灵活。当我们直接使用C语言创建GTK程序时，这可能是正确的，因为C是一种晦涩而冗长的语言，这使更改变得非常困难。对于像Nim或Python这样的高级语言，情况并非如此，因此，始终不清楚使用外部XML文件是否真的有好处。基于XML的布局具有以下优点：可以在不重新编译程序源代码的情况下修改GUI布局，因此，即使没有程序源代码的用户也可以修改GUI布局。但是，这仅在我们不附带源代码而交付软件以及将XML文件以其原始形式用作外部文本文件时才具有优势。但是在大多数情况下，我们会再次将XML文件集成到我们的主可执行文件中，以简化部署。使用XMLfiles的另一个缺点是Glade工具可能不支持所有的窗口小部件类型及其属性，因此可能需要手动修改XML文件。</p><p> So for the first part of this book we will create our GUI layout directly in the Nimsource code. Later we will introduce the use and layout of the XML files, and we willdescribe how the GTK builder library component is used to import the XML files and toaccess the widgets.</p><p> 因此，对于本书的第一部分，我们将直接在Nimsource代码中创建GUI布局。稍后，我们将介绍XML文件的使用和布局，并描述如何使用GTK构建器库组件导入XML文件和访问小部件。 </p><p> When you are interested in using GTK with Nim, them we should assume that you haveboth already installed on your computer and played with them.</p><p>如果您对在Nim上使用GTK感兴趣，我们应该假定您已经安装在计算机上并可以使用它们。</p><p>  On Linux computers GTK is generally installed by default, or at least available bythe package manager of your Linux distribution. If you should still have an old Linuxsystem which does not yet provide GTK4, you may install it beside your GTK3. Forexample you may install the latest GTK4 from git which these commands entered in aLinux terminal window:</p><p>  在Linux计算机上，GTK通常默认安装，或者至少由Linux发行版的软件包管理器提供。如果您仍然应该使用尚未提供GTK4的旧Linux系统，则可以将其安装在GTK3旁边。例如，您可以从git安装最新的GTK4，这些命令在Linux终端窗口中输入：</p><p> # https://discourse.gnome.org/t/installing-gtk4-for-testing-on-opt-ii/3349/4git clone https://gitlab.gnome.org/GNOME/gtk.gitcd gtkmeson --prefix /opt/gtk builddirninja -C builddirninja -C builddir install# maybe also necessary:export GI_TYPELIB_PATH=/opt/gtk/lib64/girepository-1.0export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:/opt/gtk/lib64/export PKG_CONFIG_PATH=&#34;/opt/gtk/lib64/pkgconfig/&#34;# you may test your installation with:GSETTINGS_SCHEMA_DIR=/opt/gtk/share/glib-2.0/schemas /opt/gtk/bin/gtk4-demo</p><p> ＃https://discourse.gnome.org/t/installing-gtk4-for-testing-on-opt-ii/3349/4git clone https://gitlab.gnome.org/GNOME/gtk.gitcd gtkmeson --prefix可能还需要/ opt / gtk builddirninja -C builddirninja -C builddir install＃：导出GI_TYPELIB_PATH = / opt / gtk / lib64 / girepository-1.0export LD_LIBRARY_PATH = $ LD_LIBRARY_PATH：/ opt / gtk / lib64 / export PKG_CONFIG_PATH =＆＃34; / opt / gtk / lib64 / pkgconfig /＆＃34;＃您可以使用以下命令测试安装：GSETTINGS_SCHEMA_DIR = / opt / gtk / share / glib-2.0 / schemas / opt / gtk / bin / gtk4-demo</p><p>     If you have problems with the installation then you may ask for support at the GTKinternet forum:</p><p>     如果您在安装过程中遇到问题，则可以在GTKinternet论坛上寻求支持：</p><p>  In the rest of this book we assume that you have also installed the Nim compiler anda C compiler like gcc or clang.</p><p>  在本书的其余部分中，我们假定您还安装了Nim编译器和gcc或clang之类的C编译器。</p><p> When you have not yet installed the Nim GTK bindings then you may enter in a terminalwindow:</p><p> 如果尚未安装Nim GTK绑定，则可以在终端窗口中输入：</p><p>  The gintro package generates the bindings between the GTK libraries and the Nimlanguage locally on your computer by querying the gobject-introspection data base.The generated modules depend on your operating system (Linux, Windows, Mac, 32 bit, 64 bit) andon the available GTK version. If you update your GTK system it may be necessary toupdate gintro by  nimble uninstall gintro; nimble install gintro. Executingthat sequence is also recommended when a new gintro release is available. You canalso use  nimble install gintro@head to get the latest gintro with latest,less tested fixes.</p><p>  gintro软件包通过查询gobject-introspection数据库在您的计算机上本地生成GTK库和Nimlanguage之间的绑定。生成的模块取决于您的操作系统（Linux，Windows，Mac，32位，64位）和可用的GTK版本。如果您更新了GTK系统，则可能需要通过灵活卸载gintro来更新gintro。敏捷安装gintro。当有新的gintro版本可用时，也建议执行该序列。您也可以使用敏捷安装gintro @ head来获取具有最新的，未经测试的修复程序的最新gintro。 </p><p> GTK 3 introduces the GtkApplication framework, which is continued by GTK 4 and isgenerally the recommended way to create GTK applications. Programs based onGtkApplication seems to be a bit more complicated than the ones with legacy GTK 2startup code, but the GtkApplication style offers some benefits like management ofmultiple program instances, parameter passing, and it enables new modern layouts withheader bars and hamburger menus. So we will use the GtkApplication style in the restof this book.</p><p>GTK 3引入了GtkApplication框架，该框架由GTK 4继承，通常是创建GTK应用程序的推荐方法。基于GtkApplication的程序似乎比具有传统GTK 2启动代码的程序复杂一些，但是GtkApplication样式提供了一些好处，例如管理多个程序实例，参数传递，并且它可以使用带有标题栏和汉堡菜单的新的现代布局。因此，我们将在本书的其余部分中使用GtkApplication样式。</p><p> As you will still find many example programs that still uses the old GTK 2 programstartup code, we will present that program shape here first. The following C programcalled simplegtk3.c uses the old GTK 2 style and can be compiled with this command:</p><p> 由于您仍会找到许多仍使用旧GTK 2程序启动代码的示例程序，因此我们将首先在此处显示该程序的形状。以下名为simplegtk3.c的C程序使用旧的GTK 2样式，可以使用以下命令进行编译：</p><p>    The program will open a tiny window containing a single push button. Clicking thatbutton will write a message to the terminal window. You can terminate the program byclicking with the mouse on the cross on the upper right corner of the program window.</p><p>    该程序将打开一个包含单个按钮的小窗口。单击该按钮会将消息写入终端窗口。您可以通过在程序窗口右上角的十字上单击鼠标来终止程序。</p><p>  // based on https://gitlab.gnome.org/GNOME/gtk/-/blob/master/tests/simple.c // gcc -o simplegtk3 simplegtk3.c `pkg-config --libs --cflags gtk+-3.0` #include  &lt;gtk/gtk.h&gt;  static  void hello  ( void ) {  g_print  ( &#34;hello world \n &#34; ); } int main  ( int  argc ,  char  * argv []) {  GtkWidget  * window ,  * button ;  gtk_init ( &amp; argc ,  &amp; argv );  window  =  gtk_window_new ( GTK_WINDOW_TOPLEVEL );  gtk_window_set_title  ( GTK_WINDOW  ( window ),  &#34;hello world&#34; );  gtk_window_set_resizable  ( GTK_WINDOW  ( window ),  FALSE );  g_signal_connect ( window ,  &#34;destroy&#34; ,  G_CALLBACK ( gtk_main_quit ),  NULL</p><p>  //基于https://gitlab.gnome.org/GNOME/gtk/-//blob/master/tests/simple.c // // gcc -o simplegtk3 simplegtk3.c`pkg-config --libs --cflags gtk +- 3.0` #include＆lt; gtk / gtk.h＆gt;静态void hello（void）{g_print（＆＃34; hello world \ n＆＃34;）; } int main（int argc，char * argv []）{GtkWidget * window，* button; gtk_init（＆amp; argc，＆amp; argv）; window = gtk_window_new（GTK_WINDOW_TOPLEVEL）; gtk_window_set_title（GTK_WINDOW（window），＆＃34; hello world＆＃34;）; gtk_window_set_resizable（GTK_WINDOW（window），FALSE）; g_signal_connect（window，＆＃34; destroy＆＃34;，G_CALLBACK（gtk_main_quit），NULL</p><p>......</p><p>...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://ssalewski.de/gtkprogramming.html">http://ssalewski.de/gtkprogramming.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/用于/">#用于</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/graphical/">#graphical</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/gtk/">#gtk</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>