<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>用于Apache Spark Preview的Kotlin</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">用于Apache Spark Preview的Kotlin</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-08-29 06:19:25</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/8/43bba91f3397ea542b467b9bd7d2c71b.png"><img src="http://img.diglog.com/img/2020/8/43bba91f3397ea542b467b9bd7d2c71b.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Apache Spark是一个用于大规模分布式数据处理的开源统一分析引擎。在过去的几年中，它已经成为用于处理大量数据的最流行的工具之一。它涵盖了广泛的任务-从数据批处理和简单的ETL(提取/转换/加载)到流和机器学习。</p><p>由于Kotlin与Java的互操作性，Kotlin开发人员已经可以通过Java API使用Apache Spark。然而，这样一来，他们就不能充分利用科特林的潜力，一般的体验也远非一帆风顺。</p><p>今天，我们很高兴与大家分享用于Apache Spark的Kotlin API的第一个预览版。该项目在Kotlin和Apache Spark之间添加了一层缺失的兼容性。它允许您使用熟悉的语言特性(如数据类和lambda表达式)编写惯用的Kotlin代码。</p><p>With Spark是使用SparkSession的一种简单而优雅的方式，它将自动为您调用块末尾的spk.stop()。您可以将运行Spark可能需要的参数传递给它，例如主位置、日志级别或应用程序名称。它还为本地运行Spark提供了一组方便的默认值。</p><p>Val日志文件=&#34；a/path/to/logFile.txt&#34；With Spark(MASTER=&#34；纱线&#34；，logLevel=SparkLogLevel.DEBUG){Partk.read().textFile(日志文件).with Cached{Val Numas=筛选器{it.concludes(&#34；a&#34；)}.count()VAL NUMBS=筛选器{it.concludes(&#34；b&#34；)}.count()Println(&#34；带有a：$Numas的行，带有b：$Numbs&#34；的行；)}}。</p><p>上例中的另一个有用函数是with Cached。在其他API中，如果您希望将计算分叉到多个路径中，但只计算一次，则可以调用“cache”方法。但是，这很快就很难跟踪了，您必须记住取消对缓存数据的持久化。否则，您可能会占用比预期更多的内存，甚至会完全损坏东西。WitCached负责跟踪和取消持久化。</p><p>Kotlin for Spark将leftJoin、rightJoin和其他别名添加到现有方法中，然而，这些别名在设计上是空安全的。</p><p>Fun Main(){数据类坐标(Val lon：Double，Val Lat：Double)数据类城市(VAL名称：字符串，VAL坐标：坐标)数据类CityPopulation(Val City：String，Val Population：Long)With Spark(appName=&#34；查找要访问的最大城市&#34；){具有坐标的VAL城市=dsOf(城市(&#34；莫斯科&#34；，坐标(37.6155600，55.7522200))，//...)VAL人口=dsOf(城市人口(&#34；莫斯科&#34；，11_503_501L)，//...)CitiesWithHarates.rightJoin(Population，citiesWithHarates.ol(&#34；name&#34；)==Population s.ol(&#34；City&#34；)).filter{(_，citiesPopulation)-&gt；城市人口.人口&gt；15_000_000L}.map{(城市，_)-&gt；//此右连接中的城市可能为空！城市？.坐标}.filterNotNull().show()}}</p><p>请注意上例中的城市？.坐标线。在此右联接中，城市可能为空。这会在其他JVM Spark API中导致NullPointerException，并且调试问题的根源会相当困难。Kotlin for Apache Spark为您提供了NULL安全保护，您可以方便地过滤出NULL结果。</p><p>这个Kotlin for Apache Spark的初始版本支持Apache Spark 3.0，其核心是针对Scala 2.12编译的。</p><p>API涵盖了创建最适合批处理ETL的自包含Spark应用程序所需的所有方法。</p><p>为了帮助您快速开始使用Kotlin for Apache Spark，我们准备了一份快速入门指南，帮助您设置环境，正确定义项目的依赖关系，并运行第一个用Kotlin编写的自含式Spark应用程序。</p><p>我们理解，将任何现有的框架升级到新版本都需要一段时间，Spark也不例外。这就是为什么在下一次更新中，我们将添加对早期Spark版本的支持：2.4.2-2.4.6。</p><p>我们还在开发Kotlin Spark shell，这样您就可以享受以交互方式处理数据的乐趣，并使用它执行探索性数据分析。</p><p>目前，Spark Streaming和Spark MLlib不在此接口范围内，但我们会密切听取您的反馈，并在我们的路线图中进行相应处理。</p><p>在未来，我们希望看到Kotlin以一等公民的身份加入官方的Apache Spark项目。我们相信它可以为Kotlin和Spark社区增加价值。这就是为什么我们开了一个Spark项目改进提案：Kotlin支持Apache Spark。我们鼓励您发表您的意见并加入讨论。</p><p>来试试Kotlin的Apache Spark吧，让我们知道你的想法！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.jetbrains.com/kotlin/2020/08/introducing-kotlin-for-apache-spark-preview/">https://blog.jetbrains.com/kotlin/2020/08/introducing-kotlin-for-apache-spark-preview/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/apache/">#apache</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/spark/">#spark</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1016719.html"><img src="http://img.diglog.com/img/2020/8/thumb_5957214543e61b2009e2522cc6045172.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1016719.html">Apache Kafka 2.6更新</a></div><span class="my_story_list_date">2020-8-7 2:32</span></div><div class="col-sm"><div><a target="_blank" href="/story/1014429.html"><img src="http://img.diglog.com/img/2020/7/thumb_fbae8366a92252684fa42b8b22c473bc.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1014429.html">Apache Arrow 1.0.0发布</a></div><span class="my_story_list_date">2020-7-27 23:28</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009746.html"><img src="http://img.diglog.com/img/2020/7/thumb_5138ba034dfa3368bb234bca1aff1001.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009746.html">修复Apache远程桌面中的严重漏洞</a></div><span class="my_story_list_date">2020-7-4 7:33</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009531.html"><img src="http://img.diglog.com/img/2020/7/thumb_5138ba034dfa3368bb234bca1aff1001.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009531.html">哈哈-Y瓜卡摩尔！修复Apache远程桌面中的严重漏洞</a></div><span class="my_story_list_date">2020-7-3 1:59</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>