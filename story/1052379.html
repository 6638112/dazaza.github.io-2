<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>与MacOS Tar相比，在使用Python的焦油时，为什么ktr.xz文件15x更小？ </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">与MacOS Tar相比，在使用Python的焦油时，为什么ktr.xz文件15x更小？ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-15 06:29:36</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/3/2c1b39c0afe786278528f3d92463870e.png"><img src="http://img2.diglog.com/img/2021/3/2c1b39c0afe786278528f3d92463870e.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>我压缩〜1.3 gb文件夹每个填充1440个json文件，并在麦斯科斯或raspbian 10（buster）上使用tar命令和使用python＆＃39; sa＆＃39;在使用python＆＃39; sa＆＃39之间的差异。在Tar​​file库中。</p><p>   ＃！/ usr / bin / env python3 from pathlib导入路径从子进口导入callimport tarfilefullpath = path（＆＃34; /用户/桌面/ temp / tar / mater / moder / desktop / temp / tar / 2021-03-11＆＃34;）zsh_out = path（fullpath.parent ，＆＃34; zsh-archive.tar.xz＆＃34;）py_out = path（fullpath.parent，＆＃34; py-archive.tar.xz＆＃34;）＃tar使用终端＃tar cjf zsh-inshive。 tar.xz folderpathcall（[＆＃34; tar＆＃34; cjf＆＃34;，zsh_out，fullpath]）＃tar使用tarfile.open（py_out，＆＃34; w：xz＆＃34; ）作为tar：tar.add（fullpath，arcname = fullpath.stem）＃print filesizateprint（f＆＃34; zsh tar文件大小：{round（path（zsh_out）.stat（）。st_size /（1024 * 1024），2） MB＆＃34;）打印（f＆＃34; py tar文件大小：{round（path（pat_out）.stat（）。st_size /（1024 * 1024），2）} mb＆＃34;）</p><p>           如果我用QuickLook（和betterzip插件）检查档案，我会看到存档中的文件以不同的方式排序：</p><p>   zsh存档使用未知的顺序，并且Python归档通过修改日期命令文件。我不确定是否重要。</p><p>  到底是怎么回事？我是通过使用Python库压缩我的数据的东西吗？是一个15倍的差异，一个问题的指标？或者我可以安全地继续使用高效的Python实现？</p><p>  8您是否确保了Tar CJF的结果实际上是XZ压缩？ XZ也使用LZMA，但它是一种不同的格式，例如7-zip。尝试文件archive.tar.xz。  -  Daniel B.</p><p>    在这两种情况下，您是否实际上是在同一个目录树上？只是确保;-)  -  tink. </p><p>嗯，好的。请验证未压缩的.tar文件是否相同。文件可能已以不同的顺序添加，从而创建不同的压缩结果。  -  Daniel B.</p><p>  @Tink，是的，我这样做。我在我的问题中添加了一个testscript，它显示了正在压缩的相同目录，生成众多不同的文件。  -  SaaruLindestøkke.</p><p>  好的，我想我发现了问题：BSD Tar和GNU Tar没有任何排序选项，以未定义的顺序将文件放在存档中。</p><p>  根据顺序对目录条目进行排序，这是无，名称或inode之一。默认值为-sort = none，以与操作系统返回的顺序存储归档成员。</p><p>     我获得了1.5 MB的.tar.xz存档，等于Python库创建的存档。</p><p>  我的JSON文件包含来自数百个传感器的测量值。我每分钟读出所有传感器，但只有少数这些传感器从分钟到分钟的数量不同。通过按名称排序文件（它在它的开头的创建UnixTime），两个后续文件在它们之间具有很小的不同字符.Apparent，这对于压缩效率非常有利。</p><p>  9压缩程序在由单个字典控制的文本块上运行;通过对输入进行排序，＆＃39; VE将相似的比特放在彼此附近，允许XZ压缩在一个字典中的大量类似的数据。压缩和减压可能更快。  - 罗吉恩 </p><p>我没有真正了解，但是为什么操作系统返回＆＃34的文件;未分发的＆＃34;使用sort = none选项顺序。我的意思是，总是有些排序顺序，对吗？如果有人知道操作系统使用的订单随意添加。  -  SaaruLindestøkke.</p><p>  @saarulindestøkkke操作系统返回目录中文件的顺序取决于所使用的文件系统（假设使用了相同的操作系统，显然您可以轻松修补Linux，以便默认情况下您想要的某些顺序返回文件或者它将返回文件默认情况下随机化订单）。因此，任何操作系统都没有使用单个排序顺序，因为我们不提供保证和我们说＆＃34;不要假设任何特定的排序顺序＆＃34;这并不意味着文件系统以前积极地随机化结果返回它们，只需意味着用户更改FS，结果可能会发生变化  -  Bakuriu.</p><p>  TL：博士：＆＃34;未归解的＆＃34;意味着在我们从OS和＃39的系统调用中使用DIR条目，您可以使用LS -U查看。  -  Peter Cordes.</p><p>      我知道你在这里询问xz但是在这个答案中解释了这里，在旧版本的gzip上，您可以使用这样的环境变量设置压缩级别：</p><p>  也就是说，只似乎只使用GZIP 1.8，并且在更高版本上折旧。所以使用-i / --USE-COMPRESS-PROGRAME = CARM命令选项，而不是tar;注意此选项可能无法在MacOS上运行，但无论如何都在此处拨打此处。因此，命令将更改为：</p><p>  是的，这些示例将压缩归档Gzip而不是XZ，但您可以轻松更改命令以使用如此：</p><p>  XZ压缩级别范围从-0到-9，默认为-6;所以-9是最高的压缩水平。 </p><p>请注意，默认情况下，XZ未安装在MacOS上。要在MacOS上安装它，您必须首先安装Homebrew，然后通过如下所示安装XZ：</p><p>  5我尝试了命令tar -i＆＃39; xz -9＆＃39; -cf zsh-archive.tar.xz folderpath，但我收到以下错误：tar：cann＆＃39; t打开xz -9：没有这样的文件或目录  -  SaaruLindestøkke.</p><p>  在麦斯科斯？我被检查了，它似乎是由我的系统提供的。所以我建议安装HomeBrew然后运行：Brew Install XZ  -  GIACOMO1968.</p><p>  是的，在麦克斯。 MAN TAR显示-I选项是-t选项的同义词，它是--files从选项。我尝试过的龙手选项 - 使用-uld-compress程序，它导致了10 MB文件，而不是常规23 MB，但它仍然没有靠近Python的1.5 MB。  -  SaaruLindestøkke.</p><p>  请注意，我也在Raspbian终端中尝试了这一点，结果与我在麦克斯上获得了类似的结果。  -  SaaruLindestøkke.</p><p>    它可能使用Liblzma中的函数调用＆＃39。 tar可能会通过xz shell命令管道。</p><p>  “排序”选项是对GNU Tar的相对较近的增强，并在Tar版本1.28中引入。 </p><p>点击“发布答案”，您同意我们的服务条款，隐私政策和Cookie政策  不是答案你和＃39;寻找？ 浏览其他标记的问题或提出您自己的问题。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://superuser.com/questions/1633073/why-are-tar-xz-files-15x-smaller-when-using-pythons-tar-library-compared-to-mac">https://superuser.com/questions/1633073/why-are-tar-xz-files-15x-smaller-when-using-pythons-tar-library-compared-to-mac</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tar/">#tar</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1052366.html"><img src="http://img2.diglog.com/img/2021/3/thumb_2c1b39c0afe786278528f3d92463870e.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1052366.html">与MacOS Tar相比，在使用Python的焦油时，为什么ktr.xz文件15x更小？ </a></div><span class="my_story_list_date">2021-3-15 5:32</span></div><div class="col-sm"><div><a target="_blank" href="/story/1051102.html"><img src="http://img2.diglog.com/img/2021/3/thumb_1e1e69ef268e85f761841d4fd52bb70c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1051102.html">我为什么要学习Python？ </a></div><span class="my_story_list_date">2021-3-7 13:20</span></div><div class="col-sm"><div><a target="_blank" href="/story/1050938.html"><img src="http://img2.diglog.com/img/2021/3/thumb_fe84bfa92b58fb5cd2740cea1b66bd8f.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1050938.html">JavaScript-（不是Python-）定义的中性网络？ Deno 1.8支持WebGPU </a></div><span class="my_story_list_date">2021-3-7 9:54</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049938.html"><img src="http://img2.diglog.com/img/2021/2/thumb_e0febb08bc47285eea945919fd64119c.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049938.html">Gradient-Free-Optimizers Python中现代优化方法的集合 </a></div><span class="my_story_list_date">2021-2-28 22:30</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>