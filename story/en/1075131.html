<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>哦，Linux打包系统中的快照安全漏洞Oh, Snap Security Holes Found in Linux Packaging System</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Oh, Snap Security Holes Found in Linux Packaging System<br/>哦，Linux打包系统中的快照安全漏洞</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-26 08:29:38</div><div class="page_narrow text-break page_content"><p>Canonical‘s  snap, like  Red Hat‘s  flatpaks, are container-based Linux software packaging and deployment programs. While snaps are most strongly associated with  Ubuntu Linux, it’s used to distribute and install Linux programs over many Linux distributions. And, alas, the  Qualys Research Team, has found several hard-to-find but  nasty snap Linux security problems including the  Oh Snap! More Lemmings Exploit.</p><p>Canonical的snap和Red Hat的Flatpak一样，都是基于容器的Linux软件打包和部署程序。虽然Snap与UbuntuLinux的关联最为密切，但它用于在许多Linux发行版上分发和安装Linux程序。唉，Qualys研究团队发现了几个很难找到但很棘手的snap Linux安全问题，包括Oh snap！更多的旅鼠利用。</p><p> Despite the funny name, these security holes are serious. In the worst-case scenario, this 7.8 Common Vulnerability Scoring System (CVSS) rated security hole can be used to obtain full root privileges on default Ubuntu installations. Ouch!</p><p>尽管名字很有趣，但这些安全漏洞很严重。在最坏的情况下，这个7.8通用漏洞评分系统（CVSS）级别的安全漏洞可以用来获得默认Ubuntu安装的完整根权限。哎哟</p><p> But, before getting worked up at Canonical, take a closer look. While discovering the snap vulnerabilities, Qualsys also found security problems you’ll find in all Linux distributions. These are  CVE-2021-3996 and  CVE-2021-3995 in util-linux (libmount and umount);  CVE-2021-3998 and  CVE-2021-3999 in the glibc (realpath() and getcwd()), and  CVE-2021-3997 in systemd (systemd-tmpfiles).</p><p>但是，在Canonical工作之前，请仔细看看。在发现snap漏洞的同时，Qualsys还发现了所有Linux发行版中都存在的安全问题。它们是util linux（libmount和umount）中的CVE-2021-3996和CVE-2021-3995；glibc中的CVE-2021-3998和CVE-2021-3999（realpath（）和getcwd（）），以及systemd中的CVE-2021-3997（systemd tmpfiles）。</p><p> The security researchers also stated, “Discovering and exploiting a vulnerability in snap-confine has been extremely challenging (especially in a default installation of Ubuntu) because snap-confine uses a very defensive programming style,  AppArmor profiles, seccomp filters, mount namespaces, and two Go helper programs.” Despite all that, they found a pair of vulnerabilities.</p><p>安全研究人员还表示，“发现和利用snap Constrict中的漏洞非常具有挑战性（尤其是在Ubuntu的默认安装中），因为snap Constrict使用了非常防御的编程风格、AppArmor配置文件、seccomp过滤器、挂载名称空间和两个Go helper程序。”尽管如此，他们还是发现了两个漏洞。</p><p>  Before getting into that though, to get you up to speed, snaps are self-contained applications running in a sandbox with mediated access to the host system. Unlike traditional Linux software managers, such as Debian DEB and Red Hat RPM, which install programs as packages along with all their other dependencies as separate packages, snaps come pre-bundled with their required dependencies. This makes it easy to deploy them on any Linux with the Snap service.</p><p>不过，在开始之前，为了让您了解最新情况，Snap是在沙箱中运行的自包含应用程序，可以通过中介访问主机系统。与传统的Linux软件管理器（如Debian DEB和Red Hat RPM）不同，传统的Linux软件管理器将程序作为软件包安装，并将其所有其他依赖项作为单独的软件包安装，而Snap是与它们所需的依赖项预捆绑在一起的。这使得在使用Snap服务的任何Linux上部署它们都很容易。</p><p> In recent years, this  newer style of installing Linux applications has become very popular. While it’s best known in Linux desktop circles, snaps are also used on servers and, indeed, with complete Linux distributions such as the Internet of Things (IoT)  Ubuntu Core distro.</p><p>近年来，这种新的安装Linux应用程序的方式变得非常流行。虽然Snap在Linux桌面圈中最为人所知，但它也被用于服务器上，事实上，在物联网（IoT）Ubuntu核心发行版等完整的Linux发行版中也有使用。</p><p>  The first problem was the snap daemon snapd didn’t properly validate the snap-confine binary’s location. Because of this, a hostile user could hard-link the binary to another location. This, in turn, meant a local attacker might be able to use this issue to execute other arbitrary binaries and escalate privileges.</p><p>第一个问题是快照守护程序snapd没有正确验证快照限制二进制文件的位置。因此，恶意用户可能会将二进制文件硬链接到另一个位置。这反过来意味着本地攻击者可能会利用此问题执行其他任意二进制文件并提升权限。</p><p> The researchers also discovered that a race condition existed in the snapd snap-confine binary when preparing a private mount namespace for a snap. With this, a local attacker could gain root privileges by bind-mounting their own contents inside the snap’s private mount namespace. With that, they could make snap-confine execute arbitrary code. From there, it’s easy to start privilege escalation for an attacker to try to make it all the way to root.</p><p>研究人员还发现，在为快照准备私有装载名称空间时，快照快照限制二进制文件中存在竞争条件。这样，本地攻击者就可以通过绑定将自己的内容装载到snap的私有装载命名空间中，从而获得root权限。这样一来，他们就可以让snap Constrict执行任意代码。从这里开始，攻击者很容易启动权限升级，从而尝试将其一直升级到root。</p><p> There’s no remote way to directly exploit this. But, if an attacker can log in as an unprivileged user, the attacker could quickly use this vulnerability to gain root privileges.</p><p>没有远程方法可以直接利用它。但是，如果攻击者能够以无权限用户的身份登录，则攻击者可以快速利用此漏洞获得root权限。</p><p>  Canonical has released a patch that fixes both security holes. The patch is available in the following supported Ubuntu releases: 21.10; 20.04, and 18.04. A simple system update will fix this nicely. The problem is also present in no longer supported Ubuntu distros such as 21.04 and 20.08. Here, you should update to a currently supported Ubuntu distro. Finally, there is no fix available yet for Ubuntu 16.04 ESM (Extended Security Maintenance), but it should be out shortly.</p><p>Canonical发布了修补这两个安全漏洞的补丁。该补丁在以下受支持的Ubuntu版本中提供：21.10；20.04和18.04。一个简单的系统更新就能很好地解决这个问题。这个问题也出现在不再受支持的Ubuntu发行版中，比如21.04和20.08。在这里，您应该更新到当前受支持的Ubuntu发行版。最后，Ubuntu16.04 ESM（扩展安全维护）目前还没有可用的修复程序，但它应该很快就会推出。</p><p> Given this vulnerability’s high level of danger, I highly recommend you patch your distributions as soon as possible. You’ll be glad you did.</p><p>鉴于此漏洞的高度危险性，我强烈建议您尽快修补发行版。你会很高兴的。</p><p> A Canonical representative said, “As always, we are thankful to the great community we are part of, for finding and disclosing such security issues responsibly. We are also grateful to the professionals in our security and snap platform teams who acted quickly to mitigate the vulnerability and to the professionals in other organizations who worked timely on the respective issues disclosed. By now, thanks to automatic refreshes, most snap-distributed platform installations in the world have already been fixed via updates. Updates for other packaging systems are also available and rolling out.”</p><p>一位权威代表说， “一如既往，我们感谢我们所属的伟大社区以负责任的态度发现和披露此类安全问题。我们还感谢我们的安全和snap平台团队中迅速采取行动缓解漏洞的专业人员，以及其他组织中及时处理相关问题的专业人员披露。到目前为止，由于自动刷新，世界上大多数snap分布式平台安装都已通过更新得到修复。其他包装系统的更新也可提供并推出。"</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/打包/">#打包</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/security/">#security</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/snap/">#snap</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>