<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>有史以来最漂亮的程序——用 Lisp 编写的 Lisp 解释器</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">有史以来最漂亮的程序——用 Lisp 编写的 Lisp 解释器</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-08-09 18:42:11</div><div class="page_narrow text-break page_content"><p>这是我第 5 次尝试关注此视频，事情终于开始在我脑海中响起。所以我想如果我把视频里讲的东西写下来，那么我可以再读15遍我的博客文章而不是看视频，这样会很方便。好的，这是它的要点。这家伙正在用Scheme 编写Scheme 解释器。让我们先从设置环境开始，然后我们可以输入。本次演讲使用的编程语言是Scheme Chez Scheme的方言，您可以从这里下载并安装它。在talk pmatch 中使用了一个模式匹配库，你可以从这里找到源代码。如果您从未使用过 Lisp，REPL 代表 Read Eval Print and Loop，它是一个交互式编程环境，允许您在输入时执行程序。现在我们只需在终端中输入 scheme 即可启动 REPL。或者如果你像我一样使用 Emacs，你可以只使用 Mx 运行方案。引用任何东西都会给你回那个东西的象征。 Symbol 有点像其他语言中的变量，它可能绑定到某个值，也可能没有。</p><p>无效的？是一个函数，如果其 arg 为 null 则返回 true，否则返回 false。 lambda 是一种定义函数的方式，例如 (lambda (x) x) 表示这是一个返回它所接受内容的函数。换句话说，它是恒等函数。正如我们所见，它试图将给定的表达式模式匹配到 ´n´，其中 n 是数字，如果找到匹配项，它会返回 n 本身。可以看到我们使用 Scheme 中的 add1 来实现我们语言中的 add1。注意那里的递归 eval-expr，以便我们可以处理像 (add1 (add1 6)) 这样的嵌套表达式。 ,rator 代表运算符，而 ,rand 代表操作数。这相当简单，我们首先评估运算符表达式，然后评估操作数表达式并将前者应用于后者。现在让我们尝试添加 lambda 表达式。这是最困难的部分，所以不要指望一口气理解它。甚至你认为你理解它，你可能没有。我发现了解更高层次上发生的事情更为重要，这将使阅读代码变得更加容易。</p><p>所以我们试图解释 lambda 表达式，但结果是什么？是的，一个我们可以稍后调用的过程，准确地说是一个 Scheme 过程。那么我们如何创建一个 Scheme 过程呢？你猜对了，拉姆达！因此，我们语言中的 lambda 将被解释为 Scheme 中的 lambda。举个例子，假设我们要解释表达式 (lambda (x) (* x 2))，x 是什么？它并不真正意味着任何单独的东西，而是一个将与主体 (* x 2) 结合使用的指标。那么x的值是多少？我们还不知道，正如所说它只是一个指标，一个符号，还没有分配给它的值。但是什么时候会知道价值呢？当然，当我们调用它时。因此，根据我们现在所知道的，可以将 lambda 表达式解释为这样的 Scheme 过程：这里的 arg 是什么？这将是调用此 lambda 的参数。这里有问题。当我们评估主体时，在这种情况下看起来像 (eval-expr &#39;(* x 2))，我们如何将 arg 5 连接到 x？换句话说，在运行时，当 Scheme lambda 被 5 调用时？解释器怎么知道现在 x 应该被评估为 5？答案是引入环境env。 env 是一个接受一个参数的过程。因此，当我们尝试在环境中查找符号时，我们只需使用符号来调用它：(env x)。那么现在回到问题上来，在评估body时我们只需要提供合适的环境，这样当我们稍后查找x时，它会产生5，这就是arg。现在有了所有这些知识，你可以阅读代码，看看你是否能更好地理解它。 (define factorial ((lambda (!) (lambda (n) ((! ! ) n ))) (lambda (! ) (lambda (n ) ( if (zero? n ) 1 (* n ((! ! ) ( sub1 n )))))))))</p><p>好吧，如果没有，那就回去重新阅读这篇博文或重新观看视频，直到一切都变得清晰为止。警告，如果您一直考虑所有嵌套的 lambda，您可能会在夜间醒来或错过公交车站。除此之外，你会没事的。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.lvguowei.me/post/the-most-beautiful-program-ever-written/">https://www.lvguowei.me/post/the-most-beautiful-program-ever-written/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/lisp/">#lisp</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/written/">#written</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1072204.html"><img src="http://img2.diglog.com/img/2021/8/thumb_f3a94aaf69d51eea05a5ba75dc9d8804.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072204.html">Stingle 是一个注重隐私的开源照片备份应用程序</a></div><span class="my_story_list_date">2021-8-9 8:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1072197.html"><img src="http://img2.diglog.com/img/2021/8/thumb_f3a94aaf69d51eea05a5ba75dc9d8804.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072197.html">Stingle 是一个注重隐私的开源照片备份应用程序</a></div><span class="my_story_list_date">2021-8-9 6:26</span></div><div class="col-sm"><div><a target="_blank" href="/story/1072067.html"><img src="http://img2.diglog.com/img/2021/8/thumb_1d15c69b3c21dfaa901abbc0ec57d5d7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072067.html">Retain.ai 是一项为企业提供跨团队、流程和应用程序的客户参与视图的服务，在 Emergence Capital 领投的 A 轮融资中筹集了 2300 万美元</a></div><span class="my_story_list_date">2021-8-8 12:51</span></div><div class="col-sm"><div><a target="_blank" href="/story/1071851.html"><img src="http://img2.diglog.com/img/2021/8/thumb_7bb08f949e83d2af176d039845be0347.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1071851.html">我喜欢 Bandcamp 的原因：周五免收费用，可靠的应用程序，无 DRM，更多</a></div><span class="my_story_list_date">2021-8-7 3:34</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>