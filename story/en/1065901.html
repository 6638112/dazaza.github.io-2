<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>不可能的Java 11 The Impossible Java 11</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">The Impossible Java 11<br/>不可能的Java 11 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-15 22:15:44</div><div class="page_narrow text-break page_content"><p>Over the past two years, I did something no one thought was possible. I updated our code fromJDK 8 to JDK 16. Out of all the things I’ve accomplished at Netflix, this is the one thing I’vehad the most questions about, and the most astonishment. “How did you do it?”</p><p>在过去的两年里，我做了一些没有人想到的事情。我将代码从JDK 8到JDK 16更新。在我在Netflix完成的所有事情中，这是我最疑问和最惊人的最疑问的一件事。 “你是怎么做到的？”</p><p> If you aren’t familiar with Java, Oracle made a tough decision to modernize Java. Prior toJava 9, a major version came out once every few years, and with relatively minor breaking changes.All that changed in Java 9; major versions were going to be breaking, and coming out once every 6months.</p><p> 如果您不熟悉Java，Oracle会使Java现代化的艰难决定。在Tojava 9之前，主要版本每隔几年一次出现一次，并且具有相对较小的破坏变化。在Java 9中改变了所有的打破。主要版本将突破，每6个月出来一次。</p><p> However, unlike Python 3000, Java’s breaking changes were extremely limited. Only JVM internalswould be restricted or removed. That’s it. All the existing language features were stillavailable for use. All the JVM bytecode and classes still worked. Want to use a class written in1995? If it doesn’t depend on  sun.* code, it’s good to go!</p><p> 但是，与Python 3000不同，Java的破坏变化非常有限。只有JVM内部会受到限制或删除。就是这样。所有现有的语言功能都是仍然可用的。所有JVM字节码和类仍然有效。想用1995号写的课程吗？如果它不依赖于太阳。*代码，很高兴！</p><p> But, this is also why so many people thought upgrading was impossible. So much Java code out therehad taken liberties with the JDK internals. Want to use  sun.misc.Unsafe? It’s yours forthe taking. Want to modify final (a.k.a. const) fields? It’s only a little reflection away. Wantto inject some classes into the JDK classloader? No one will stop you.</p><p> 但是，这也是为什么这么多人认为升级是不可能的。这么多Java代码在那里与JDK Internals采取了自由。想要使用sun.misc.unsafe？这是你的。想要修改Final（A.k.a. const）字段？它只是一点反射。想要将某些类注入JDK ClassLoader？没有人会阻止你。</p><p> With no teeth in the API boundaries, Java 8 pretty much let application and library owners do whatthey wanted. Guice, Guava, Jackson, Groovy, Gradle, CGLib, Mockito, Lombok, ErrorProne, and othercommon Java tech played fast and loose with the guts of the JVM. Yes, their code was faster. Butno, it wasn’t a long term win.</p><p> 在API边界中没有牙齿，Java 8几乎让应用程序和图书馆所有者做Whatthey想要的。 Guice，Guava，Jackson，Groovy，Gradle，Cglib，Mockito，Lombok，Errerprone，以及其他与JVM的胆量的快速和松散的杂志。是的，他们的代码更快。 Butno，这不是一个长期的胜利。</p><p> This is where that tough decision by  someone who works one Java comes into play. Java could improveitself, add features, and improve the VM, but it would come at the cost of breaking the ecosystem.Many libraries, which had claimed wins, would have to give them back. Alternatives would beprovided, but everyone would have to coordinate a worldwide, backwards compatible, multi-versionupgrade. Every library not wanting to yield their gains would need to be rewritten. Mostpoignantly though, applications would need to wait till  every library they depended onto make this move.</p><p> 这是一个努力工作一个Java的棘手的决定。 Java可以改进，添加功能，提高VM，但它会以突破生态系统的成本。声称赢的Many图书馆将不得不给他们回来。替代方案将被保存，但每个人都必须协调全球，向后兼容，多版本upplade。每个图书馆都不需要重写才能产生其收益。尽管如此，应用程序需要等待每个库，他们依赖于实现这一移动。</p><p>  Having strong, enforceable API boundaries are necessary for long term improvements. Shortterm wins, while alluring, usually come with non-standard or unsupported baggage. The stricterit is today, the more maintainable it is in the future.</p><p>  具有强大，可执行的API边界是长期改进所必需的。 ShortTerm赢得，同时诱人，通常与非标准或不受支持的行李带来。斯特瑞特是今天，它更为普遍的是未来。 </p><p> Taking away functionality, even under the auspices of standards or specifications, it going tohurt. If it used to work, and you break it, it’s your fault.</p><p>即使在标准或规格的主持下，也脱离功能，即它。如果它曾经工作过，你打破它，这是你的错。</p><p>  When I joined Netflix, no one told me it was impossible to upgrade from Java 8 to 11. I juststarted using it. When things didn’t work (and they definitely didn’t!) on 11, I went and checkedif I needed to update the library. I did this as a back-burner project, on my own machine,separate from the main repo. One by one, all the non-working libraries were updated to the workingones. When a library was not Java 11 compatible, I filed a PR on GitHub to fix it. And, plain asit sounds,  when there are no more broken things, only working things are left!</p><p>  当我加入Netflix时，没有人告诉我，无法从Java 8到11升级。我刚刚开始使用它。当事情不起作用（而且它们肯定没有！）11，我去了并检查了我需要更新库。我在自己的机器上做到这一点是一个背部刻录机项目，与主仓库分开。一个接一个，所有非工作库都更新到果子中。当库不是Java 11兼容时，我在GitHub上提交了一个PR来修复它。而且，普通的声音，当没有更破碎的东西时，只有工作的东西都留下了！</p><p> It was only after I pushed these changes to production, that I found out what I did was impossible.Numerous people asked me how I made this happen. Someone, or some group, had looked at thedaunting task of updating hundreds of projects and probably hundreds more libraries, and had givenup hope. Like a poison placebo, people’s perception of the impossibility actually made itimpossible. Socialize these obstacles and you end up with a whole company finding itinsurmountable.</p><p> 只有在我推动这些改变之后，我发现了我所做的是不可能的。诺瑞的人问我如何发生这种情况。某人或某些团队，看过更新数百个项目，可能是数百个图书馆的追逐任务，并留下了希望。就像一个毒药安慰剂，人们对不可能的看法实际上取消了它。让这些障碍社交，你最终得到了一家整个公司寻找ItinsurMountable。</p><p> When I told them how I fixed it, they were usually disappointed. “Just updated the libraries?” theywould ask, looking for something deeper. Java 11 was time-consuming to upgrade to, but not veryhard. The only difference between my approach and there’s was a lack of despair.</p><p> 当我告诉他们我如何修复它时，他们通常会失望。 “刚更新了库？”他们会问，寻找更深的东西。 Java 11升级到但不是非常令人徒次的。我的方法与缺乏绝望之间的唯一区别。</p><p> I bring up this story to boost the confidence in others that using the latest and greatest is within grasp. A month ago I updated our code to Java 15, and last week to 16. It gets easiereach time. Once you are close to the latest version, it’s no challenge to stay there. Since theonly breaking changes were hiding JVM internals, and we’re no longer using those, it’s trivial toupdate. As a reward, we get all the advanced features (better JIT, GC, language features, etc.)that have been delivered over the past years.</p><p> 我提出了这个故事来提高对他人使用最新和最伟大的掌握的信心。一个月前，我将代码更新为Java 15，上周到16.它会变得更容易。一旦你接近最新版本，那就留在那里没有挑战。由于Alonly破坏的变化是隐藏JVM内部的，因此我们不再使用那些，这是琐碎的尖端。作为奖励，我们获得过去几年送达的所有高级功能（更好的JIT，GC，语言特征等）。</p><p> I encourage you to take a look at updating too, since it is probably easier than you think!</p><p> 我鼓励你看看更新，因为它可能比你想象的更容易！ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://carlmastrangelo.com/blog/the-impossible-java-11">https://carlmastrangelo.com/blog/the-impossible-java-11</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/java/">#java</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/可能/">#可能</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>