<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>用覆盆子pi监控您的互联网 Monitor Your Internet with a Raspberry Pi</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Monitor Your Internet with a Raspberry Pi<br/>用覆盆子pi监控您的互联网 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-24 06:05:32</div><div class="page_narrow text-break page_content"><p>Internet Service Providers are almost universally despised. They&#39;ve pushed for the FCC to continue  defining 25 Mbps as &#34;high use&#34; broadband, and on top of that they overstate the quality of service they provide. A recently-released map of  broadband availability in the US paints a pretty dire picture:</p><p>互联网服务提供商几乎普遍鄙视。他们推动了FCC继续定义25 Mbps作为＆＃34;高使用＆＃34;宽带，以及它们夸大了他们提供的服务质量。最近发布的美国宽带可用性地图绘制了一个漂亮的惨重图片：</p><p>  Here in St. Louis—where I guess I should count my lucky stars we have &#39;high use&#39; broadband available—I have only two options: I can get &#39;gigabit&#39; cable Internet from Spectrum, or 75 megabit DSL from AT&amp;T.</p><p>  在圣路易斯 - 我想我应该算我算上我的幸运星＆＃39;高使用＆＃39;宽带可用 - 我只有两种选择：我可以获得＆＃39;千兆＆＃39;从频谱的有线互联网，或从AT＆amp的75兆比特DSL。</p><p>   But Spectrum&#39;s &#34;gigabit&#34; Internet is 930 megabits down—in  ideal conditions—but only 40 megabits up. And that&#39;s the highest plan that costs about $150 a month!</p><p>   但光谱＆＃39; s＆＃34;千兆＆＃34;互联网是930兆位的下载理想条件 - 但只有40兆位。那个＆＃39;是一个最高计划，每月花费约150美元！</p><p> Some would die for those speeds (see the map above), but much of the world is better off. And are you really getting the speeds you pay for? You probably don&#39;t know.</p><p> 有些人会因为这些速度而死（见上面的地图），但世界的大部分都是更好的。你真的得到了你支付的速度吗？你可能不知道。</p><p>  Well, I do, thanks to a $35 Raspberry Pi! And you don&#39;t even need a Pi, you could run the software I use on any computer. I just like having a dedicated computer to run all my Internet connection tools, so it&#39;s easy to backup or replace, and it doesn&#39;t get bogged down.</p><p>  好吧，我这样做，感谢35美元的覆盆子PI！而且你甚至需要一个pi，你可以运行我在任何计算机上使用的软件。我只是喜欢拥有专用的电脑来运行我的所有互联网连接工具，所以它易于备份或替换，并且它没有陷入困境。</p><p>  I have a video that goes along with this blog post, and it&#39;s embedded below; skip past it if you prefer reading over viewing.</p><p>  我有一个与此博客文章一起的视频，它嵌入下面的博客文章;如果您更喜欢阅读查看，请跳过它。</p><p>     I have it installed in a rack (here&#39;s a  video on the Pi rack), but it could just as easily be on my desk, or sitting by my Internet router.</p><p>     我已经安装在机架中（这里是PI机架上的视频），但它可以很容易地在我的桌子上，或者坐在我的互联网路由器上。 </p><p> The most important thing for measuring a network connection is that it&#39;s wired. WiFi, especially on the Pi, fluctuates quite a bit and is terrible for monitoring anything besides maybe WiFi signal strength.</p><p>用于测量网络连接最重要的是它＆＃39;有线。 WiFi，特别是在PI上，除了可能是WiFi信号强度之外，可以监测任何一点，并且可以监测任何内容。</p><p> The Internet Pi runs  Pi-hole for DNS privacy and ad-blocking, and  Prometheus and  Grafana to provide Internet connection monitoring dashboards.</p><p> 互联网PI为DNS隐私和广告封锁运行PI-Hole，以及Prometheus和Grafana，提供互联网连接监控仪表板。</p><p> Having a Pi monitoring my Internet continuously makes it easy to see trends over time, or confirm outages. If you just spot check by running a Speedtest every now and then, you don&#39;t have much data to go on.</p><p> 连续监控我的互联网的PI使得随着时间的推移，易于看到趋势，或确认中断。如果您只需每次运行SpeedTest，那么您就可以立即查询，而且您可以继续使用太多数据。</p><p>  I built the free and open source  internet-pi project on GitHub. It&#39;s simple to set up, and you can choose which parts of the platform you want to use.</p><p>  我在github上建立了自由和开源的互联网pi项目。它＆＃39; s易于设置，您可以选择要使用的平台的哪些部分。</p><p> I set up my Internet Pi from another computer, but you could also run the Internet Pi playbook on the Pi itself. Following the install instructions, you need to have a Pi set up with Raspberry Pi OS running on your network, and be able to SSH into the Pi.</p><p> 我从另一台计算机设置了我的互联网pi，但你也可以在pi本身上运行互联网pi剧本。在安装说明之后，您需要使用网络上运行的Raspberry PI OS设置PI，并能够将PI SSH。</p><p>  Install the Ansible Galaxy content that&#39;s required to make the playbook work:  ansible-galaxy install -r requirements.yml</p><p>  安装Ansible Galaxy内容，＆＃39; s所需的剧本工作：Ansible-Galaxy Install-R要求.YML</p><p> Make copies of the  example.inventory.ini and  example.config.yml files (dropping the  example. from the filenames) and modify them for your own needs</p><p> 制作example.inventory.ini和example.config.yml文件的副本（删除示例。从文件名）并为您自己的需求修改它们 </p><p> The playbook installs all the tools you choose in your configuration file, and once that&#39;s done, you should be able to access your Pi&#39;s IP address in a web browser to see Pi-hole, or visit the IP address with the port  :3030 on the end to see the Grafana dashboards.</p><p>PlayBook安装您在配置文件中选择的所有工具，并完成了＆＃39;完成，您应该能够在Web浏览器中访问您的PI和＃39; S IP地址以查看PI-孔，或访问IP与端口的地址：3030最后看Grafana仪表板。</p><p>   If you wanna use Pi-hole as your home network&#39;s DNS server, you should configure your router to advertise the Pi&#39;s IP address as the primary DNS server for your whole home network. For extra redundancy, you could actually configure two Pis running Pi-hole, but that&#39;s a topic for another post!</p><p>   如果您想使用PI-Hole作为您的家庭网络＆＃39; S DNS服务器，您应该将路由器配置为为整个家庭网络提供PI和＃39; SID DNS服务器。有关额外的冗余，您实际上可以配置两个运行PI-孔的PI，但是另一个帖子的主题＆＃39;</p><p> But the great thing is, that allows you to see all the DNS requests your devices are making, and make sure (for the most part) things like so-called &#39;smart&#39; TVs don&#39;t  send tons of information to advertisers.</p><p> 但伟大的事情是，这允许您查看您的设备正在制作的所有DNS请求，并确保（大多数情况下）如所谓的和＃39;智能＆＃39; TVS Don＆＃39; T向广告商发送大量信息。</p><p> Pi-hole is a great  first line of defense for your Internet privacy, at least at home, and it even has some other neat tools like a simple DNS server, if you want to use them.</p><p> Pi-孔是您的互联网隐私，至少在家里的伟大辩护，它甚至还有一些像简单的DNS服务器那样的其他简洁的工具，如果要使用它们。</p><p>  The Internet monitoring dashboard is automatically configured for you, but it can take up to an hour before you start seeing data.</p><p>  Internet监控仪表板自动为您配置，但在开始查看数据之前可能需要一个小时。</p><p>  In my case, it&#39;s been running for a couple months, so I can see the Internet connection for the past day, week, or even longer!</p><p>  在我的情况下，它＆＃39; s一直在运行几个月，所以我可以在过去一天，一周甚至更长时间看到互联网连接！</p><p> The monitoring configuration runs one container that connects to Speedtest.net. Every 30 minutes or so, another container running Prometheus tells the first container to run a speed test.</p><p> 监控配置运行一个连接到SpeedTest.Net的容器​​。每30分钟左右，运行普罗米修斯的另一个集装箱告诉第一个容器运行速度测试。 </p><p> NOTE: If you run this monitoring on your own network, be aware that these Speedtest.net checks will consume a good amount of data, especially if you run them more frequently. If you have data caps and want to use this monitoring solution, make sure to modify the check interval so you don&#39;t get an unexpected overage. ISPs, gotta love &#39;em!</p><p>注意：如果您在自己的网络上运行此监控，请注意，这些SpeedTest.net检查将消耗良好的数据，特别是如果您更频繁地运行它们。如果您有数据帽并希望使用此监控解决方案，请务必修改检查间隔，以便您不要获得意想不到的超额。 ISP，Gotta Love＆＃39; EM！</p><p> It stores that data on the Pi, and the Grafana dashboard displays it over time. There&#39;s another service that does simple checks on websites you can configure for uptime and HTTP request timing stats—those lightweight checks are performed every few seconds, to give a detailed view when there is more latency in your Internet connection.</p><p> 它存储PI上的数据，Grafana仪表板随着时间的推移显示它。在那里的另一个服务可以在网站上进行简单的检查，您可以为全摩擦和HTTP请求定时统计数据 - 每隔几秒钟执行那些轻量级检查，以便在Internet连接中有更多延迟时提供详细的视图。</p><p> One thing I found interesting was my Cable internet connection—which is  supposed to be one 930 Mbps—is only really about 700 Mbps on average.</p><p> 我发现有趣的一件事是我的有线互联网连接 - 这应该是一个930 Mbps  - 平均只有约700 Mbps。</p><p> Upload speeds are more consistent, so I begrudgingly pay for this high-tier plan... But I&#39;d be a  lot happier with 50 or 100 Mbps of asymmetric data, since I&#39;m not downloading terabytes of files every day.</p><p> 上传速度更加一致，所以我吝啬了这个高层计划的支付......但是我＆＃39; D与不对称数据的50或100 Mbps的更幸福，因为我没有下载每一个文件的terabytes日。</p><p>  The main reason I set this stuff up was to compare my Gigabit Cable Internet to SpaceX&#39;s Starlink Internet.</p><p>  我设置这些东西的主要原因是将我的千兆线上互联网与Spacex＆＃39; s starlink Internet进行比较。</p><p>  I&#39;ll get more into Starlink in a future review, but it looks like on average, when it has a stable connection, I get over 150 Mbps down, and 15 Mbps up, with 40 milliseconds of latency.</p><p>  我＆＃39; LL在将来的审查中获得了更多的Starlink，但它平均看起来像稳定的连接时，我达到了150多Mbps，15 Mbps，延迟了40毫秒。</p><p> Those numbers  are less than my Cable ISP; but Starlink also costs less—it&#39;s $99/month. And Starlink is also beaming the Internet through satellites up in the sky! For someone who doesn&#39;t have a fast Cable option (like rural customers), that&#39;s a mind-blowing upgrade from dial-up speeds.</p><p> 这些数字少于我的电缆ISP;但Starlink还花费较少 - 它＆＃39; S $ 99 /月。 Starlink也通过卫星在天空中发出互联网！对于那些没有拨号速度的快速电缆选项（如农村客户）的人（如农村客户）的人，那是拨号速度的思想升级。 </p><p> But I mentioned earlier, there&#39;s also a Starlink-specific dashboard that gives all the details you&#39;d normally find in the Starlink App.</p><p>但我早些时候提到过，还有一个特定于Starlink应用程序的所有细节的Starlink的仪表板。</p><p>  I haven&#39;t been actively using the Starlink connection today, so it&#39;s a little barren, but it gives a ton of detail, and I&#39;d like to thank Daniel Willcocks ( DanOpsTech) for making this possible; I&#39;m using his Docker image and dashboard, and he even  adjusted it to work on the Raspberry Pi after I asked about it!</p><p>  我哈文＆＃39;今天曾经积极地使用Starlink连接，所以它有点贫瘠，但它给了一大吨细节，我喜欢感谢Daniel Willcocks（Danopstech）来实现这一目标;我＆＃39; m使用他的Docker图像和仪表板，他甚至调整它在我问过它后在覆盆子PI上工作！</p><p>  I also monitor Starlink&#39;s power consumption using a  Shelly Plug US and a  custom Shelly Plug Prometheus exporter I wrote:</p><p>  我还使用Shelly Plug监控Starlink＆＃39;我写的自定义Shelly Plug Prometheus出口商：</p><p>  Starlink&#39;s dish and router use a  lot of power (more than you might expect)—but I&#39;ll discuss more about that in my Starlink review coming soon! I have a  blog post with more about how I set up the Shelly Plug power monitoring.</p><p>  Starlink＆＃39; S菜和路由器使用大量的电力（比你可能期望的更多） - 但是我＆＃39; LL在我的Starlink评论即将推出！我有一个关于我如何设置Shelly Plug电源监控的博客文章。</p><p>  Now I know exactly how much my ISP is fleecing me for Internet. In Spectrum&#39;s case, it looks like they&#39;re only giving me about 3/4ths of what I pay for.</p><p>  现在我确切地知道我的ISP吞噬了我的互联网。在光谱和＃39; S案例中，它看起来像他们＆＃39;只给我3/4岁的我所支付的东西。</p><p> I wish I could just pay them $110 a month instead of $150, but if I did that, they&#39;d cancel my service!</p><p> 我希望我能每月支付110美元而不是150美元，但如果我这样做，他们会取消我的服务！</p><p> I&#39;d like to thank  Max Andersen for the original inspiration for the original monitoring configuration, the developers behind Pi-hole for making it free and open source, and especially  Miguel who maintains the speedtest exporter, for his help  getting some bugs fixed!</p><p> 我喜欢感谢Max Andersen的原始灵感，因为原来的监控配置，Pi-Hole背后的开发人员，用于使其自由和开放的源，尤其是维持Speedtest出口商的米格尔，为他的帮助获得一些错误！！ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.jeffgeerling.com/blog/2021/monitor-your-internet-raspberry-pi">https://www.jeffgeerling.com/blog/2021/monitor-your-internet-raspberry-pi</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/pi/">#pi</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/internet/">#internet</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>