<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Travis CI的新定价计划给我的开源作品带来了麻烦</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Travis CI的新定价计划给我的开源作品带来了麻烦</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-06 08:36:08</div><div class="page_narrow text-break page_content"><p>I just spent the past 6 hours migrating some of my open source projects from Travis CI to GitHub Actions, and I thought I&#39;d pause for a bit (12 hours into this project, probably 15-20 more to go) to jot down a few thoughts.</p><p>我刚刚花了6个小时将我的一些开源项目从Travis CI迁移到GitHub Actions，我想我应该暂停一下(这个项目已经进行了12个小时，可能还需要15-20个小时)来记录一些想法。</p><p> I am not one to look a gift horse in the mouth. For almost a decade, Travis CI made it possible for me to build—and maintain, for years— hundreds of open source projects.</p><p>我不是那种吹毛求疵的人。在近十年的时间里，Travis CI让我能够构建-并维护-数百个开源项目，并保持了多年。</p><p> I have built projects for Raspberry Pi, PHP, Python, Drupal, Ansible, Kubernetes, macOS, iOS, Android, Docker, Arduino, and more. And almost every single project I built got immediate integration with Travis CI.</p><p>我已经为Raspberry Pi、PHP、Python、Drupal、Ansible、Kubernetes、MacOS、iOS、Android、Docker、Arduino等构建了项目。我建造的几乎每一个项目都立即与特拉维斯CI整合在一起。</p><p> Without that testing, and the ability to run tests on a schedule, I would have abandoned most of these projects. But with the testing, I&#39;m able to keep up with build failures induced by bit rot over the years and review PRs more easily.</p><p>如果没有这种测试，没有按计划运行测试的能力，我就会放弃这些项目中的大多数。但有了测试，我能够跟上多年来由位腐烂导致的构建失败，并更容易地审查PR。</p><p>  From the outset, Travis CI was built to integrate with GitHub repositories and offer free open source CI. At one time it was showered with praise on Hacker News and elsewhere for its culture and ethos.</p><p>从一开始，Travis CI就是为了与GitHub存储库集成而构建的，并提供免费的开源CI。它一度在黑客新闻(Hacker News)和其他地方因其文化和精神而获得铺天盖地的赞扬。</p><p> But as the years passed, other CI systems became much more popular, until late in 2018, GitHub dropped the bombshell that was GitHub Actions, and it seemed like the outlook for Travis CI went to:</p><p>但随着时间的推移，其他CI系统变得越来越流行，直到2018年底，GitHub抛出了一个重磅炸弹--GitHub Actions，而Travis CI的前景似乎是这样的：</p><p>  Now, to shed a little more light on where, precisely, things went from bad to worse, I put together this little timeline of Travis CI&#39;s most important moments in relation to open source builds:</p><p>现在，为了更好地阐明事情到底在哪里变得越来越糟，我把特拉维斯·CI关于开源版本最重要的时刻整理了一下：</p><p> 2012:  Travis CI raises $134k to support business operations in &#39;Love&#39; crowdfunding campaign, and launches paid plans for private repositories</p><p>2012年：特拉维斯CI筹集了1.34亿美元，以支持爱的众筹活动中的业务运营，并推出了私人储存库的付费计划</p><p> 2012-2020: I integrated over 200 of my open source project repositories into Travis CI test and build processes.</p><p>2012-2020：我将200多个开源项目库集成到Travis CI测试和构建流程中。</p><p>      Oct 2020: I moved all my ~120 remaining travis-ci.org repos to travis-ci.com so they would actually run.</p><p>2020年10月：我把我剩下的大约120条travis-ci.org的回复都移到了travis-ci.com上，这样它们就可以真正运行了。</p><p>  Nov 2, 2020: I notice  none of my builds are working. I ran out of credits before I even saw the new billing plan notice.</p><p>2020年11月2日：我注意到我的版本都不工作了。我甚至在看到新的账单计划通知之前就用完了积分。</p><p> Note that we&#39;re not yet caught up to the end of the timeline. There are many other open source developers and projects out there still using travis-ci.org, who either haven&#39;t found the time or motivation to migrate to travis-ci.com (or elsewhere, ideally), as evidenced by this massive daily backlog of build jobs:</p><p>请注意，我们还没有赶上时间表的末尾。还有许多其他开源开发者和项目仍在使用Travis-ci.org，他们要么没有时间，要么没有动力迁移到Travis-ci.com(或者最好是其他地方)，每天积压的大量构建工作就证明了这一点：</p><p>  Those who, like me, finished migrating to travis-ci.com in the past couple of weeks to get out of that backlog hell are now realizing that we are going to have to beg for extra build minutes after our 1000 &#39;trial plan&#39; build minutes run out:</p><p>那些和我一样，在过去几周里为了摆脱积压的地狱而迁移到Travis-ci.com网站的人现在意识到，在我们的1000分钟试用计划用完后，我们将不得不乞求额外的构建分钟：</p><p> We will be offering an allotment of OSS minutes that will be reviewed and allocated on a case by case basis. Should you want to apply for these credits please open a request with Travis CI support stating that you’d like to be considered for the OSS allotment. Please include:</p><p>我们将提供开放源码软件会议记录的分配，这些会议记录将根据具体情况进行审查和分配。如果您想申请这些积分，请向Travis CI支持部门提出申请，说明您愿意被考虑获得OSS分配。请包括：</p><p>  Your account name and VCS provider How many credits (build minutes) you’d like to request (should your run out of credits again you can repeat the process to request more or discuss a renewable amount)</p><p>您的帐户名和VCS提供商希望申请多少积分(构建分钟数)(如果您的积分再次用完，您可以重复此过程以请求更多积分或讨论续订金额)。</p><p> Sorry, but no thanks. I don&#39;t have enough time in my day to send off emails every few [days|weeks|months] requesting extra build credits so I can continue maintaining my open source projects.</p><p>对不起，不过不用了，谢谢。我每天没有足够的时间每隔几天|几周|几个月发一封电子邮件请求额外的构建积分，这样我就可以继续维护我的开源项目了。</p><p>  As I said earlier, I am appreciative of the acceleration in my own growth and career that Travis CI enabled over the past decade. And there so many other services with generous offers for open source maintainers that I appreciate and try to support in any way I can (often financially, as far as I&#39;m able).</p><p>正如我前面所说的，我很感激特拉维斯·CI在过去十年里为我自己的成长和职业生涯带来的加速。还有很多其他服务为开源维护员提供慷慨的服务，我对此表示感谢，并尽我所能(通常是在我力所能及的范围内，在经济上)提供支持。</p><p> I just fear that, like when Google shut down  Google Code in 2015, this will have some cascading affects on some of the smaller and less-maintained open source projects some of us rely on, but don&#39;t think about.</p><p>我只是担心，就像2015年谷歌(Google)关闭谷歌代码(Google Code)一样，这将对我们中的一些人所依赖、但没有考虑到的规模较小、维护较少的开源项目产生一些连锁影响。</p><p> And I know personally, this whole project is going to soak up around 4 weeks worth of the time I can devote to my free open source work, meaning that&#39;s a month out of my open source development time that&#39;s just vanished into thin air. Not fun, and not motivating.</p><p>我个人也知道，整个项目将占用我可以投入到免费开源工作中的大约四周的时间，这意味着在我的开源开发时间中，一个月的时间就会消失得无影无踪。不好玩，也不激励人。</p><p> I&#39;m lucky to have many supporters on  GitHub Sponsors who have helped make my work more sustainable, but most open source maintainers have either a fraction of the support I do, or none at all.</p><p>我很幸运，在GitHub赞助商上有很多支持者，他们帮助我的工作更可持续，但大多数开源维护者要么只有我的一小部分支持，要么根本没有。</p><p>   Ever since the January 2019 buyout, the writing&#39;s been on the wall—especially after so much of the existing engineering staff was laid off. I had already started building newer projects using GitHub Actions for CI instead of Travis CI.</p><p>自从2019年1月被收购以来，这件事就一直是不祥之兆--特别是在现有的工程人员被裁掉之后。我已经开始使用GitHub Actions为CI而不是Travis CI构建较新的项目。</p><p> I had planned on slowly migrating over the course of a few years, since many of my older projects still work, and are used, but are not in active development.</p><p>我曾计划在几年的时间里慢慢迁移，因为我的许多旧项目仍然有效，正在使用，但并未积极开发。</p><p> But the actions Travis CI took this month—without any prior notice—forced my hand, and now I&#39;m in the middle of probably a 2-to-4-week-long process of moving everything off Travis CI as fast as possible. Getting behind on build failures for a month would lead to a pileup of small issues that will really bog me down.</p><p>但特拉维斯·CI本月在没有任何事先通知的情况下采取的行动迫使我采取了行动，现在我正在进行一个可能需要2到4周的过程，以尽快将一切从特拉维斯·CI手中移走。在构建失败上拖延一个月会导致堆积如山的小问题，这真的会让我陷入困境。</p><p> Anyways, enough of my sob story. I wanted to link to some of the tools I used to migrate, and show how I automated some of the migration, so you can do your own more easily!</p><p>不管怎样，我的悲伤故事说够了。我想链接到我用来迁移的一些工具，并展示我是如何自动化一些迁移的，这样您就可以更轻松地完成自己的迁移了！</p><p> The majority of my open source projects are Ansible roles (a large part of the  Ansible content I maintain), and to get them migrated, I automated as much as possible. You can see all the details in this GitHub issue:  Convert from Travis CI to GitHub Actions.</p><p>我的大多数开源项目都是Ansible角色(我维护的Ansible内容的很大一部分)，为了让它们迁移，我尽可能地自动化。您可以在这期GitHub中看到所有细节：从Travis CI转换为GitHub操作。</p><p> For each role, I used  this Ansible playbook to write new GitHub Actions CI and release workflows using a template. Then I adjusted all the &#39;cron&#39; values so the Actions won&#39;t all run at the same exact time each week.</p><p>对于每个角色，我都使用这本Ansible剧本来编写新的GitHub操作配置项，并使用模板发布工作流。然后，我调整了所有的值，这样操作就不会在每周的同一时间运行。</p><p> Then I created  github-repo-manager, a simple little project that uses  PyGithub to make changes across all or a subset of my repositories. I used it to add a  GALAXY_API_KEY secret to all repositories in my account that began with  ansible-role-* (for repositories in a personal account, you have to add GitHub Actions secrets to each repo—for organizations, you can create shared organization secrets... much more convenient!).</p><p>然后我创建了giHub-repo-manager，这是一个简单的小项目，它使用PyGithub在我的所有存储库或部分存储库中进行更改。我使用它将Galaxy_API_KEY密钥添加到我帐户中以Ansible-Role-*开头的所有存储库(对于个人帐户中的存储库，您必须将GitHub操作机密添加到每个存储库-对于组织，您可以创建共享的组织机密...。方便多了！)。</p><p> Finally, I went in and manually migrated the small part of the Travis CI build definition that was custom to each role (e.g. some have a one-dimensional build-matrix, some have a two-dimensional, and they all have a different mix of OSes they build on).</p><p>最后，我手动迁移了Travis CI构建定义中为每个角色定制的一小部分(例如，一些具有一维构建矩阵，一些具有二维构建矩阵，并且它们都具有不同的构建操作系统组合)。</p><p> I had already started building many new projects (both Ansible and Kubernetes-related) on top of GitHub Actions, even presenting on the process a few times (e.g.  Continuous Ansible testing with Molecule and GitHub Actions). The news earlier this week just accelerated my migration plans for older content from &#39;when I get time&#39; to &#39;right now.&#39;</p><p>我已经开始在GitHub操作的基础上构建许多新的项目(包括Ansible和Kubernetes相关的)，甚至还介绍了几次这个过程(例如，使用分子和GitHub操作进行持续的Ansible测试)。本周早些时候的消息让我加快了旧内容的迁移计划，从我有空的时候到现在。</p><p> Luckily, GitHub Actions does pretty much everything I could do in Travis CI (so far... I still have 36 more unique repos to go!), and the only real complaint I have is the  continue-on-error functionality is no substitute for Travis CI&#39;s  allowed_failures option.</p><p>幸运的是，GitHub Actions几乎做了我在Travis CI中能做的所有事情(到目前为止……。我还有36个独特的回复要做！)，我唯一真正抱怨的是继续出错功能不能替代Travis CI的Allowed_Failures选项。</p><p> There&#39;s still a bit of work to be done, and I&#39;m trying to prioritize things so I don&#39;t leave my most widely-used projects (like  Drupal VM) without active CI for too long, but at least this story doesn&#39;t have a bad ending.</p><p>还有一些工作要做，我正在努力安排事情的优先顺序，这样我就不会让我最广泛使用的项目(如Drupal VM)在太长时间内没有活动的CI，但至少这个故事不会有一个糟糕的结局。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.jeffgeerling.com/blog/2020/travis-cis-new-pricing-plan-threw-wrench-my-open-source-works">https://www.jeffgeerling.com/blog/2020/travis-cis-new-pricing-plan-threw-wrench-my-open-source-works</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开源/">#开源</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ci/">#ci</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1033283.html"><img src="http://img2.diglog.com/img/2020/11/thumb_c13477f6896e3f061f40791358604777.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033283.html">奇点--一个开源的简单、快速、安全的容器平台</a></div><span class="my_story_list_date">2020-11-5 20:11</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033265.html"><img src="http://img2.diglog.com/img/2020/11/thumb_3c453984327c27da470e63b39ae6fedc.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033265.html">我将整个GitHub后端源代码上传到GitHub自己的DMCA repo</a></div><span class="my_story_list_date">2020-11-5 20:2</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033166.html"><img src="http://img2.diglog.com/img/2020/11/thumb_1635a399e3db7920a43578809c11d7a2.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033166.html">开始使用开源安全工具Info Monkey</a></div><span class="my_story_list_date">2020-11-4 20:35</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033069.html"><img src="http://img2.diglog.com/img/2020/11/thumb_39ae786507ecbcef195afbb875512017.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033069.html">Qovery引擎-开源多云部署</a></div><span class="my_story_list_date">2020-11-4 6:57</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>