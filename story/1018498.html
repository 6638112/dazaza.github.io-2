<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用语义对偶在x86二进制文件中隐藏消息</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用语义对偶在x86二进制文件中隐藏消息</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-08-16 23:29:52</div><div class="page_narrow text-break page_content"><p>这提供了极大的灵活性和可控性，但也使编译器更难执行最佳选择。它还要求隐写者维护他们的(派生的)编译器。这是个不错的主意，但需要付出相当大的努力。</p><p>另一种方法是忽略编译的指令本身，而专注于二进制容器：ELF、MACH-O或PE等。</p><p>这些格式提供了许多嵌入信息的机会：段和段的顺序(文件和虚拟地址)、重定位表的顺序和布局以及它们的内部规则的组成，等等。</p><p>插装二进制格式而不是可执行代码意味着不必搞乱指令选择，而且在信息密度方面也不那么丰富。它也是不可移植的，例如在ELF重定位条目中隐藏信息的技巧必须针对PE进行调整。</p><p>Tiny86没有控制指令选择或调整包含的二进制格式的细节，而是采取了第三种方法：它使用x86和AMD64指令格式中存在的语义对有选择地在编译后重写程序。</p><p>与每个ISA一样，x86(和AMD64)有多种方式来编码特定(更高级别的概念性)操作的语义。例如，清除一个寄存器：</p><p>；对寄存器本身进行异或运算将清除所有位xor eax，eax；而将寄存器设置为0也会清除所有位和eax，0；我们还可以设置0mov eax，0；...或减去SUB eax，eax；...或加载一个&#34；计算出的地址，该地址始终为0表示eax，[0]。</p><p>…。还有很多其他的。不幸的是，这并不完全像我们希望的那样工作：</p><p>Add r/m8，R8&lt；=&gt；Add R8，r/m8ADD r/m16，R16&lt；=&gt；Add R16，r/m16ADD r/m32，R32&lt；=&gt；Add R32，r/m32ADD r/m64，R64&lt；=&gt；Add R64，r/m64ADC r/m8，R8&lt；=&gt；ADC R32，r/m32ADC r/m64，R64和=&gt；ADC R64，r/m64和r/m8，R8和r8，r/m8和r/m16，r16和r16，r/m16和r/m32，r32和r/m64；和r32，r/m32和r/m64。或r16，r/m16or r/m32，r32&lt；=&gt；or r32，r/m32or r/m64，r64&lt；=&gt；or r64，r/m64XOR r/m8，r8&lt；=&gt；XOR r8，r/m8XOR r/m16，r16&lt；=&gt；XOR R16，r/m16XOR r/m32。SUB R8，r/m8SUB r/m16，R16&lt；=&gt；sub R16，r/m16SUB r/m32，R32&lt；=&gt；sub R32，r/m32SUB r/m64，R64&lt；=&gt；subR64，r/m64SBB r/m8，R8&lt；=&gt；SBB R8，r/m8SBB r/m16，SBB R64，r/m64MOV r/m8，r8&lt；=&gt；MOV r8，r/m8MOV r/m16，r16&lt；=&gt；MOV r16，r/m16MOV r/m32，r32&lt；=&gt；MOV R32，r/m32MOV r/m64，R64&lt；=&gt；MOV R64，r/m64CMP r/。CMP R32，r/m32CMP r/m64，r64&lt；=&gt；CMP R64，r/m64。</p><p>每个对偶代表一位信息：我们可以任意指定一种形式为真，而另一种形式为假。如果目标程序中有足够多的表单，我们可以通过在表单之间转换来隐藏消息。结果是：一个与原始文件大小完全相同、具有相同性能特征的二进制文件，但带有隐藏的信息。</p><p>这就是steg86所做的一切：它在其目标程序中定位每个语义对，将输入消息映射到一个位串，并根据其对应的消息位来翻译每个对。因为它只使用DUAL，所以它与其包含的格式完全无关：steg86CLI目前支持ELF、Mach-O和PE/PE32+二进制文件。</p><p>下面是它的实际外观，其中(一些)不同的字节以红色突出显示：</p><p>$steg86profile/bin/bash.bin/bash的摘要：总共175828条指令，27957个潜在语义对，27925比特的信息容量(3,490字节，约。3KB)$steg86 Embed/bin/bash test.steg&lt；&lt；&#34；hello world！&#34；$file test.stegtest.steg：ELF 64位LSB共享对象，x86-64，版本1(SYSV)，动态链接，解释器/lib64/ld-linux-x86-64.so.2，BuildID[sha1]=a6cb40078351e05121d46da.。</p><p>就像x86的每个部分一样，它实际上要比这复杂得多。但就我们的目的而言，它本质上是一个8位操作数选择器。“↩</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.yossarian.net/2020/08/16/Hiding-messages-in-x86-binaries-using-semantic-duals">https://blog.yossarian.net/2020/08/16/Hiding-messages-in-x86-binaries-using-semantic-duals</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/语义/">#语义</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/messages/">#messages</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/信息/">#信息</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>