<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Microconfig功能 Microconfig Features</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Microconfig Features<br/>Microconfig功能 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-05 03:16:40</div><div class="page_narrow text-break page_content"><p>Microconfig only asks you to create folders for your services somewhere in  components folder. You choose the names and folder structure. If you have different types of configuration just place them in the same service folder.</p><p>Microconfig仅要求您在组件文件夹中的某个位置为服务创建文件夹。您选择名称和文件夹结构。如果您有不同类型的配置，只需将它们放在同一服务文件夹中即可。</p><p>  components ├── payments │ ├── payment-backend │ │ ├── application.yaml │ │ └── values.deploy │ └── payment-frontend │ ├── application.yaml │ └── values.deploy └── ... ...</p><p>  组件├──付款│├──付款后端││├──application.yaml││└──values.deploy│└──付款前端│├──application.yaml│└──values.deploy└ ──... ...</p><p>  Microservices have a lot of shared configuration parts that is copy-pasted between them. So you need to go through all services one by one to update this shared part.</p><p>  微服务具有许多共享配置部分，它们之间被复制粘贴。因此，您需要逐一浏览所有服务以更新此共享部分。</p><p>  Microconfig allows you to extract common parts of configuration to a dedicated component and reuse it with  #include. This way service config is more focused on unique parts and all common parts are just included. In this case if you need to update your common part you just do it in one place and everyone gets this update via  #include.</p><p>  Microconfig允许您将配置的公共部分提取到专用组件中，并与#include一起使用。这样，服务配置将更多的精力集中在独特的部分上，而所有公共部分都包括在内。在这种情况下，如果您需要更新公用部分，则只需在一个地方进行，每个人都可以通过#include获得此更新。</p><p>  Problem    Solution  name: payment-backend server: port: 8080 context: /api monitoring: secure: false base-path: /monitoring endpoints: info, health, ready, prometheus logging: level: ROOT: INFO APP: DEBUG</p><p>  问题解决方案名称：后端付款服务器：端口：8080上下文：/ api监视：安全：错误的基本路径：/监视端点：信息，运行状况，就绪，普罗米修斯日志记录：级别：根：信息应用程序：调试</p><p>  name: payment-frontend payment-backend: host: http://payment-backend.local path: /api monitoring: secure: true base-path: /monitoring endpoints: info, health, ready, prometheus logging: level: ROOT: INFO APP: DEBUG</p><p>  名称：支付前端支付后端：主机：http：//payment-backend.local路径：/ api监视：安全：真正的基本路径：/ monitoring端点：信息，运行状况，就绪，普罗米修斯日志记录：级别：ROOT： INFO APP：调试</p><p>  Different services can depend on each other&#39;s configuration keys. For example frontend needs backend&#39;s api base path. You can just keep this value in two places but in this case you need to remember about this dependency and update them both.</p><p>  不同的服务可以依赖于彼此的配置密钥。例如，前端需要后端的api基本路径。您可以仅在两个位置保留此值，但在这种情况下，您需要记住该依赖性并同时更新它们。 </p><p>  Microconfig can reference a value from current or another component with a  ${placeholder}. This allows you to keep values only in original services and all who depend on them can just have an explicit reference. In this case you need to update the value only once.</p><p>Microconfig可以使用$ {placeholder}引用当前或另一个组件中的值。这允许您仅在原始服务中保留值，并且依赖它们的所有人都可以拥有明确的引用。在这种情况下，您只需更新一次值。</p><p>  Sometimes static values are not enough, and you want to do a  +1 or  base64. Some values even are more readable as expressions.</p><p>  有时，静态值还不够，您想执行+1或base64。有些值甚至更易于理解为表达式。</p><p>  Microconfig has  #{&#39;expression&#39; + &#39;language&#39;}  to dynamically generate your values. It supports math operations and much more.</p><p>  Microconfig具有＃{＆＃39; expression＆＃39; +＆＃39; language＆＃39;}动态生成您的值。它支持数学运算等等。</p><p>  Problem    Solution  name: payment-frontend payment-backend: timeoutMs: #{ 3 * 60 * 1000 } log: filename: #{ &#39;${this@name}&#39;.toUpperCase() }.log ...</p><p>  问题解决方案名称：支付前端支付后端：超时短信：＃{3 * 60 * 1000}日志：文件名：＃{＆＃39; $ {this @ name}＆＃39; .toUpperCase（）} .log .. 。</p><p>  We deploy services to different environments that have specific properties. Your production database has different ip address than your dev. All of those specifications should be applied to final version for your environment.</p><p>  我们将服务部署到具有特定属性的不同环境。您的生产数据库的IP地址与开发人员的IP地址不同。所有这些规范都应应用于您的环境的最终版本。</p><p>  Microconfig supports specific values for each environment you need. You just create an override  .env. file near your base configuration. In this file you specify all that you want for your  env and it will be merged with your base configuration. More specific values will override base ones.</p><p>  Microconfig支持您需要的每种环境的特定值。您只需创建覆盖.env。基本配置附近的文件。在此文件中，指定环境所需的所有内容，它将与基本配置合并。更具体的值将覆盖基本值。</p><p>  Your services usually require some additional 3rd party configuration files like a log configuration or a deploy script. It&#39;s easy if these files don&#39;t have difference for every service but what if you need to change them a bit for each service or environment?</p><p>  您的服务通常需要一些其他的第三方配置文件，例如日志配置或部署脚本。如果这些文件对每种服务没有区别，那很容易，但是如果您需要对每种服务或环境进行一些更改，该怎么办呢？ </p><p>  Microconfig can use static templates and populate them with data unique for each service via placeholders and  Moustache. So you can keep your template in one place and then generate specific result for each service.</p><p>Microconfig可以使用静态模板，并通过占位符和Moustache为每个服务填充唯一的数据。因此，您可以将模板放在一个位置，然后为每种服务生成特定的结果。</p><p>  Problem    Solution  &lt;configuration&gt; &lt;appender class=&#34;FileAppender&#34;&gt; &lt;file&gt;logs/payment-backend.log&lt;/file&gt; &lt;encoder&gt; &lt;pattern&gt;%d{HH:mm:ss} %-5level %logger %msg %n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;appender class=&#34;LogstashTcpSocketAppender&#34;&gt; &lt;destination&gt;30.30.30.30:9600&lt;/destination&gt; &lt;encoder class=&#34;LogstashEncoder&#34;&gt; &lt;customFields&gt;{&#34;servicename&#34;:&#34;payment-backend&#34;}&lt;/customFields&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;/configuration&gt;</p><p>  问题解决方案＆lt;配置＆gt; ＆lt; appender class =＆＃34; FileAppender＆＃34;＆gt; ＆lt; file＆gt; logs / payment-backend.log＆lt; / file＆gt; ＆lt;编码器＆gt; ＆lt; pattern＆gt;％d {HH：mm：ss}％-5level％logger％msg％n＆lt; / pattern＆gt; ＆lt; / encoder＆gt; ＆lt; / appender＆gt; ＆lt; appender class =＆＃34; LogstashTcpSocketAppender＆＃34;＆gt; ＆lt;目的地＆gt; 30.30.30.30：9600＆lt; /目的地＆gt; ＆lt; encoder class =＆＃34; LogstashEncoder＆＃34;＆gt; ＆lt; customFields＆gt; {＆＃34;服务名＆＃34;：＆＃34;付款后端＆＃34;}＆lt; / customFields＆gt; ＆lt; / encoder＆gt; ＆lt; / appender＆gt; ＆lt; / configuration＆gt;</p><p>  &lt;configuration&gt; &lt;appender class=&#34;FileAppender&#34;&gt; &lt;file&gt;logs/${this@name}.log&lt;/file&gt; &lt;encoder&gt; &lt;pattern&gt;%d{HH:mm:ss} %-5level %logger %msg %n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; {{#appender.stash}} &lt;appender class=&#34;LogstashTcpSocketAppender&#34;&gt; &lt;destination&gt;30.30.30.30:9600&lt;/destination&gt; &lt;encoder class=&#34;LogstashEncoder&#34;&gt; &lt;customFields&gt;{&#34;servicename&#34;:&#34;${this@name}&#34;}&lt;/customFields&gt; &lt;/encoder&gt; &lt;/appender&gt; {{/appender.stash}} &lt;/configuration&gt;</p><p>  ＆lt;配置＆gt; ＆lt; appender class =＆＃34; FileAppender＆＃34;＆gt; ＆lt; file＆gt; logs / $ {this @ name} .log＆lt; / file＆gt; ＆lt;编码器＆gt; ＆lt; pattern＆gt;％d {HH：mm：ss}％-5level％logger％msg％n＆lt; / pattern＆gt; ＆lt; / encoder＆gt; ＆lt; / appender＆gt; {{＃appender.stash}}＆lt; appender class =＆＃34; LogstashTcpSocketAppender＆＃34;＆gt; ＆lt;目的地＆gt; 30.30.30.30：9600＆lt; /目的地＆gt; ＆lt; encoder class =＆＃34; LogstashEncoder＆＃34;＆gt; ＆lt; customFields＆gt; {＆＃34; servicename＆＃34;：＆＃34; $ {this @ name}＆＃34;}＆lt; / customFields＆gt; ＆lt; / encoder＆gt; ＆lt; / appender＆gt; {{/appender.stash}}＆lt; / configuration＆gt;</p><p>  When you have your configuration in some kind of templating engine it might be difficult to keep track of changes or compare different versions of configuration. For example, before new deployment to production you want to know what has been changed in your configuration.</p><p>  当您在某种模板引擎中进行配置时，可能难以跟踪更改或比较不同版本的配置。例如，在将新部署到生产之前，您想知道配置中已更改的内容。</p><p>  Microconfig allows you to generate git style  diff and see how your configuration changes overtime or compare different versions.</p><p>  Microconfig允许您生成git style diff，并查看您的配置如何随时间变化或比较不同版本。</p><p>  Problem    Solution  name: payment-frontend monitoring: base-path: /monitoring endpoints: info, health, ready, prometheus payment-backend: host: http://payment-backend.local path: /api server: maxThreads: 100 minThreads: 10 port: 80 timeoutMs: 180000</p><p>  问题解决方案名称：支付前端监视：基本路径：/监视端点：信息，运行状况，就绪，普罗米修斯支付后端：主机：http：//payment-backend.local路径：/ api服务器：maxThreads：100 minThreads： 10端口：80超时女士：180000</p><p>  name: payment-frontend monitoring: base-path: /monitoring endpoints: info, health, ready, prometheus payment-backend: host: https://payment-backend.local path: /api timeoutMs: 180000 server: port: 80</p><p>  名称：支付前端监控：基本路径：/监控端点：信息，运行状况，就绪，普罗米修斯支付后端：主机：https：//payment-backend.local路径：/ api timeoutMs：180000服务器：端口：80 </p><p>  +payment-backend: timeoutMs: 180000 -server: maxThreads: 100 minThreads: 10 timeoutMs: 180000 payment-backend: host: http://payment-backend.local -&gt; https://payment-backend.local</p><p>+ payment-backend：timeoutMs：180000 -server：maxThreads：100 minThreads：10 timeoutMs：180000 Payment-backend：host：http：//payment-backend.local-＆gt; https：//payment-backend.local </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/配置/">#配置</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>