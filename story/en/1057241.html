<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在咖啡机上运行MS团队？ （或：嵌入式Linux FrameBuffer VNC客户端） Run MS Teams on a Coffee Machine?? (Or: Embedded Linux Framebuffer VNC Client)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Run MS Teams on a Coffee Machine?? (Or: Embedded Linux Framebuffer VNC Client)<br/>在咖啡机上运行MS团队？ （或：嵌入式Linux FrameBuffer VNC客户端） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-09 18:14:55</div><div class="page_narrow text-break page_content"><p>Skip to main content          To fill some time  during compiling I tried to get a VNC client running on a coffee machine, specifically to show MS Teams. At work I develop software for these coffee machines in C++, which allows me to do such fun stuff, because from a software point of view, it&#39;s just an ARM PC running linux with a framebuffer for graphics. I compiled a few framebuffer VNC clients, fired up an SSH tunnel and used  x11vnc to share one specific window and after a few attempts, Teams was up and running on my &#39;new&#39; second monitor.This post contains my little adventure in framebuffer VNC clients, but it&#39;s not a comprehensive guide as most of my other articles. Showing you how to set up an Openembedded server with a VariScite specific toolchain is way too much work to cross-compile a simple C program, but since that&#39;s my day job, why not use it for fun. It contains some tips for  x11vnc and shows you two different framebuffer VNC clients,  fbvnc and  directvnc.</p><p>跳过主要内容以填补一段时间在编译期间，我试图在咖啡机上运行的VNC客户端，专门向MS团队展示。在工作中，我在C ++中为这些咖啡机开发软件，这使我能够做出如此有趣的东西，因为从软件的角度来看，它只是一个运行Linux的ARM PC，带有框架缓冲器。我编译了一些帧缓冲的VNC客户端，触发了一个SSH隧道并使用X11VNC共享一个特定的窗口，经过几次尝试，团队在我的＆＃39上运行;新＆＃39;第二个Monitor。这篇文章包含我的小型冒险，但它不是全面指南，因为我的其他大部分文章。向您展示如何使用Variscite特定的工具链设置OpenEmbedded服务器是太多的工作来交叉编译简单的C程序，但自那个＆＃39;我的日常工作，为什么不用它乐趣。它包含X11VNC的一些提示，并向您展示两个不同的FrameBuffer VNC客户端，FBVNC和DirectVNC。</p><p>    Important disclaimer: this was a fun side project, neither acknowledged nor endorsed bymy employer. Their coffee machines can not run custom software under normal circumstances.</p><p>    重要的免责声明：这是一个有趣的方面项目，既不承认也不承认越过我的雇主。他们的咖啡机无法在正常情况下运行定制软件。</p><p> The instructions in this post are applicable to any linux framebuffer device.It could be a raspberry pi or even your own machine. I did not test user input(mouse/keyboard), because I intended to use the device as a view only screen.</p><p> 此帖子中的说明适用于任何Linux FrameBuffer设备。它可能是覆盆子PI甚至是您自己的机器。我没有测试用户输入（鼠标/键盘），因为我打算将设备用作视图屏幕。</p><p> For local development, I sometimes do it the reverse way around, run thecoffee machine UI on my  local machine. Manual testing is a rareoccurrence, since by far a large part of our codebase is covered by unittests and there is an extensive HTTP API. But still, sometimes there is a needfor local testing, we have stubs, can run the QT UI locally and even  theflash UI still runs with some hoops. And of course a bunch of coffeemachines to test with, but who likes walking and manually pressing buttons ifyou can automate that stuff away?</p><p> 对于本地开发，我有时会这样做反向的方式，在我的本地机器上运行Thecoffee Machine UI。手动测试是一种稀有电流，因为到迄今为止，我们的代码库的大部分是由unittests覆盖的，并且有一个广泛的HTTP API。但是，有时，有必要的本地测试，我们有存根，可以在本地运行Qt UI，甚至普遍使用一些篮球运行。当然，一堆咖啡有待测试，但谁喜欢行走和手动按下按钮，如果你可以自动化那个东西？</p><p>    So why not get an actual second screen? Well, I personally use just onescreen, because I try to do one thing at a time. That one thing usuallyrequires all of my focus and attention, so a second screen with all kinds ofdistractions doesn&#39;t really work for me.</p><p>    那么为什么不获得实际的第二屏幕？好吧，我个人使用截止值，因为我试着一次做一件事。一件事通常会令我关注的关注和关注，所以第二个屏幕，各种各样的股票都没有为我工作。</p><p> However, infrequently, I miss a second screen. During chat sessions or videocall&#39;s where you&#39;re pair programming or to have a datasheet open. In suchcases I would like a small screen which is easy to turn off when it&#39;s notneeded anymore.</p><p> 但是，不经常，我错过了第二屏幕。在聊天会话或Videocall＆＃39; s＆＃39;重组编程或打开数据表。在Supcase中，我想要一个小屏幕，当它不再被了，易于关闭。</p><p> A friend of mine is a video editor and he has a separate 5&#34; screen, for usewith Final Cut. That thing was expensive (due to colour correctness) and onAliExpress I could only find  these things, still expensive.</p><p> 我的一位朋友是视频编辑器，他有一个单独的5＆＃34;屏幕，用于最终切割。那件事昂贵（由于颜色正确）和onaliexpress我只能找到这些东西，仍然昂贵。 </p><p> Then it occurred, our coffee machines all have 7&#34; touch screens, they runlinux and I have a bunch of Frankenstein just-enough-coffee-machines on mydesk for testing. Why not use such a screen for the occasional chat window?</p><p>然后它发生了，我们的咖啡机都有7＆＃34;触摸屏幕，他们runlinux，我在yodesk上有一堆弗兰肯斯坦的咖啡机进行测试。为什么不使用这样的屏幕偶尔聊天窗口？</p><p> The machines run either  gnash with a flash UI, a  qt UI or a  headlessUI for touchless, which uses MQTT and an internal HTTP API. The QT ui alsouses the HTTP API, flash still runs a custom communication protocol.</p><p> 机器使用Flash UI，Qt UI或WardlessUI进行闪存，使用MQTT和内部HTTP API来运行GNASH。 Qt UI Alsouses HTTP API，Flash仍然运行自定义通信协议。</p><p> Both QT and Gnash run on the framebuffer, there is no X server, so a regularVNC client will not work. Or the actual teams binary for that matter.</p><p> Qt和gnash都在帧缓冲区上运行，没有x服务器，因此roundalvnc客户端无法正常工作。或者实际的团队为这一事件二进制。</p><p>  I use the following command to start a VNC server on  localhost only (because it runs without a password,  fbvnc does not support that). The special thing is that that command allows me to pick one window which is sharedover VNC, not the entire desktop or a screen region.</p><p>  我使用以下命令仅在localhost上启动VNC服务器（因为它在没有密码的情况下运行，FBVNC不支持该）。特殊的事情是该命令允许我选择一个窗口，该窗口是Sharedover VNC，而不是整个桌面或屏幕区域。</p><p>  The  -geometry and  -scale parameters are given because the machine screenhas that resolution. It looks less weird that way.</p><p>  赋予-geometry和-scale参数是因为机器屏幕分辨率。这看起来不那么奇怪。</p><p> Since the VNC server is only accessible via localhost, I use SSH to setupa secure tunnel to the coffee machine and forward my machine&#39;s VNCport to the coffee machine:</p><p> 由于VNC服务器仅通过LocalHost访问，因此我使用SSH到Setupa安全隧道到咖啡机并将我的机器和＃39; S VNCPORT转发给咖啡机：</p><p>  The coffee machines normally do not have SSH running or exposed. For localdevelopment we can turn it on, but it involves a signed package and UART.</p><p>  咖啡机通常没有SSH运行或暴露。对于LocalDevelopment，我们可以打开它，但它涉及签名包和UART。 </p><p> Now, as far as the coffee machine is concerned, it has a port on  localhost:5900 which is also a working VNC  display:0. Great! Let&#39;s continue on to VNC clients.</p><p>现在，就咖啡机而言，它在localhost上有一个端口：5900，它也是一个工作的VNC显示器：0。伟大的！ Let＆＃39; s继续到VNC客户端。</p><p> Both VNC clients for the framebuffer were cross-compiled with out specific toolchain,instructions for that are not really applicable elsewhere. On a raspberry pi or other ARM board, you can just install  gcc ( apt install build-essential) andfollow along.</p><p> FrameBuffer的VNC客户端都与特定的工具链进行了交叉编译，对其他地方的说明并不真正适用。在覆盆子PI或其他ARM板上，您可以安装GCC（APT安装Build-Essential）并沿着。</p><p>  The first client I found was  directvnc. Over 9 years old, seeminglydead, but I could find an  openembedded  recipe for it which workedright away, so that was easy. Too easy it appeared, because it works partly.As you can see on the image below,  one half of the screen was black andthe colours are a bit off on the other (working) half:</p><p>  我发现的第一个客户是DirectVNC。超过9岁，似乎是德德，但我可以找到一个开阔的jedded配方，这是它的工作原理，所以很容易。它显得太容易了，因为它部分工作。你可以在下面的图像上看到，屏幕的一半是黑色的，而且颜色有点脱落（工作）半：</p><p>  I  filed a github issue but I don&#39;t expect it will be fixed, since theproject seems dead. The curious thing was that other code using  directfb didwork on the entire screen, no issues  running the examples.  directvncused  directfb for the framebuffer rendering.</p><p>  我提出了一个github问题，但我不期待它将是固定的，因为Project似乎已经死了。好奇的事情是其他代码在整个屏幕上使用DirectFB Didework，没有问题运行示例。用于帧缓冲渲染的DirectVncused DirectFB。</p><p> I tried all the possible options in  /etc/directfbrc and took a quick look atthe code, but didn&#39;t find anything to make it work. And since it&#39;s a sideproject in my spare time, I decided to move on to the next client I found, fbvnc.</p><p> 我尝试了/ etc / directfbrc中的所有可能的选项，快速查看代码，但没有找到任何让它工作的东西。自＆＃39;在业余时间的sideproject以来，我决定继续前进到我发现的下一个客户端fbvnc。</p><p> If you&#39;re compiling yourself, you can clone the repository ( git clonehttps://github.com/drinkmilk/directvnc) and run  autoreconf -vfi then automake, then  ./configure and finish off with  make. There should be a new binary in that folder. Make sure you have  directfb installed aswell, it&#39;s a dependency.</p><p> 如果您＆＃39;重新编译自己，您可以克隆存储库（git clonehttps：//github.com/drinkmilk/directvnc）并运行autoreconf -vfi然后automake，然后是./configure和make完成。该文件夹中应该有一个新的二进制文件。确保您有Adwer的DirectFB，IT＆＃39;依赖。</p><p>    fbvnc is a smaller, more bare-bones tool. The old  webpages are of courseoffline, but archive.org still has copies. However, to my surprise, the  git repository has recent commits from its author,  Ali Gholami Rudi!</p><p>    FBVNC是一个较小的更赤裸的骨骼工具。旧的网页课程是outhousoffline，但archive.org仍然有副本。然而，为了我的惊喜，Git存储库从其作者开始了，Ali Golemi Rudi最近犯了协议！ </p><p> A  git clone and  make fbvnc in my cross-compile setup later I have a working binary. The connection failed at first, because I had passwordprotected it. After removing the password, it worked right away. Way easiercompilation setup (no  autotools) and no dependency on  directfb, savesa lot of work.</p><p>Git Clone并在我的交叉编译设置中制作FBVNC我有一个工作二进制。连接起初失败了，因为我有密码保护。删除密码后，它立即运行。方式简单的方式设置（无AutoTools），没有对DirectFB的依赖，Savesa很多工作。</p><p> fbvnc hard codes the host  127.0.0.1 and the port  5900, but youcan specify others on the command line:</p><p> FBVNC硬编码主机127.0.0.1和端口5900，但是您可以在命令行上指定其他人：</p><p>  There is no help or instructions, just a  connection failed or  initfailed. The source is small and readable so figuring out what happens when iseasy. After you start it,  CTRL+C to quit doesn&#39;t work, to stop it you must stop  x11vnc.</p><p>  没有帮助或指示，只是连接失败或initFailed。源很小且可读，所以弄清楚何时易行的事情。启动它后，Ctrl + C退出DONN＆＃39; t工作，停止它必须停止x11vnc。</p><p> Here is a screenshot of my entire KDE desktop running (scaled_ on the coffeemachine, via VNC:</p><p> 以下是我的整个KDE桌面运行的屏幕截图（在咖啡机上缩放，Vy VNC：</p><p>   Performance wise, it&#39;s better then I expected. A tad bit laggy, but usable andeven for video calls, not that much stuttering. Since it&#39;s all running on myworkstation and only the rendering is on the coffee machine, I didn&#39;t expectany less. If I have some more spare time, I&#39;ll try to make a video sometimeshowing the performance. For an occasional second screen, it&#39;s just perfect.</p><p>   表演明智，它＆＃39;好吧，我期待。一个Tad Bit Laggy，但是可以使用Andeven进行视频通话，而不是那么多口吃。因为它＆＃39;＆＃39;所有在MyWorkStation上运行，只有渲染就在咖啡机上，我没有较少。如果我有更多的业余时间，我会尝试在有时拍摄的视频。对于偶尔的第二屏幕，它＆＃39; s只是完美。</p><p>Tags:  autotools,  blog,  development,  framebuffer,  fun,  linux,  microsoft,  vnc</p><p>标签：AutoTools，博客，开发，框架，有趣，Linux，Microsoft，VNC </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://raymii.org/s/blog/MS_Teams_on_a_Coffee_Machine_or_Framebuffer_VNC_Client.html">https://raymii.org/s/blog/MS_Teams_on_a_Coffee_Machine_or_Framebuffer_VNC_Client.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ms/">#ms</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/coffee/">#coffee</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/运行/">#运行</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>