<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Lynx 的 SSL 证书验证中的错误——通过 SNI 以明文形式泄露密码Bug in Lynx' SSL certificate validation – leaks password in clear text via SNI</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Bug in Lynx' SSL certificate validation – leaks password in clear text via SNI<br/>Lynx 的 SSL 证书验证中的错误——通过 SNI 以明文形式泄露密码</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-08-07 23:57:19</div><div class="page_narrow text-break page_content"><p>Date: Sat, 7 Aug 2021 03:51:07 +0200From: Axel Beckert &lt;abe@...ian.org&gt;To: lynx-dev@...gnu.orgCc: oss-security@...ts.openwall.com, security@...ian.org,	991971@...s.debian.orgSubject: Re: [Lynx-dev] bug in Lynx&#39; SSL certificate validation -&gt; leaks password in clear text via SNI (under some circumstances)Hi,On Fri, Aug 06, 2021 at 05:14:32PM +0000, Thorsten Glaser&lt;tg@...bsd.de&gt; wrote in https://lists.nongnu.org/archive/html/lynx-dev/2021-08/msg00000.html:&gt; this affects both OpenSSL and Debian’s nonGNUtls builds:&gt; &gt; lynx https://user:pass@...t/&gt; &gt; … will lead to…&gt; &gt; SSL error:host(user:pass@...t)!=cert(CN&lt;mainhost&gt;:SAN&lt;DNS=host&gt;:SAN&lt;DNS=otherhost&gt;&gt; &gt; … for OpenSSL lynx and…&gt; &gt; SSL error:host(user:pass@...t)!=cert(CN&lt;mainhost&gt;)-Continue? (n)&gt; &gt; … for nonGNUtls lynx.&gt; &gt; Obviously, user:pass@ need to be stripped before comparing.This is more severe than it initially looked like: Due to TLS ServerName Indication (SNI) the hostname as parsed by Lynx (i.e with&#34;user:pass@&#34; included) is sent in _clear_ text over the wire even_before_ I can even said &#34;n&#34; for &#34;no, don&#39;t continue to talk with thisserver&#34; in Lynx&#39;s prompt as shown above.I was able to capture the password given on the commandline in trafficof an TLS handshake using tcpdump and analysing it with Wireshark:From Wiresharks TLS dissector:Server Name Indication extension Server Name list length: 28 Server Name Type: host_name (0) Server Name length: 25 Server Name: user:pass@....example.org ^^^^^^^^^^From Wiresharks &#34;Follow TCP stream&#34;:...........a....jV.. ......../.......D.&amp;....R.+.,.....	..../.0...............z.{./.5.A........|.}.3.9.E.............2.8.D.......p............$.&#34;...user:pass@....example.org......#.....................................................(PCAPs available on request. Actually did the test with a local serverof mine. But it should be easy to reproduce, be it with any Linuxdistribution.)I did this test with Lynx from Debian Experimental (which has thecurrent Lynx upstream release 2.9.0dev.8) as well as with Lynx fromDebian 8 Jessie ELTS (which has Lynx 2.8.9dev.1) and both leak thepassword via SNI. I though assume that older releases of Lynx areprobably also affected as well, at least if they or the accordingcrypto libraries support SNI.But given that the symptoms Thorsten discovered stayed unreported forquite some years, I assume that this use case is a rather seldom one.Nevertheless only trying to use Lynx that way (and seeing it fail)already leaks the used password.IMHO this nevertheless needs a CVE-ID.Cc&#39;ing Debian Security Team as well as the OSS Security mailing listfor making them aware of this issue. I also updated the subject ofthis thread to make it less ambigous on other mailing lists.And I&#39;m also Cc&#39;ing the according Debian bug report which I createdfor tracking this issue in Debian:  https://bugs.debian.org/991971		Kind regards, Axel-- ,&#39;&#39;`. | Axel Beckert &lt;abe@...ian.org&gt;,  https://people.debian.org/~abe/: :&#39; : | Debian Developer, ftp.ch.debian.org Admin`. `&#39; | 4096R: 2517 B724 C5F6 CA99 5329 6E61 2FF9 CD59 6126 16B5 `- | 1024D: F067 EA27 26B9 C3FC 1486 202E C09E 1D89 9593 0EDE  Download attachment &#34; signature.asc &#34; of type &#34;application/pgp-signature &#34; (834 bytes)</p><p>日期：2021 年 8 月 7 日星期六 03:51:07 +0200 发件人：Axel Beckert &lt;abe@...ian.org&gt;收件人：lynx-dev@...gnu.orgCc：oss-security@...ts.openwall .com, security@...ian.org, 991971@...s.debian.orgSubject: Re: [Lynx-dev] Lynx SSL 证书验证中的错误 -&gt; 通过 SNI 以明文形式泄露密码（在某些情况下） )嗨，2021 年 8 月 6 日星期五下午 05:14:32 +0000，Thorsten Glaser&lt;tg@...bsd.de&gt; 在 https://lists.nongnu.org/archive/html/lynx-dev 中写道/2021-08/msg00000.html:&gt; 这会影响 OpenSSL 和 Debian 的非 GNUtls 构建：&gt; &gt; lynx https://user:pass@...t/&gt; &gt; ... 将导致...&gt; &gt; SSL error:host(user :pass@...t)!=cert(CN&lt;mainhost&gt;:SAN&lt;DNS=host&gt;:SAN&lt;DNS=otherhost&gt;&gt; &gt; ... 对于 OpenSSL lynx 和...&gt; &gt; SSL 错误:host(user:pass@. ..t)!=cert(CN&lt;mainhost&gt;)-Continue? (n)&gt; &gt; ... for nonGNUtls lynx.&gt; &gt; 显然，user:pass@ 需要在比较之前被剥离。这比最初看起来更严重：由于 TLS ServerName Indication (SNI)，Lynx 解析的主机名（即包含“user:pass@”）在 _c 中发送lear_ 网络上的文本 even_before_ 我什至可以在 Lynx 的提示中说“n”表示“不，不要继续与此服务器对话”，如上所示。我能够在 TLS 握手的流量中捕获命令行上给出的密码使用tcpdump 并使用 Wireshark 进行分析：来自 Wiresharks TLS dissector：服务器名称指示扩展服务器名称列表长度：28 服务器名称类型：host_name (0) 服务器名称长度：25 服务器名称：user:pass@....example.org ^ ^^^^^^^^^来自Wiresharks“跟随TCP流”：...........a....jV.........../..... ..D.&amp;...R.+.,..... ..../.0.........z.{./.5.A ........|.}.3.9.E.................2.8.D........ .$.&quot;...user:pass@....example.org......#................................ ......................（可应要求提供 PCAP。实际上用我的本地服务器进行了测试。但是它应该很容易重现，无论是任何 Linux 发行版。）我用来自 Debian Experimental（它有当前的 Lynx 上游版本 2.9.0dev.8）的 Lynx 以及来自 Debian 8 Jessie ELTS（它有 Lynx 2.8.9dev.1) 并且都通过 SNI 泄露密码。我虽然假设 Lynx 的旧版本也可能受到影响，至少如果它们或相应的加密库支持 SNI。尽管如此，仅尝试以这种方式使用 Lynx（并且看到它失败）已经泄露了使用的密码。恕我直言，这仍然需要一个 CVE-ID.Cc&#39;ing Debian 安全团队以及 OSS 安全邮件列表，以便让他们意识到这个问题。我还更新了该线程的主题，以使其在其他邮件列表中不那么含糊不清。我还抄送了我为在 Debian 中跟踪此问题而创建的相应 Debian 错误报告：https://bugs.debian.org/991971亲切的问候，阿克塞尔 - ，&#39;&#39;`。 | Axel Beckert &lt;abe@...ian.org&gt;, https://people.debian.org/~abe/: :&#39; : | Debian 开发人员，ftp.ch.debian.org 管理员`。 `&#39; | 4096R：2517 B724 C5F6 CA99 5329 6E61 2FF9 CD59 6126 16B5`- | 1024D: F067 EA27 26B9 C3FC 1486 202E C09E 1D89 9593 0EDE 下载“application/pgp-signature”类型的附件“signature.asc”（834字节）</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/密码/">#密码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ssl/">#ssl</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/lynx/">#lynx</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>