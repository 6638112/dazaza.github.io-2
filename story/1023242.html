<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>GO模块有一个v2+问题</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">GO模块有一个v2+问题</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-11 21:31:05</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/7c5317ce5bc313419b09a09e5161f671.png"><img src="http://img2.diglog.com/img/2020/9/7c5317ce5bc313419b09a09e5161f671.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>围棋有个问题。GO模块对模块版本2或更高版本提出了奇怪的命名要求。模块v2+上的模块名称必须以主要版本ALA…结尾。/v2，此规则的沟通一直较弱。这并不明显，整个社区也不理解它。</p><p>我在当地的围棋聚会上提出了这个问题，但从来没有人听说过这条规则。他们非常怀疑这条规则是否存在。</p><p>在很长一段时间里，Go没有包含用于版本控制依赖项的内置方法。它确实包括有时有争议的获取包裹的Go Get方法。直到最近，Go Get工具还只是根据URL克隆了Packages主分支的头部，并将其放在$GOPATH中。</p><p>关于向后兼容性的极端立场经常与GO的极端立场联系在一起，人们的期望主要是，如果你出版了一个库，你应该尽可能地保持兼容性。</p><p>多年来，出现了过多的工具来填补这一空白，gopkg.in、gopkg.in、lide，甚至一度成为官方实验部门。</p><p>然而，似乎突然之间，Russ&34；RSC&34；Cox突然将VGo(又名围棋模块)作为官方围棋解决方案出现在世界上。在它的创建过程中，似乎没有来自社区的投入，这让许多人感到懊恼。</p><p>虽然dep在很大程度上是NPM之类的标准依赖项管理器，而Go模块则是一个绝对自以为是的解决方案(Go&#34；Go&#34；Solution)。它作为构建步骤作为语言的一部分进行处理。当您进行构建时，如果您缺少版本化依赖项，则构建工具将获取它。</p><p>依赖项要求在go.mod中列出，预期的确切版本在go.sum中。这两个文件都使用各自特定于领域的语言。PIRE的语法让人联想到围棋本身。后者是一个空格分隔的依赖版本列表，很大程度上不打算供人类使用。</p><p>构建步骤将根据需要添加到这些文件中，运行go mod tidy将清理它们。</p><p>GO模块对包开发人员提出了非常奇怪的要求。当模块达到主要版本2或更高版本时，模块名称必须以主要版本结尾。这样做的好处是它创建了一个单独的包。结果是，一个项目现在可以依赖于同一个库的多个主要版本。</p><p>例如，可以在github.com/google/go-gihub的go.mod中看到，这看起来很简单，但它还要求您更改包中的所有交叉引用。虽然不是世界末日，但它很容易出错，甚至连谷歌都错过了一些。</p><p>这种方法最大的问题是它破坏了Go的非模块感知版本中的子包。随着时间的推移，这一点变得不那么重要了，但在旧版本的围棋中，包的名称必须与它的位置完全匹配。当没有v2目录时，https://github.com/pkg/foo不能是github.com/pkg/foo/v2。围棋团队认识到了这一问题，并将基本的模块支持补丁到围棋语言的1.9.7和1.10.3版本中，以帮助简化过渡。</p><p>第二种方法和围棋团队自己推广的方法是将v1项目保留在repo的根目录中，并实际创建包含v2库的v2/子文件夹。</p><p>这感觉很奇怪，但好处是它可以与不理解模块的旧版本Go干净利落地工作。不假思索，我只知道有一个项目走了这条路，而他们似乎又走上了这条路。</p><p>无论它的价值是什么，官方围棋博客试图澄清一些情况，并发布了一篇关于它的评论。</p><p>即使作为一名经验丰富的开发人员，我也觉得这篇文章有些令人费解。对于这一要求的重要性和不同寻常之处，写下来的内容是不够容易理解的。</p><p>许多项目，包括Buildkite的终端到HTML，直到忘记处理才知道这一要求，最终发布了不完整的版本。带有go.mod文件但不遵守模块v2+规则的v2+go库对于依赖项是编译时错误。这对用户来说比不是围棋模块更糟糕。</p><p>一些项目，如GORM，通过将其2.0版本标记为远远超过1.x版本来完全回避这个问题。这是个不错的解决方案，但是闻起来很难闻。</p><p>首先，我认为围棋团队需要更好地阐明这一规则。他们需要在屋顶上尖叫。他们至少需要文档的一个部分，清楚地用外行的话来说明。</p><p>除此之外，还有来自围棋工具的警告空间。导入较旧版本的根包的子包应该会抛出警告。这是一个太容易忽略的问题。</p><p>对于GO来说，最好也是最不可能的选择是放弃该要求，并使其成为可选的。我相信这是一个可行的解决方案。想要允许用户包含多个版本的软件包可以遵循v2指南，而其他软件包则不需要这样做。</p><p>我个人推荐的一个选项是同时要求/v0和/v1，这样您就可以立即解决问题，而不是在项目中花费数年时间，但很可能永远不会发生。早点讲授大会。</p><p>当黑客新闻和Reddit上有数千条评论，但我的评论中没有一条评论时，这是我的一个小小的挫折。我要打破僵局了！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://donatstudios.com/Go-v2-Modules">https://donatstudios.com/Go-v2-Modules</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/v2/">#v2</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/围棋/">#围棋</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>