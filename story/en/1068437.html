<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>网上数学渲染问题（2020） Problems with math rendering on the web (2020)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Problems with math rendering on the web (2020)<br/>网上数学渲染问题（2020） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-29 22:31:52</div><div class="page_narrow text-break page_content"><p>Since I first started working on my website at age fourteen, the sitehas gone through many revisions, and hopefully changed for the better.This blog was originally dynamically served using a Python/Flask backend,having a custom login system and post “editor” (just an input box).One of the more strange things about my website, though, was how I displayedcontent.</p><p>自从我第十四岁开始在十四岁开始工作以来，Sitehas经历了许多修订，并希望为更好的改变。这博客最初使用Python /烧瓶后端动态地服务，拥有自定义登录系统和“编辑器”（虽然是一个输入框）。关于我网站的更奇怪的事情，我是我的表现形式。</p><p> It was clear to me, even at my young age, that writing raw HTML wassuboptimal. Somehow (perhaps through GitHub) I heard about Markdown,and realized that a human-readable markup language was probably a muchbetter way to go. What remained was, of course, rendering the content.The easiest way I found was to just stick a JavaScript script, callingout to  marked, to run on pageload and convert all the markup into pretty HTML.</p><p> 对我来说很清楚，即使在我的年轻时期，也要写出原始的HTML WassubOpptimal。不知何故（也许通过github）我听说了马克下降，并意识到一种人类可读的标记语言可能是一种重大的方式。当然，留下了什么，渲染内容。我发现的最简单方法是只需坚持一个javascript脚本，调用标记为标记，以在pageload上运行并将所有标记转换为漂亮的HTML。</p><p> This rendering would happen on every page load. Every time I navigatedbetween pages on my site, for a second or two, I’d see the raw, unrenderedMarkdown that I had written, which would then disappear and be replacedwith a proper view of the page’s content. The rendering wasn’t error-proof,either. If my connection was particularly slow (which it was, thanks, Comcast),or if I forgot to disable uMatrix, I would be left having to sift throughthe frequent occurences of  #,  _,  *… Eventually I realized my mistake,and switched to rendering Markdown on the backend. Now, my contentwould appear to the user already formatted, and they wouldn’t have towait for a JavaScript program to finish to read what I had written.All was well.</p><p> 每个页面加载都会发生这种渲染。每次我在我的网站上导航页面上的页面，一两秒钟，我会看到我所写的原始，UnroweredMarkdown，然后将会消失并被替换为页面的内容。渲染也没有错误。如果我的连接特别慢（谢谢，康卡斯特），或者如果我忘了禁用Umatrix，我将被遗漏频繁出现＃，_，* ......最终我意识到我的错误，并转换为渲染后端的啰嗦。现在，我的内容将出现已经格式化的用户，并且他们不会为JavaScript程序进行磁带来完成阅读我写的内容。所有事情都很好。</p><p> Sometimes, I look back on the early iterations of my site, and smileat the silly mistakes I’d made. Yet I can’t innocently make fun ofmy original Markdown rendering solution, because in a way, it lives on.</p><p> 有时候，我回顾了我的网站的早期迭代，并微笑了我所做的愚蠢错误。然而，我无法自然取笑原始的标准渲染解决方案，因为在某种程度上，它仍然存在。</p><p>  When I search for “render math on website” on Google,the following two links are at the top of my search:</p><p>  当我在Google上搜索“网站上的网站”时，以下两个链接位于我的搜索顶部：</p><p>  Indeed, these are the two most popular math rendering solutions(in my experience). Yet both of these solutiosn share something somethingin common with each other and with the early iterations of my website -they use client-side rendering for static content. In my opinion, this is absurd.Every time that you visit a website that uses MathJax or KaTeX, any mathematicalnotation arrives to your machine in the form of LaTex markup. For instance,       e  −  x 2 e^{-\frac{x}{2}}     e         −           2        x ​     looks like  e^{-\frac{x}{2}}. The renderingsoftware (MathJax or KaTeX) then takes this markup and converts it intoHTML and CSS that your browser can display. Just like my old website,all of this happens  every time the page is loaded. This isn’t an uncommonthing, either: websites like Mathematics StackExchange and Chegg use MathJax, and many more can be foundon  this list.According to  this page, Facebook Messenger, Khan Academy,  Gitterand  GitLab use KaTeX. Some of these websitesdon’t even load their content with JavaScript enabled, much less rendermath.</p><p>  实际上，这些是两个最受欢迎的数学渲染解决方案（我的经验）。然而，这两个Solutiosn共享某些东西，彼此共同，并随着我的网站的早期迭代 - 他们使用客户端渲染进行静态内容。在我看来，这是荒谬的。每次你都要访问使用Mathjax或Katex的网站，任何数学输电都到达你的机器以乳胶标记的形式。例如，e-x 2 e ^ { -  \ frac {x} {2}} e-2 x看起来像e ^ { -  \ frac {x} {2}}。然后渲染图软件（Mathjax或Katex）然后拍摄此标记，并将其转换为您可以显示浏览器和CSS。就像我的旧网站一样，所有这一切都会在加载页面时发生。这不是一个unmonmonthing，无论是：数学itackexchange和chegg使用mathjax等网站，还有更多可以发现这个列表。根据这个页面，khan学院，gitterand gitlab使用Katex。其中一些网站甚至没有启用JavaScript加载它们的内容，更少的Rendermath。</p><p> A skeptic might say that it is not possible to render LaTeX to HTML andCSS ahead of time. This might even have been true in the past. A useron the “can we replace client-side MathJax with server-side MathJax” thread on MathOverflow Meta in 2015 points out that MathJax doesn’t supportserver-side HTML output:</p><p> 一个怀疑论可能会说不可能提前向HTML ANDCS渲染乳胶。这甚至可能是真的。 UserOn“我们可以用服务器端Mathjax替换客户端Mathjax”在2015年Mathoverflow Meta上的线程指出MathJax不支持HTML输出： </p><p> I found  [the comment] from a MathJax developer confirming that HTML+CSS doesn’t work yet with the server-side version . . .</p><p>我从Mathjax开发人员找到了[评论]确认HTML + CSS尚未使用服务器端版本运行。 。 。</p><p>    Or are we? Version 2.6 of MathJax has the following comment in its change log:</p><p>    还是我们？ MathJax版本2.6在其更改日志中具有以下注释：</p><p> Improved CommonHTML output. The CommonHTML output now provides the same layout quality and MathML support as the HTML-CSS and SVG output. It is on average 40% faster than the other outputs and the markup it produces are identical on all browsers and thus can also be pre-generated on the server via MathJax-node.</p><p> 改进了CommonHTML输出。 CommonHTML输出现在提供与HTML-CSS和SVG输出相同的布局质量和MathML支持。它平均比其他输出快40％，并且它在所有浏览器上产生的标记相同，因此也可以通过Mathjax-node在服务器上预先生成。</p><p>  [CommonHTML] is MathJax’s primary output mode since MathJax version 2.6. Its major advantage is its quality, consistency, and the fact that its output is independent of the browser, operating system, and user environment</p><p>  [commonhtml]是Mathjax版本2.6以来的Mathjax的主要输出模式。其主要优势是其质量，一致性以及其输出与浏览器，操作系统和用户环境无关的事实</p><p> So not only is it explicitly possible to have a server-generated math output,but the algorithm that would be used for generating such output is alreadyin use on the client-side! If you look hard enough, you may even find a fewresources for using this algorithm server-side, but many of those suffer fromanother problem…</p><p> 因此，不仅可以明确实现服务器生成的数学输出，而且用于生成这种输出的算法已经在客户端使用！如果你看起来很难，你甚至可以找到几个使用这个算法服务器端的人，但其中许多人患有其他问题......</p><p>  It’s tempting to convert mathematics to an image, such as a PNG or an SVG file.This approach is taken on  this blog and this  Advanced Web Machinery article.  Wolfram MathWorld also render their mathematics to images. However, in my opion,this is  not the right approach. It is inconvenient for me as a user,and, I suspect, for those in need of assistive technologies. Here arethe issues I see with rendering mathematics to images:</p><p>  将数学转换为图像（例如PNG或SVG文件）诱人很诱人。此方法是在此博客上拍摄和此高级Web机械文章。 Wolfram Mathworld还将他们的数学呈现为图像。但是，在我的作业中，这不是正确的方法。对于用户而言，我对我来说是不方便的，我怀疑是需要辅助技术的人。在这里，我看到的问题我看到了图像数学：</p><p> Images are impossible to use with copy/paste. I am unable to select a word,number, or symbol in a rendered image. I do this on occasion, and this isnot a contrived issue.</p><p> 图像是不可能与复制/粘贴一起使用的。我无法在渲染图像中选择一个单词，数字或符号。我有时这样做，这是一个有目的的问题。 </p><p> Images are not nearly as responsive, and are difficult to style.Line breaking, fonts, and even colors are difficult to change when using images.They stick out like a sore thumb when used for inline math, and canlook very strange (or disappear) if a user extension manipulates colors on thepage.</p><p>图像并不像响应，并且很难样式。在使用图像时难以改变线条破碎，字体，甚至颜色难以改变。当用于内联数学时，它们就像疼痛的拇指一样伸出粗糙，并且溃疡非常奇怪（或消失）如果用户扩展会在页面上操纵颜色。</p><p> Images are completely opaque to users in need of screen readers. Whilesome readers support  MathML,   [note:MathML is an XML-based markup for mathematics, meant to serve as a low-levelouput target for other math processors. While it is supported in Firefox,it requires a Polyfill in Chrome, and brings us back to front-end JavaScript. ] images are much harder to work with. The sitesthat I linked that use images do not have captions with their math,making it completely inaccessible.</p><p> 对需要屏幕读者的用户完全不透明。读者支持MathML，[注意：MathML是基于XML的数学标记，意味着用作其他数学处理器的低levelouput目标。虽然它在Firefox中支持，但它需要在Chrome中的Polyfill，并将我们带回前端的JavaScript。 ]图像更难与之合作。我链接的SITESTHAT，使用图像没有标题与他们的数学，使其完全无法进入。</p><p> Using images instead of a JavaScript-based renderer reminds me ofthe  false dichotomy fallacy. Why can’t we do what we do,but using the server?</p><p> 使用图像而不是基于JavaScript的渲染器让我想起了虚假的二分法谬误。为什么我们不能做我们做的事情，而是使用服务器？</p><p>  If you look up “mathjax setup” on Google, you are greeted with dozensof links telling you how to get the rendering working client-side. It’sconvenient: a single JavaScript  &lt;src&gt; tag, and maybe a bit of codeat the bottom of the page with some settings.</p><p>  如果您在Google上查找“Mathjax Setup”，则使用大约多种链接告诉您如何获取渲染工作客户端的链接。 IT'CONVAVENT：单个JavaScript＆lt; src＆gt;标签，也许有点代码在页面底部有一些设置。</p><p> If you look up “mathjax render server-side”, the resources are far morescarce. In fact, the first two image-based solutions I presented to youcame up as results after such a search. One more website looks promising: Antoine Amarilli’s blog post about server-side rendering.The page promises a self-hosted way of generating HTML using  mathjax-node,and even provides a very compelling sample output. I decided to tryout this approach, but to no avail. First of all, the MathJax infrastructurehas changed:</p><p> 如果您查找“Mathjax渲染服务器端”，则资源是潮流的。实际上，我在这样的搜索后呈现的前两个基于图像的解决方案。还有一个网站看起来有希望：Antoine Amarilli的博客文章关于服务器端渲染。该页面承诺使用MathJax-node生成HTML的自托管方式，甚至提供了非常引人注目的示例输出。我决定尝试这种方法，但无济于事。首先，Mathjax基础架构改变了：</p><p> As mathjax has reorganized their repositories, to make the following work, you will probably need to install manually mathjax-node-cli, as well as maybe installing mathjax-node and possibly mathjax-node-page. Again, I haven’t tried it. Thanks again to Ted for pointing this out!</p><p> 随着MathJax重组其存储库，要进行以下工作，您可能需要手动安装Mathjax-node-CLI，以及安装MathJax-node和可能的MathJax-node-Page。再次，我没有尝试过。再次感谢指向这一点！</p><p> This was indeed the case. The bigger issue, though, was that the  page2htmlprogram, which rendered all the mathematics in a single HTML page,was gone. I found  tex2html and  text2htmlcss, which could onlyrender equations without the surrounding HTML. I also found  mjpage,which replaced mathematical expressions in a page with their SVG forms.This actually looked quite good - the SVGs even had labels with theiroriginal LaTeX code. However, those labels were hard to read (likelyespecially so for people using screen readers), and the SVG imagesotherwise maintained most of the issues I described above. Additionally,  the page behaved significantly more sluggishly after the initial render than the JavaScript-based alternative.   [note:This is purely anecdotal, and would require a more thorough analysis togeneralize. ]</p><p> 这确实如此。但是，较大的问题是Page2htmlprick，它在一个HTML页面中呈现了所有数学的page2htmlprick。我找到了tex2html和text2htmlcs，它可以唯一没有周围HTML的方程式。我还找到了MJPage，它用SVG Forms替换了一个页面中的数学表达式。这个实际上看起来非常好 -  SVGS甚至有标签与磨牙乳胶代码。但是，这些标签很难读取（可能是使用屏幕读者的人数），并且SVG映像othersweplyswore维持了上述大部分问题。此外，在初始渲染之后，该页面的表现比基于JavaScript的替代方案更加缓慢。 [注意：这是纯粹的轶事，并且需要更彻底的分析一成本。 ] </p><p> In short, it’s much harder to find resources for server-side LaTeX rendering.It is especially hard to find such resources that work with morethan static pages. I could probably use a regular expression to extractmath I need to render from HTML, call  tex2htmlcss on it, and splice it backinto the page. But how could a WordPress user render their math? Whatabout someone writing their blog engine like I did in my youth? Somehow,those of us wanting to give our users a better experience are leftfumbling for an alternative, more or less without outside help…</p><p>简而言之，找到服务器端LaTex渲染的资源更难。尤其很难找到与MoreThan静态页面一起使用的这些资源。我可以使用正则表达式来解压缩我需要从HTML呈现，调用它上的Tex2htmlcs，并拼接它回到页面。但是德语用户怎么能呈现他们的数学？ Whatabout有人像我在你的年轻人那样写博客引擎？不知何故，我们希望为用户提供更好的体验，左右的替代方案，或多或少没有外部帮助......</p><p>  The majority of websites today use client-side, JavaScript-based renderingtechniques for mathematics. The work that could be done by a serveris outsorced to thousands of browsers, who have to run the same codeto get  identical results. Somehow, this is the best solution -the most accessible alternatives use images, which are a downgradeto the user experience. I wish for server-side rendering to becomemore common, and better documented.</p><p>  今天的大多数网站使用客户端，基于JavaScript的渲染技术进行数学。 Serveris可以完成的工作已经超越了成千上万的浏览器，他们必须运行相同的codeto获得相同的结果。不知何故，这是最好的解决方案 - 最可访问的替代方案使用图像，这是用户体验的下坡。我希望服务器端渲染成为常见的，更好地记录。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://danilafe.com/blog/math_rendering_is_wrong/">https://danilafe.com/blog/math_rendering_is_wrong/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/2020/">#2020</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/渲染/">#渲染</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/math/">#math</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1068381.html"><img src="http://img2.diglog.com/img/2021/6/thumb_d1615bb7dc31e3f074082558ea885b96.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1068381.html">论梦想分享及其目的（2020年） </a></div><span class="my_story_list_date">2021-6-26 11:37</span></div><div class="col-sm"><div><a target="_blank" href="/story/1068267.html"><img src="http://img2.diglog.com/img/2021/6/thumb_06ea97da1ba19fd0da53a6a87d67e332.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1068267.html">David Dobrik的概况，一个愚蠢的恶作剧臭名昭着的愚蠢恶作剧，他们在2020年赚取了1550万美元，现在在火灾中遭到造成创伤 </a></div><span class="my_story_list_date">2021-6-26 0:28</span></div><div class="col-sm"><div><a target="_blank" href="/story/1067914.html"><img src="http://img2.diglog.com/img/2021/6/thumb_07fceb2227c245f6b5c2c09bec8685b9.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1067914.html">肥皂的历史（2020） </a></div><span class="my_story_list_date">2021-6-24 15:26</span></div><div class="col-sm"><div><a target="_blank" href="/story/1067690.html"><img src="http://img2.diglog.com/img/2021/6/thumb_ac47bd9ae7ffd39361a85c87a05d50c5.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1067690.html">谷歌照片是如此2020-欢迎来到自主照片管理世界 </a></div><span class="my_story_list_date">2021-6-23 20:38</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>