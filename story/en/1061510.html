<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>跟踪一年恶意战利中继活动（第二部分） Tracking One Year of Malicious Tor Exit Relay Activities (Part II)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Tracking One Year of Malicious Tor Exit Relay Activities (Part II)<br/>跟踪一年恶意战利中继活动（第二部分） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-05-10 07:34:58</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/5/d071c4dfd409b4ad0b0bacb8a9eb0af1.png"><img src="http://img2.diglog.com/img/2021/5/d071c4dfd409b4ad0b0bacb8a9eb0af1.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>In August 2020 I reported about “ How Malicious Tor Relays are Exploiting Users in 2020 (Part I)”. Back then I made the hypothesis that the entity behind these malicious tor relays is not going to stop its activities anytime soon. Unfortunately this turned out to be true. In this follow-up post, I will give you an update, share what additional information we learned about the attacker since August 2020 and to what extend they were and still are active on the tor network.</p><p>2020年8月20日我报告了“恶意转移如何在2020年（第i部分）中利用用户”。然后，我做出了假设，即这些恶意转移后面的实体即将尽快停止其活动。不幸的是，这结果是真的。在此后续帖子中，我将为您提供更新，分享自8月2020年8月以来对攻击者了解的其他信息以及它们所在的延伸，并且仍然在Tor网络上处于活动状态。</p><p> After  publishing the previous blog post it took only a few days until two sets of relay groups that were on my radar at the time (Figure 8 in  Part I) got confirmed performing the same kind of attacks against Tor users as previously observed:</p><p> 在发布之前的博客文章后，只需几天时间，直到我的雷达上的两组中继组（图8中的第8部分）确认为先前观察到的TOR用户执行相同类型的攻击：</p><p>    The graph in Figure 1 starts where the first graph in the  previous blog post ends and shows the fraction of known malicious exit capacity linked to this specific actor between July 2020 and April 2021. You can see the repeating pattern of new malicious relays getting added to the tor network and gaining significant traction before dropping sharply, when they got removed.</p><p>    图1中的图表首先启动前一个博客帖子中的第一个图形的结束，并显示了与2020年7月2021年7月至4月之间的特定演员相关的已知恶意退出容量的分数。您可以看到添加到的新恶意继电器的重复模式当他们被删除时，Tor网络并在急剧下降之前获得显着的牵引力。</p><p> In terms of scale of the attacker’s exit fraction, they managed to break their own record from May 2020 (&gt;23% malicious exit fraction) twice:</p><p> 在攻击者出口分数的规模方面，他们设法从2020年5月（＆gt; 23％恶意出口分数）打破自己的记录：</p><p> on 2020–10–30 the malicious entity operated more than 26% of the tor network’s exit relay capacity</p><p> 2020-10-30恶意实体运营超过26％的TOR网络退出继电器容量</p><p> and on 2021–02–02 they managed more than 27% of tor’s exit relay capacity. This is the largest malicious tor exit fraction I’ve ever observed by a single actor.</p><p> 在2021-02-02，他们管理了超过27％的Tor的退出继电器能力。这是我用单个演员观察到的最大的恶意战利品分数。</p><p> Since there likely are additional malicious exit relays by this actor — which I did not manage to uncover I expect their actual fraction to be slightly higher (+1–3%) than the fractions stated above. The attacker managed such a large fraction, that the total fraction managed by somewhat known tor relay community members — that made up about 73% before this attacker started its operations over a year ago — dropped to bellow 50% at the end of 2020 before it started to recover again after 2021–02–05.</p><p> 由于这种演员可能是额外的恶意退出继电器 - 我无法揭示我预计他们的实际分数略高（+ 1-3％）而不是上述级分。攻击者管理了这么大的分数，即由某种众所周知的扭转击球社区成员管理的总分数 - 在这位攻击者开始在一年前开始其运营之前大约73％ - 在2020年之前下降到50％ 2021-02-05后开始再次恢复。 </p><p> Figure 4 shows the malicious exit fraction split by relay  ContactInfo. The attack strategy to hide large amounts of malicious tor exit relays by faking multiple distinct ContactInfos continued (as previously reported).</p><p>图4显示了通过继电器ContractInfo拆分的恶意出口分数。通过伪造多个不同的联系方式隐藏大量恶意TOR出口继电器的攻击策略（如前所述）。</p><p>  large exit fraction without any relay ContactInfo: This actor is increasingly adding malicious tor relays without any ContactInfo (this is the largest fraction, shown in red in Figure 4). Once a malicious tor exit relay is detected, all other relays using the same ContactInfo are easily found and removed, this is not an issue for them if they do not have a ContactInfo at all. Figure 5 shows the overall tor exit fraction that had no ContactInfo set (blue) and what part of it was malicious (red). We can obviously not rule out that even more of them are malicious and we failed to detect them. The vast majority of exit capacity without ContactInfo was malicious between October 2020 and March 2021.</p><p>  没有任何继电器的大型出口分数联系方式：这个演员越来越多地添加恶意的转移，没有任何ContactInfo（这是图4中红色所示的最大部分）。一旦检测到恶意退出继电器，就可以轻松找到使用相同ContactInfo的所有其他继电器，并且如果它们根本没有ContactInfo，这不是它们的问题。图5显示了没有ContactInfo Set（Blue）的整体TOR出口分数以及它的哪个部分是恶意（红色）。我们可以显然不排除更多，更多的是恶意，我们未能发现它们。未经HONTECTINFO的绝大多数退出能力在10月20日至3月2021年3月之间恶意恶毒。</p><p>  Roger Dingledine (one of the founders of the Tor Project) also has a  clear opinion on this topic:</p><p>  Roger Dingleine（Tor项目的创始人之一）也对这一主题有明确的意见：</p><p> Make clear that being a relay operator requires transparency about the relay operator, not secrecy</p><p> 明确成为继电器运营商需要透明的继电器运营商，而不是保密</p><p> The tor client has no configuration option to say “do not use exits without ContactInfo”. I wrote a short  proof-of-concept python script (not reviewed, not signed) that demonstrates such a feature by excluding exit relays without ContactInfo in the exit position via the “ ExcludeExitNodes” option, but it is not meant to be used by the average user and we aim for more robust protections than a simple “has ContactInfo? y/n” test (it still can be one of multiple factors). To allow everyone to easily see what exit fraction is currently contributed by exit relays without ContactInfo I added a new  graph to  OrNetStats which gets updated on a daily basis.</p><p> Tor客户端没有配置选项可以说“不要使用没有ContactInfo的退出”。我写了一个简短的概念验证Python脚本（未审核，未签名），通过通过“excludeexitnodes”选项排除退出继电器而不会在退出位置中排除退出继电器，但不打算使用普通用户，我们的目标是更强大的保护，而不是简单的“有联系方式？ Y / N“测试（它仍然可以是多种因素之一）。要允许每个人都轻松查看目前因退出继电器的退出贡献而没有ContactInfo的退出部分，我向ORNetStats添加了新图，每天更新。</p><p> impersonation attacks against other operators: This is not directly visible because the list of contacts was too large to include in Figure 4, but the malicious actor also started to impersonate other operators to hide malicious relays by using their ContactInfos. In one case they used  CypherPunkLabs’ ContactInfo. (Side note: To avoid false positives Figure 4 was generated by identifying malicious relays by fingerprint and not by searching for the ContactInfos used by CypherPunkLabs.)</p><p> 对其他运营商的模拟攻击：这不是直接可见的，因为联系人列表太大而无法在图4中包含，但恶意演员还开始模拟其他运营商通过使用他们的联系方式隐藏恶意继电器。在一个案例中，他们使用CypherPunklabs的ContactInfo。 （侧面注意：为避免误报，通过指纹识别恶意继电器而不是通过搜索CypherPunklabs使用的ContactInfos来生成。）</p><p>  In August and September 2020 malicious relays got reported and removed continuously (see the Appendix II for examples). In October 2020 the malicious exit fraction reached a new record (&gt;26% malicious exit fraction). What was different in October 2020? Like the previously identified groups, also the groups appearing at the end of September and the beginning of October 2020 got detected by  OrNetRadar (a relay group detector):</p><p>  八月和9月20日2020年9月均报告并持续删除（见附录二）。 2010年10月，恶意出口分数达到了新的记录（＆gt; 26％的恶意退出分数）。 10月20日的不同是什么？与以前识别的群体一样，也是在9月底和10月20日初出现的群体由ORNETRadar（继电器组检测器）检测到： </p><p> https://nusenu.github.io/OrNetRadar/2020/10/02/a10 Their name event contained the string “MITM” (short for man-in-the-middle attacks), which felt a bit like trolling to me.</p><p>https://nusenu.github.io/ornetradar/2020/10/02/10他们的名称事件包含了字符串“mitm”（对于中间人攻击的短而言），这感觉有点像拖钓。</p><p> They got reported to the Tor Project on 2020–10–04, unfortunately there was no reaction and so these malicious relay groups gained significant exit fraction over time before they got probably discovered again and removed at the end of October 2020:</p><p> 他们在2020-10-04举行了TOR项目，不幸的是，没有反应，因此这些恶意中继团队随着时间的推移，在2020年10月底再次发现并被删除之前，这些恶意中继组随着时间的推移而获得了重要的出口分数：</p><p>  Another example: The following graph shows the exit fraction of a set of  malicious relays (identified by their relay fingerprint), that got reported in August 2020 and was found again on the tor network with over 1% exit fraction in April 2021.</p><p>  另一个例子：下图显示了一组恶意继电器（由其继电器指纹标识）的出口分数，该分数于2020年8月在8月2020年再次发现，在4月2021年4月2021年再次发现了超过1％的出口分数。</p><p>   In September, on 2020–09–03 “Андрей Гвоздев &lt; andrejgvozdev55@gmail.com&gt;” reported CypherpunkLabs relays, an undeclared relay group (but not necessarily run with malicious intends), to bad-relays at lists.torproject.org.</p><p>   9月，在2020-09-03“Андрейгвоздев＆lt; andrejgvozdev55@gmail.com& gt;“报告的CypherPunklabs继电器，一个未释录的继电器组（但不一定与恶意拟运行），在Lists.torproject.org上的坏继电器。</p><p>  thanks for your email. We have them on our radar and they promised to improve things after our first contact but in fact they didn’t. We will follow up on them.</p><p>  谢谢你的电邮。我们拥有我们的雷达，他们答应在我们第一次接触后改善事情，但事实上他们没有。我们将跟进他们。</p><p> Even though I contacted CypherpunkLabs multiple times the situation with their relay configuration had not improved at the time. Such  MyFamily misconfigurations make impersonation attacks easier for attackers.</p><p> 尽管我在多次联系CypherPunklabs时，其继电器配置的情况当时没有改善。这种MyFamily错误配置使攻击者更容易造成巨大的攻击。</p><p> About three weeks later, on 2020–09–26, the malicious entity started to take advantage of CypherpunkLabs’ relay misconfiguration. New malicious exit relays using CypherPunkLabs’ ContactInfo appeared. Is this related to the email from 2020–09–03? A coincidence? At the time I did not realize what just happened, but the events that followed until the end of 2020 made it clear.</p><p> 大约三个星期后，在2020-09-26，恶意实体开始利用CyPherpunklabs的继电器错误配置。使用CyPherPunklabs的新的恶意退出继电器出现了。这是否与2020-09-03的电子邮件有关？巧合？当时我没有意识到刚刚发生的事情，但在2020年底之前遵循的事件使其明确。 </p><p>  On 2020–10–31 Roger Dingledine sent an  email to the tor-relays mailing list mentioning that tor directory authorities removed a long list of malicious exit relays for performing the known attacks (mitmproxy, sslstrip) against tor users. Side note: Since CypherPunkLabs did  not properly declare their relay group it was not possible to tell their relays apart from the attacker’s relays (they even used the same hosting company for the malicious relays). So all of them, those actually run by CypherpunkLabs and those run by the attacker, got removed altogether:</p><p>在2020-10-31罗杰dingledine向Tor-Relays邮件列表发送了一封电子邮件，提到了Tor Directory当局删除了一个长长的恶意退出继电器，以便对TOR用户执行已知的攻击（Mitmproxy，SSLStrip）。侧面注意：由于CypherPunkLabs没有正确声明他们的继电器组，因此无法与攻击者的继电器分开的继电器（他们甚至使用同一个托管公司进行恶意继电器）。因此，所有这些都是由Cypherpunklabs和攻击者运行的那些实际运行的人，完全删除了：</p><p>  At the bottom of the  long list of malicious tor exit relays published by Roger Dingledine, we can see the following set of malicious exit relay identifiers (fingerprints):</p><p>  在Roger Dingledine发布的恶意Tor出口继电器的长期底部，我们可以看到以下一组恶意退出中继标识符（指纹）：</p><p>  Unlike most of the other relays they were  not located at one of the usual hosters (OVH, Leasweb, Frantech). These relays did run on the following IP addresses: 185.32.222.167–185.32.222.170 (if you would like to verify that:  archive) located in Switzerland at the internet service provider Datasource AG ( AS51395). Let’s have a look at what WHOIS information is available for these IP addresses:</p><p>  与其他大多数继电器不同，他们不在常规旅馆之一（OVH，烤丝网，Frantech）。这些继电器确实在以下IP地址上运行：185.32.222.167-185.32.167-185.32.222.170（如果您想验证：存档）位于瑞士在互联网服务提供商DataSource AG（AS51395）。让我们看看Whois信息可用于这些IP地址：</p><p>  Due to the size (just a few IP addresses) and it’s status (“ASSIGNED PA”) the assignment, this is likely an end user assignment (instead of the hoster’s contact info). Of particular interest is the abuse-contact, since it shows the email address that contacted the bad-relays team on 2020–09–03 and reported the CypherpunkLabs relays which then became a impersonation attack victims after they got reported.</p><p>  由于大小（只是几个IP地址）和它的状态（“分配了PA”）的分配，这可能是最终用户分配（而不是Hoster的联系信息）。特别感兴趣的是虐待联系，因为它显示了与2020-09-03联系的电子邮件地址，并报告了Cypherpunklabs继电器，然后在他们报告后成为冒充攻击受害者。</p><p> The RIPE database can also be used to find other IP blocks that use the same abuse-contact (inverse lookup). Using that search method we found one additional IP block also hosting tor exit relays but unlike the other exit relays these relays were not removed at the time (October 2020):</p><p> 成熟数据库也可用于查找使用相同的滥用 - 联系人（逆查找）的其他IP块。使用该搜索方法我们发现一个额外的IP块也托管TOR出口继电器，但与其他出口继电器不同，这些继电器在当时（10月2020年10月）未删除这些继电器：</p><p>  On 2020–12–31 a new tor exit relay using a confirmed malicious ContactInfo (“ fbirelays@protonmail.com” — see  Part I) joined the tor network. The IP address of that relay (91.192.103.35) happened to be located in this IP address block. That means that we have multiple independent paths that link the email address  andrejgvozdev55@gmail.com to the attacker:</p><p>  在2020-12-31使用确认的恶意ContactInfo（“fbirelays@protonmail.com” - 见第I）的新的TOR退出继电器加入了TOR网络。继电器（91.192.103.35）的IP地址恰好位于此IP地址块中。这意味着我们有多个独立的路径，将电子邮件地址andrejgvozdev55@gmail.com链接到攻击者：</p><p> andrejgvozdev55@gmail.com tested the bad-relays team by reporting the CypherPunkLabs relays to see if they get removed for improper MyFamily configuration. This information is crucial for them because an attacker can not establish a mutual MyFamily configuration with the victim they impersonate. A few weeks later malicious relays appeared using the CypherPunkLabs ContactInfo (CypherPunkLabs was not the only relay group they reported..).</p><p> andrejgvozdev55@gmail.com通过报告CypherPunklabs继电器来测试Bad-Relays团队，以查看它们是否因不正确的MyFamily配置而被删除。此信息对他们至关重要，因为攻击者无法与受害者建立相互的MyFamily配置，他们冒充它们。几周后，使用CypherPunklabs出现的恶意继电器ContactInfo（CypherPunklabs不是他们报告的唯一的中继组..）。 </p><p> andrejgvozdev55@gmail.com shows up as abuse-contact in WHOIS for two small IP blocks that contain malicious tor exit relays.</p><p>Andrejgvozdev55@gmail.com在Whois中显示出两个包含恶意TOR退出继电器的小型IP块的滥用联系。</p><p> One of these exit relays in these IP blocks used a confirmed malicious ContactInfo previously identified (“ fbirelays@protonmail.com”).</p><p> 这些IP块中的这些退出继电器中的一个使用先前识别的确认的恶意ContactInfo（“fbirelays@protonmail.com”）。</p><p> It is unclear why they would reuse confirmed malicious ContactInfos and link their new exit relays to known malicious activities, since one would expect that known malicious ContactInfos are on an alert and removal list, but since they removed the known malicious ContactInfo from the relay configuration on 2021–01–16 while keeping the relay running, my guess is that they reused tor configuration files and unintentionally used a confirmed malicious ContactInfo. Such presumably unintentional disclosure happened multiple times.</p><p> 目前尚不清楚为什么他们会重用确认的恶意联系方式并将其新的退出继电器链接到已知的恶意活动，因为人们希望在警报和删除列表中遇到已知的恶意ContactInfos，但由于它们从中继配置中删除了已知的恶意ContactInfo 2021-01-16在保持继电器运行的同时，我的猜测是他们重复使用了Tor配置文件，无意中使用了确认的恶意ContactInfo。如此可能意外披露多次发生。</p><p> The RIPE database abuse-contact records for these IP blocks leads to an address in Moscow, Russia:</p><p> 这些IP块的成熟数据库滥用 - 联系记录会导致俄罗斯莫斯科的地址：</p><p>  An email address in the RIPE database is not necessarily there with the consent of the actual email address owner even though addresses are  validated to some extend by the RIPE NCC. There was still the possibility that the actual attacker fraudulently provided the address “ andrejgvozdev55@gmail.com” as abuse-contact without actually having access to it (impersonation), but we can rule that out since the hosting company confirmed that the RIPE database records are correct and the email address is verified. There is also a second reason why using someone else’s email address as abuse-contact for a tor exit IP block will not remain unnoticed for very long: That email address will get actual abuse emails delivered to it. So we are confident that the owner of the email address  andrejgvozdev55@gmail.com is actually running these malicious exit relays. After  confronting them they did not respond (not too surprising).</p><p>  即使地址验证到某些成熟的NCC扩展，也不一定在成熟数据库中的电子邮件地址不一定存在于实际电子邮件地址所有者的同意。实际攻击者欺诈地提供了欺诈地址“andrejgvozdev55@gmail.com”作为虐待 - 联系，而无需实际访问它（冒充），但我们可以统治以来，自托管公司确认成熟数据库记录以来是正确的，验证了电子邮件地址。还有一个第二个原因为什么使用别人的电子邮件地址作为滥用行为的滥用行动，对于Tor退出IP块将不会忽视很长：电子邮件地址将获得送达的实际滥用电子邮件。因此，我们相信电子邮件地址的所有者Andrejgvozdev55@gmail.com实际上正在运行这些恶意退出继电器。在面对他们之后，他们没有回应（不太令人惊讶）。</p><p> To what extend the physical address is authentic is unknown at this point. It would obviously not make much sense for an attacker to use their actual address when ordering servers, but at the same time they used a single email address when ordering servers for malicious relays and reporting non-malicious relays to the Tor Project. And it is not clear whether they knew that their email address and (alleged) physical address ends up in public RIPE database records.</p><p> 到了物理地址是真实的，此时未知。攻击者在订购服务器时使用实际地址显然不会有很大的意义，但同时他们在订购恶意继电器时使用单个电子邮件地址并将非恶意继电器报告给TOR项目。并不清楚他们是否知道他们的电子邮件地址和（所谓的）物理地址最终在公共成熟数据库记录中。</p><p> WHOIS information is rarely ever useful for malicious tor relay investigations, but in this particular case we were lucky and found useful information and were even able to find more malicious exit relays using RIPE database inverse-lookups.</p><p> WHOIS信息很少有助于恶意转发调查，但在这种特殊情况下，我们很幸运，发现有用的信息，甚至能够使用成熟数据库反向查找找到更多恶意退出继电器。 </p><p>  The tor network usually consists of less than  1 500 tor exit relays. In early May 2021 over 1 000 new unnamed tor exit relays without ContactInfo joined the tor network within less than 24 hours ( 1,  2,  3,  4). Although that sounds like an impressive number of exit relays, such massive relay groups impose little risk for tor users because they basically get removed right away before gaining any meaningful traction. When I noticed them I thought they are trolling because no one can assume such a large Sybil stays on the network for long, until I got email from them. Someone responded off-list to a short note I wrote to the  tor-relays mailing list about this event. Apparently they were  not amused by the removal of these exit relays (I do not claim any credit for their removal). It is likely that this is the same entity previously observed, because their limited vocabulary is consistent with earlier emails I got from “ andrejgvozdev55@gmail.com”.</p><p>TOR网络通常由小于1 500个TOR出口继电器组成。在5月初2021年，超过1 000多个未接受的TOR出口继电器在不到24小时内加入TOR网络（1,2,3,4）。虽然这听起来像令人印象深刻的退出继电器，但这种大规模的继电器组对TOR用户的风险很少，因为它们在获得任何有意义的牵引力之前基本上被拆除。当我注意到他们时，我以为他们是拖钓，因为没有人可以担任这么大的Sybil，直到我收到他们的电子邮件。有人回应了一个简短的注意事项，我写信给Tor-Relays邮件列表有关此事件。显然，他们没有通过去除这些出口继电器而感到乐趣（我没有要求他们的删除的任何信贷）。这可能是先前观察到的同一个实体，因为他们有限的词汇表与我从“Andrejgvozdev55@gmail.com”到的早期电子邮件一致。</p><p>  My previous blog posts about malicious tor relay activities ( 1,  2) featured a section about proposals the Tor Project could implement to reduce the risks for Tor Browser users. That did not turn out to be fruitful. So after several attempts to convince them to improve the situation I’m going to take an another approach: Digital self-defense for tor users. This is a work in progress and my plan is to write about it in more detail in a future blog post but this section might provides some overview .</p><p>  我之前的博客文章有关恶意转移活动（1,2）的帖子有一个关于Tor项目可以实施的提案，以减少Tor浏览器用户的风险。这并没有变成富有成效。所以经过几次尝试说服他们改善这种情况，我将采取另一种方法：为Tor用户进行数字自卫。这是一个正在进行的工作，我的计划是在未来的博客文章中更详细地写下它，但本节可能提供一些概述。</p><p> In addition to tor user protections I also tackle tor relay operator impersonation attacks via a non-spoofable ContactInfo — which (exit) relay operators are encouraged to implement and many (exit) relay operators adopted it already. Being able to confirm if a relay is actually operated by the entity it is claimed to be operated in an automated manner is a corner stone for addressing operator impersonation attacks and malicious relays in general.</p><p> 除了Tor用户保护之外，我还通过不可欺骗的ContactInfo解决Tor Relay操作员模拟攻击 - 鼓励（退出）继电器运营商实施，许多（退出）中继运营商已经采用。能够确认继电器实际上是由其被要求以自动方式操作的实体运行的，是用于解决操作员模拟攻击和恶意继电器的角落石。</p><p>  Non-central options should only be considered after trying (and failing) to achieve protections at the tor directory authority level because they will never reach all users.</p><p>  在尝试（和失败）之后只考虑非中央选项，以实现Tor目录权限级别的保护，因为它们永远不会到达所有用户。</p><p> Tor client configuration changes should generally be avoided to avoid splitting the anonymity set and only be used as an option of last resort (or as a method to vote with your feed as a tor user).</p><p> 通常应该避免扭转客户端配置更改，以避免拆分匿名集，只用作最后一个度假村的选项（或作为作为Tor用户的饲料投票的方法）。</p><p> Nonetheless we are in a dilemma between knowingly using malicious tor exit relays vs. excluding them via the tor client configuration at the price of having a non-default configuration. This is additionally complicated by the fact that the exact nature of the attacks are not entirely known. We know about mitmproxy, sslstrip, bitcoin address rewrites and download modification attacks but it is not possible to rule out other types of attacks. Imagine an attacker runs 27% of the tor network’s exit capacity and a firefox exploit affecting Tor Browser gets published before all users got their (auto)updates.</p><p> 尽管如此，我们在故意使用恶意TOR出口继电器VS之间处于两难困境。以非默认配置的价格通过Tor客户端配置排除它们。这又是攻击的确切性质并不完全知道这一点。我们知道关于Mitmproxy，SSLStrip，比特币地址重写和下载修改攻击，但无法排除其他类型的攻击。想象一下，攻击者运行了27％的TOR网络的退出容量，并且在所有用户获得（自动）更新之前会发布一次Firefox Exproit。</p><p>  The  HTTPS-Only mode (which might land in Tor Browser based on Firefox 91 ESR) would be a strong protection, but there are still some uncertainties with that as well as a Tor Browser developer points out  on a tor mailing list:</p><p>  仅限HTTPS的模式（可能基于Firefox 91 ESR的Tor浏览器中降落）将是一个很强的保护，但仍然存在一些不确定性以及Tor浏览器开发人员在Tor邮件列表中指出： </p><p> When Tor Browser migrates to Firefox 91esr we will look at enabling https-only mode for everyone, but there remains a significant concern that there are many sites that do not support HTTPS (especially more region specific sites) and the question of what messaging Tor Browser should use in that case.</p><p>当Tor Browser迁移到Firefox 91ES时，我们将为每个人提供仅启用HTTPS的模式，但仍然有一个重要的问题，即存在许多不支持HTTPS（特别是更多区域特定网站）的网站以及消息传递浏览器的问题应该在这种情况下使用。</p><p>  Problem:  ContactInfo is an unverified arbitrarily spoofable string and malicious actors take advantage of that by using other peoples ContactInfos to hide their malicious relays — especially if their MyFamily configuration is not properly setup. This even goes as far as using names of (former) tor community people that do not even run exit relays.</p><p>  问题：ContactInfo是一个未经验证的任意欺骗的字符串和恶意演员利用它通过使用其他人的ContactInfos来隐藏他们的恶意继电器 - 特别是如果他们的MyFamily配置没有正确设置。这甚至可以使用甚至不运行退出继电器的（以前）的名称。</p><p> Solution: Non-spoofable ContactInfos. The  ContactInfo Information Sharing Specification (version 2) provides a  non-spoofable ContactInfo “url” field that can be protected against impersonation attacks. The specification ties a relay to a domain and makes use of the  IANA registered  “tor-relay” well-known URI to place the list of relay fingerprints operated by an entity at a well defined location on the operator domain (or via DNS TXT records). An attacker claiming to be another trusted operator (for example “ emeraldonion.org”) can be detected because the attacker can not place his relay fingerprints at the  defined location. This effectively protects the provided “url” field. Even operators that do not own a domain have used Github pages and similar services to protect their relay’s ContactInfo in this way. This non-spoofable ContactInfo field is also the foundation for graphs showing trusted/untrusted exit fraction over time.</p><p> 解决方案：不可欺骗的联系方式。 ContactInfo信息共享规范（版本2）提供了一个不可欺骗的ContactInfo“URL”字段，可以防止模拟攻击保护。该规范将继电器连接到域，并利用IANA注册的“TOR-RELAY”众所周知的URI，以将由实体在运营商域上的良好定义位置处运行的中继指纹列表（或通过DNS TXT记录）。 ）。声称是另一个可信任的运算符的攻击者可以检测到“emeraldonion.org”），因为攻击者不能在定义的位置放置他的继电器指纹。这有效地保护提供的“URL”字段。甚至运营商不拥有域的运营商已经使用GitHub页面和类似的服务来以这种方式保护他们的继电器的ContactInfo。这种不可欺骗的ContactInfo领域也是图表显示可信/不受信任的出口分数随时间的图表的基础。</p><p> Over 20% of the tor network’s exit capacity is already protecting their ContactInfo “url” field using this method. Please consider  using a non-spoofable ContactInfo if you are a tor relay operator to help prevent these attacks. As a nice side effect you get an aggregated graph for your group of relays on OrNetStats ( example). Generating the ContactInfo string has become rather easy with the availability of  https://torcontactinfogenerator.netlify.app/ contributed by  Eran Sandler (only “url”, “proof” and “ciissversion” fields are needed for a non-spoofable ContactInfo).</p><p> 超过20％的TOR网络的退出容量已经使用此方法保护其ContactInfo“URL”字段。如果您是Tor Relay运营商，请考虑使用不可欺骗的联系方式，以帮助防止这些攻击。作为一个很好的副作用，您可以在ORNetStats（示例）上为您的继电器组进行聚合图。通过HTTPS://torContactInfogenerator.NetLify.App/由Eran Sandler（仅“URL”，“验证”和“Ciissversion”字段提供的不可欺骗ContactInfo需要），生成ContactInfo String已经变得相当容易。</p><p> Note: Also malicious operators can and will setup these fields, but the key point is, that they can not impersonate other relay operators.</p><p> 注意：还有恶意运算符可以并将设置这些字段，但关键点是，它们不能冒充其他中继运算符。</p><p>  Visualizations provide a good overview on what is going on on the tor network with regards to changes related to who controls what exit fraction for example. I use the following graph to get an idea on what is going on before proceeding with more specific investigations. It shows the aggregated exit probability from operators I classify as “somewhat known/non-malicious”.</p><p>  可视化提供了关于TOR网络在与谁控制的变化上进行的更改进行了良好的概览，例如控制谁的退出分数。我使用以下图来了解在进行更具体的调查之前发生的事情。它显示了来自运算符的聚合退出概率，我将分类为“有点已知/非恶意”。</p><p>  The graph spans over more than one year and can indirectly show malicious relay activities (indicated by a significantly decreasing exit fraction) or outages at known operators. This can be seen without having to know anything about the attackers in specific but it requires constant manual investigations because it has a significant problem: It uses untrusted input data (ContactInfo) that malicious entities are taking advantage of by using other peoples ContactInfo.</p><p>  图表跨越了一年多的时间，可以间接地显示恶意中继活动（由已知的运营商中的中断表明。可以看出，在特定于攻击者的情况下，可以看出，但它需要不断的手动调查，因为它具有重要问题：它使用不受信任的输入数据（ContactInfo），恶意实体正在利用其他人民联系方式优势。 </p><p> This is where the non-spoofable ContactInfo “url” field comes in. With the increasing adoption of the non-spoofable ContactInfo field we can visualize what fraction of the network is “known” without depending on arbitrarily spoofable input data. Instead we simply use domain names from the non-spoofable ContactInfo url field and specify “I know emeraldonion.org, hviv.nl, …”. Figure 15 shows all current non-spoofable domains by exit operators. This is a snapshot of the daily updated  graph I’m adding to OrNetStats with the release of this blog post. On OrNetStats you can interactively select whether a operator should be include or not by clicking on an operator domain. It is up to the user to decide which operator they consider trusted.</p><p>这是不可欺骗的ContactInfo“URL”字段所进入的地方。随着不可避免的联系方式的不断采用，我们可以可视化网络的一部分“已知”，而无需取决于任意欺骗的输入数据。相反，我们只需使用来自不可欺骗的ContactInfo URL字段的域名，并指定“我知道emeraldonion.org，hviv.nl，......”。图15显示了退出运算符的所有当前不可欺骗域。这是日常更新图的快照，我正在向ORNETSTAT添加到此博客文章。在ORNetStats上，您可以通过单击操作域来交互方式选择操作员是否应包括或不包括。用户可以决定他们认为哪个操作员。</p><p>  This graph is similar to what Roger Dingledine wrote in  this Tor Project gitlab issue, but instead of tagging each relay individually we leave the task to (verifiable) link a relay to an operator to the operator running it and then do the tagging (known vs. unknown) on the operator level instead of at the relay level, this should scale well and does not require any actions if an operator adds a new relay to the network.</p><p>  此图类似于roger dingledine在此Tor项目Gitlab问题中写道，而不是单独标记每个继电器我们将任务留给（可验证）链接到运行函数的运行员，然后执行标记（已知VS 。未知）在操作员级别而不是在中继级别，这应该符合速度良好，如果运算符向网络添加新继电器，则不需要任何操作。</p><p> The aggregated exit fraction in Figure 14 is significantly larger than in Figure 15 where we use non-spoofable input data, but we have just started and more operators are about to adopt the non-spoofable ContactInfo to make this even more useful. I envision a future where a tor user can choose his preferred risk level between “I want to use known exits only” and “I’m fine with some higher risk, I want more diversity, allocate up to 20% of unknown tor exit relays ”. Beware that his comes at the price of splitting the anonymity set. On the long run all Tor Browser traffic should be authenticated and encrypted which will make running malicious exit relays less profitable for malicious entities.</p><p> 图14中的聚合出口分数明显大于图15，其中我们使用不可欺骗的输入数据，但我们刚刚开始，更多的运算符即将采用不可欺骗的ContactInfo来使这更有用。我想到一个人可以选择“我想使用已知的退出”和“我很好的风险，我想要更加普通的未来的未来，我想要更多的多样性，可以分配高达20％未知的tor出口继电器“。小心他以拆分匿名集的价格来。在长期运行中，所有Tor浏览器流量都应进行身份验证和加密，这将使恶意退出中继较少对恶意实体有利可图。</p><p>  The entity attacking tor users, originally disclosed in  August 2020, is actively exploiting tor users since over a year and expanded the scale of their attacks to a new record level (&gt;27% of the tor network’s exit capacity has been under their co</p><p>  目的攻击者用户最初在2020年8月在8月20日透露，自一年以来是积极利用用户的，并扩展了他们对新的记录水平的攻击规模（＆gt; 27％的TOR网络的退出能力已经在他们的公司下</p><p>......</p><p>...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://nusenu.medium.com/tracking-one-year-of-malicious-tor-exit-relay-activities-part-ii-85c80875c5df">https://nusenu.medium.com/tracking-one-year-of-malicious-tor-exit-relay-activities-part-ii-85c80875c5df</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/战利/">#战利</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/year/">#year</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/继电器/">#继电器</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>