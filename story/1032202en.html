<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我讨厌坐标系</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">我讨厌坐标系</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-30 09:09:46</div><div class="page_narrow text-break page_content"><p>Apply this three-part mental model of geospatial datasets. Many common problems happen when one of these parts is missing or out of sync.</p><p>应用这个地理空间数据集的三部分心理模型。当其中一个部件丢失或不同步时，会出现许多常见问题。</p><p>  Your dataset probably has some junk  coordinates.  Many data formats store &#34;null&#34; as zeroes. If your software is assuming a longitude/latitude geographic  coordinate system (GCS), then the point with  coordinates (0, 0) is where the equator crosses the prime meridian off the coast of Africa (humorously known as  Null Island). This can sometimes happen when importing from Excel and empty rows are not trimmed off.</p><p>您的数据集可能有一些垃圾坐标。许多数据格式将&#34；NULL&#34；存储为零。如果您的软件假定使用经度/纬度地理坐标系(GCS)，则坐标为(0，0)的点是赤道穿过非洲海岸的本初子午线的位置(幽默地称为空岛)。从Excel导入且未裁剪空行时，有时可能会发生这种情况。</p><p>  Your dataset probably has its  coordinate system wrongly defined as a longitude/latitude geographic coordinate system (GCS).  This can happen if the coordinate system is missing altogether, in which case GIS software often assumes a GCS without telling you. A GCS only ranges from -180° west to +180° east in the X-axis and -90° south to +90 north in the Y-axis. If the  coordinates in your dataset are out of this range then your dataset will look like it&#39;s off of the Earth.</p><p>您的数据集可能将其坐标系错误地定义为经度/纬度地理坐标系(GCS)。如果坐标系完全丢失，则可能会发生这种情况，在这种情况下，GIS软件通常会在不通知您的情况下假定GCS。GCS在X轴上仅在-180°西到+180°东之间，在Y轴上在-90°南到+90°北之间。如果您的数据集中的坐标超出此范围，那么您的数据集看起来就像是在地球之外。</p><p>  Solution:  Redefine the coordinate system, i.e. change the  coordinate system but not the  coordinates, from the GCS to the  correct coordinate system.</p><p>解决方案：重新定义坐标系，即将坐标系从GCS更改为正确的坐标系，但不更改坐标。</p><p>  Your dataset probably has the wrong  coordinate system.  This is the more general case of the previous problem. This can happen if the coordinate system is missing altogether, in which case GIS software often assumes that it is the same coordinate system as a previously loaded dataset, or the coordinate system set in the &#34;project&#34; or &#34;map document&#34;.</p><p>您的数据集可能具有错误的坐标系。这是前面问题的更一般情况。如果坐标系完全丢失，则可能会发生这种情况，在这种情况下，GIS软件通常会假设它与以前加载的数据集或在项目或地图文档中设置的坐标系相同。</p><p>  Solution:  Redefine the coordinate system, i.e. change the  coordinate system but not the  coordinates, to the  correct coordinate system.</p><p>解决方案：重新定义坐标系，即将坐标系更改为正确的坐标系，而不是将坐标更改为正确的坐标系。</p><p>  Look at the two things you do know: the  attributes and the  coordinates.  A data point&#39;s  attributes gives context to where on the Earth it is located. Most GIS software will display the minimum and maximum  coordinates in the layer&#39;s properties as &#34;extent&#34; or &#34;bounding box&#34;. From these, do some detective work on the  coordinate system which you should use when  redefining your dataset.</p><p>看看您确实知道的两件事：属性和坐标。数据点的属性提供了它在地球上所处位置的上下文。大多数GIS软件会将图层属性中的最小和最大坐标显示为范围或边界框。在此基础上，对重新定义数据集时应使用的坐标系进行一些检测工作。</p><p>    If the  attributes indicate the approximate longitude,latitude where the  coordinates  should be located, try doing a reverse lookup. This iterates over every well-defined  coordinate system, unprojects the X,Y  coordinates to WGS84, and measures the error to the known longitude,latitude. Errors less than a few hundred meters denote a reasonable projection, though this isn&#39;t precise enough to  determine the GCS. You can run  this sample code yourself, or use this form:</p><p>如果属性指示坐标应该位于的大致经度、纬度，请尝试反向查找。这将迭代每个明确定义的坐标系，取消将X，Y坐标投影到WGS84，并将误差测量到已知的经纬度。误差小于几百米表示一个合理的预测，尽管这不够精确，无法确定GCS。您可以自己运行此示例代码，或使用以下形式：</p><p>        If the  coordinates have X-values between -180 and 180, and Y-values between -90 and 90, then you probably want to  redefine to a longitude,latitude geographic  coordinate system (GCS) like WGS84.</p><p>如果坐标的X值介于-180和180之间，Y值介于-90和90之间，则可能需要重新定义为经纬度地理坐标系(GCS)，如WGS84。</p><p>  If the  coordinates have large absolute values, try  redefining to a local  coordinate system like UTM, Gauss-Krüger, State Plane, or a national grid. Also consider trying neighboring zones, e.g. if UTM Zone 19N is wrong, try UTM Zone 18N.</p><p>如果坐标具有较大的绝对值，请尝试重新定义为本地坐标系，如UTM、Gauss-Krüger、州平面或国家栅格。还可以考虑尝试邻近区域，例如，如果UTM区域19N错误，请尝试UTM区域18N。</p><p>  If the  attributes suggest the dataset is in the USA, then there might a problem converting to/from   Freedom Units  . Try multiplying/dividing a data point&#39;s  coordinates by 3.28084 to convert feet to meters/meters to feet and see if that places it in the proper location.</p><p>如果属性表明数据集在美国，则在与Freedom Units之间进行转换时可能会出现问题。试着将数据点的坐标乘以/除以3.28084，将英尺转换为米/米到英尺，看看是否将其放置在正确的位置。</p><p>  If the minimum X/Y  coordinates are both zero and the maxmimum X/Y  coordinates are both positive, then the dataset may have been exported from non-geospatial software like Photoshop or Illustrator or Inkscape. This is especially likely if the dataset is flipped vertically since those editors typically have the Y-axis increasing going down. You will need to manually georeference the dataset to use it, which changes both the  coordinates and the  coordinate system.</p><p>如果最小X/Y坐标均为零，最大X/Y坐标均为正，则数据集可能已从非地理空间软件(如Photoshop、Illustrator或Inkscape)导出。这在数据集垂直翻转时尤其可能，因为这些编辑器通常会向下增加Y轴。您需要手动对数据集进行地理配准才能使用它，这会同时更改坐标和坐标系。</p><p>  Your dataset probably has the wrong longitude/latitude geographic  coordinate system (GCS). Different GCSs define slightly different sizes/shapes of the Earth (their ellipsoids) and different positionings on the Earth (their datums). As a result, the same longitude/latitude  coordinates in two different GCSs can appear offset, although typically within tens of meters of each other. This can happen even if you are using a projected coordinate system (PCS) whose units are not degrees of longitude/latitude since PCSs have a GCS embedded within them.    Solution:  Redefine the coordinate system, i.e. change the  coordinate system but not the  coordinates, to one of the following</p><p>您的数据集可能具有错误的经度/纬度地理坐标系(GCS)。不同的GCS定义略有不同的地球大小/形状(它们的椭球体)和地球上不同的位置(它们的基准面)。因此，两个不同的GCS中的相同经度/纬度坐标可能会出现偏移，尽管彼此之间通常在几十米之内。即使您使用的投影坐标系(PCS)的单位不是经度/纬度，也会发生这种情况，因为PCS中嵌入了GCS。解决方案：重新定义坐标系，即将坐标系而不是坐标更改为以下选项之一。</p><p>  If your dataset is in the USA  , try redefining to NAD27, NAD83, or WGS84.</p><p>如果您的数据集在美国，请尝试重新定义为NAD27、NAD83或WGS84。</p><p>  It depends on your software.  Remember, redefining means the metadata about the  coordinate system is modified but the  coordinates are not. This contrasts with reprojections and transformations, which modify both the  coordinate system and the  coordinates.</p><p>这取决于您的软件。请记住，重新定义意味着修改了有关坐标系的元数据，但不修改坐标。这与重新投影和变换形成对比，后者同时修改坐标系和坐标。</p><p>    In QGIS, for vector datasets, use the  Assign Projection tool in the Vector General toolset,  not the Reproject Layer tool.</p><p>在QGIS中，对于矢量数据集，请使用矢量常规工具集中的指定投影工具，而不是重新投影图层工具。</p><p>  In QGIS, for raster datasets, use the  Assign Projection tool in the &#34;GDAL&#34; toolset,  not the Warp (Reproject) tool.</p><p>在QGIS中，对于栅格数据集，请使用GDAL&34；工具集中的指定投影工具，而不是扭曲(重新投影)工具。</p><p>  From the command line, for vector datasets, use   ogr2ogr with the  -a_srs parameter,  not the  -t_srs parameter.</p><p>在命令行中，对于矢量数据集，请使用带-a_srs参数的ogr2ogr，而不是-t_srs参数。</p><p>  Your dataset is probably in a non-equidistant  coordinate system.  Most GIS software stupidly calculates distances, areas, and volumes using Euclidean math in the dataset&#39;s or data frame&#39;s  coordinate system,  regardless of whether it is equidistant. Depending on the amount of distortion associated with the projection, this can lead to (wildly) incorrect measurements without you realizing. In the common case of the Mercator projection, distances are enlarged by about  1/cos(latitude).</p><p>您的数据集可能位于不等距的坐标系中。大多数GIS软件在数据集或数据框的坐标系中使用欧几里得数学愚蠢地计算距离、面积和体积，而不管它们是否等距离。根据与投影相关的畸变量，这可能会在您没有意识到的情况下导致(极大的)不正确的测量。在墨卡托投影的常见情况下，距离放大约1/cos(纬度)。</p><p>    Reproject your dataset (changing both the  coordinates and  coordinate system) to an appropriate &#34;local&#34;  coordinate system. A local coordinate system is tuned to offer very accurate Euclidean measurements for a constrained region of the Earth. Examples include UTM, Gauss-Krüger, State Plane, and equidistant national grids like the Equidistant Conic.</p><p>将数据集(更改坐标和坐标系)重新投影到适当的本地坐标系。调整了一个局部坐标系，以便为地球的受限区域提供非常精确的欧几里德测量。例如UTM、Gauss-Krüger、州平面和等距国家网格(如等距圆锥)。</p><p>  Perform geodesic measurements. This unprojects the  coordinates to longitude/latitude (if projected) and then calculates precise distance along the GCS&#39;s ellipsoid. But beware: each calculation is slower than the Euclidean version, and the improvement in accuracy is marginal versus a local  coordinate  (the previous solution) unless you require sub-centimeter accuracy. This is done by default in  QGIS, can be enabled in  ArcGIS Pro and  ArcMap, and can be performed programmatically with open-source libraries like  GeographicLib.</p><p>执行测地线测量。这会取消将坐标投影到经度/纬度(如果投影)，然后计算出沿GCS椭球体的精确距离。但请注意：每个计算都比欧几里得版本慢，并且精度的提高与局部坐标(以前的解决方案)相比微不足道，除非您需要亚厘米精度。默认情况下，这是在QGIS中完成的，可以在ArcGIS Pro和ArcMap中启用，并且可以使用GeraphicLib等开源库以编程方式执行。</p><p>  Mercator is the only  conformal cylindrical map projection. Cylindrical map projections mean the whole Earth fits into a rectangle, which is very convenient for data processing algorithms that are used to working with rectangular images. Conformal means that angles and shapes are always preserved: north is always up, squares are always square, etc. Using a non-conformal projection would make things look stretched, squashed, and/or rotated when zooming in.</p><p>墨卡托是唯一的保角柱面地图投影。柱面地图投影意味着整个地球适合于一个矩形，这对于用来处理矩形图像的数据处理算法来说是非常方便的。保角意味着角度和形状始终保持不变：北向始终向上，正方形始终为正方形，等等。使用非保角投影会使放大时的物体看起来被拉伸、挤压和/或旋转。</p><p>      Mercator does enlarge  areas farther from the equator, but at least this distortion is the same horizontally and vertically. And it&#39;s trivial to calculate a  scale factor to correct measurements. The only time the distortion is problematic is when viewing a global-scale map with a range of different scale factors, but most maps are not global-scale and there are plenty of better projections to use for this case.</p><p>墨卡托确实扩大了距离赤道更远的区域，但至少这种扭曲在水平和垂直方向上是相同的。而且计算一个比例因子来修正测量也是微不足道的。只有在查看具有一系列不同比例因子的全球比例地图时，才会出现扭曲问题，但大多数地图不是全球比例地图，在这种情况下有很多更好的投影可供使用。</p><p>  Good question. There are a bunch of reasons we use planar projected  coordinate systems rather than just sticking with latitude,longitude geographic  coordinate systems all the time:</p><p>问得好。我们使用平面投影坐标系而不是始终使用经纬度地理坐标系的原因有很多：</p><p>  Planar measurements are ubiquitous. Common GIS features like property boundaries, road centerlines, forests, lakes, etc. are all reckoned in Euclidean distances, areas, and volumes - not in terms of angles.</p><p>平面测量无处不在。常见的GIS要素(如财产边界、道路中心线、森林、湖泊等)都是按欧几里得距离、面积和体积计算的，而不是按角度计算的。</p><p>  Planar measurements are easier to calculate. Measuring distances on a plane with the Pythagorean theorem is easier than along a sphere with the  Haversine formula and  way easier than along an ellipsoid with the  Vincenty&#39;s formulae, to say nothing of areas or volumes.</p><p>平面尺寸更容易计算。用毕达哥拉斯定理测量平面上的距离比用哈弗正弦公式测量球面上的距离容易，比用文森西公式测量椭球面上的距离容易得多，更不用说面积和体积了。</p><p>  Longitude was hard to figure out before GNSS. Reliable means of determining longitude are  only a couple hundred years old, and GPS only a couple decades old. There is a lot of inertia in surveying and geodesy using Cartesian distances from fixed monuments.</p><p>在GNSS之前，经度是很难计算出来的。可靠的经度测定方法只有几百年的历史，而GPS只有几十年的历史。使用与固定纪念碑的笛卡尔距离进行测量和大地测量有很大的惯性。</p><p>  Your dataset is probably measuring height above the ellipsoid instead of above sea level (geoid), or vice-versa.  Sea level follows the geoid, a surface which is lumpy because of minute regional variations in gravity. GNSS like GPS do not measure the height above the geoid but rather the idealized mathematical representation called the ellipsoid. Some GPS devices automatically convert ellipsoidal height to height above sea level (aka orthometric height aka geoidal height), but many do not.</p><p>您的数据集可能测量的是椭球体以上的高度，而不是高于海平面(大地水准面)的高度，反之亦然。海平面跟随着大地水准面，由于重力的微小区域差异，大地水准面是一个凹凸不平的表面。像GPS一样，GNSS不测量大地水准面以上的高度，而是测量被称为椭球体的理想化的数学表示法。一些GPS设备会自动将椭球面高度转换为高于海平面的高度(又名正交高程又称大地水准面高程)，但许多设备不能。</p><p>    Solution: Use   cs2cs in PROJ, or alternatively an older tool like  VDatum, to convert between ellipsoidal and orthometric (above sea level) heights. For a reasonably small dataset, a constant offset can be applied to all Z-coordinates.</p><p>解决方案：在Proj中使用cs2cs，或者使用较旧的工具(如VDatum)在椭球体和正交(高于海平面)高度之间进行转换。对于相当小的数据集，可以将恒定偏移量应用于所有Z坐标。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://ihatecoordinatesystems.com/">https://ihatecoordinatesystems.com/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/讨厌/">#讨厌</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/测量/">#测量</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>