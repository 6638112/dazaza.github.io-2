<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>V8优化了新的JavaScript语言功能(2018)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">V8优化了新的JavaScript语言功能(2018)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-08 09:39:48</div><div class="page_narrow text-break page_content"><p>PermalLink GitHub是5000万多名开发人员的家园，他们一起工作，共同托管和审查代码、管理项目和构建软件。</p><p>报名。</p><p>本文档列出了JavaScript语言功能，并提供了有关其性能的信息。在某些情况下，它解释了为什么一个特性过去是慢的，以及它是如何被加速的。</p><p>归根结底，以前由于曲轴的限制而无法优化的大多数功能现在都是新的编译器链的一等公民，不再阻止优化。</p><p>C++/JS的语言边界是双向的，这是昂贵的(特别是。从C++回调到JS)。</p><p>直接推送绑定接收器和绑定参数，然后调用目标函数，可以进一步优化编译时间，并允许将目标函数内联到调用器中。</p><p>因此，大量使用绑定的Reaction运行时的性能提高了一倍。</p><p>开发人员应该在任何地方自由地使用绑定函数，而不必担心性能损失</p><p>下面的两个代码片段执行相同的操作，但第二个代码片段可读性更好，而且对于arr.duce是唯一的传递方式，因为它不支持像forEach和map这样作为单独的参数传递它。</p><p>//将`this`作为单独的参数arr传入MAP。直接arr将`this`映射(Convert，this)//绑定到Convert函数。贴图(转换。绑定(此)。</p><p>这需要检查是否在每次为给定对象调用instanceof时都为其定义了@@hasInstance(99%的情况下不会定义)。</p><p>最初，只要没有添加覆盖(全局保护单元)，就会跳过该检查。</p><p>Js Writable类使用@@hasInstance，因此对instanceof~100倍产生了巨大的性能瓶颈，因为现在不再跳过检查。</p><p>通过避免依赖于涡轮风扇的全局保护单元，并允许内联实例码，这一性能瓶颈已被修复。</p><p>开发人员在通过@@hasInstance覆盖它的行为之前应该认真考虑，因为这个神奇的行为可能会让其他人感到困惑，但使用它不会导致性能损失。</p><p>Reflect.Apply和Reflect.Construction在V8 v6.1中获得了17倍的性能提升，因此在这一点上应该被视为性能良好</p><p>诸如MAP、For Each、Reduce、ReduceRight、Find、findIndex等数组内建函数可以内联到turbofan优化代码中，从而显著提高性能。</p><p>当涉及到与临时死区相关的检查时，Const有更多的开销，因为它没有被设置。</p><p>然而，const关键字还保证，一旦将值分配给它的槽，它就不会在将来更改。</p><p>因此，每次访问常量槽值插槽时，涡轮风扇都会跳过加载和检查这些插槽(功能上下文专门化)。</p><p>Const，像let一样，由于TDZ(临时死区)而增加了开销，因此在未经优化的代码中性能略有下降。</p><p>此外，根据语言规范，每个FORF都隐式地包装在TRY/CATCH块中，这阻止了它的优化，因为曲轴从未优化过包含TRY/CATCH语句的函数。</p><p>由于turbofan能够优化包含try/Catch语句的函数，现在完全优化成为可能。</p><p>Maps和Set都提供了forEach方法，该方法允许通过提供回调来迭代它的项</p><p>因此需要首先转换到C++，并处理转换回JavaScript所需的回调(开销很大)。</p><p>由于现在没有使用C++，这些函数可以通过turbofan进一步优化和内联。</p><p>每次调用For Each时都会创建新回调函数(不是针对每个项目，而是在教导时间运行该代码行)，这可能会导致它在非优化模式下运行。</p><p>最好将该调用替换为Object.prototype.hasOwnProperty.call(obj，prop)，因为这样更安全，并且避免了潜在的性能影响。</p><p>曲轴进行了两次优化，仅考虑了接收器上的快速特性，原型链不包含可枚举特性或其他特殊情况(如代理)。</p><p>常量折叠的Object.hasOwnProperty在可能的情况下调用内部为True，需要满足以下三个条件。</p><p>枚举缓存需要调整，以便turbofan知道何时可以安全地使用枚举缓存索引，以避免去优化循环(这也会影响曲轴)。</p><p>密钥累加器由支持有限For-In操作集的快速部分和支持所有复杂情况(如ES6代理)的慢速部分组成</p><p>For in加上Object.Prototype.hasOwnProperty.call(obj，prop)的正确使用，是迭代对象属性的一种非常快速的方式，因此应该用于以下情况。</p><p>纯对象子类化A类本身扩展对象{}是没有用的，因为B类{}将产生相同的结果，即使A类的构造函数与B类的构造函数具有不同的原型链。</p><p>在不需要基类的情况下，我们传递对象，如下例所示。</p><p>函数createClassBasedOn(BaseClass){返回类foo扩展BaseClass{}}类栏{}const JustFoo=createClassBasedOn(Object)const FooBar=createClassBasedOn(Bar)。</p><p>Turbofan检测对象构造函数用作基类的情况，并完全内联对象实例化。</p><p>如果没有特定的基类需要混合，并且对象是从类工厂传递来扩展的，那么类工厂不会产生任何额外的开销。</p><p>以TypedArray为参数调用Function.Prototype.Apply的速度加快了，这对String.FromCharCode的调用产生了积极影响。</p><p>只要有可能，就应该使用TyedArray，因为它允许V8比普通数组更快、更积极地应用优化</p><p>任何剩余的瓶颈都将尽快解决，因为TypeArray速度快是Webgl顺利运行的前提条件。</p><p>Object.is(v，-0)的一个用法是通过Object.is(v，-0)检查值是否为-0。</p><p>确保不修改RegExp实例或其原型，因为这会干扰应用于regex操作的优化。</p><p>V8中的原生承诺已经看到了巨大的性能改进，以及通过异步/等待使用它们。</p><p>V8公开了C++API，允许跟踪Node.js apit所使用的承诺生命周期，从而深入了解承诺的执行情况。</p><p>新的编译器链生成字节码，这些字节码将复杂的生成器控制流脱糖成更简单的本地控制流字节码。</p><p>这些生成的字节码很容易被Turbofan优化，而不需要了解任何关于发电机控制流的具体信息。</p><p>将C++位移植到CodeStubAssembler允许所有执行都发生在JavaScript运行时内部，导致运行时之间没有跳转</p><p>虽然使用代理确实会产生开销，但该开销已大幅降低，但在热代码路径中仍应避免</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/thlorenz/v8-perf/blob/master/language-features.md">https://github.com/thlorenz/v8-perf/blob/master/language-features.md</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/java/">#java</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/语言/">#语言</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/optimized/">#optimized</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/性能/">#性能</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1033316.html"><img src="http://img2.diglog.com/img/2020/11/thumb_21f8be35cef4397449ea9dd55e0aa657.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033316.html">Python取代Java成为第二大最受欢迎的编程语言</a></div><span class="my_story_list_date">2020-11-5 20:25</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032758.html"><img src="http://img2.diglog.com/img/2020/11/thumb_5284cf17db551895b1215de49c9ea500.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032758.html">Dojo3D-用于3D互动故事的简单JavaScript库</a></div><span class="my_story_list_date">2020-11-2 18:59</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032702.html"><img src="http://img2.diglog.com/img/2020/11/thumb_74f1ccfa4249fcc4f7e79edad2d58586.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032702.html">Go中常量的细微差别；Go不是JavaScript</a></div><span class="my_story_list_date">2020-11-2 9:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032572.html"><img src="http://img2.diglog.com/img/2020/11/thumb_9b2a7fcceee51585feb5628a787bccaa.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032572.html">打算停止在我的(JavaScript)代码中使用NULL</a></div><span class="my_story_list_date">2020-11-1 10:50</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>