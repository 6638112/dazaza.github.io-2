<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>政府机构的高级持续威胁妥协 Advanced Persistent Threat Compromise of Government Agencies</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Advanced Persistent Threat Compromise of Government Agencies<br/>政府机构的高级持续威胁妥协 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-18 16:00:53</div><div class="page_narrow text-break page_content"><p>CISA is aware of compromises, which began at least as early as March 2020, at U.S. government agencies, critical infrastructure entities, and private sector organizations by an APT actor. This threat actor has demonstrated sophistication and complex tradecraft in these intrusions. CISA expects that removing the threat actor from compromised environments will be highly complex and challenging. This adversary has demonstrated an ability to exploit software supply chains and shown significant knowledge of Windows networks. It is likely that the adversary has additional initial access vectors and tactics, techniques, and procedures (TTPs) that have not yet been discovered. CISA will continue to update this Alert and the corresponding indicators of compromise (IOCs) as new information becomes available.</p><p>CISA意识到至少在2020年3月就开始出现妥协，而APT参与者则在美国政府机构，关键基础设施实体和私营部门组织中达成了妥协。这位威胁行动者在这些入侵中表现出复杂性和复杂的技巧。 CISA期望从受威胁的环境中删除威胁因素将是非常复杂且具有挑战性的。该对手已经展示了开发软件供应链的能力，并且展示了Windows网络的丰富知识。对手可能还有尚未发现的其他初始访问媒介以及战术，技术和程序（TTP）。当有新信息可用时，CISA将继续更新此警报和相应的危害指标（IOC）。</p><p>  CISA is investigating incidents that exhibit adversary TTPs consistent with this activity, including some where victims either do not leverage SolarWinds Orion or where SolarWinds Orion was present but where there was no SolarWinds exploitation activity observed. Volexity has also reported publicly that they observed the APT using a secret key that the APT previously stole in order to generate a cookie to bypass the Duo multi-factor authentication protecting access to Outlook Web App (OWA).[ 1] Volexity attributes this intrusion to the same activity as the SolarWinds Orion supply chain compromise, and the TTPs are consistent between the two. This observation indicates that there are other initial access vectors beyond SolarWinds Orion, and there may still be others that are not yet known.</p><p>  CISA正在调查显示与该活动一致的敌对TTP的事件，包括一些受害者没有使用SolarWinds Orion或在有SolarWinds Orion的情况下但未观察到SolarWinds开采活动的事件。 Volexity还公开报告说，他们使用APT先前窃取的密钥来观察APT，以生成Cookie来绕过Duo多因素身份验证，从而保护对Outlook Web App（OWA）的访问。[1] Volexity将此入侵归因于与SolarWinds Orion供应链折衷的活动相同，并且两者之间的TTP保持一致。该观察结果表明，除了SolarWinds Orion之外，还有其他初始访问向量，并且可能还有其他未知的访问向量。</p><p>  SolarWinds Orion is an enterprise network management software suite that includes performance and application monitoring and network configuration management along with several different types of analyzing tools. SolarWinds Orion is used to monitor and manage on-premise and hosted infrastructures. To provide SolarWinds Orion with the necessary visibility into this diverse set of technologies, it is common for network administrators to configure SolarWinds Orion with pervasive privileges, making it a valuable target for adversary activity.</p><p>  SolarWinds Orion是一个企业网络管理软件套件，其中包括性能和应用程序监视以及网络配置管理以及几种不同类型的分析工具。 SolarWinds Orion用于监视和管理内部部署和托管基础结构。为了使SolarWinds Orion具有对这套多样化技术的必要可见性，网络管理员通常会以普遍的特权来配置SolarWinds Orion，使其成为攻击者活动的重要目标。</p><p> The threat actor has been observed leveraging a software supply chain compromise of SolarWinds Orion products[ 2] (see Appendix A). The adversary added a malicious version of the binary  solarwinds.orion.core.businesslayer.dll into the SolarWinds software lifecycle, which was then signed by the legitimate SolarWinds code signing certificate. This binary, once installed, calls out to a victim-specific  avsvmcloud[.]com domain using a protocol designed to mimic legitimate SolarWinds protocol traffic. After the initial check-in, the adversary can use the Domain Name System (DNS) response to selectively send back new domains or IP addresses for interactive command and control (C2) traffic. Consequently, entities that observe traffic from their SolarWinds Orion devices to  avsvmcloud[.]com should not immediately conclude that the adversary leveraged the SolarWinds Orion backdoor. Instead, additional investigation is needed into whether the SolarWinds Orion device engaged in further unexplained communications. If additional Canonical Name record (CNAME) resolutions associated with the  avsvmcloud[.]com domain are observed, possible additional adversary action leveraging the back door has occurred.</p><p> 已经观察到威胁参与者利用了SolarWinds Orion产品[2]的软件供应链漏洞（请参阅附录A）。攻击者在SolarWinds软件生命周期中添加了二进制文件solarwinds.orion.core.businesslayer.dll的恶意版本，然后使用合法的SolarWinds代码签名证书对其进行了签名。此二进制文件一经安装，便使用旨在模拟合法SolarWinds协议流量的协议调出特定于受害者的avsvmcloud [。] com域。初始签入后，对手可以使用域名系统（DNS）响应来有选择地发回新域或IP地址，以进行交互式命令和控制（C2）通信。因此，观察到从SolarWinds Orion设备到avsvmcloud [.com]的流量的实体不应立即得出结论，即对手利用了SolarWinds Orion后门。相反，需要进一步调查SolarWinds Orion设备是否参与了进一步的无法解释的通信。如果观察到与avsvmcloud [。] com域相关的其他规范名称记录（CNAME）解析，则可能发生了利用后门的其他对抗措施。</p><p> Based on coordinated actions by multiple private sector partners, as of December 15, 2020,  avsvmcloud[.]com resolves to  20.140.0[.]1, which is an IP address on the Microsoft blocklist. This negates any future use of the implants and would have caused communications with this domain to cease. In the case of infections where the attacker has already moved C2 past the initial beacon, infection will likely continue notwithstanding this action.</p><p> 根据多个私营部门合作伙伴的协调行动，截至2020年12月15日，avsvmcloud [。] com解析为20.140.0 [。] 1，这是Microsoft阻止列表上的IP地址。这否定了将来对植入物的任何使用，并会导致与此域的通信停止。对于感染，攻击者已经将C2移过初始信标的情况，尽管采取此措施，感染仍可能继续。</p><p> SolarWinds Orion typically leverages a significant number of highly privileged accounts and access to perform normal business functions. Successful compromise of one of these systems can therefore enable further action and privileges in any environment where these accounts are trusted.</p><p> SolarWinds Orion通常利用大量的高特权帐户和访问权限来执行正常的业务功能。因此，成功折衷这些系统之一可以在信任这些帐户的任何环境中启用进一步的操作和特权。</p><p>  The adversary is making extensive use of obfuscation to hide their C2 communications. The adversary is using virtual private servers (VPSs), often with IP addresses in the home country of the victim, for most communications to hide their activity among legitimate user traffic. The attackers also frequently rotate their “last mile” IP addresses to different endpoints to obscure their activity and avoid detection.</p><p>  对手正在广泛使用混淆来隐藏其C2通信。对手使用虚拟专用服务器（VPS）（通常在受害者的本国拥有IP地址）进行大多数通信，以将其活动隐藏在合法用户流量中。攻击者还经常将其“最后一英里” IP地址旋转到不同的端点，以掩盖其活动并避免被检测到。 </p><p> FireEye has reported that the adversary is using steganography ( Obfuscated Files or Information: Steganography [ T1027.003]) to obscure C2 communications.[ 3] This technique negates many common defensive capabilities in detecting the activity.  Note: CISA has not yet been able to independently confirm the adversary’s use of this technique.</p><p>FireEye报告说，对手正在使用隐写术（混淆文件或信息：隐写术[T1027.003]）来掩盖C2通信。[3]该技术在检测活动时否定了许多常见的防御功能。注意：CISA尚未能够独立确认对手是否使用了此技术。</p><p> According to FireEye, the malware also checks for a list of hard-coded IPv4 and IPv6 addresses—including RFC-reserved IPv4 and IPv6 IP—in an attempt to detect if the malware is executed in an analysis environment (e.g., a malware analysis sandbox); if so, the malware will stop further execution. Additionally, FireEye analysis identified that the backdoor implemented time threshold checks to ensure that there are unpredictable delays between C2 communication attempts, further frustrating traditional network-based analysis.</p><p> 根据FireEye的说法，该恶意软件还会检查硬编码的IPv4和IPv6地址列表（包括RFC保留的IPv4和IPv6 IP），以尝试检测该恶意软件是否在分析环境中执行（例如，恶意软件分析沙箱） ）;如果是这样，恶意软件将停止进一步执行。此外，FireEye分析确定后门实施了时间阈值检查，以确保C2通信尝试之间存在不可预测的延迟，从而进一步挫败了传统的基于网络的分析。</p><p> While not a full anti-forensic technique, the adversary is heavily leveraging compromised or spoofed tokens for accounts for lateral movement. This will frustrate commonly used detection techniques in many environments. Since valid, but unauthorized, security tokens and accounts are utilized, detecting this activity will require the maturity to identify actions that are outside of a user’s normal duties. For example, it is unlikely that an account associated with the HR department would need to access the cyber threat intelligence database.</p><p> 对手虽然不是一种完整的反取证技术，但却在很大程度上利用受侵害或欺骗的令牌来说明横向移动。这将挫败许多环境中常用的检测技术。由于使用了有效但未经授权的安全令牌和帐户，因此检测此活动将需要成熟度来识别超出用户正常职责范围的动作。例如，与人力资源部门关联的帐户不太可能需要访问网络威胁情报数据库。</p><p> Taken together, these observed techniques indicate an adversary who is skilled, stealthy with operational security, and is willing to expend significant resources to maintain covert presence.</p><p> 综上所述，这些观察到的技术表明了一个对手，该对手熟练，隐秘且具有操作安全性，并愿意花费大量资源来维持秘密存在。</p><p>  The adversary has been observed using multiple persistence mechanisms across a variety of intrusions. CISA has observed the threat actor adding authentication tokens and credentials to highly privileged Active Directory domain accounts as a persistence and escalation mechanism. In many instances, the tokens enable access to both on-premise and hosted resources. Microsoft has released a query that can help detect this activity.[ 4]</p><p>  使用跨多种入侵的多种持久性机制观察到了对手。 CISA观察到威胁行为者将身份验证令牌和凭据添加到高度特权的Active Directory域帐户，作为持久性和升级机制。在许多情况下，令牌使您能够访问内部资源和托管资源。 Microsoft已发布了一个查询，可以帮助检测此活动。[4]</p><p> Microsoft reported that the actor has added new federation trusts to existing infrastructure, a technique that CISA believes was utilized by a threat actor in an incident to which CISA has responded. Where this technique is used, it is possible that authentication can occur outside of an organization’s known infrastructure and may not be visible to the legitimate system owner. Microsoft has released a query to help identify this activity.[ 5]</p><p> 微软报告说，攻击者已向现有基础结构中添加了新的联合身份验证信任，CISA认为该技术已由威胁参与者在CISA响应的事件中使用。使用此技术的地方，身份验证有可能发生在组织的已知基础结构之外，并且可能对合法的系统所有者不可见。 Microsoft已发布查询以帮助识别此活动。[5]</p><p>  The adversary’s initial objectives, as understood today, appear to be to collect information from victim environments. One of the principal ways the adversary is accomplishing this objective is by compromising the Security Assertion Markup Language (SAML) signing certificate using their escalated Active Directory privileges. Once this is accomplished, the adversary creates unauthorized but valid tokens and presents them to services that trust SAML tokens from the environment. These tokens can then be used to access resources in hosted environments, such as email, for data exfiltration via authorized application programming interfaces (APIs).</p><p>  正如今天所了解的那样，对手的最初目标似乎是从受害者环境中收集信息。攻击者实现此目标的主要方法之一是使用其升级的Active Directory特权来破坏安全断言标记语言（SAML）签名证书。一旦完成此操作，对手就会创建未经授权但有效的令牌，并将其提供给信任来自环境的SAML令牌的服务。然后，这些令牌可用于访问托管环境（例如电子邮件）中的资源，以通过授权的应用程序编程接口（API）进行数据泄露。 </p><p> CISA has observed in its incident response work adversaries targeting email accounts belonging to key personnel, including IT and incident response personnel.</p><p>CISA在事件响应工作中观察到了针对主要人员（包括IT和事件响应人员）的电子邮件帐户的对手。</p><p>    The adversary is using a complex network of IP addresses to obscure their activity, which can result in a detection opportunity referred to as “impossible travel.” Impossible travel occurs when a user logs in from multiple IP addresses that are a significant geographic distance apart (i.e., a person could not realistically travel between the geographic locations of the two IP addresses during the time period between the logins).  Note: implementing this detection opportunity can result in false positives if legitimate users apply virtual private network (VPN) solutions before connecting into networks.</p><p>    攻击者正在使用IP地址的复杂网络来掩盖其活动，这可能会导致被称为“不可能的旅行”的发现机会。当用户从相距较大地理位置的多个IP地址登录时（即，在两次登录之间的时间段内，一个人实际上无法在两个IP地址的地理位置之间旅行），将发生不可能的旅行。注意：如果合法用户在连接到网络之前应用虚拟专用网（VPN）解决方案，则实施此检测机会可能会导致误报。</p><p>   Most organizations have SAML tokens with 1-hour validity periods. Long SAML token validity durations, such as 24 hours, could be unusual.</p><p>   大多数组织都有具有1小时有效期的SAML令牌。较长的SAML令牌有效期（例如24小时）可能是异常的。</p><p>  The SAML token contains different timestamps, including the time it was issued and the last time it was used. A token having the same timestamp for when it was issued and when it was used is not indicative of normal user behavior as users tend to use the token within a few seconds but not at the exact same time of issuance.</p><p>  SAML令牌包含不同的时间戳，包括其发出的时间和上次使用的时间。令牌的发行时间和使用时间具有相同的时间戳，并不表示正常的用户行为，因为用户倾向于在几秒钟内（而不是在发行的确切时间）使用令牌。</p><p>  A token that does not have an associated login with its user account within an hour of the token being generated also warrants investigation.</p><p>  在生成令牌后一小时内没有与其用户帐户相关联的登录信息的令牌也值得调查。</p><p>  Due to the nature of this pattern of adversary activity—and the targeting of key personnel, incident response staff, and IT email accounts—discussion of findings and mitigations should be considered very sensitive, and should be protected by operational security measures. An operational security plan needs to be developed and socialized, via out-of-band communications, to ensure all staff are aware of the applicable handling caveats.</p><p>  由于这种攻击活动模式的性质（以及主要人员，事件响应人员和IT电子邮件帐户的目标），对结果和缓解措施的讨论应被视为非常敏感，并应通过操作安全措施加以保护。需要通过带外通信来制定和实施运营安全计划，以确保所有员工都知道适用的处理警告。</p><p>  An outline of what “normal business” is acceptable to be conducted on the suspect network;</p><p>  概述在可疑网络上可以接受哪些“正常业务”； </p><p>  CISA assesses that the threat actor engaged in the activities described in this Alert uses the below-listed ATT&amp;CK techniques.</p><p>CISA评估从事此警报中描述的活动的威胁行为者使用下面列出的ATT＆amp; CK技术。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://us-cert.cisa.gov/ncas/alerts/aa20-352a">https://us-cert.cisa.gov/ncas/alerts/aa20-352a</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/威胁/">#威胁</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>