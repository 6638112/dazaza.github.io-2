<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Wikimedia正在迁移到GitLab</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Wikimedia正在迁移到GitLab</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-29 00:36:28</div><div class="page_narrow text-break page_content"><p>Jump to navigation  Jump to search  2020-10-23: The working group decided that migrating our code repositories from Gerrit to Gitlab is the right decision.  GitLab is a portal for more details.</p><p>跳转到导航跳转到搜索2020-10-23：工作组决定将我们的代码库从Gernt迁移到GitLab是正确的决定。GitLab是获取更多详细信息的门户。</p><p>  For the past two years, our  developer satisfaction survey has shown that there is some level of dissatisfaction with Gerrit, our code review system. This dissatisfaction is particularly evident for our volunteer communities. The evident dissatisfaction with code review, coupled with an internal review of our CI tooling and practice makes this an opportune moment to revisit our code review choices.</p><p>在过去的两年中，我们的开发人员满意度调查显示，人们对我们的代码审查系统Gernt存在一定程度的不满。这种不满对我们的志愿者社区尤为明显。对代码审查的明显不满，加上对我们的CI工具和实践的内部审查，使得现在是重新审视我们的代码审查选择的好时机。</p><p> While Gerrit’s workflow is in many respects best-in-class, its interface suffers from usability deficits, and its workflow differs from mainstream industry practices. This creates barriers to entry for the community and slows onboarding for WMF technical staff.In addition, there are a growing number of individuals and teams (both staff and non-staff) who are opting to forgo the use of Gerrit and instead use a third-party hosted option such as GitHub.Reasons vary for the choice to use third-party hosting but, based on informal communication, there are 3 main groupings:</p><p>虽然Gerrit的工作流程在很多方面都是同类中最好的，但它的界面存在可用性缺陷，而且它的工作流程不同于主流的行业实践。这为社区设置了进入障碍，并减缓了WMF技术人员的入职速度。此外，越来越多的个人和团队(包括员工和非员工)选择放弃使用Gernt，转而使用第三方托管选项(如GitHub)。选择使用第三方托管的原因各不相同，但根据非正式交流，主要分为3组：</p><p>  All these explanations point to friction in our existing code-review system slowing development rather than fostering it.The choice to use third-party code-hosting hurts our collaboration (both internal and external), adds to the confusion of onboarding, and makes it more difficult to maintain code standards across repositories. At the same time, there is a  requirement that all software which is deployed to Wikimedia production is hosted and deployed from Gerrit.</p><p>所有这些解释都指向我们现有的代码审查系统中的摩擦，它不仅没有促进开发，反而减缓了开发。选择使用第三方代码托管损害了我们的协作(内部和外部)，增加了入职的混乱，并使跨存储库维护代码标准变得更加困难。同时，还要求部署到Wikimedia Production的所有软件都是从Gernt托管和部署的。</p><p> If we fail to address the real usability problems that users have with Gerrit, people will continue to launch and build projects on whatever system it is they prefer—Wikimedia&#39;s GitHub already contains  152 projects , the Research team has  127 projects.</p><p>如果我们不能解决用户在Gernt上遇到的真正的可用性问题，人们将继续在他们喜欢的任何系统上启动和构建项目--维基媒体的GitHub已经包含152个项目，研究团队有127个项目。</p><p>  This raises the question: if Gerrit has identifiable problems, why can&#39;t we solve those problems  in Gerrit? Gerrit is open source (Apache licensed) software; modifications are a simple matter of programming.</p><p>这就提出了一个问题：如果格瑞特有可识别的问题，为什么我们不能用格瑞特解决这些问题呢？GERRIT是开放源码(Apache许可)软件；修改很简单，只需编程即可。</p><p> We are unique in the community of Gerrit users which include large companies such as SAP, Ericsson, Qualcomm, and Google. Google, in particular, is singular in their use of Gerrit for projects like Android and Chromium. To support these large, open projects multi-site capabilities are needed; however, much of that work is either closed-source or  does not support multi-site writes.</p><p>我们在GERRIT用户社区中是独一无二的，其中包括SAP、爱立信、高通和谷歌等大公司。特别是谷歌，他们在Android和Chromium等项目中使用Gernt是独一无二的。要支持这些大型开放项目，需要多站点功能；然而，这些工作中的大部分要么是闭源的，要么不支持多站点写入。</p><p> Upstream has improved the UI in recent releases, and releases have become more frequent; however, upgrade path documentation is often lacking. The migration from Gerrit 2 to Gerrit 3, for example, required several  upstream patchsets to avoid the recommended path of several days of downtime. This is the effort required to maintain the status quo. Even small improvements require effort and  time as, often, our use-case is very different from the remainder of the Gerrit community.</p><p>Upstream在最近的版本中改进了UI，并且版本变得更加频繁；但是，通常缺少升级路径文档。例如，从Gerrit2到Gerrit3的迁移需要几个上游补丁程序集来避免建议的几天停机时间。这是维持现状所需的努力。即使是很小的改进也需要努力和时间，因为我们的用例通常与Gernt社区的其余部分非常不同。</p><p>   GitLab is a capable and scalable code review system written in Ruby. GitLab is available for self-hosting, as required for parity with the rest of our development tooling infrastructure and to alleviate concerns about data privacy or usage restrictions of third-party hosting.As GitLab offers an MIT licensed community edition (CE), it adheres to the Foundation&#39;s guiding principle of  Freedom and open source.</p><p>GitLab是一个用Ruby编写的功能强大且可伸缩的代码审查系统。GitLab可用于自托管，以与我们的其他开发工具基础设施平起平坐，并缓解对数据隐私或第三方托管的使用限制的担忧。由于GitLab提供麻省理工学院许可的社区版(CE)，因此它遵循基金会的自由和开源指导原则。</p><p> Finally, GitLab was evaluated as part of the Release Engineering team&#39;s Continuous Integration working group. While GitLab&#39;s continuous integration systems were found to be adequate for our needs, code review was out of scope for the charter of that working group. Therefore GitLab&#39;s capabilities were weighed against the likelihood of introducing social friction and added complexity—integrating GitLab&#39;s CI with Gerrit.Replacing Gerrit with GitLab would significantly change the equation of our CI tooling—allowing us to use an industry-standard workflow and self-serve CI tooling built into GitLab.For these reasons we&#39;d like to limit the scope of this discussion to evaluation of whether it’s feasible and advisable to move from Gerrit to GitLab for code review.Things within scope include: code review workflows and processes; tools and bots involved in the code review process; merge, branch, and deployment strategies; as well as unforeseen blockers to adopting a new code review system within our technical community.For the avoidance of doubt, continuous integration (CI) and task/project tracking are out of scope of this evaluation.</p><p>最后，GitLab作为发布工程团队持续集成工作组的一部分进行了评估。虽然GitLab的持续集成系统被发现足以满足我们的需求，但代码审查超出了该工作组章程的范围。因此，将GitLab的能力与引入社会摩擦和增加复杂性的可能性进行了权衡-将GitLab的CI与Gerrit相集成。用GitLab取代Gernt将显著改变我们的CI工具的方程式-允许我们使用GitLab中内置的行业标准工作流和自助式CI工具。出于这些原因，我们希望将本讨论的范围限制为评估从GitLab迁移到GitLab进行代码审查是否可行和可取。范围内的内容包括：代码审查工作流和流程；代码审查过程中涉及的工具和机器人；合并、分支和部署策略；为避免产生疑问，持续集成(CI)和任务/项目跟踪不在此评估范围之内。</p><p>  A few useful terms and definitions for the comparison of GitLab and Gerrit code review:</p><p>以下是一些用于比较GitLab和GERRIT代码审查的有用术语和定义：</p><p>   The method of integration in Gerrit. A single commit under review. It is very common to amend a commit during the code review process.   [3]</p><p>格瑞特语言中的积分方法。正在审查的单一提交。在代码评审过程中修改提交是非常常见的。[3]。</p><p> The method of integration in GitLab. A request to merge one branch into another.   [4]</p><p>GitLab中的集成方法。将一个分支合并到另一个分支的请求。[4]。</p><p> Put all work for a feature on its own branch, integrate into mainline when the feature is complete.   [5] These branches are often short-lived.   [6]</p><p>将一个功能的所有工作放在它自己的分支上，当功能完成时集成到主线中。[5]这些分支通常是短暂的。[6]。</p><p> Developers do mainline integration as soon as they have a healthy commit they can share.   [7]</p><p>开发人员一旦拥有了可以共享的健康承诺，就会立即进行主线集成。[7]。</p><p>             Broader Wikimedia movement (via the consultation’s talk page, mailing list messages to wikitech-l@ and wikitech-ambassadors@, and the TechNews newsletter)</p><p>更广泛的维基媒体运动(通过咨询的讨论页面、给wikitech-l@和wikitech-amesadors@的邮件列表信息，以及Technews时事通讯)</p><p>  The Working Group is responsible for engaging with the discussion, surfacing and weighting feedback from consulted groups, providing recommendations, and directly informing the outcome of the consultation.Members of the Working Group:</p><p>工作小组负责参与讨论、整理和权衡各谘询小组的意见、提供建议，以及直接告知谘询结果。工作小组成员如下：</p><p>   Communication between the various groups involved in this consultation will be important to achieving an equitable outcome of this process.</p><p>参与这次协商的各团体之间的沟通对于实现这一进程的公平结果非常重要。</p><p>  Announcements will be made on Wiki, via mailing lists, and via the TechNews newsletter. It will be announced when each stage of the process outlined below begins and ends. Additionally, a summary of feedback will be amalgamated at the end of the entire consultation process.</p><p>公告将在Wiki上、通过邮件列表和通过Technews时事通讯发布。以下概述的进程的每个阶段开始和结束时将宣布。此外，在整个咨询过程结束时，将合并反馈意见的摘要。</p><p>  Feedback will be solicited on Wiki, via mailing lists, and via TechNews.  Feedback will be collected for the duration of the consultation period via on-wiki talk pages.Members of the working group will strive to engage in discussions that happen on-wiki during the consultation period.At the end of the entire process a summary of the feedback collected during the consultation will be shared.</p><p>反馈将在维基上、通过邮件列表和通过技术新闻征求。在咨询期内将通过维基讨论页面收集反馈。工作组成员将努力参与咨询期内在维基上进行的讨论。在整个过程结束时，将分享在咨询期间收集的反馈摘要。</p><p>  As this decision has secondary effects on our continuous integration system, which is also planned to be replaced in the near future, we hope to follow the below timeline:</p><p>由于这一决定对我们的持续集成系统有次要影响，该系统也计划在不久的将来更换，我们希望遵循以下时间表：</p><p>   A test instance of GitLab, hosted on Wikimedia Cloud Services infrastructure, is available at:  https://gitlab-test.wmcloud.org/</p><p>托管在维基媒体云服务基础设施上的GitLab的测试实例可在以下网址获得：https://gitlab-test.wmcloud.org/。</p><p> Note: This is a test instance only. Any data should be expected to be lost. Do not reuse any passwords when registering. For bugs or configuration / feature requests while using the test instance, please file tasks in Phabricator using the  GitLab-Test project.</p><p>注意：这只是一个测试实例。任何数据都应该预料到会丢失。注册时不要重复使用任何密码。对于使用测试实例时的bug或配置/功能请求，请使用GitLab-Test项目在Phabricator中归档任务。</p><p>  The Wikimedia technical community has many workflows and participants from all over the world with differing levels of technical knowledge and expertise. To arrive at an equitable decision concerning the adoption of GitLab there&#39;s a need to weigh valid concerns against the longevity of the technical projects that the community stewards while also considering the needs of all contributors.These are the considerations that will be used in the evaluation. The evaluation will be completed by the members of the Working Group initially and shared during the consultation period.Topics of discussion include:</p><p>Wikimedia技术社区有来自世界各地的许多工作流程和参与者，他们拥有不同水平的技术知识和专业知识。为了就采用GitLab做出公平的决定，有必要权衡合理的担忧与社区管理的技术项目的持久性，同时也要考虑所有贡献者的需求。这些都是评估中将使用的考虑因素。评估工作将由工作小组成员初步完成，并在谘询期内分享。讨论的议题包括：</p><p>       Would we use GitLab Enterprise or Community Edition? Community Edition (CE). It is the Free Software-only release of GitLab. This is similar to other Free Software/Culture groups who use GitLab, for example:  Debian,  GNOME, and  KDE.</p><p>我们会使用GitLab企业版还是社区版？社区版(CE)。它是GitLab的免费软件专用版本。这类似于其他使用GitLab的自由软件/文化团体，例如：Debian、GNOME和KDE。</p><p> Why is Continuous Integration (CI) out of scope? CI is out of scope because that infrastructure is secondary to code review. In other words, ideally the details of how CI is set up and maintained are not important to developers on a day to day basis.</p><p>为什么持续集成(CI)超出范围？CI超出了范围，因为该基础设施是代码审查的次要部分。换句话说，理想情况下，CI如何设置和维护的细节对于开发人员日常来说并不重要。</p><p> Why is GitHub not considered? GitHub would be the first tool required to participate in the Wikimedia technical community that would be non Free Software and non self-hosted.</p><p>为什么不考虑GitHub？GitHub将是加入维基媒体技术社区所需的第一个工具，该社区将是非自由软件和非自托管的。</p><p> GitHub also does not meet all of our needs; for example, GitHub grants little control of metadata, no influence over privacy policy/data retention, sanctions and bans, little control over backups and data integrity checks, and no long-term guaranteed access to underlying repository settings and configuration.</p><p>GitHub也不能满足我们所有的需求；例如，GitHub对元数据几乎没有控制，对隐私策略/数据保留、制裁和禁止几乎没有影响，对备份和数据完整性检查几乎没有控制，并且没有对底层存储库设置和配置的长期保证访问权限。</p><p> What happens to repositories developed on GitHub if we move to GitLab? Given that GitLab provides a very similar workflow and feature set, we will strongly encourage all developers to use GitLab instead of GitHub for all development. Repositories will still be mirrored to GitHub, for visibility purposes.</p><p>如果我们迁移到GitLab，在GitHub上开发的存储库会发生什么情况？鉴于GitLab提供了非常相似的工作流程和功能集，我们强烈建议所有开发人员使用GitLab而不是GitHub进行所有开发。出于可见性的目的，存储库仍将镜像到GitHub。</p><p> What about using other GitLab built in features like Issues, Wikis, Pages, etc if we decide to use GitLab for code review? This consultation is focused only on code review, not issue tracking or replacing other functionalities already provided to Wikimedia developers. To pre-empt a segmentation in our issue tracking we would turn off issue tracking on GitLab. In addition we would turn off repository wikis,  GitLab Pages, and other features overlapping with currently provided tooling.</p><p>如果我们决定使用GitLab进行代码审查，那么使用GitLab内置的其他功能(如问题、Wiki、页面等)会怎么样？这次咨询只关注代码审查，而不是问题跟踪或替换已经提供给Wikimedia开发人员的其他功能。为了在问题跟踪中先发制人，我们可以在GitLab上关闭问题跟踪。此外，我们将关闭存储库wiki、GitLab页面和其他与当前提供的工具重叠的功能。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.mediawiki.org/wiki/GitLab_consultation#Outcome">https://www.mediawiki.org/wiki/GitLab_consultation#Outcome</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/moving/">#moving</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/gitlab/">#gitlab</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>