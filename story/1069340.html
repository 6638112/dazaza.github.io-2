<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>激活前任何人都可以使用 Pay-to-Taproot 输出</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">激活前任何人都可以使用 Pay-to-Taproot 输出</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-07-24 07:17:01</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/7/1fb89afefe117b7e27bc907c3544c11c.png"><img src="http://img2.diglog.com/img/2021/7/1fb89afefe117b7e27bc907c3544c11c.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>在致力于对 transactionfee.info 的主根支持进行工作时，很明显主网上已经存在一些 Pay-to-Taproot (P2TR) 输出。任何人都可以使用这些输出，但它们是非标准的，因此无法在比特币中的节点之间进行中继点对点网络。但是，矿池可以在其区块中包含非标准交易。我们涵盖了主网上已经存在的六个 P2TR 输出，并解释了为什么任何人都可以在主根激活之前使用这些输出。在 f2pool.com 矿池的帮助下，四个 P2TR 输出被捐赠给 brink.dev，一家专注于支持开源比特币开发的非营利公司。 Taproot 是对比特币协议的软分叉升级，并收紧了共识规则。软分叉一旦激活就会禁止之前允许的东西。 Taproot 限制了原生 SegWit 输出的使用方式，witnessversion 为 1 和一个 32 字节的见证程序。其他见证版本、嵌套隔离见证和原生隔离见证输出的支出规则，其见证版本为 1，但更长或更短的见证程序不受影响。虽然可以在主根激活之前创建 P2TR 输出，但不建议这样做。同样，钱包不应该在激活前生成 P2TR 地址。尽管如此，在撰写本文时，比特币主网上已经有六个 P2TR 输出。第一个 P2TR 输出是在 2019 年 12 月 17 日在来自 purse.io 的提款交易中创建的。 Matthew Zipkin 向见证版本 1 bech32 地址发起了 5431 sat 的提款，以测试发送对见证版本 1 的支持。他将他的测试结果添加到比特币 OptechCompatibility Matrix 中，并提供了一张显示在 thepurse.io 前端提款的屏幕截图。地址中编码的公钥是 010 10101 01010101 010 101010101010 10 10 101010101 0101010101 0 101010 101，这很可能不是由私钥生成的。假设这个公钥的私钥是未知的，一旦主根激活，资金将无法使用。第二个 P2TR 输出创建于 2020 年 1 月 28 日。值为 700sat，接近默认的 SegWit 灰尘阈值 294 sat。此输出的创建者未知。第三个、第四个和第五个 P2TR 输出是在检查发送支持到 Pieter Wuille 于 2020 年 10 月 19 日发布到比特币开发邮件列表的见证 v1 bech32 地址时创建的测试输出。第三个 P2TR 输出的值为 3656 sat 和由 Riccardo Casatta 使用 Blockstream Aqua 钱包创建。价值 50.000 sat 的第四个 P2TR 输出很可能是 Mike Schmidt 使用 BRD 钱包创建的。不知道是谁创建了第五个 P2TR 输出，值为 100.000 sat。第六个 P2TR 输出，值为 1324 sat，创建于 2021 年 7 月 7 日。它是在 2021 年 6 月 13 日锁定主根后创建的唯一 P2TR 输出。其他 P2TR 输出是在尚不清楚主根何时或是否会被创建时创建的启用。</p><p>在主根激活之前，任何人都可以使用这六个 P2TR 输出。然而，这些 P2TR 输出还没有被花费，因为支出交易目前被认为是非标准的。非标准交易不会在比特币网络上中继。在接受交易到内存池之前，比特币核心会在 AreInputsStandard 函数中检查每个输入的标准性。如果花费的 UTXO 是 P2TR 输出，则该函数当前返回 false，表明交易具有非标准输入。节点不接受对其内存池的交易，并且不会将其转发给对等方。但是，当直接包含在一个区块中时，非标准交易仍然有效。在其他检查旁边，交易必须通过脚本验证。不检查标准。在 Bitcoin Core 中，VerifyScript 函数负责脚本验证。 SegWit 花费的脚本验证包括两部分：脚本评估和见证程序的验证。在脚本评估期间，首先评估 scriptSig。在从输入中引用的 UTXO 评估 scriptPubKey 时，结果堆栈用作初始堆栈状态。如果脚本评估完成且没有失败，堆栈不为空，并且堆栈顶部元素转换为真（不为零），则脚本评估成功。当使用原生 SegWit 输出（例如 P2TRoutputs）时，scriptSig 为空。 scriptPubKey 包含witnessversion 和witness 程序。由于 scriptSig 为空，因此使用空堆栈进行 scriptPubKey 评估。在那里，见证版本和见证程序被压入堆栈。脚本评估完成。由于堆栈不为空并且堆栈顶部元素是见证程序（通常不为零），脚本评估将成功。这种行为使 SegWit 成为软分叉。隔离见证交易对不支持隔离见证的节点有效，因为栈顶元素不为空。一旦主根激活，关键路径 P2TR 支出将是有效和标准的。任何人都可以支出的 P2TR 支出可能有一个空的见证人，但其他方面看起来是一样的。下一步，如果见证版本已知，则验证见证程序。如果见证版本未知，则将见证程序视为有效 1.在验证版本 1 见证程序期间（即当花费 P2TR 输出时）的第一个检查) 是如果设置了 SCRIPT_VERIFY_TAPROOT 脚本验证标志。如果未设置，则在检查见证程序之前验证成功。此标志仅在主根处于活动状态时设置。这导致主根输出在激活之前是任何人都可以使用的。见证程序未经过验证，见证可以留空。我们通过构建一个共识有效的非标准交易来证明在主根软分叉激活之前 P2TR 输出的支出。矿池 f2pool.com 通过在区块中包含非标准交易来提供帮助。对于我们的交易，我们从前面讨论的六个可用输出中选择第一个、第三个、第四个和第五个 P2TR 输出。值为 5.431 sat 的第一个输出在主根激活时将无法使用，否则将永远保留在 UTXO 集中。第三个（3.656 sat）、第四个（50.000 sat）和第五个（100.000 sat）P2TR 输出在测试交易中发送，知道资金很可能会丢失或捐赠给慈善机构。这使我们总共可以花费 159.087 sat。我们将另外两个 P2TR 输出（700 sat 和 1.324 sat）留给其他人在激活之前或之后使用。</p><p>我们的交易包含两个输出。第一个输出将全部输入量 159.087 sat（在撰写本文时约为 50 美元）捐赠给 brink.dev，以支持开源比特币开发。交易故意不支付矿工费以最大化捐赠金额。第二个输出是一个 OP_RETURN 输出，带有指向此博客文章的链接。这使得找到任何人都可以花费的交易的人有可能更多地了解为什么在 Taproot 激活之前 P2TR 输出是可以花费的。 { “TxID添加”： “b10c007c60e14f9d087e0291d4d0c7869697c6681d979c6639dbd960792b4d41”， “散列”： “b10c007c60e14f9d087e0291d4d0c7869697c6681d979c6639dbd960792b4d41”， “版本”：1， “大小”：234， “VSIZE”：234， “重量”：936， “LOCKTIME”：45324， “VIN” : [ { &quot;txid&quot; : &quot;b53e3bc5edbb41b34a963ecf67eb045266cf841cab73a780940ce6845377f141&quot;, &quot;vout&quot; : 0, &quot;scriptSig&quot; : { &quot;asm,&quot; 7&quot;, &quot;16&quot;, &quot;16&quot;, &quot;7&quot;, &quot;4 b48a59fa9e036e997ba733904f631b1a64f5274be646698e49fd542141ca9404&quot; ， “VOUT”：0 “scriptSig”：{ “ASM”： “”， “六角”： “”}， “序列”：45324}，{ “TxID添加”： “7641c08f4bd299abfef26dcc6b477938f4a6c2eed2f224d1f5c1c86b4e09739d”， “VOUT”：1 , &quot;scriptSig&quot; : { &quot;asm&quot; : &quot;&quot; , &quot;hex&quot; : &quot;&quot; }, &quot;sequence&quot; : 45324 }, { &quot;txid&quot; : &quot;fd43650477e0ba6825ae0482a8b0b2b509d5443fa2a87127s&quot;{ig2a87271ds&quot;,scripta87s, dd0as &quot;, sig2a87271d&quot; &quot; : &quot;&quot; , &quot;hex&quot; : &quot;&quot; }, &quot;sequence&quot; : 45324 }], &quot;vout&quot; : [ { &quot;value&quot; : 0.00159087, &quot;n&quot; : 0, &quot;scriptPubKey&quot; : { &quot;asm&quot; : &quot;OP_HASH160 fb94f9a556bae3f98f44186e1c caa4f5ff6a3187 OP_EQUAL”， “六角”： “a914fb94f9a556bae3f98f44186e1ccaa4f5ff6a318787”， “reqSigs”：1， “类型”： “scripthash”， “地址”：[ “3QdFzfpU3u92GeRN4U5pLLezbBaHbj2ppr”]}}，{ “值”：0.00000000中， “n”：1 “scriptPubKey”：{ “ASM”： “OP_RETURN 68747470733a2f2f623130632e6d652f37”， “六角”： “6a1168747470733a2f2f623130632e6d652f37”， “类型”： “nulldata”}}]}当在块709632直根激活，比特币核心v0.21.1和newerwill开始执行主根规则。只有通过为密钥路径花费提供有效签名或满足脚本路径花费的脚本要求，才有可能花费 P2TR。但是，不知道主根软分叉的旧节点将继续将 P2TR 花费视为任何人都可以花费。例如，如果矿池忘记升级并包含来自 P2TR 输出的交易支出，而没有满足网络强制执行的主根规则，这可能会成为一个问题。链将在执行主根的升级节点和未升级节点之间分裂。建议在激活主根之前升级生产和支付处理节点。我要感谢 f2pool.com 的合作。如果没有他们在一个区块中包含非标准交易，将 P2TR 输出捐赠给 brink.dev，将是不可能的。这允许通过未来的软分叉向当前未使用的见证版本引入新规则。见证程序验证在不知道软分叉的节点上成功。 ↩︎</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://b10c.me/blog/007-spending-p2tr-pre-activation/">https://b10c.me/blog/007-spending-p2tr-pre-activation/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/pay/">#pay</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/输出/">#输出</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1067718.html"><img src="http://img2.diglog.com/img/2021/6/thumb_7e7ce68a68f74b570ad195b6947ce60d.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1067718.html">Patreon不支付苹果的30％App Store委员会，其CEO不确定为什么 </a></div><span class="my_story_list_date">2021-6-23 22:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1067346.html"><img src="http://img2.diglog.com/img/2021/6/thumb_0c5a322b1b4f91bdcca3ff5e7dfcb147.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1067346.html">CA偿还在Covid期间累计的所有过去的租金，给租房者清洁石板 </a></div><span class="my_story_list_date">2021-6-22 11:40</span></div><div class="col-sm"><div><a target="_blank" href="/story/1067296.html"><img src="http://img2.diglog.com/img/2021/6/thumb_6b8de5bc2836042024ccee878a1f38e9.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1067296.html">加州在Covid-19大流行期间偿还了累积的无偿租金 </a></div><span class="my_story_list_date">2021-6-22 5:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/1067201.html"><img src="http://img2.diglog.com/img/2021/6/thumb_0335dd6815ad44044c124d4120f0fa8c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1067201.html">立即购买，付款后来启动Kredivo将其债务工业从胜利公园资本增加到200米 </a></div><span class="my_story_list_date">2021-6-21 21:30</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>