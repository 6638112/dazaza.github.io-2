<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>缓解AWS中断的架构 Architectures for Mitigating AWS Outages</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Architectures for Mitigating AWS Outages<br/>缓解AWS中断的架构 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-04 22:50:59</div><div class="page_narrow text-break page_content"><p>With the recent outage on AWS last week, there have been a lot of discussions about various architectures and how effective they would&#39;ve been to combat the downtime. Since these vary a lot in cost, complexity, and tradeoffs, I want to go through a couple of them at a high level, then dive into one that was unfortunately missing from much of the conversation.</p><p>上周，随着AWS最近的停运，人们对各种架构及其在应对停机方面的有效性进行了大量讨论。由于这些方法在成本，复杂性和权衡方面存在很大差异，因此我想在较高层次上进行研究，然后再深入探讨其中不幸的是很多对话中都缺少的一种方法。</p><p>  First were comments made about the value of going multi-cloud. The idea of this is to run your application in… multiple clouds. By spreading the load across multiple providers, you are insulated in case one of them goes down. In theory, it sounds great! Surely two cloud vendors won&#39;t go down at the same time! In practice, this is horrible at the application level for a multitude of reasons:</p><p>  首先是有关多云的价值的评论。这样的想法是在…多个云中运行您的应用程序。通过将负载分散到多个提供程序中，可以避免其中之一发生故障。理论上，这听起来很棒！当然，两个云供应商不会同时崩溃！实际上，由于多种原因，这在应用程序级别上是可怕的：</p><p>  Because of this, a multi-cloud architecture would not be a feasible option for high availability (outside a select few edge cases).</p><p>  因此，对于高可用性（在少数几个极端情况之外），多云架构将不是可行的选择。</p><p>  Next, there were talks about multi-region. An AWS Region is a group of multiple availability zones (AZ), with each AZ being one or more discrete data centers with independent power, networking, and connectivity. Operating in a single region across multiple AZs provides high availability, but doesn&#39;t provide DR. For that, you need multiple regions. A very simplified version of a multi-region setup looks like this: This fixes a couple of the issues of going multi-cloud:</p><p>  接下来，有关于多区域的讨论。 AWS区域是一组多个可用区（AZ），每个可用区是一个或多个具有独立电源，网络和连接性的离散数据中心。在多个可用区中的单个区域中操作可提供高可用性，但不提供灾难恢复。为此，您需要多个区域。一个多区域设置的非常简化的版本如下所示：这解决了使用多云的几个问题：</p><p> Your application will stay in the same cloud, so the infrastructure will stay the same</p><p> 您的应用程序将保留在同一云中，因此基础架构将保持不变</p><p> Unfortunately, most of the comments were around  Active-Active multi-region. That is, distributing the load across multiple regions at the same time. This adds in a lot of complexities around keeping the persistence layer in sync. This also adds complexity around deployments and has a lot of places for things to go wrong. This can lead to more self-inflicted downtime than AWS has ever caused.</p><p> 不幸的是，大多数评论都围绕Active-Active多区域。即，将负载同时分布在多个区域中。使持久层保持同步会增加很多复杂性。这也增加了部署的复杂性，并且有很多地方出错。与AWS相比，这可能导致更多的自我停机时间。</p><p>  This is the one that has been largely overlooked in recent days. It is the idea that only a single region is active at a time, and a secondary region is capable of taking over in the event of a disaster (hence DR). This shares the benefits listed above. However, it is able to largely mitigate the complexities of a full Active-Active setup. Under this setup, the secondary region doesn&#39;t need to be fully built - only persistent data needs to be replicated.</p><p>  这是最近几天被大大忽略的一种。这种想法是一次仅激活一个区域，而在发生灾难时辅助区域可以接管（因此称为DR）。这具有上述好处。但是，它能够在很大程度上缓解整个Active-Active设置的复杂性。在这种设置下，不需要完全构建辅助区域-仅需要复制持久数据。 </p><p>  But wait, won&#39;t it take a while to deploy the full application stack in the event of a disaster? Yes… yes it will. And this is okay! High-Availability is achieved by using multiple AZs is sufficient for most common outages. If an entire  region has issues, like we saw last week, spending &lt;1 hour standing up a new stack from backups is still preferable to a &gt;8 hour outage. This process can be streamlined via automation, but even if it&#39;s a manual (but practiced) operation, the fact that you  actually have options is important.</p><p>但是，等等，如果发生灾难，部署整个应用程序堆栈是否需要花费一些时间？是的，是的。这没关系！通过使用多个可用区来实现高可用性，足以应对大多数常见的停机情况。如果整个区域都有问题，如我们上周看到的那样，从备份中建立新堆栈的时间少于＆lt; 1小时，则要比＆gt; 8小时停机更可取。可以通过自动化来简化此过程，但是即使它是手动（但已实践）的操作，您实际上也有选择的事实很重要。</p><p>  Using AWS managed services, backups and replication for persistent data is generally a configuration setting or two away:</p><p>  使用AWS托管服务，持久性数据的备份和复制通常是一两个配置设置：</p><p> In the event of a fail-over, deploy the application in the other region (hopefully using Infrastructure-as-Code) and update DNS settings</p><p> 如果发生故障转移，请在其他区域中部署应用程序（希望使用“基础结构即代码”）并更新DNS设置</p><p> Is this a silver-bullet? Absolutely not. It won&#39;t work for every workload, and definitely won&#39;t work for every type of outage. However, it is a relatively simple solution that can also be cost effective. And last week, it could&#39;ve allowed clients to be back up and functioning long before services in us-east-1 were fully restored.</p><p> 这是银子弹吗？绝对不。它不会对每种工作负载都起作用，并且绝对不会对每种类型的中断都起作用。但是，这是一个相对简单的解决方案，也可以节省成本。上周，它可以允许客户端备份并正常运行us-east-1中的服务。</p><p>  In conclusion, outages happen. This does not diminish the value of AWS in any way, but it does make clear the importance of good architecture and planning. There are some very expensive and elaborate systems that can be designed to mitigate these outages, but which are overkill and impractical for most clients. Fortunately, there are other options that may offer an “effective enough” solution with reasonable tradeoffs, which should become “best-practice” when working in AWS.</p><p>  总之，发生中断。这不会以任何方式降低AWS的价值，但确实表明了良好架构和计划的重要性。可以设计一些非常昂贵和精巧的系统来减轻这些故障，但是对于大多数客户而言，它们是过大且不切实际的。幸运的是，还有其他选择可以提供具有合理权衡的“足够有效”的解决方案，当在AWS中工作时，这些选择应成为“最佳实践”。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.forelse.io/posts/architectures-for-mitigating-aws-outages/">https://www.forelse.io/posts/architectures-for-mitigating-aws-outages/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/aws/">#aws</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>