<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>开源，不开放贡献 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">开源，不开放贡献 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-28 22:25:59</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/1/eeb101b4d5e6b3a1af91d22e717d237f.jpeg"><img src="http://img2.diglog.com/img/2021/1/eeb101b4d5e6b3a1af91d22e717d237f.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Litestream是用于SQLite的独立流复制工具。它作为后台进程运行，并安全地将更改增量复制到另一个文件或S3。 Litestream仅通过SQLite API与SQLite通信，因此它不会破坏您的数据库。</p><p> 如果您需要支持或有关于改进Litestream的想法，请访问GitHub Discussions聊天。</p><p>       您可以从“发行版”页面下载.deb文件，然后运行以下命令：</p><p>     您也可以从发行版页面下载系统的发行版二进制文件，并将其作为独立的应用程序运行。</p><p>      Litestream提供了一个可用于生产部署的配置文件，但您也可以在试用时在命令行上指定单个数据库和副本。</p><p> 首先，您需要创建一个S3存储桶，我们将其称为“ mybkt＆＃34;在这个例子中。您还需要设置您的AWS凭证：</p><p>  接下来，可以使用要备份的数据库的路径和副本目标的URL来运行litestreamplicat命令。 </p><p>如果您对本地数据库进行更改，则这些更改将每10秒复制到S3。在另一个终端窗口中，您可以从S3副本还原数据库：</p><p>   您的数据库应还原到发送到S3的最后一个复制状态。您可以使用下面指定的基于配置的方法来调整复制频率和其他选项。</p><p>  基于配置的安装为您提供了更多复制选项。默认情况下，配置文件位于/etc/litestream.yml中，但是您可以使用-config PATH标志将路径传递给任何litestream命令。您还可以设置LITESTREAM_CONFIG环境变量以指定新路径。</p><p> 该配置指定一个或多个数据库以及每个数据库的一个或多个副本位置的列表。以下是一些常见的配置：</p><p>  这会将/ path / to / db中的数据库复制到＆＃34; / db＆＃34;中。 S3存储桶中名为＆＃34; mybkt＆＃34;的路径。</p><p>      默认情况下，副本将保留快照＆amp;随后的24小时WAL更改。当快照寿命超过保留阈值时，将拍摄并上传新快照，并删除先前的快照和WAL文件。</p><p> 您可以按副本配置此设置。时间是使用Go持续时间解析的，因此允许使用小时（h），分钟（m）和秒（s）的时间单位，但不允许使用天，周，月和年。 </p><p>您还可以通过使用addr字段指定绑定地址来启用Prometheus度量标准端点来监视复制：</p><p>     名称-如果您使用多个副本，请为副本指定一个可选名称。</p><p>    validation-interval-定期检查之间的间隔，以确保还原的备份与当前数据库匹配。默认禁用。</p><p>     保存配置后，您将需要开始复制。如果安装了.deb文件，请运行：</p><p>   ＃使用/etc/litestream.yml配置进行复制。$ litestreamplicat＃使用不同的配置路径进行复制。$ litestream copy -config /path/to/litestream.yml</p><p> litestream命令将初始化，然后无限期地等待更改。您应该看到目标副本路径现在已填充了generation目录。里面应该有一个16个字符的十六进制生成目录，里面应该有快照＆amp; WAL文件。在对源数据库进行更改时，更改将被增量复制到副本中。</p><p>  Litestream可以还原以前的快照并重放所有复制的WAL文件，默认情况下，它将还原到最新的WAL文件，但您也可以执行时间点还原。 </p><p>数据库只能还原到不存在的路径，因此您不必担心意外覆盖当前数据库。</p><p> ＃将数据库还原到原始路径。$ litestream restore / path / to / db＃将数据库还原到新位置。$ litestream restore -o / path / to / restored / db / path / to / db＃从副本URL还原。 $ litestream restore -o / path / to / restored / db s3：// mybkt / db＃将数据库还原到特定时间点。$ litestream restore -timestamp 2020-01-01T00：00：00Z / path / to /D b</p><p> 时间点还原仅具有WAL文件本身时间戳的分辨率。默认情况下，litestream将每分钟启动一个新的WAL文件，因此时间点还原仅精确到分钟。</p><p>  SQLite提供了WAL（预写日志）日记模式，该模式将页面写到-wal文件中，然后最终将其复制到原始数据库文件中。此复制过程称为检查点。 WAL文件用作循环缓冲区，因此当WAL达到一定大小时，它将从头开始重新启动。</p><p> Litestream通过接管检查点流程并控制何时重新启动它来工作，以确保它复制每个新页面。仅当没有读取事务时才允许检查点，因此Litestream会针对每个数据库保持运行中的读取事务，直到准备好检查点为止。</p><p> 将SQLite WAL文件复制到称为影子WAL的单独位置，以确保它不会被SQLite覆盖。该影子WAL充当临时缓冲区，以便副本可以复制到其目标位置（例如，另一个文件路径或S3）。影子WAL文件在完全复制后将被删除。您可以在数据库文件旁边找到影子目录作为隐藏目录。如果数据库文件名为/var/lib/my.db，则影子目录将为/var/lib/.my.db-litestream。</p><p> Litestream将快照分组，并将所有随后的WAL更改划分为“几代”。如果最初复制数据库，则将开始一代，如果litestream检测到WAL复制不再连续，则将开始新一代。如果litestream进程停止并且允许另一个进程检查WAL，则会发生这种情况。 </p><p>与SQLite相似，litestream是开源的，但不提供贡献。 这使代码库中没有专有或许可的代码，但也有助于我继续维护和构建litestream。  作为BoltDB的作者，我发现接受并维护第三方补丁程序使我精疲力尽，最终我将项目存档。 编写数据库和 低级复制工具涉及细微差别，简单的一行更改会在准确性和性能上产生深刻而出乎意料的变化。 小额捐款通常需要我花费几个小时来正确测试和验证它们。  感谢社区的参与，错误报告和＆amp; 功能要求。 我除了欢迎外，什么都不想离开。但是，我决定让这个项目保持封闭状态，以确保我的个人健康和项目的长期生存。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/benbjohnson/litestream#open-source-not-open-contribution">https://github.com/benbjohnson/litestream#open-source-not-open-contribution</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开源/">#开源</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/开放/">#开放</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/open/">#open</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1046214.html"><img src="http://img2.diglog.com/img/2021/1/thumb_f9e404022aac6639ad404b1a38c8abf3.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1046214.html">OpenWifiPass –苹果Wi-Fi密码共享的开源实现 </a></div><span class="my_story_list_date">2021-1-28 22:23</span></div><div class="col-sm"><div><a target="_blank" href="/story/1046088.html"><img src="http://img2.diglog.com/img/2021/1/thumb_d7ff0cde9b7daed3919feeb4f1c1cd61.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1046088.html">Tree –用于处理嵌套数据结构的库，由deepmind开源 </a></div><span class="my_story_list_date">2021-1-24 7:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1045974.html"><img src="http://img2.diglog.com/img/2021/1/thumb_5a039d8862606b2de5ed922ae81e584a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1045974.html">嘉吉开源其“类似于区块链”的供应链软件Splinter </a></div><span class="my_story_list_date">2021-1-23 15:44</span></div><div class="col-sm"><div><a target="_blank" href="/story/1045834.html"><img src="http://img2.diglog.com/img/2021/1/thumb_fb1cc678be59ae238c402c41f99d2ae9.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1045834.html">开源软件的奇怪经济学（2015年） </a></div><span class="my_story_list_date">2021-1-23 1:11</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>