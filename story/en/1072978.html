<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>运行自己的电子邮件服务器Running your own email server</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Running your own email server<br/>运行自己的电子邮件服务器</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-14 08:37:37</div><div class="page_narrow text-break page_content"><p>Email was one of the earliest services for communication via the internet. But, hosting such a simple service is quite complicated nowadays. In this post I have documented how I set up an email server for a business quickly and easily.</p><p>电子邮件是最早通过互联网进行交流的服务之一。但是，现在托管这样一个简单的服务相当复杂。在这篇文章中，我记录了我如何快速、轻松地为企业设置电子邮件服务器。</p><p>  There already exists several established players for simply sending and receiving emails, but there could be reasons why you would want to host your own:– Privacy If you are dealing with financial data, or in general don&#39;t want Google, Microsoft, etc. to snoop in over your emails– Several Users If you have more than a couple users on your domain name, hosting emails gets expensive, and that too quickly. Hosting it on your local server or a VPS is much cheaper than paying for GSuite if not using its other services.– Control The Internet is becoming quite centralized especially with messaging (WhatsApp, Signal, iMessage, etc.). Email by its virtue is meant to be distributed making it ideal for messaging. [Will talk about encryption further]</p><p>目前已经有几家成熟的公司可以简单地发送和接收电子邮件，但你想要拥有自己的电子邮件可能有一些原因：——如果你处理财务数据，那么就要有隐私，或者一般来说，don&#39；I don’我不想让谷歌、微软等窥探你的电子邮件——如果你的域名上有多个用户，那么多个用户托管电子邮件会很贵，而且速度太快。如果不使用GSuite的其他服务，将其托管在本地服务器或VPS上要比支付GSuite的费用便宜得多控制互联网变得相当集中，尤其是通过消息传递（WhatsApp、Signal、iMessage等）。电子邮件的优点是可以分发，这使其成为发送消息的理想选择。[将进一步讨论加密]</p><p>  Upon quick googling we can find that there are  several email server solutions. Basically a complete package that is easy to run and maintain. After a lot of testing of different solutions and checking feature parity, I decided on using  Power Mail-in-a-Box {a fork of  Mail-in-a-box — an already popular solution} for setting it up for a business. A couple of reasons for choosing it, over several others:</p><p>通过快速搜索，我们可以发现有几种电子邮件服务器解决方案。基本上是一个易于运行和维护的完整包。在对不同的解决方案进行了大量测试并检查了功能奇偶性之后，我决定使用Power Mail-in-a-Box{a fork of Mail-in-a-Box-一种已经很流行的解决方案}来为企业建立它。选择它的原因有以下几个：</p><p> Supports Ubuntu 20.04, Debian 10/11 out of the box. This means that at least for several years, no major upgrades or maintenance will be needed.</p><p>支持Ubuntu 20.04，Debian 10/11开箱即用。这意味着至少在几年内，不需要进行重大升级或维护。</p><p> Pretty lightweight: can run on a 1 core CPU with 1 GB ram (a cheap Digital Ocean VM)</p><p>非常轻巧：可以在1核CPU和1 GB ram（廉价的数字海洋虚拟机）上运行</p><p>  Has support for an external SMTP relay. As you might know, a lot of Cloud providers and ISPs block port 25 (for outgoing email) or the IP is already blacklisted. Getting a clean IP, and convincing your ISP to setup  reverse DNS is super difficult. [more on this later]</p><p>支持外部SMTP中继。你可能知道，很多云提供商和ISP都会屏蔽端口25（用于发送电子邮件），或者IP已经被列入黑名单。获得一个干净的IP，并说服您的ISP设置反向DNS是非常困难的。[稍后有更多信息]</p><p>    Has support for calendar and contacts sync. Also has built in Nextcloud for users to store some files and share.</p><p>支持日历和联系人同步。还内置了Nextcloud，用户可以存储一些文件并共享。</p><p>   There are several ways to host your email server. The best is to just repurpose any old system, with a replaced drive, adding ram, etc.</p><p>有几种方法可以托管电子邮件服务器。最好的方法是重新调整任何旧系统的用途，更换驱动器，添加ram等。</p><p> An old system&#39;s specs which I tested everything on– An Old system with intel i3-2100 or something– 6 GB DDR3 RAM– 500 GB WD Blue SSD (~60 USD) //added extra</p><p>旧制度#39；我测试了所有东西的s规格——一个带有英特尔i3-2100之类的旧系统——6 GB DDR3 RAM——500 GB WD Blue SSD（~60美元）//额外增加了</p><p> You can also deploy on a cloud provider, which I did for the business this was set up for. I recommend  Digital Ocean (affiliate link) simply because it&#39;s super simple, doesn&#39;t block ports and setting up reverse DNS is just as simple as renaming your VM. Although you need to get lucky with an IP that is not blacklisted.</p><p>你也可以部署在云服务提供商上，这是我为这项业务所做的。我推荐Digital Ocean（附属链接），只是因为它&#39；太简单了，不是吗&#39；t阻塞端口和设置反向DNS就像重命名虚拟机一样简单。尽管你需要幸运地拥有一个没有被列入黑名单的IP。</p><p>  After installing the OS, setting it up is literally super simple. Follow the steps on the  GitHub readme. You will need to configure port forwarding on your router if hosting locally or in your cloud provider&#39;s firewall settings.</p><p>安装操作系统后，设置它简直是超级简单。按照GitHub自述中的步骤操作。如果在本地或云提供商中托管，则需要在路由器上配置端口转发&#39；s防火墙设置。</p><p> I would  not recommend setting up your box as the DNS server, because if it goes down, your website and even other services will not be accessible publicly. I would hence recommend just copying all records shown and adding it to your DNS server (Cloudflare, Route 53, etc.)</p><p>我不建议将您的邮箱设置为DNS服务器，因为如果它关闭，您的网站甚至其他服务将无法公开访问。因此，我建议只复制显示的所有记录，并将其添加到DNS服务器（Cloudflare、Route 53等）</p><p>  You might not want to open outgoing ports or if ISP might be blocking outgoing email ports (esp. 25), continue reading ahead for a simple solution.</p><p>您可能不想打开传出端口，或者如果ISP可能会阻止传出电子邮件端口（特别是25），请继续阅读前面的内容，以获得一个简单的解决方案。</p><p>  There are several reasons why your emails will be ending up in spam. In fact, you might not even be able to send emails if your ISP is blocking specific ports. For these reasons, SMTP relays come into play.</p><p>你的电子邮件最终会变成垃圾邮件有几个原因。事实上，如果你的ISP屏蔽了特定的端口，你甚至可能无法发送电子邮件。由于这些原因，SMTP中继开始发挥作用。</p><p> Basically all your emails from your server are sent to another service which then delivers the email from their servers, which are not blacklisted, ensuring perfect delivery. The emails someone else sends are still delivered to your mailinabox; just sending is handled by such an SMTP relay.</p><p>基本上，你从服务器发送的所有电子邮件都会被发送到另一个服务，然后该服务会从他们的服务器（未被列入黑名单）发送电子邮件，从而确保完美的发送。其他人发送的电子邮件仍会发送到你的邮箱；只是发送由这样的SMTP中继处理。</p><p> There are several services like AWS SES, Sendgrid, etc. but I really liked  Zoho ZeptoMail due to its simple pricing (~ $2 for 10,000 emails), amazing email delivery, and very good customer support which approved our account fairly quickly. There are also several free services like Sendinblue, Mailazy, etc. if sending very few emails/day. After you make an account, setup the required DNS records for your domain; you can configure it in the admin interface as shown below:</p><p>有几种服务，如AWS SES、Sendgrid等。但我真的很喜欢Zoho ZeptoMail，因为它的定价很简单（10000封邮件约2美元），邮件传递非常好，而且非常好的客户支持，很快就批准了我们的帐户。如果每天只发送很少的电子邮件，还有一些免费服务，如Sendinblue、Mailazy等。创建帐户后，为您的域设置所需的DNS记录；您可以在管理界面中进行配置，如下所示：</p><p>   As I alluded to earlier, you might want privacy and prevent Tech Giants, ISPs from snooping in on your emails. There exists simple solutions like  Proton mail to encrypt your emails end-to-end but self-hosting email takes it to another level. Power Mail-in-a-box supports OpenPGP based email encryption and decryption in Roundcube (webmail) itself. It basically ensures that no one can read an email which is sent to you with your public key, and the emails you send could also be encrypted and signed to prove that they are not spoofed. Pretty cool!</p><p>正如我之前提到的，你可能想要隐私，并防止科技巨头、ISP窥探你的电子邮件。有一些简单的解决方案，比如质子邮件（Proton mail），可以端到端地加密电子邮件，但自托管电子邮件将其提升到了另一个层次。PowerMail-in-a-box支持Roundcube（webmail）本身中基于OpenPGP的电子邮件加密和解密。它基本上可以确保没有人可以阅读用你的公钥发送给你的电子邮件，你发送的电子邮件也可以被加密和签名，以证明它们不是伪造的。很酷！</p><p>  Even though I set this up for a business because the  free GSuite days are coming to an end, I would not do it for myself. Managing infrastructure is still work, even though mail-in-a-box basically requires almost zero maintenance after everything is configured. For me, I just use Zoho Mail which gives 5 GB free for 5 users on a custom domain, which is generous for individuals &amp; family.</p><p>尽管我为一家企业设立了这个项目，因为免费GSuite的日子即将结束，但我不会为自己这么做。管理基础设施仍然是可行的，尽管邮箱基本上在所有配置完成后几乎不需要维护。对我来说，我只是使用Zoho Mail，它为自定义域上的5个用户提供5GB的免费空间，这对个人和；家庭</p><p> But, for small sized organisations or just for having some fun, this is a legitimate and extremely simple way to set up a mail server. With SPF, DKIM records properly configured and using a relay, even email deliverability is not an issue. The install which I did has been stable and running for a month almost. I will highly recommend setting up backup — its super simple. It supports rsync directly to another remote machine via SSH keys, and it can be configured via the web admin interface itself.</p><p>但是，对于小型组织或只是为了好玩，这是一种合理且极其简单的邮件服务器设置方法。有了SPF，DKIM记录被正确配置并使用中继，即使电子邮件的可交付性也不是问题。我所做的安装已经稳定运行了将近一个月。我强烈建议设置备份，它非常简单。它支持通过SSH密钥直接与另一台远程机器进行rsync，并且可以通过web管理界面本身进行配置。</p><p>    If you found any typo, wanna reach out, or get in touch – Please email me at  hi@vimarsh.info</p><p>如果您发现任何拼写错误，想联系或联系我，请发电子邮件至hi@vimarsh.info</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/电子邮件/">#电子邮件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/email/">#email</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>