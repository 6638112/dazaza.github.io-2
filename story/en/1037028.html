<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>学习SQL并掌握以成为数据工程师的途径The path to learning SQL and mastering it to become a Data Engineer</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">The path to learning SQL and mastering it to become a Data Engineer<br/>学习SQL并掌握以成为数据工程师的途径</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-29 01:56:10</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/2af1fe41a27a7145970454e5f13bf441.jpeg"><img src="http://img2.diglog.com/img/2020/11/2af1fe41a27a7145970454e5f13bf441.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>SQL is one of the key tools used by data engineers to model business logic, extract key performance metrics, and create reusable data structures. There are, however, different types of SQL to consider for data engineers: Basic, Advanced Modelling, Efficient, Big Data, and Programmatic. The path to learning SQL involves progressively learning these different types.</p><p>SQL是数据工程师用来建模业务逻辑，提取关键性能指标以及创建可重用数据结构的关键工具之一。但是，数据工程师需要考虑不同类型的SQL：基本，高级建模，高效，大数据和程序化。学习SQL的途径涉及逐步学习这些不同的类型。</p><p>   Learning “Basic SQL” is all about learning the key operations in SQL to manipulate the data such as aggregations, grain, and joins, for example.</p><p>   学习“ Basic SQL”就是关于学习SQL中的关键操作以操纵诸如聚合，粒度和联接之类的数据。</p><p>  Basic SQL can be learned from websites such as  W3C or looking for a more practical approach to learning from websites such as  Datacamp or  DataQuest. These websites allow us to get a decent grasp of SQL&#39;s core concepts, such as the different operations, functions, subqueries, and joins. Some of the core concepts in data engineering, such as working with the grain of a table/dataset, are often not as extensively discussed as they deserve.</p><p>  可以从W3C之类的网站学习基本SQL，也可以从Datacamp或DataQuest之类的网站中寻找更实用的学习方法。这些网站使我们可以很好地掌握SQL的核心概念，例如不同的操作，函数，子查询和联接。数据工程中的某些核心概念（例如处理表/数据集的粒度）通常没有得到应有的重视。</p><p>  One of the main challenges of learning SQL is setting up the database and access to datasets. These days installing a local database has become quite easy, but it does require some time to set up the database. After that, the tables need to be created, and datasets uploaded onto them before they can become useable for practical learning.</p><p>  学习SQL的主要挑战之一是建立数据库和访问数据集。这些天来安装本地数据库变得非常容易，但是确实需要一些时间来设置数据库。之后，需要创建表，并将数据集上载到表中，然后才能用于实践学习。</p><p>  This type of knowledge is generally tested during screening interview questions, such as  that of the histogram, to understand how candidates have grasped concepts such as granularity or joins. This type of interview question is also at the typical SQL knowledge level expected for fresh graduates embarking on data engineers&#39; careers.</p><p>  通常在筛选面试问题（例如直方图）时测试此类知识，以了解候选人如何掌握诸如粒度或联接之类的概念。这种面试问题也是针对即将从事数据工程师职业的应届毕业生所期望的典型SQL知识水平。</p><p>  Data engineers need to be able to model complex transformations. Learning some advanced analytical SQL helps model these types of behavior. Two main things help support this kind of use case 1) Advanced Queries 2) Data Models.</p><p>  数据工程师需要能够为复杂的转换建模。学习一些高级分析SQL有助于对这些类型的行为进行建模。有两点主要帮助支持这种用例：1）高级查询2）数据模型。</p><p>  Window functions are a special class of functions with added properties. They help more easily define transformations that would have otherwise required a mix of subqueries and joins to achieve the same results. They can help handle many heavier data transformations, such as sessionization, preference picks, or optimization based on actual data.</p><p>  窗口函数是一类特殊的具有添加属性的函数。它们有助于更轻松地定义否则需要混合子查询和联接才能获得相同结果的转换。它们可以帮助处理许多较重的数据转换，例如会话化，首选项选择或基于实际数据的优化。</p><p> REGEXP and their associated functions provide a way to do more extensive text pattern matches than the regular  LIKE operator.</p><p>与常规LIKE运算符相比，REGEXP及其相关功能提供了一种进行更广泛的文本模式匹配的方法。</p><p> Collection aggregates functions, allow to summarize the dataset contained within it, typical functions are   LISTAGG and   array_agg. They can be useful for providing some data that would naturally be a more granular level than the summarized dataset. For example, take the use case of knowing if certain product types were included in a given e-commerce order. This could be computed from the raw order items data, but it could also be very easily computed from an orders table with an aggregated field based on  jsonb_object_agg .</p><p> 集合聚合函数，允许汇总其中包含的数据集，典型的函数是LISTAGG和array_agg。它们对于提供某些数据可能很有用，这些数据自然比汇总数据集更细化。例如，以了解特定产品类型是否包含在给定的电子商务订单中的用例为例。这可以从原始订单商品数据中计算得出，但是也可以非常容易地从具有基于jsonb_object_agg的聚合字段的订单表中计算出来。</p><p> Recursive CTEs / hierarchal queries are generally less used than the other types of transformation, such as window function/regexp or collection aggregate functions. They are, however, essential to solving certain types of problems.</p><p> 递归CTE /层次结构查询通常比其他类型的转换（如窗口函数/正则表达式或集合聚合函数）少用。但是，它们对于解决某些类型的问题至关重要。</p><p>  Data models, the type of data models that are used can be particularly impactful. Three types of</p><p>  数据模型，即所使用的数据模型的类型可能会特别具有影响力。三种</p><p> Normal Form: It is important for data engineers to understand the benefits of database normalization, what the  different normal forms mean, and where they should be used.</p><p> 规范形式：对于数据工程师来说，了解数据库规范化的好处，不同的规范形式的含义以及应在何处使用非常重要。</p><p> Slowly Changing Dimensions: Setting up and leveraging  type II slowly changing dimension (SCD) tables can make it particularly easy to handle certain use cases such as calculating the evolution, such as an insurance premium across time for a given insurance contract.  Type I SDC tables would be more appropriate for providing visibility to the current user demographic split by age group.</p><p> 缓慢变化的维度：设置并利用II型缓慢变化的维度（SCD）表可以使处理某些用例特别容易，例如计算演变，例如给定保险合同的整个时间的保险费。 I型SDC表将更适合于提供按年龄段划分的当前用户人口统计信息。</p><p> Denormalized Design: denormalization is the typical way data tends to be exposed in a data warehouse, and understanding the pre-requests and different approaches used in denormalized design, such as star and snowflakes schemas, is important to keep a sane data warehouse.</p><p> 非规范化设计：非规范化是数据倾向于在数据仓库中公开的典型方式，了解非规范化设计中使用的预请求和不同方法（例如星型和雪花模式）对于保持理智的数据仓库很重要。</p><p>  One of the key learning materials for advanced analytical SQL is the database&#39;s official documentation. It is essential to understand what is available and what could be of interest when needing to model business problems. Some books also provide a good overview of how to best apply SQL to these modeling use cases, such as  Practical Oracle SQL, which provides practical applications to window functions, examples of applying recursive queries, or handling row pattern matching.</p><p>数据库的官方文档是高级分析SQL的关键学习材料之一。在需要对业务问题进行建模时，必须了解可用的内容和可能感兴趣的内容。一些书还很好地概述了如何将SQL最好地应用于这些建模用例，例如，实践Oracle SQL，它为窗口函数提供了实用的应用程序，提供了递归查询的示例，或处理了行模式匹配。</p><p> For data models, there are several database classes  [1]  [2]  [3] that teach some of the critical modeling principles. These need to be applied in practice. Books such as  Modelling Business Information or  Database Design for Mere Mortals provide useful references to deep dive into the subject.</p><p> 对于数据模型，有几个数据库类[1] [2] [3]讲授一些关键的建模原理。这些需要在实践中应用。诸如为仅有的人建立业务信息建模或数据库设计之类的书为深入研究该主题提供了有用的参考。</p><p>  Questions on advanced modeling tend to come up in interviews either as part of a SQL case study, for instance, designing a table structure and transformation for a given specific use case, or can be more theoretical, such as explaining the difference between normal form versions.</p><p>  有关高级建模的问题往往会在访谈中提出，例如作为SQL案例研究的一部分，例如针对给定的特定用例设计表结构和转换，或者可以更具理论性，例如解释标准格式版本之间的差异。 。</p><p>  Part of the job of being a data engineer is to write efficient code. There are a few things that are important to know in that regard. 1) having a good grasp of complexity 2) a good understanding of data structure, efficient data model, and query patterns, and 3) being able to analyze and explain plan and understand what is being done by the optimizer.</p><p>  成为数据工程师的一部分工作是编写高效的代码。在这方面需要了解一些重要的事情。 1）对复杂性有很好的了解2）对数据结构，有效的数据模型和查询模式有很好的理解，以及3）能够分析和解释计划并了解优化程序正在执行的操作</p><p>  Besides, having a general knowledge about some approaches is particularly expensive,  such as using correlated subqueries; it is essential for data engineers to understand the  time and space complexity of the different transformations done, both in a naive way and in the way optimized by the databases.</p><p>  此外，对某些方法的一般知识特别昂贵，例如使用相关子查询；数据工程师必须以幼稚的方式以及通过数据库优化的方式了解完成的不同转换的时间和空间复杂性。</p><p>  Understanding concepts such as index and partitions and how they can contribute to higher efficiency, and how modeling around them can bring benefit. Take the example of a daily snapshotted table — it can be a great way to support the entity&#39;s update process, leveraging the previous day partition and applying the modifications on top.</p><p>  了解索引和分区等概念，以及它们如何有助于提高效率以及围绕它们进行建模如何带来好处。以每日快照表为例-这可能是支持实体的更新过程的一种好方法，它利用前一天的分区并将修改应用到顶部。</p><p> WITH  daily_updates AS ( SELECT   customer_id,  name,  created_on,  ROW_NUMBER () OVER (PARTITION BY customer_id ORDER BY created_on DESC) as rn FROM customer_updates cu WHERE   cu.ds = &#39;2020-02-02&#39; ) INSERT INTO dim_user  SELECT   &#39;2020-01-02&#39; AS ds,  COALESCE(daily.customer_id, du.customer_id) AS customer_id,  COALESCE(daily.name, du.name) AS name,  COALESCE(daily.created_on, du.last_login_on) AS last_login_on  FROM dim_user du FULL OUTER JOIN daily_updates daily   ON du.customer_id = daily.customer_id  AND daily.rn = 1 WHERE   du.ds = &#39;2020-01-01&#39;</p><p> 从客户端更新CU WHERE cu.ds ='2020-02-02'的daily_updates AS（选择customer_id，名称，created_on，ROW_NUMBER（）OVER（PARTITION BY customer_id ORDER BY created_on DESC））插入到dim_user SELECT'2020-01 -02'AS ds，COALESCE（daily.customer_id，du.customer_id）AS customer_id，COALESCE（daily.name，du.name）AS名称，COALESCE（daily.created_on，du.last_login_on）AS last_login_on来自dim_user du FULL OUTER JOIN daily_updates每天在du.customer_id = daily.customer_id AND daily.rn = 1处更新du.ds ='2020-01-01'</p><p> Let’s look at the above SQL query, where  ds represent the daily partition. The process is rn daily to update with a different partition, leveraging a full outer join, and a ( filtered, i.e., rn=1) CTE at the same grain  (i.e., customer_id); it is possible to compute the update looking at only a subset of the data at the time — the daily updated data, and an already consolidated view of customers — much more efficient than recomputing every time the state of the customers based on the full update logs.</p><p>让我们看一下上面的SQL查询，其中ds代表每日分区。该过程每天进行一次，以利用一个完整的外部联接和相同粒度（即customer_id）的CTE（已过滤，即rn = 1）来更新到不同的分区。可以仅查看当时的一部分数据（每日更新的数据以及已经合并的客户视图）来计算更新，这比每次根据完整更新日志重新计算客户的状态要高效得多。</p><p>  Understanding how to read an explain plan is necessary when dealing with databases. It tells you what decision the optimizer has taken and the different steps that are being performed. This gives data engineers the ability to  see what operations are expensive and could be optimized. Take, for example, the use of a  nested loops operation happening when it should be a  hash join .</p><p>  处理数据库时，必须了解如何阅读解释计划。它告诉您优化器已做出的决定以及正在执行的不同步骤。这使数据工程师能够查看哪些操作昂贵并且可以进行优化。例如，当它应该是哈希联接时，就会发生嵌套循环操作的使用。</p><p> There are different methods to optimize the queries based on what is returned by the explain plan, and the analysis of the explain plan should be tied to these optimizations techniques be it 1) query rewrites 2) introduction of indices, presorting steps, partitions … 3) use of  optimizer/planner hints 4) update of the table statistics.</p><p> 有多种方法可根据解释计划返回的内容来优化查询，并且解释计划的分析应与这些优化技术联系在一起，例如1）查询重写2）引入索引，预排序步骤，分区…3 ）使用优化程序/计划程序提示4）更新表统计信息。</p><p>  The most typical way to learn how to write efficient SQL code is to be confronted with inefficient or slow operations and optimize them out of necessity. There are books and courses on databases that provide some of the information to learn, articles  such as this one from online learning platforms, which provide insights into what can be done to write more efficient SQL. Nevertheless, one of the most important sources of information for this comes from reading the official database documentation and learning from experience.</p><p>  学习如何编写高效的SQL代码的最典型方法是面对效率低下或运行缓慢的操作，并在必要时对其进行优化。有一些关于数据库的书籍和课程可提供一些学习信息，例如在线学习平台上的此类文章，这些文章提供了有关如何编写更有效的SQL的见解。但是，最重要的信息来源之一是阅读官方数据库文档并从经验中学习。</p><p>  Questions of efficiency usually pop up in interviews for candidates with experience. They usually come up as follow up questions to a modeling exercise, asking how the transformation could be rendered more efficient. Certain companies, however, place a particular focus on writing efficient code and on query optimization. For these types of interviews, it is primordial not just to understand some of the methods mentioned but to truly understand what is happening under the hood and how the optimizer actually rewrites the query top render them more efficient, such as techniques like  flattening, inlining, predicate pushdown,  partition pruning, …</p><p>  对于有经验的候选人，面试中通常会出现效率问题。他们通常会作为建模练习的后续问题，询问如何使转换更加有效。但是，某些公司将重点放在编写高效的代码和查询优化上。对于这些类型的采访，不仅要了解所提到的某些方法，而且要真正了解幕后发生的事情以及优化器如何实际重写查询顶部以使其更加高效（例如扁平化，内联，谓词下推，分区修剪...</p><p>  There are specificities involved in dealing with SQL for Big Data technologies. Certain data structure options such as buckets or cluster by is very traditional to big data technologies.</p><p>  处理大数据SQL涉及一些特殊性。某些数据结构选项（例如存储桶或群集依据）对于大数据技术而言是非常传统的。</p><p> The use of  probabilistic data structures in certain functions, such as   approx_distinct in presto, is also something typically found in the SQL code leveraging big data technologies despite some of these functions being available in traditional databases.</p><p> 尽管某些功能在传统数据库中可用，但某些功能中使用概率数据结构（例如presto中的rox_distinct）也是在利用大数据技术的SQL代码中通常发现的东西。</p><p> A lot of the aspect in dealing with Big Data SQL is understanding what is happening under the hood in the specific distributed systems, similarly to how the system plans and executes the queries.</p><p>处理大数据SQL的许多方面是了解特定分布式系统中幕后发生的事情，类似于系统如何计划和执行查询。</p><p>  A lot of learning big data SQL comes from working with big data systems and attempting to debug what is happening. The specific documentation of the platform used, such as Spark or Hive, will provide a high-level view of what is happening. Courses such as Harvard’s  Algorithms for Big data give a much more in-depth explanation of what is happening under the hood of some of the probabilistic algorithms and data structures used in Big Data.</p><p>  学习大数据的很多知识来自于使用大数据系统并尝试调试正在发生的事情。使用的平台的特定文档，例如Spark或Hive，将提供正在发生的事情的高级视图。诸如哈佛大学大数据算法之类的课程更深入地解释了大数据中使用的某些概率算法和数据结构的内幕。</p><p>  Programmatic SQL offers a way to orchestrate a flow of transactions through procedures. It provides the core of a programmatic language, introducing control flow( loops, ifs,…), variables, handling exceptions, and even generating and executing SQL queries dynamically.</p><p>  程序化SQL提供了一种通过过程来协调事务流的方法。它提供了编程语言的核心，引入了控制流（循环，if，…），变量，异常处理，甚至动态生成和执行SQL查询。</p><p> Although the use of programmatic SQL has fallen a bit in disfavor with some of the modern data engineering movements favoring data immutability and full re-load vs. incremental updates, as well as the rise of workflow engines such as Airflow or Prefect, it is still useful and in use in a large number of companies.</p><p> 尽管程序化SQL的使用在某些现代数据工程运动中变得有些不利，这些运动赞成数据不变性和完全重载与增量更新，以及工作流引擎（如Airflow或Prefect）的兴起，但它仍然有用并在许多公司中使用。</p><p>  Most RDBMS support a flavor of programmatic SQL such as T-SQL for MsSQL, PL/SQL for Oracle, or PL/pgSQL for Postgres, and the language is therefore very much vendor-specific.</p><p>  大多数RDBMS支持多种编程SQL，例如用于MsSQL的T-SQL，用于Oracle的PL / SQL或用于Postgres的PL / pgSQL，因此该语言在很大程度上取决于供应商。</p><p> The documentation provided by the specific vendor offers a good first pass to give the procedural language a try or to search for certain functions specifically. There are, however, some decent books to get introduced to these languages, such as  Oracle PL/SQL Programming or  PostgreSQL Server Programming.</p><p> 特定供应商提供的文档为尝试使用过程语言或专门搜索某些功能提供了良好的第一步。但是，有一些不错的书籍可以介绍这些语言，例如Oracle PL / SQL编程或PostgreSQL服务器编程。</p><p>  In my experience, programmatic SQL questions do not tend to be directly asked in an interview, in part because of the vendor specificity of the language. However, some companies looking for people with experience with a specific database vendor may ask to complete some automated tests that include some questions around programmatic SQL.</p><p>  以我的经验，编程的SQL问题通常不会在面试中直接问到，部分原因是该语言的供应商特殊性。但是，某些寻找具有特定数据库供应商经验的人员的公司可能会要求完成一些自动化测试，其中包括一些有关编程SQL的问题。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/analytics-and-data/the-path-to-learning-sql-and-mastering-it-to-become-a-data-engineer-256ea0fef4e7">https://medium.com/analytics-and-data/the-path-to-learning-sql-and-mastering-it-to-become-a-data-engineer-256ea0fef4e7</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/sql/">#sql</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/learning/">#learning</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>