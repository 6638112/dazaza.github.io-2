<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Windows中不可原谅的不安全感</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Windows中不可原谅的不安全感</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-09 06:29:10</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/65fe1ac55cb547c52b4d5798dd332b64.png"><img src="http://img2.diglog.com/img/2020/11/65fe1ac55cb547c52b4d5798dd332b64.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>In 2017, DZone wrote  a really cool article about a windows exploit that a  German student discovered that takes advantage of the trusted binary ‘ fodhelper.exe’ that is a part of windows. It is located in System32 and is signed by Microsoft, so when you run it, the UAC prompt (pictured below), which is normally required to run a program as an administrator, is not required.</p><p>2017年，DZone写了一篇很酷的文章，讲述了一名德国学生发现的Windows漏洞，该漏洞利用了Windows中可信的二进制文件“fodhelper.exe”。它位于System32中，并由Microsoft签名，因此当您运行它时，通常需要以管理员身份运行程序的UAC提示符(如下图所示)不是必需的。</p><p>  The student found that  fodhelper.exe looks for additional commands to execute in these two registry keys:</p><p>该学生发现fodhelper.exe在以下两个注册表项中查找要执行的其他命令：</p><p>  and that he could m anipulate the contents of those keys to execute any command he wanted with administrative privileges.</p><p>并且他可以操纵这些密钥的内容以使用管理特权执行他想要的任何命令。</p><p> The DZone article made some Python code as an example. I edited the code to show some good examples of how this could be use maliciously.</p><p>DZone文章提供了一些Python代码作为示例。我编辑了代码，展示了如何恶意使用它的一些很好的例子。</p><p> Essentially, I made a script that asked: ask/force. The ask option created a UAC prompt that elevated the script and executed a command of the user’s choosing; the force option used the exploit to do the same without any UAC prompt.</p><p>实际上，我编写了一个脚本，要求：Ask/force。Ask选项创建了一个UAC提示符，该提示符提升了脚本并执行了用户选择的命令；FORCE选项利用漏洞进行了同样的操作，但没有任何UAC提示符。</p><p>   In an attempt to combat this, I used  PyInstaller to compile the Python script into an executable binary, which surprisingly prevented windows defender from recognising it as harmful.</p><p>为了解决这一问题，我使用了PyInstaller将Python脚本编译成可执行的二进制文件，这出人意料地阻止了Windows Defender意识到它是有害的。</p><p> Below I am showing how it could be used to create an elevated command prompt</p><p>下面我将展示如何使用它来创建提升的命令提示符。</p><p>  It writes the command I have typed in (cmd.exe) to the registry key, and runs fodhelper.exe. An elevated command prompt then opens:</p><p>它将我键入的命令(cmd.exe)写入注册表项，并运行fodhelper.exe。然后，将打开提升的命令提示符：</p><p>  From this command prompt I could wipe my hard drive, get all wi-fi passwords, copy work, delete system files, etc. — all with no further permissions.</p><p>通过这个命令提示符，我可以擦除硬盘、获取所有wi-fi密码、复制工作、删除系统文件等--所有这些都没有进一步的权限。</p><p> This is inexcusable. The world’s leading operating system on factory settings is this easily attacked when the vulnerability has been known for over three years.</p><p>这是不可原谅的。世界领先的出厂设置操作系统在该漏洞已被发现三年多的情况下很容易受到攻击。</p><p> Since it is a single executable file, this could be implemented as a payload in a  Microsoft Word document exploit or similar styled attack and easily have access to an entire system.</p><p>因为它是单个可执行文件，所以它可以作为Microsoft Word文档利用漏洞攻击或类似样式的攻击中的有效负载实现，并且可以轻松访问整个系统。</p><p> Currently, the only way to prevent this is by not having administrator accounts, which for a lot of people would be extremely inconvenient.</p><p>目前，防止这种情况发生的唯一方法是没有管理员帐户，这对很多人来说是非常不方便的。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://seberry.medium.com/windows-insecurity-10c33aa8f5db">https://seberry.medium.com/windows-insecurity-10c33aa8f5db</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/原谅/">#原谅</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/执行/">#执行</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1033802.html"><img src="http://img2.diglog.com/img/2020/11/thumb_dc1fad55ea711afc952976f650d78b78.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033802.html">WinApps：在Linux上运行Windows应用程序，就像它们是原生操作系统的一部分一样</a></div><span class="my_story_list_date">2020-11-8 12:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033759.html"><img src="http://img2.diglog.com/img/2020/11/thumb_4a03f622ee66ea3150f73ee58b19c0cd.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033759.html">SpotifyKeyDumper-从Windows Spotify客户端转储歌曲解密密钥</a></div><span class="my_story_list_date">2020-11-8 9:35</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033733.html"><img src="http://img2.diglog.com/img/2020/11/thumb_e98c1db4db3e72293a9a8f2e9cc0a393.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033733.html">如何将一台旧的Windows笔记本电脑切换到Linux</a></div><span class="my_story_list_date">2020-11-8 9:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033067.html"><img src="http://img2.diglog.com/img/2020/11/thumb_640c8f055f248f635730f4686b5e12e0.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033067.html">未打补丁的WindowsZero-Day在野外为沙盒逃逸而利用</a></div><span class="my_story_list_date">2020-11-4 6:56</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>