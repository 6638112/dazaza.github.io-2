<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>RansomEXX特洛伊木马攻击Linux系统</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">RansomEXX特洛伊木马攻击Linux系统</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-09 03:11:29</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/aaea17dc1c0dd2c391d964f1d035bf53.jpg"><img src="http://img2.diglog.com/img/2020/11/aaea17dc1c0dd2c391d964f1d035bf53.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>We recently discovered a new file-encrypting Trojan built as an ELF executable and intended to encrypt data on machines controlled by Linux-based operating systems.</p><p>我们最近发现了一个新的文件加密特洛伊木马程序，它是作为ELF可执行文件构建的，旨在加密由基于Linux的操作系统控制的计算机上的数据。</p><p> After the initial analysis we noticed similarities in the code of the Trojan, the text of the ransom notes and the general approach to extortion, which suggested that we had in fact encountered a Linux build of the previously known ransomware family RansomEXX. This malware is notorious for attacking large organizations and was most active earlier this year.</p><p>经过初步分析，我们注意到特洛伊木马的代码、赎金笔记的文本和敲诈勒索的一般方法都有相似之处，这表明我们实际上遇到了先前已知的勒索软件家族RansomEXX的Linux版本。这种恶意软件因攻击大型组织而臭名昭著，今年早些时候最为活跃。</p><p> RansomEXX is a highly targeted Trojan. Each sample of the malware contains a hardcoded name of the victim organization. Moreover, both the encrypted file extension and the email address for contacting the extortionists make use of the victim’s name.</p><p>RansomEXX是一种具有高度针对性的特洛伊木马程序。恶意软件的每个样本都包含受害者组织的硬编码名称。此外，加密的文件扩展名和联系勒索者的电子邮件地址都使用了受害者的名字。</p><p> Several companies have fallen victim to this malware in recent months, including the  Texas Department of Transportation (TxDOT) and  Konica Minolta.</p><p>近几个月来，有几家公司成为了这种恶意软件的受害者，包括德克萨斯州交通部(TxDOT)和柯尼卡美能达(Konica Minolta)。</p><p>  The sample we came across –  aa1ddf0c8312349be614ff43e80a262f – is a 64-bit ELF executable. The Trojan implements its cryptographic scheme using functions from the open-source library mbedtls.</p><p>我们遇到的示例aa1ddf0c8312349be614ff43e80a262f是一个64位ELF可执行文件。该特洛伊木马程序使用开源库mbedtls中的函数实现其加密方案。</p><p> When launched, the Trojan generates a 256-bit key and uses it to encrypt all the files belonging to the victim that it can reach using the AES block cipher in ECB mode. The AES key is encrypted by a public RSA-4096 key embedded in the Trojan’s body and appended to each encrypted file.</p><p>启动后，该特洛伊木马程序会生成256位密钥，并使用它在ECB模式下使用AES块密码加密属于受害者的所有文件。AES密钥由嵌入特洛伊木马正文的公开RSA-4096密钥加密，并附加到每个加密文件中。</p><p> Additionally, the malware launches a thread that regenerates and re-encrypts the AES key every 0.18 seconds. However, based on an analysis of the implementation, the keys actually only differ every second.</p><p>此外，恶意软件每0.18秒启动一次重新生成和重新加密AES密钥的线程。然而，根据对实现的分析，密钥实际上每秒都不同。</p><p> Apart from encrypting the files and leaving ransom notes, the sample has none of the additional functionality that other threat actors tend to use in their Trojans: no C&amp;C communication, no termination of running processes, no anti-analysis tricks, etc.</p><p>除了加密文件和留下赎金纸条外，该示例没有其他威胁攻击者在其特洛伊木马程序中倾向于使用的附加功能：没有C&amp；C通信、没有终止运行的进程、没有反分析技巧等。</p><p>  Fragment of the file encryption procedure pseudocode; variable and function names are saved in the debug information and must match the original source code</p><p>文件加密过程伪代码的片段；变量和函数名保存在调试信息中，必须与原始源代码匹配。</p><p> Curiously, the ELF binary contains some debug information, including names of functions, global variables and source code files used by the malware developers.</p><p>奇怪的是，ELF二进制文件包含一些调试信息，包括恶意软件开发人员使用的函数名称、全局变量和源代码文件。</p><p>      Despite the fact that previously discovered PE builds of RansomEXX use WinAPI (functions specific to Windows OS), the organization of the Trojan’s code and the method of using specific functions from the mbedtls library hint that both ELF and PE may be derived from the same source code.</p><p>尽管之前发现的RansomEXX的PE版本使用WinAPI(特定于Windows操作系统的函数)，但特洛伊木马代码的组织和使用mbedtls库中特定函数的方法暗示ELF和PE可能源自相同的源代码。</p><p> In the screenshot below, we see a comparison of the procedures that encrypt the AES key. On the left is the ELF sample aa1ddf0c8312349be614ff43e80a262f; on the right is the PE sample fcd21c6fca3b9378961aa1865bee7ecb used in the TxDOT attack.</p><p>在下面的屏幕截图中，我们可以看到加密AES密钥的过程的比较。左侧是ELF示例aa1ddf0c8312349be614ff43e80a262f；右侧是TxDOT攻击中使用的PE示例fcd21c6fca3b9378961aa1865bee7ecb。</p><p> Despite being built by different compilers with different optimization options and for different platforms, the similarity is quite obvious.</p><p>尽管不同的编译器使用不同的优化选项并针对不同的平台构建，但相似性非常明显。</p><p>  We also observe resemblances in the procedure that encrypts the file content, and in the overall layout of the code.</p><p>我们还观察到加密文件内容的过程和代码的总体布局有相似之处。</p><p> What’s more, the text of the ransom note is also practically the same, with the name of the victim in the title and equivalent phrasing.</p><p>更重要的是，赎金纸条的文本也几乎是一样的，标题中有受害者的名字，以及相应的措辞。</p><p>  As  reported by the media, one of the country’s government institutions has just been attacked by a targeted ransomware Trojan.</p><p>据媒体报道，该国的一家政府机构刚刚受到了一种定向勒索软件特洛伊木马的攻击。</p><p> Based on the ransom note, which is almost identical to the one in the sample we described, and the news article mentioned above, there is a high probability that the target is the victim of another variant of RansomEXX.</p><p>根据与我们描述的样本中的赎金纸条几乎相同的赎金纸条，以及上面提到的新闻文章，目标很有可能是另一种RansomEXX变种的受害者。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://securelist.com/ransomexx-trojan-attacks-linux-systems/99279/">https://securelist.com/ransomexx-trojan-attacks-linux-systems/99279/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/trojan/">#trojan</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1033802.html"><img src="http://img2.diglog.com/img/2020/11/thumb_dc1fad55ea711afc952976f650d78b78.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033802.html">WinApps：在Linux上运行Windows应用程序，就像它们是原生操作系统的一部分一样</a></div><span class="my_story_list_date">2020-11-8 12:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033783.html"><img src="http://img2.diglog.com/img/2020/11/thumb_f4b8833e3b825bd4551ccc396c17bcf7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033783.html">网络攻击者现在还制作他们的勒索软件的Linux版本</a></div><span class="my_story_list_date">2020-11-8 9:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033770.html"><img src="http://img2.diglog.com/img/2020/11/thumb_39b5870f0152d70653491cd5930ddbb5.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033770.html">了解如何设计和保护嵌入式Linux设备</a></div><span class="my_story_list_date">2020-11-8 9:38</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033735.html"><img src="http://img2.diglog.com/img/2020/11/thumb_bce22b37d0c9f16656c02dcd1b55ac81.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033735.html">DragonBox PYRA掌上Linux游戏PC本月开始发货</a></div><span class="my_story_list_date">2020-11-8 9:24</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>