<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>BitLocker锁屏绕过 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">BitLocker锁屏绕过 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-17 21:20:09</div><div class="page_narrow text-break page_content"><p>BitLocker是一种现代数据保护功能，已与Windows内核深度集成。许多公司使用它作为盗窃情况下保护公司机密的一种手段。 Microsoft建议您使用一个受信任的平台模块，该模块可以为您完成一些繁重的加密任务。</p><p>  给定没有已知密码的Windows 10系统和受BitLocker保护的硬盘驱动器，可以通过执行以下操作来添加管理员帐户：</p><p> 卸下拇指驱动器，然后再放回去，进入主屏幕。</p><p> 现在，添加了一个名为hax的用户帐户，其密码为“ hax”，具有Administrators成员身份。要使用要登录的帐户更新列表，请单击我忘记密码，然后返回主屏幕。</p><p>  首先，我们选择“我忘记了密码”。此选项将启动一个附加会话，并根据需要创建/删除一个帐户。用户个人资料服务将其称为默认帐户。它的第一个可用名称为defaultuser1，defaultuser100000，defaultuser100001等。</p><p> 为了逃脱锁定，我们必须使用“讲述人”，因为如果我们设法启动某些内容，我们将看不到它，但是使用“讲述人”，我们将能够对其进行导航。但是，我们如何启动某些东西？</p><p>  如果我们连续快速地按了5次班次，则会出现一个打开“设置”应用程序的链接，该链接实际上有效。我们看不到启动的“设置”应用程序。重点关注已启动的应用程序；您必须单击链接，然后单击可以在正确的时间显示启动的应用程序的位置。学习此方法最简单的方法是，每秒大约两次单击链接。粘滞键窗口将消失。继续点击！现在，您将在屏幕中间看到一个焦点框。那是“设置”应用程序，当您获得焦点时必须停止单击。 </p><p>现在，我们可以使用CapsLock +向左箭头导航“设置”应用程序，按此按钮直至到达“主页”。现在，当“主页”具有焦点时，按住Caps Lock并按Enter。使用CapsLock +向右箭头导航到“设备”，然后在焦点对准CapsLock + Enter时输入。</p><p>  现在导航至“自动播放”，单击CapsLock + Enter，然后选择“打开文件夹以查看文件（文件资源管理器）”。现在插入准备好的USB驱动器，等待几秒钟，讲述人将宣布驱动器已打开，并且窗口已聚焦。现在选择文件Exploit.exe并使用CapsLock + Enter执行。女士们，先生们，这是任意代码执行，无需使用任何密码。但是，我们受限制为默认配置文件。</p><p>   安装USB记忆棒后，BitLocker将在“系统卷信息”中创建一个名为ClientRecoveryPasswordRotation的目录，并将权限设置为：</p><p>  要重定向创建操作，需要在NT名称空间中使用符号链接，因为它允许我们控制文件名，并且链接的存在并不会终止该操作，因为它仍在创建目录。</p><p> 因此，请使用USB驱动器，并将\ System Volume Information设为针对\ RPC Control的安装点。然后在\ RPC Control \ ClientRecoveryPasswordRotation中以\ ?? \ C：\ windows \ system32 \ Narrator.exe.local为目标进行符号链接。如果重新插入USB记忆棒，则将创建具有允许我们创建子目录的权限的文件夹C：\ windows \ system32 \ Narrator.exe.local。</p><p>  在此子目录中，我们删除了一个名为comctl32.dll的有效负载DLL。下次触发讲述人时，它将加载DLL。顺便说一句，我选择了讲述人，因为它可以从登录屏幕作为系统服务触发，并且不会自动加载，因此，如果出现任何问题，我们仍然可以启动。</p><p>  要使用ClientRecoveryPasswordRotation漏洞，必须在\ RPC Control中使用符号链接。 USB驱动器上的可执行文件使用对DefineDosDevice的两次调用来创建链接，从而使该链接成为永久链接，以便它们可以在需要时退出/登录。 </p><p>很容易看到循环何时运行，因为讲述人将移动其焦点框并每秒说一次“访问被拒绝”。现在，我们可以使用在RPC控制中创建的链接。拔下USB记忆棒，然后重新插入。可写目录将在System32中创建。在下一个循环迭代中，将植入有效负载，并退出exploit.exe。若要测试漏洞利用程序是否成功，请关闭“讲述人”，然后尝试重新启动它。</p><p> 如果叙述者不起作用，那是因为DLL已植入，并且叙述者执行了该DLL，但是由于它以defaultuser1身份启动，因此无法添加帐户。植入有效负载后，您将需要单击返回登录屏幕并启动“讲述人”。将发出三声哔哔声，并显示一个消息框，指出DLL已作为SYSTEM加载。大！该帐户已创建，但不在列表中。按“我忘记了密码”，然后单击返回以更新列表。</p><p>    C：\ Users \ jonas＆gt;格式D：/ fs：ntfs / q为驱动器D插入新磁盘D：准备就绪时按ENTER ...---文件系统：NTFS。快速格式化30.0 GB容量标签（32个字符，对于ENTER输入创建文件系统结构。格式化完整。总磁盘空间30.0 GB。可用30.0 GB。</p><p>      D：\＆gt; icacls＆＃34;系统卷信息＆＃34; / grant每个人：（F）处理的文件：系统卷信息成功处理了1个文件；无法处理0个文件D：\＆gt; rmdir / s / q＆＃34;系统卷信息＆＃34;</p><p>      我披露了此漏洞，并为其分配了CVE-2020-1398。它的补丁可以在这里找到 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://secret.club/2021/01/15/bitlocker-bypass.html">https://secret.club/2021/01/15/bitlocker-bypass.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/bitlocker/">#bitlocker</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>