<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>走向Vagrant 3.0. Toward Vagrant 3.0</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Toward Vagrant 3.0<br/>走向Vagrant 3.0. </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-12 02:52:35</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/6/b20a0ce08e28c5cfe7e73c21b72aa99c.jpg"><img src="http://img2.diglog.com/img/2021/6/b20a0ce08e28c5cfe7e73c21b72aa99c.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>HashiCorp Vagrant started as a small project to make interacting with virtual machines for local development easy. A growing community of developers, operators, designers, and products rely on Vagrant. In pursuing the goal to continue improving Vagrant, we discovered a path that would allow Vagrant to be ported to Go and still support its Ruby-based features. In this post, we’ll discuss how migration to a Go code base will not only support developer environments of the past decade but also new development workflows, environments, and ecosystems.</p><p>Hashicorp Vagrant开始作为一个小项目，使与本地开发的虚拟机交互。越来越多的开发人员，运营商，设计师和产品依赖于流浪者。在追求目标继续改进流浪汉时，我们发现了一条允许移植的路径，以便移植到仍然支持其基于Ruby的功能。在此帖子中，我们将讨论对Go代码库的迁移程度如何，不仅会支持过去十年的开发人员环境，而且还支持新的开发工作流，环境和生态系统。</p><p> The changes we are working on now are designed to allow you to run Vagrant with a client-server architecture, secure it better on different operating systems, and manage its configuration globally. They’ll also offer a more seamless plugin development experience by improving the portability of plugins and reducing the complexity of package management.</p><p> 我们正在进行的更改现在旨在允许您使用客户端 - 服务器架构运行Vagrant，在不同的操作系统上更好地保护它，并在全球管理其配置。通过提高插件的可移植性以及降低包装管理的复杂性，它们还将提供更无缝插件开发经验。</p><p> Over the next year, Vagrant 2.3 and 2.4 will not break compatibility promises of Vagrantfiles or plugin interfaces. Vagrant 3.0 will introduce new methods for configuration but retain tooling for continued compatibility of Vagrantfiles. This includes detection for Ruby Vagrantfiles and installation of compatibility helpers to minimize interruptions to user workflow. While we don&#39;t yet have specific timeframes, we will announce our plans for these new versions of Vagrant as they solidify over the next few months.</p><p> 在明年，Vagrant 2.3和2.4不会破坏Vagrantfiles或Plugin接口的兼容性承诺。 Vagrant 3.0将引入新的配置方法，但保留工具以继续兼容Vagrantfiles的兼容性。这包括对Ruby VagrantFiles的检测和安装兼容性助手，以最大限度地减少对用户工作流程的中断。虽然我们没有具体的时间框架，但我们将在未来几个月内凝固这些新版本的流浪汉计划。</p><p>  You can look forward to many new features, capabilities, and improvements made possible by these updates to Vagrant’s architecture:</p><p>  您可以期待这些更新的许多新功能，功能和改进，以通过这些更新为VAGRANT的架构提供：</p><p>  The new architecture will allow you to run Vagrant on a remote host and secure actions on the machine. You will be able to install Vagrant on a resource-intensive machine and interact with it on a thin client, which will allow sharing of one Vagrant environment among multiple team members.</p><p>  新架构将允许您在远程主机上运行Vagrant并在机器上安全。您将能够在资源密集型计算机上安装Vagrant并在瘦客户端上与其交互，这将允许在多个团队成员之间共享一个VAGRANT环境。</p><p> A new client-server model will facilitate easy sharing of configuration and resources while also giving administrators power over Vagrant’s privileged actions. This streamlines the collaboration experience offered by the  existing Vagrant Share plugin. You will still be able to run Vagrant locally on a desktop machine and use the new security capabilities.</p><p> 新的客户端 - 服务器模型将易于分享配置和资源，同时还提供管理员over vagrant的特权操作。这简化了现有的VAGRANT共享插件提供的协作经验。您仍然可以在桌面机器上本地运行Vagrant，并使用新的安全功能。</p><p>  Vagrant runs as a user process that requires acceptance from a user to run privileged actions. You can work around request and acceptance on POSIX platforms using a  sudoers file to define each Vagrant command with escalated privileges. Unfortunately, you need to update this file any time you change the privileged Vagrant commands. On Windows systems, you cannot use a  sudoers file. Instead, you must confirm a User Account Control (UAC) prompt, which makes it difficult to run Vagrant in a headless context. Vagrant 3.0 will enable a privileged service to execute known and trusted commands from Vagrant and its plugins without the need for direct user interaction.</p><p>  VAGRANT作为用户进程运行，需要从用户接受以运行特权操作。您可以使用sudoers文件对Posix平台的请求和验收，以定义具有升级权限的每个vagrant命令。不幸的是，您需要随时更改特权VAGRANT命令时更新此文件。在Windows系统上，您无法使用sudoers文件。相反，您必须确认用户帐户控制（UAC）提示，这使得在无头脑中难以运行VAGRANT。 VAGRANT 3.0将启用特权服务来从VAGRANT及其插件执行已知和可信命令，而无需直接用户交互。 </p><p> In addition to finer control of trusted commands, you will be able to use controls to prevent automatic evaluation of Ruby-based Vagrantfiles. You will also be able to write configuration in HashiCorp Configuration Language (HCL) to limit the potential for mistakes or risk arising from dynamic configuration. This prevents arbitrary code execution inline in Vagrantfiles.</p><p>除了更精细地控制受信任命令之外，您将能够使用控件来防止自动评估基于Ruby的Vagrantfiles。您还将能够在Hashicorp配置语言（HCL）中编写配置，以限制来自动态配置引起的错误或风险的可能性。这可以防止VagrantFiles中的任意代码执行内联。</p><p>  Currently, you can reference only your own local configuration of Vagrant. Different users on the same system do not have access to the same configuration. A new, server-based approach will allow for management of a global Vagrant configuration, which you can also store in a database. This will fix  long-running issues where provider-specific information results in lost configuration settings. Lost settings can result in unexpected and unintended system modifications.</p><p>  目前，您只能引用自己的本地vagrant配置。同一系统上的不同用户无法访问相同的配置。一种新的基于服务器的方法将允许管理全局VAGRANT配置，您还可以存储在数据库中。这将修复提供者特定信息导致丢失配置设置的长期问题。丢失的设置可能导致意外和意外的系统修改。</p><p> Global configuration management helps organize Vagrant’s state and lays the foundation for adding a web-based UI, error checking, and transaction-based interactions. This improves Vagrant’s resilience to bad changes. The update will also resolve issues around Vagrant’s index file  growing too big or  being too fragile.</p><p> 全局配置管理有助于组织Vagrant的状态，并为添加基于Web的UI，错误检查和基于事务的交互而奠定基础。这改善了Vagrant的恢复力对糟糕的变化。更新还将解决Vagrant的索引文件周围的问题，而不是太大或太脆弱。</p><p>  While the existing Ruby plugin API will continue to be supported, Vagrant will support a new plugin API with the help of the  HashiCorp go-plugin library. Plugin authors will be able to create Vagrant plugins in Go or any other language with GRPC support. A plugin SDK will provide common utilities and helpers for plugin development.</p><p>  虽然将继续支持现有的Ruby Plugin API，但Vagrant将在Hashicorp Go-Plugin库的帮助下支持一个新插件API。插件作者将能够以GO或GRPC支持的任何其他语言创建Vagrant插件。插件SDK将为插件开发提供常用实用程序和帮助程序。</p><p> You will be able to port plugins written with the new API across platforms and release them independently of Vagrant’s releases. A compiled Go plugin&#39;s cross-platform capability will ease distribution and usage by simplifying current requirements for complex dependency management.</p><p> 您将能够跨平台与新API写入的插件，并独立于VAGRANT的版本释放它们。编译的Go插件＆＃39; S跨平台功能将通过简化复杂依赖管理的当前要求来轻松分配和使用。</p><p>  A long-standing issue with some plugins and third-party distributions packaging Vagrant revolves around Vagrant shipping its own Ruby. This causes friction when you want to  run Vagrant on the latest versions of Ruby or when Ruby plugins depend on packages that  require specific libraries. Moving away from bundling Ruby with Vagrant will give users more control over the Ruby runtime. For example, systems such as Arch or Fedora that distribute their own Vagrant package can safely depend on system Ruby.</p><p>  具有某些插件和第三方分布的长期问题，包装流浪汉围绕着流浪者围绕着自己的红宝石。当您想要在最新版本的Ruby或Ruby插件依赖于需要特定库的软件包时运行Vagrant时会导致摩擦。远离捆绑红宝石的流浪汉将使用户更加控制Ruby运行时。例如，诸如分布自己的Vagrant包的arch或fedora等系统可以安全地依赖于系统Ruby。</p><p>  We have developed a number of Go libraries for other HashiCorp products and other infrastructure tooling by various vendors and communities. The move to Go will allow Vagrant to more fully join this community, gaining the ability to use (and contribute to) tools that already exist, as well as lean on the Go expertise that exists at Hashicorp.</p><p>  我们开发了各种供应商和社区的其他Hashicorp产品和其他基础设施的Go图书馆。搬家将允许流浪者更充分地加入这个社区，获得使用（并贡献）已经存在的工具的能力，以及凭借Hashicorp存在的Go专业知识。 </p><p> HashiCorp tools such as  go-plugin and  glint helped us explore the possibilities around writing Vagrant in Go while maintaining backward compatibility. Moving forward, other Go libraries will allow Vagrant to accommodate a wide variety of new plugins. For example, you can use Go bindings for different virtualization software to build new plugins for many more backends.</p><p>Go-Plugin和Glint等Hashicorp工具帮助我们探讨了在维护向后兼容的过程中围绕写作流浪汉的可能性。向前迈进，其他Go库将允许流浪者容纳各种新插件。例如，您可以为不同的虚拟化软件使用Go绑定来构建新插件的更多后端。</p><p>  Vagrant has more than 70 built-in plugins. This proliferation has introduced new development constraints. Currently, any fix that may be required on a built-in plugin is dependent on the entirety of Vagrant before it can be released. With Vagrant 3.0, as we continue to improve the plugin API and portability, we can extract plugins from Vagrant so you can update them faster and easier.</p><p>  Vagrant拥有超过70个内置插件。这种扩散引入了新的发展限制。目前，内置插件可能需要的任何修复都依赖于可以在释放之前的整个流浪汉。使用VAGRANT 3.0，随着我们继续提高插件API和可移植性，我们可以从VAGRANT中提取插件，以便您可以更快更轻松地更新它们。</p><p> The focus will mainly be on provider and provisioner plugins. Once these plugins are externalized, you will be able to upgrade provider and provisioner plugins independent of Vagrant. Command plugins will remain internal and still depend on Vagrant’s release cycle.</p><p> 重点将主要是在提供者和便州插件上。一旦这些插件都是外部化的，您就可以升级无关的提供商和便携式插件。命令插件将保持内部，仍然依赖于Vagrant的发布周期。</p><p>  We recognize that porting a project to another language can be disruptive, so we aim to make it as seamless as possible. We will not deprecate any interfaces or features you require as a Vagrant end user or plugin developer during this process. First, we will port the core of Vagrant to Go. Once that is stable, we will work on built-in plugins. This iterative process ensures full compatibility between the Go and Ruby Vagrant runtimes, a requirement for our own built-in plugins to remain functional.</p><p>  我们认识到将项目移植到另一种语言可能是破坏性的，因此我们的目标是使其尽可能无缝。在此过程中，我们不会弃用您在Vagrant最终用户或插件开发人员所需的任何接口或功能。首先，我们将港口港口陷入困境。一旦稳定，我们将在内置插件上工作。此迭代过程可确保Go和Ruby Vagrant运行时完全兼容，这是我们自己内置插件的要求保持功能。</p><p>   The Vagrant 2.3 release will include the initial alpha version of the Go-based Vagrant implementation. It will be shipped in the Vagrant installer packages and made available as an optional executable. You will be able to choose to use the new implementation, but you may experience some instability. Throughout the Vagrant 2.3 release cycle, we will work to stabilize the Go-based Vagrant implementation and begin to port built-in plugins. The  vagrant command will continue to run the traditional Ruby-based Vagrant implementation.</p><p>   Vagrant 2.3版本将包括基于Go的Vagrant实现的初始alpha版本。它将在Vagrant Installer软件包中发货，并作为可选的可执行文件提供。您将能够选择使用新的实现，但您可能会遇到一些不稳定。在整个VAGRANT 2.3发布周期中，我们将努力稳定基于GO的VAGRANT实现并开始港口内置插件。 VAGRANT命令将继续运行传统的基于Ruby的VAGRANT实现。</p><p>  The Vagrant 2.4 release will feature the new Go implementation of Vagrant as the primary executable. It will include a migration command, which will import existing data from the Vagrant home and project directories. Vagrantfiles will also support HCL and data structures.</p><p>  vagrant 2.4版本将具有新的Go vagrant作为主要可执行文件实现。它将包含迁移命令，该命令将导入Vagrant Home和项目目录的现有数据。 VAGRANTFILES还将支持HCL和数据结构。</p><p> We will focus on identifying and resolving compatibility issues in the Vagrant 2.4 release cycle. You will still be able to use the Ruby-based implementation by using the alternate executable. Based on feedback and the consistency of user experience in the 2.4 series, we may have additional 2.x series releases.</p><p> 我们将专注于识别和解决Vagrant 2.4发布周期中的兼容性问题。您仍然能够使用备用可执行文件使用基于Ruby的实现。根据反馈和2.4系列中用户体验的一致性，我们可能有额外的2.x系列版本。 </p><p>  The Vagrant 3.0 release will include only the Go-based Vagrant implementation. By default, it will support only plugins that use the new API and HCL-based Vagrantfiles. The installer package will no longer include Ruby nor the extra dependencies required for running the Ruby-based Vagrant implementation.</p><p>VAGRANT 3.0版本只包含基于GO的VAGRANT实现。默认情况下，它只支持使用新API和基于HCL的VAGRANTFILE的插件。安装程序包将不再包含Ruby，也不包含运行基于Ruby的VAGRANT实现所需的额外依赖项。</p><p> You will still be able to use Ruby-based Vagrantfiles and Vagrant plugins. However, you will need to install Ruby on the host system. Vagrant will detect Ruby-based Vagrantfile or plugin usage and prompt you with instructions for installing Ruby on your platform. Once installed, Ruby-based Vagrantfiles and plugins will work normally.</p><p> 您仍然可以使用基于Ruby的VagrantFiles和Vagrant插件。但是，您需要在主机系统上安装Ruby。 VAGRANT将检测基于RUBY的VAGRANTFILE或插件使用，并提示您使用在您的平台上安装RUBY的说明。一旦安装，基于Ruby的VagrantFiles和插件将正常工作。</p><p>  From a new Go-based implementation to the externalization of plugins, we are designing Vagrant 3.0 to provide a foundation to integrate with new developer environments while maintaining the environments of the last decade. We look forward to making these changes available to help you scale your use and development of Vagrant. If you have feedback on our plans for Vagrant, or would like to ask questions about it, please reply with a comment in  our topic on the Vagrant forum.</p><p>  从新的GO-COMPETION of Plugins的外部化，我们正在设计VAGRANT 3.0，为实现与新开发人员环境的基础，同时保持上一十年的环境。我们期待使这些更改可用于帮助您扩展Vagrant的使用和开发。如果您有关于我们的VAGRANT计划的反馈，或者想提出关于它的问题，请回复我们在VAGRANT论坛上的课题中的评论。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.hashicorp.com/blog/toward-vagrant-3-0">https://www.hashicorp.com/blog/toward-vagrant-3-0</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/走向/">#走向</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/vagrant/">#vagrant</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>