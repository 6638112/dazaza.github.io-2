<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PureScript和Haskell PureScript and Haskell</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">PureScript and Haskell<br/>PureScript和Haskell </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-27 09:11:42</div><div class="page_narrow text-break page_content"><p>Two years ago, I starting learning  PureScript. Ihad been intrigued by purely functional programming for some time but had failedto learn  Haskell once or twice. PureScript seemed tobe a kinder, gentler introduction to this world while retaining the fundamentalproperties of pureness that made Haskell intriguing to me. As part of mylearning process, I rebuilt a slack bot  1 I had previously written in go.</p><p>两年前，我开始学习PureScript。我曾经对纯函数式编程很感兴趣，但是一两次都没学过Haskell。 PureScript似乎是对这个世界的一种更友好，更温和的介绍，同时保留了使Haskell着迷的纯净性的基本属性。作为mylearning过程的一部分，我重建了一个以前在go中编写的松弛bot 1。</p><p> Once I had learned PureScript and become more comfortable with purely functionalidioms, the next logical step seemed to be learning Haskell. I was surprised todiscover how much Haskell I already knew from learning PureScript, but corefeatures like laziness (PureScript is a strict language) took some getting usedto.</p><p> 一旦我学习了PureScript并且对纯函数习语变得更加熟悉，下一步的逻辑步骤似乎就是学习Haskell。我惊讶地发现通过学习PureScript我已经了解了多少Haskell，但是诸如惰性（PureScript是一种严格的语言）之类的核心功能却花了一些时间来适应。</p><p> I decided to finish my Haskell learning experience by rewriting my slack bot  2once again, this time in Haskell. In this post I’ll compare and contrast myexperiences writing the same program in Haskell and PureScript. The applicationI built was “real” enough to have some interesting design challenges. Theyincluded:</p><p> 我决定通过再次重写松弛机器人2once来结束Haskell的学习经历，这次是在Haskell。在这篇文章中，我将比较和对比在Haskell和PureScript中编写同一程序的经验。我构建的应用程序“真实”足以带来一些有趣的设计挑战。其中包括：</p><p>    Haskell is a lazy language while PureScript is a strict one. I expected thiscore difference to manifest itself constantly when writing these applications,but in reality it rarely came up. I had predicted a lot of banging my headagainst the wall dealing with laziness bugs but it just didn’t happen.</p><p>    Haskell是一种惰性语言，而PureScript是一种严格的语言。我希望这种核心差异在编写这些应用程序时会不断显现，但实际上很少出现。我曾预料过很多事情会撞墙，以应对懒惰的虫子，但这只是没有发生。</p><p> I will say that I generally prefer PureScript being a strict-by-defaultlanguage. When laziness is required, there are plenty of ways to  getit, but it is always explicit.</p><p> 我会说，我通常更喜欢PureScript是一种默认的严格语言。当需要懒惰时，有很多获取它的方法，但是它总是很明显的。</p><p> While not directly related to strictness, a pain point on the PureScript sidethat I didn’t experience in Haskell was stack safety  3. In PureScript, it canoften be confusing to determine if the operation you’re using is stack safe.When these operations  aren’t stack safe, the errors that are produced can beconfusing and hard to track down. I found myself struggling with stack safety inPureScript far more than I struggled with laziness in Haskell.</p><p> 虽然与严格性没有直接关系，但是我在Haskell中没有遇到过的PureScript方面的一个痛点是堆栈安全性3。在PureScript中，确定您使用的操作是否是堆栈安全性常常会造成混淆。堆叠不安全，所产生的错误可能令人困惑且难以追查。我发现自己在PureScript中为堆栈安全而苦苦挣扎远远超过在Haskell中为懒惰而苦苦挣扎。</p><p>  A year or two ago, I would have simply said that PureScript has incredibletooling and Haskell does not. Thanks to the amazing work on the  HaskellLanguage Server project,this gap is starting to close.</p><p>  一两年前，我会简单地说PureScript具有令人难以置信的工具，而Haskell没有。由于在HaskellLanguage Server项目上所做的出色工作，这种差距开始缩小。 </p><p> Regardless, PureScript still has far better tooling. Spago is an incredible build tool thatoffers many of the same features as Stack while remaining farmore user friendly and PureScript’s  languageserver is excellentand easy to install.</p><p>无论如何，PureScript仍然具有更好的工具。 Spago是令人难以置信的构建工具，它提供了许多与Stack相同的功能，同时又保持了用户友好性，PureScript的语言服务器非常出色且易于安装。</p><p> However, PureScript is currently struggling on a few fronts. First, the packageecosystem is moving from bower to a registry hosted on Github. Theresulting registry seems to be moving along nicely and I believe the result willbe incredible for the language, but the current in-between state is unfortunate.I am glad the core maintainers are taking their time to design this registrywell and I firmly believe that this will be a strong positive for the PureScriptcommunity in 6-12 months.</p><p> 但是，PureScript当前在几个方面都在挣扎。首先，packageecosystem正在从凉亭转移到Github上托管的注册表。结果注册表似乎进展顺利，我相信结果对于语言来说将是令人难以置信的，但是目前的过渡状态是不幸的。我很高兴核心维护者花时间设计此注册表井，我坚信这会在6到12个月内对PureScript社区产生积极的影响。</p><p> Second, PureScript doesn’t have a great option for a formatter. While purty does exist, it seems to be mostly inmaintenance mode and many of the formatting choices are frustrating for me.Specifically, the automatic removal of blank lines within functions and theaddition of newlines for  let assignments in  do blocks both hamperreadability and author intent. On the Haskell side, ormolu was easy to install and“just worked”.</p><p> 其次，PureScript对于格式化程序来说不是一个很好的选择。尽管确实存在purty，但它似乎主要是维护模式，许多格式化选择对我来说都是令人沮丧的。特别是，自动删除函数中的空白行以及添加新行以让do分配给do都阻碍了可读性和作者意图。在Haskell方面，ormolu易于安装且“工作正常”。</p><p>  It’s not a controversial statement to say that Haskell has far more languagefeatures than PureScript. It’s also not a new observation to say that it ischallenging to determine which of these features one should be using and whatextensions one should enable to use them. Here’s the list of default extensionsI have enabled for my project:</p><p>  说Haskell具有比PureScript更多的语言功能，这并不是有争议的说法。说要确定应使用这些功能中的哪些以及应启用哪些扩展功能的挑战也并不是什么新发现。这是我为我的项目启用的默认扩展名的列表：</p><p>  I found Haskell’s deriving capabilities to be more powerful than PureScript andled to reduced boilerplate, especially when creating my application monad. Ialso like that Haskell’s type class instances do not require names. The namesrequired by PureScript add very little in terms of readability or author intent.</p><p>  我发现Haskell的派生功能比PureScript更强大，并减少了样板，尤其是在创建应用程序monad时。我也喜欢Haskell的类型类实例不需要名称。 PureScript要求的名称在可读性或作者意图方面几乎没有增加。</p><p> By far the biggest difference I felt between the two languages is the way theydeal with records. Again, this isn’t a new observation, but it can not beoverstated how much better PureScript’s records are than Haskell’s. Recordsbased on row polymorphism are a joy to work with, as is having a dedicatedsyntax for creating, updating, and accessing records. GHC does have an  acceptedproposalfor adding record dot syntax which will solve many of these problems, but Ithink the underlying implementation based on row polymorphism will continue togive PureScript the edge here.</p><p> 到目前为止，我觉得这两种语言之间最大的区别是它们处理记录的方式。同样，这不是一个新发现，但不能高估PureScript的记录比Haskell的记录好多少。基于行多态性的记录具有创建，更新和访问记录的专用语法，因此使用起来很愉快。 GHC确实有一个添加记录点语法的提议，可以解决许多这些问题，但是我认为基于行多态性的基础实现将继续使PureScript占据优势。</p><p>  When I first learned PureScript I compared its compile times to other staticallytyped languages like Rust, Go, and Java. I found it much slower than these otherlanguages, though incremental rebuilds were generally quite fast. I assumed uponmoving to Haskell that the situation would be comparable or better. I was verywrong.</p><p>  当我第一次学习PureScript时，我将其编译时间与其他静态类型的语言（如Rust，Go和Java）进行了比较。我发现它比其他语言要慢得多，尽管增量重建通常相当快。我假设转移到Haskell后，情况将是可比的或更好的。我错了。 </p><p> Compilation times in Haskell are significantly worse than PureScript, often byan order or two of magnitude when compiling a project’s dependencies. I say thisless to rag on Haskell (this seems like a challenging problem to tackle), butmore to applaud the PureScript community for the work they’ve already done onthis front.</p><p>Haskell中的编译时间比PureScript差很多，在编译项目的依赖项时，编译时间通常要差一个或两个数量级。我说这对Haskell毫无用处（这似乎是一个极具挑战性的问题），但更值得称赞PureScript社区在此方面所做的工作。</p><p>  Haskell has a far larger ecosystem of packages than PureScript – kind of. Interms of Haskell and PureScript in isolation, Haskell has a vastly superiorcollection of packages and the quality of these packages is generally very high.However, PureScript has done a great job of porting over many of the bestHaskell packages.</p><p>  Haskell具有比PureScript大得多的软件包生态系统。 Haskell和PureScript是相互隔离的，Haskell具有非常丰富的软件包集合，这些软件包的质量通常很高。但是，PureScript在移植许多bestHaskell软件包方面做得很出色。</p><p> Additionally, PureScript gives you access to the entire ecosystem of JavaScriptpackages via FFI. While many in the community find this to be something of adisadvantage, from a practical perspective it is fantastic. As an example, whenbuilding full-text search for Haskell, I ended up using the full-text-searchpackage. It was fully featured and comprehensive, but required  quite abitof code to get working.</p><p> 此外，PureScript使您可以通过FFI访问整个JavaScriptpackage生态系统。尽管社区中的许多人认为这是一个缺点，但从实际的角度来看，这是很棒的。例如，在为Haskell建立全文搜索时，我最终使用了全文搜索包。它具有完整的功能和全面的功能，但是需要大量的代码才能正常工作。</p><p> On the PureScript side, I built a  simple FFIwrapperaround elasticlunr. While I understand that the JavaScript ecosystem haspackages of variable quality, it does have  lots of package solving  manyproblems and PureScript’s FFI makes it extremely easy to leverage this giantecosystem in a safe way.</p><p> 在PureScript方面，我围绕elasticlunr构建了一个简单的FFIwrapper。虽然我了解JavaScript生态系统具有质量可变的软件包，但确实有很多软件包可以解决许多问题，而PureScript的FFI使得以安全的方式利用此巨型生态系统变得极为容易。</p><p>  For my PureScript application I chose the HTTPure. It was light-weightand easy to use while feeling idiomatic. This was a relatively simple choicebecause there are few options for server-side frameworks within the PureScriptecosystem that included the features I needed (specifically middleware).</p><p>  对于我的PureScript应用程序，我选择了HTTPure。它重量轻且易于使用，同时感觉很惯用。这是一个相对简单的选择，因为PureScriptecosystem中的服务器端框架很少有包含我需要的功能（特别是中间件）的选项。</p><p> On the Haskell side, the choice of web framework was more complicated. I wantedsomething small and light-weight, but with the ability work within my custommonad stack for my application. I ended up using  scotty, but the defaultmiddleware solution doesn’t operate within your application’s monad stack, so Ineeded to explicitly provide middleware-like-functions for  eachendpointin my router.</p><p> 在Haskell方面，Web框架的选择更为复杂。我想要一些小巧轻便的东西，但是能够在我的custommonad堆栈中为我的应用程序工作。我最终使用了scotty，但是默认的中间件解决方案无法在您的应用程序的monad堆栈中运行，因此Ineeded明确为路由器中的每个端点提供了类似中间件的功能。</p><p> At the end of the day, this was mostly a wash between languages, but I expectedthe Haskell ecosystem to be far more mature in the backend HTTP service space.</p><p> 归根结底，这主要是语言之间的冲突，但是我希望Haskell生态系统在后端HTTP服务空间中会更加成熟。 </p><p>  To deploy my PureScript application, I used ncc. While this required that I had  nodeavailable in my deployment environment, it made everything else easy. The  ncctool produced a single, self-contained JavaScript file that included all of theapplication code along with required dependencies. I then simply  scp‘d this tomy deployment environment and ran it with  node.</p><p>要部署我的PureScript应用程序，我使用了ncc。尽管这要求我在部署环境中具有可用的节点，但是这使其他一切变得容易。 ncctool生成了一个单独的JavaScript文件，其中包含所有应用程序代码以及所需的依赖项。然后，我简单地将其部署到我的部署环境中，并与node一起运行。</p><p> On the Haskell side, I used stack’s docker support to build my application’sexecutable within a container that matches my deployment environment (debian),and then shipped the resulting executable via  scp as well. The executable wascompletely self-contained.</p><p> 在Haskell方面，我使用了堆栈的docker支持在与部署环境（debian）匹配的容器中构建应用程序的可执行文件，然后还通过scp交付了生成的可执行文件。该可执行文件是完全独立的。</p><p> Overall, both approaches felt equivalent in terms of ease. On the PureScriptside, it is a bit frustrating to need  node within the deployment environment.On the Haskell side, there was the added complication of having to use dockerfor cross-compilation. Overall, though, both experiences were reasonably nice.</p><p> 总体而言，这两种方法在简便性方面都相当。在PureScript方面，在部署环境中需要节点有点令人沮丧。在Haskell方面，不得不使用docker进行交叉编译带来了额外的麻烦。总体而言，这两种经验都相当不错。</p><p>  In reading over this post, I worry that it feels like I’m picking on Haskell –I’m absolutely not. I’m very aware that PureScript is  heavily influenced byHaskell and is standing the shoulders of giants. PureScript was able to learnfrom some of the mistakes of Haskell and make choices about intentionaldepartures from the Haskell ecosystem that better fit the intended use cases ofPureScript.</p><p>  在阅读这篇文章时，我担心感觉就像我在选择Haskell一样-绝对不是。我非常清楚PureScript受Haskell的影响很大，并且站在巨人的肩膀上。 PureScript能够从Haskell的一些错误中吸取教训，并做出关于Haskell生态系统中有意偏离的选择，这些偏离更适合PureScript的预期用例。</p><p> I found the experiences of learning and using both Haskell and PureScript veryrewarding. I will admit to being surprised at how well PureScript compared toHaskell in the server-side HTTP space, given that its primary focus is currentlyon the front end. I think both languages have a bright future and I’m excited tofollow their continued development.</p><p> 我发现学习和使用Haskell和PureScript的经验非常有益。鉴于PureScript在服务器端HTTP领域与Haskell相比表现出色，我将对此感到惊讶，因为它目前主要集中在前端。我认为这两种语言都有光明的未来，我很高兴跟随他们的不断发展。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.drewolson.org/purescript-and-haskell">https://blog.drewolson.org/purescript-and-haskell</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/haskell/">#haskell</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>