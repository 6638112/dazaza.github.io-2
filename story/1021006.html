<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>英特尔的“残缺AMD”功能(2019年)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">英特尔的“残缺AMD”功能(2019年)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-08-29 04:52:20</div><div class="page_narrow text-break page_content"><p>英特尔正在为各种用途生产C++和Fortran编译器以及几个高度优化的函数库。使用英特尔编译器和函数库的软件程序员并不总是意识到，使用这些工具生产的软件在AMD上或通过处理器执行时，运行速度可能会低于必要的速度。代码可能包含几个不同的版本，每个版本都针对特定的指令集扩展(如SSE2、AVX或AVX512)进行了优化。所谓的CPU调度器根据运行它的CPU来选择要运行的代码版本。CPU调度器可能是公平的，也可能是不公平的。公平的CPU调度器将根据CPU支持的指令集扩展选择最佳代码版本。只有当CPU在英特尔CPU上运行时，不公平的CPU调度器才会检测CPU的品牌并选择最佳代码路径。当在另一个品牌的CPU上运行时，即使CPU与更好的版本兼容，它也会选择慢速通用版本。不公平的CPU调度员在第三方程序员不知情的情况下出现在他们生产的软件中，引发了很多争议和法律诉讼。我们甚至看到基于基准软件的英特尔和AMD处理器之间的基准比较具有误导性，这些软件包含不公平的CPU调度器。有关这一主题的长篇讨论帖子可以在https://www.agner.org/optimize/blog/read.php?i=49.上的本博客的较旧版本中看到。本帖是对这一讨论的摘要，并回顾了最重要的结论。链接和详细信息可以在原始帖子中找到。几年前，当我开始测试英特尔的编译器时，我很快发现它有一个偏向的CPU调度器。早在2007年1月，我就向英特尔投诉CPU调度器不公平。我与英特尔工程师就这个问题进行了长时间的通信，他们一直否认这个问题，我也不断地提供更多的证据。他们说：CPU调度，加上优化，旨在优化英特尔和AMD处理器的性能，以提供最佳结果。这显然是我们的目标，除了一个例外，我们相信我们现在就在那里。一个例外是我们的9.x编译器在AMD处理器上不支持SSE3，因为AMD处理器与我们的编译器的发布时间不同(我们的编译器是在AMD支持SSE3之前开发的)。未来的10.x编译器将在本季度进入测试版，大约在今年年中发布，既然我们已经有时间调整和调整以适应新的AMD处理器，它将解决这个问题。</p><p>这听起来不错，但事实是CPU调度器不支持AMD处理器中的更高指令集，至今仍不支持(英特尔编译器版本19)。我后来发现，其他人也向英特尔提出了类似的投诉，得到了类似的无用答案(参见旧博客文章中的链接)。我还发现英特尔CPU调度器不仅检查供应商ID字符串和支持的指令集。它还检查了特定的处理器型号。事实上，它将无法识别未来家族号不同于6的英特尔处理器。当我向英特尔工程师提到这一点时，他们回答说：您提到，如果没有编译器更新，我们将不支持未来具有非6家族名称的英特尔处理器。是的，这是正确的，也是有意的。我们的编译器生成的代码，我们有很高的信心将在未来继续运行。这样做的效果是不会对未来的英特尔或AMD或其他处理器做出任何假设。你已经注意到我们可以更有攻击性。我们认为这对我们的客户来说是不明智的，他们希望他们的代码(用我们的编译器构建)能够在很长一段时间内继续运行的安全级别。您建议的方法虽然听起来合理，但对于我们高度优化的编译器来说还不够保守。我们的经验指导我们保守地发布代码，并在有机会验证新的英特尔和新的AMD处理器的功能时更新编译器。这意味着我们对新处理器的生产版本支持存在一定的滞后。</p><p>换句话说，他们声称他们是针对特定的处理器型号进行优化，而不是针对特定的指令集进行优化。如果是真的，这给了英特尔不能正确支持AMD处理器的理由。但这也意味着，每当市场上出现新的英特尔处理器时，所有使用英特尔编译器的软件开发商都必须重新编译代码，并向客户分发新版本。三年后，我尝试在最新的英特尔处理器上运行用旧版本的英特尔编译器编译的程序。您已经猜到了：它仍然运行最佳代码路径。但原因更难猜测：英特尔对新处理器上的CPUID系列编号进行了操控，使得它们在旧的英特尔软件中看起来像是已知的型号。也许英特尔&#的最初设计</p><p>切勿依赖基准测试，除非已知基准测试代码是开源的，并且无需使用任何英特尔工具即可编译。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.agner.org/forum/viewtopic.php?f=1&t=6">https://www.agner.org/forum/viewtopic.php?f=1&t=6</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/英特尔/">#英特尔</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/amd/">#amd</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cripple/">#cripple</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1020232.html"><img src="http://img.diglog.com/img/2020/8/thumb_d7f7d21e816b2215e20a16504ad60032.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1020232.html">Verta由跟踪机器学习模型版本的ModelDB的创建者创立，在英特尔资本(Intel Capital)的带领下，凭借1000万美元的首轮融资从隐形中脱颖而出</a></div><span class="my_story_list_date">2020-8-26 2:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1019946.html"><img src="http://img.diglog.com/img/2020/8/thumb_832104dcc297a961d396f843217ed054.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1019946.html">苹果15年前的一项决定如何伤害了现在的英特尔</a></div><span class="my_story_list_date">2020-8-24 2:54</span></div><div class="col-sm"><div><a target="_blank" href="/story/1019770.html"><img src="http://img.diglog.com/img/2020/8/thumb_3008bd59e4da459384d7bdc416ab700a.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1019770.html">英特尔转向芯片：7纳米的“Client 2.0”</a></div><span class="my_story_list_date">2020-8-22 19:5</span></div><div class="col-sm"><div><a target="_blank" href="/story/1019643.html"><img src="http://img.diglog.com/img/2020/8/thumb_c66d3466a0a7fc304a38d0872f9b5e12.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1019643.html">英特尔Xe-HP显卡：早期示例提供42 TFLOPS的FP32性能</a></div><span class="my_story_list_date">2020-8-22 2:44</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>