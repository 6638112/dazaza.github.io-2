<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>适用于Linux的一些HiDPI技巧 A few HiDPI tricks for Linux</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">A few HiDPI tricks for Linux<br/>适用于Linux的一些HiDPI技巧 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-31 02:53:34</div><div class="page_narrow text-break page_content"><p>As part of that switch, I needed to configure parts of my Linux environment (which was originallystock Ubuntu, but is now  i3 with a heavily customized userspace) to functioncorrectly on HiDPI displays.</p><p>作为该切换的一部分，我需要配置Linux环境的某些部分（最初是Ubuntu的原始版本，但现在是i3，具有大量自定义的用户空间），才能在HiDPI显示器上正确运行。</p><p> This post will document most of the changes I applied. Hopefully others will find it useful fortheir own HiDPI setups.</p><p> 这篇文章将记录我应用的大多数更改。希望其他人会发现它对自己的HiDPI设置有用。</p><p>  As it turns out, there’s a (nearly) one-stop location for configuring the default DPI forX11 applications: the  Xft.dpi setting.</p><p>  事实证明，这里有一个（几乎）一站式的位置，用于配置X11应用程序的默认DPI：Xft.dpi设置。</p><p> There are lots of ways to configure X11, but I personally use an  ~/.Xresources file:</p><p> 有很多方法可以配置X11，但是我个人使用〜/ .Xresources文件：</p><p>   On my system,  ~/.Xresources gets loaded into the X resource database automatically by somemagic that I never configured. However, if yours doesn’t (or you use a different resource file),you can always tell i3 (or your WM of choice) to load it explicitly with  xrdb.</p><p>   在我的系统上，〜/ .Xresources通过我从未配置过的魔术自动加载到X资源数据库中。但是，如果您没有（或使用其他资源文件），则始终可以告诉i3（或您选择的WM）使用xrdb显式加载它。</p><p>   With just this, about 90% of my applications (including GTK based ones, like Firefox) scaledcorrectly and were usable without any font or custom scaling changes. Not bad for a single line!</p><p>   有了这个，大约90％的应用程序（包括基于GTK的应用程序，如Firefox）可以正确缩放，并且可以使用，而无需更改任何字体或自定义缩放比例。单行还不错！</p><p>   Spotify’s Linux application is a  CEFshell. For reasons that are unclear to me, it doesn’t respect  Xft.dpi while normal Chromium(via  snap or  apt) does.</p><p>   Spotify的Linux应用程序是CEFshell。由于我不清楚的原因，它不尊重Xft.dpi，而普通的Chromium（通过snap或apt）却尊重Xft.dpi。 </p><p>   At this point, it became clear to me that the fractional form of my DPI would be nice to set inas few places as possible, to avoid duplication. Hence the  janus.fractionalDpi  above,and this little  spotify wrapper:</p><p>在这一点上，我很清楚DPI的小数形式可以在尽可能少的位置设置，以避免重复。因此，上面的janus.fractionalDpi和这个小的Spotify包装器：</p><p> # see the actual script linked above for some program-finding stupidity real_spotify =/snap/bin/spotify # grab the correct fractional DPI from the X resource DB dpi = $(xrdb  -query |  grep  &#34; $( hostname ) .fractionalDpi&#34; |  cut  -f2 ) &#34; ${ real_spotify } &#34;  --force-device-scale-factor = &#34; ${ dpi } &#34;  &#34; ${ @ } &#34;</p><p> ＃查看上面链接的实际脚本，了解一些程序发现愚蠢real_spotify = / snap / bin / spotify＃从X资源DB dpi = $（xrdb -query | grep＆＃34; $（hostname）中获取正确的分数DPI。分数Dpi＆＃34; | cut -f2）＆＃34; $ {real_spotify}＆＃34; --force-device-scale-factor =＆＃34; $ {dpi}＆＃34; ＆＃34; $ {@}＆＃34;</p><p>  I use  Sublime Text 3 as my primary editor. As far as I can tellit doesn’t use either GTK or Qt (or any other open-source GUI framework), which is probably whyit doesn’t respect  Xft.dpi.</p><p>  我将Sublime Text 3用作主要编辑器。据我所知，它既不使用GTK也不使用Qt（或任何其他开源GUI框架），这可能就是为什么它不尊重Xft.dpi的原因。</p><p> To get Sublime Text to scale correctly, I had to set  ui_scale to the appropriate fractional DPIin my user preferences ( ~/.config/sublime-text-3/Preferences.sublime-settings):</p><p> 为了使Sublime Text正确缩放，我必须在用户首选项（〜/ .config / sublime-text-3 / Preferences.sublime-settings）中将ui_scale设置为适当的分数DPI：</p><p>   Sublime Text’s input is noticeably laggy when the UI is scaled. It’s not so laggy as to beunusable, but it’s definitely noticeable even if you aren’t sensitive to latencies (I’m not).</p><p>   缩放UI时，Sublime Text的输入明显滞后。它虽然不那么笨拙，却无法使用，但即使您对延迟不敏感（我也不是），也绝对可以注意到。</p><p>  Mousing between Sublime Text and other windows causes noticeable stutter/hiccuping duringvideo playback. I haven’t dug into the X events yet, but my guess is that it’s got some kindof pessimistic (and serial)  XFlush or  XSync that takes a decent bit of time on a larger windowbuffer. It doesn’t happen with smaller windows (either floating or fixed).</p><p>  在Sublime Text和其他窗口之间移动会在视频播放期间引起明显的卡顿/打ic。我还没有研究过X事件，但是我猜想它有一些悲观（和串行）的XFlush或XSync，它们在较大的窗口缓冲区上需要花费一些时间。较小的窗口（浮动窗口或固定窗口）不会发生这种情况。</p><p>  I haven’t used it recently, but I used to use  OBS to stream myselfworking on open source projects.</p><p>  我最近没有使用过它，但是我曾经使用OBS来流媒体处理开源项目。 </p><p> When I switched monitors, I noticed that the embedded preview window for my scenes had stoppedworking. OBS  itself was still fully functional and the  separate preview window still worked,but the embedded preview was always filled in with black pixels.</p><p>切换显示器时，我注意到场景的嵌入式预览窗口已停止工作。 OBS本身仍然可以正常运行，并且单独的预览窗口仍然有效，但是嵌入式预览始终填充有黑色像素。</p><p> After a decent bit of hair-pulling, I found a Qt environment variable that “fixed” it:</p><p> 经过一番梳理之后，我发现了一个Qt环境变量来“修复”它：</p><p>  I still don’t understand why that fixed it, but now my OBS is scaled correctly  and has afunctional preview embed. I also posted this fix to the OBS forum.</p><p>  我仍然不明白为什么要修复此问题，但是现在我的OBS已正确缩放并嵌入了功能预览。我还将此修复程序发布到OBS论坛。</p><p>  I use   feh as my image viewer. By default, it seems to usea bitmap font that’s incredibly small on HiDPI displays.</p><p>  我使用feh作为图像查看器。默认情况下，它似乎使用的位图字体在HiDPI显示器上非常小。</p><p> To fix it, I modified by default theme to use my distro supplied Ubuntu Roman-face font in14pt.</p><p> 为了修复它，我默认修改了主题以使用发行版提供的Ubuntu Roman-face字体in14pt。</p><p>   One thing I haven’t figured out: when I open some higher-resolution images in  feh, they’reoccasionally shifted to the right with transparent pixels where some of the image should be.Clicking and dragging inside the image window causes it to re-render correctly, as doesresizing the window. Not a huge deal, but slightly annoying.</p><p>   我还没有弄清楚的一件事：当我用feh打开一些高分辨率的图像时，它们有时会向右移动，其中应包含一些图像的透明像素。在图像窗口内单击并拖动会导致图像重新正确渲染，就像调整窗口大小一样。没什么大不了的，但是有点烦人。</p><p>   It didn’t  need any HiDPI-specific configuration, but I took the opportunity to make itsnotifications slightly more readable on these newer displays.</p><p>   它不需要任何特定于HiDPI的配置，但我借此机会使这些通知在这些较新的显示器上更具可读性。 </p><p>     My new displays are individually larger and significantly more dense than my previous ones, makingmy mouse feel sluggish. I originally configured my mouse acceleration with  xset, but at some point mysystem switched to  libinput and  libinput-based inputs apparently don’t respect  xset anymore(or never did?). Sigh.</p><p>我的新显示器分别比以前的显示器更大，并且密度更大，这使鼠标感觉迟钝。我最初用xset配置了鼠标加速，但是在某些时候，我的系统切换到了libinput和基于libinput的输入显然不再使用xset了（或者从不这样做）。叹。</p><p> The fix is to use  xinput instead, with either symbolic names or XIDs for the device and settingbeing controlled. For example, this is what I use to set my mouse’s acceleration to the maximum( 1.0):</p><p> 解决的办法是改用xinput，使用设备的符号名称或XID，并进行设置控制。例如，这是我用来将鼠标的加速度设置为最大值（1.0）的方法：</p><p>  Your device and setting names may vary, of course, as may their value ranges (mine happened to be 0.0 to  1.0). You can use  xinput on its own to list the names and XIDs of your devices; xinput list-props &lt;XID-or-name&gt; can be used to dump a particular device’s properties andtheir current values.</p><p>  当然，您的设备和设置名称可能会有所不同，其值范围也可能有所不同（我的碰巧是0.0到1.0）。您可以单独使用xinput列出设备的名称和XID。 xinput list-props＆lt; XID或名称＆gt;可用于转储特定设备的属性及其当前值。</p><p>  I use i3’s  layout saving/restoring functionalityto automatically load all of my workspaces and their applications when I log in.</p><p>  登录时，我使用i3的布局保存/恢复功能自动加载所有工作区及其应用程序。</p><p> Those layouts are stored in a (relaxed) JSON format via  i3-save-tree, and contain hardcodedcoordinates. To update them for my new monitors, I just had to recreate each of my workspacesonce on my new monitors and dump them:</p><p> 这些布局通过i3-save-tree以（宽松的）JSON格式存储，并包含硬编码的坐标。要为新显示器更新它们，我只需要在新显示器上重新创建每个工作区并将其转储：</p><p>     HexChat’s config file includes individual offsets for each of the sub-panes in the GUI,which means that it breaks badly if you change your monitor dimensions. I couldn’t figure outhow to fix them, so I ended up deleting my main  ~/.config/hexchat/hexchat.conf entirely andrecreating my preferred layout from memory. YMMV.</p><p>     HexChat的配置文件在GUI中的每个子窗格中都包含单独的偏移量，这意味着，如果您更改显示器尺寸，则损坏严重。我无法弄清楚如何解决它们，因此最终删除了我的主〜/ .config / hexchat / hexchat.conf并从内存中重新创建了我喜欢的布局。 YMMV。</p><p>  I didn’t have to make any changes with respect to my system icon sizes, which is  probablybecause I actually see very few icons during normal i3 usage. Once again, YMMV.</p><p>  我不需要对系统图标大小进行任何更改，这可能是因为在i3正常使用期间实际上看到的图标很少。再次，YMMV。 </p><p>  Switching from a set of 3 FHD monitors to two 4K HiDPI ones was  relatively painless. Theproblems that I had, unsurprisingly, were primarily with the few proprietary applications I useneeding to be spoon-feed DPI information in their own ways — every other problem waseither a bug (OBS + Qt) or a matter of more general reconfiguration.</p><p>从一组3个FHD监视器切换到两个4K HiDPI监视器是相对容易的。 毫无疑问，我遇到的问题主要是我使用的少数专有应用程序需要以自己的方式来获取DPI信息-其他所有问题都是bug（OBS + Qt）或更一般的重新配置问题。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.yossarian.net/2020/12/24/A-few-HiDPI-tricks-for-Linux">https://blog.yossarian.net/2020/12/24/A-few-HiDPI-tricks-for-Linux</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/适用/">#适用</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tricks/">#tricks</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>