<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PRET-打印机开发工具包</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">PRET-打印机开发工具包</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-13 17:36:54</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/af2421cf2b10c8daf0b0243b5afd064f.png"><img src="http://img2.diglog.com/img/2020/11/af2421cf2b10c8daf0b0243b5afd064f.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>PRET是在波鸿鲁尔大学硕士论文范围内开发的一种新的打印机安全测试工具。它通过网络或USB连接到设备，并利用给定打印机语言的功能。目前，大多数激光打印机都支持PostScript、PJL和PCL。这使得捕获或操作打印作业、访问打印机的文件系统和内存，甚至造成设备物理损坏之类的事情变得很酷。所有攻击都详细记录在黑客打印机维基上。</p><p>PRET的主要思想是促进终端用户和打印机之间的通信。因此，在输入类似于UNIX的命令后，Pret会将其转换为PostScript、PJL或PCL，并将其发送到打印机，评估结果，然后将其转换回用户友好的格式。Pret提供了一系列对打印机攻击和模糊有用的命令。</p><p>Pret只需要一个Python2解释器。但是，对于彩色输出和SNMP支持，需要安装第三方模块：</p><p>如果在Windows控制台上运行且Unicode字符显示不正确，请安装Win_Unicode_Console模块：</p><p>对于实验性的无人驾驶打印(请参阅打印命令)，需要安装ImageMagick和GhostScript：</p><p>用法：prepre.py[-h][-s][-q][-d][-i file][-o file]target{ps，pjl，pcl}位置参数：目标打印机设备或主机名{ps，pjl，pcl}要滥用的打印语言可选参数：-h，--Help显示此帮助消息并退出-s，--Safe验证语言是否受支持-q，--Quiet Suppress Warning and chit-chat-d，--debug进入调试模式(show Traffic。--从file-o file加载文件并运行命令，--log file记录发送到目标的原始数据。</p><p>PRET需要有效的目标和打印机语言作为参数。目标可以是网络打印机的IP地址/主机名(端口9100/tcp打开)，也可以是本地USB打印机的/dev/usb/lp0之类的设备。要使用SNMP广播快速发现您的子网中的所有网络打印机，只需在不带参数的情况下运行Pret：</p><p>./prepre.py未给出目标，发现本地打印机解决设备正常运行时间状态────192.168.1.5 HP LaserJet 4250 10：21：49 Ready 192.168.1.11 HP LaserJet M3027 MFP 13天卡纸192.168。1.27利盟X792 153天准备就绪192.168.1.28 MFC-7860DW 16：31：17睡眠模式</p><p>要滥用的打印机语言必须是PS、PJL或PCL之一。并非所有打印机都支持所有语言，因此如果没有收到任何反馈，您可能需要切换语言。每种打印机语言都映射到一组不同的PRET命令，并且有不同的功能可供利用。</p><p>--在连接之前，外管局尝试通过IPP、HTTP和SNMP检查设备是否确实支持所选的打印语言(PS/PJL/PCL)。在非联网打印机(USB、并行电缆)上，此测试将失败。</p><p>--DEBUG显示实际发送到设备的数据流以及收到的反馈。请注意，报头数据和其他开销会被过滤。要查看整个流量，请使用Wireshark。也可以使用DEBUG命令在Pret会话中打开/关闭调试。</p><p>--LOAD FILENAME从文本文件读取并执行Pret命令。这对自动化很有用。稍后也可以通过LOAD命令在Pret会话中调用命令文件。</p><p>--log filename将发送到打印机的原始数据流的副本写入文件。这对于构建恶意打印作业文件非常有用，该文件可以部署在无法直接访问的另一台打印机上，例如通过从USB驱动器打印该文件。</p><p>连接到打印机设备后，您将看到Pret外壳，并可以执行各种命令：</p><p>$./pre.py laserjet.lan pjl_/|/_/__/||Pret|打印机开发工具包v0.25|=|-|Jens Mueller&lt；jens.a.mueller@Rub.de&gt；|ô|_|ô|/.‘--.|“因为您的设备可以|-||/_\||-。||“比卡纸更有趣”|_||=L==H==|__|/(Jan Foerster创作的ASCII艺术)与laserjet.lan的连接已建立设备：HP LaserJet 4250欢迎使用PRET外壳。键入Help或？列出命令。laserjet.lan：/&gt；Help可用命令(键入Help&lt；topic&gt；)：==append DEBUG EDIT FREE ID ls Open Restart Timeout猫DELETE env Fuzz Info Mirror printenv selftest ouch CD df exit get load mkdir put set traversalchvolDisable Find Help LOCK NVRAM PWD site unlock CLOSE DISPLAY FORMAT HOLD LOOP LOOP OFLINE RESET STATUS VERSION LASERJET.lan：/&gt；ls../../-834.profred-bind-devd../../-834.profied-bind-devd。</p><p>Help列出可用命令或获取有关Help的详细帮助。调试进入调试模式。将十六进制用于十六进制转储：调试[十六进制]从文件加载运行命令：加载cmd.txtloop用于多个参数的运行命令：LOOP&lt；cmd&&gt;；&lt；arg1；&lt；arg2&&gt;…。打开连接到远程设备：打开&lt；目标&&gt;关闭与设备的连接。超时设置连接超时：超时&lt；秒&&gt;发现通过SNMP发现本地打印机设备。打印图像文件或原始文本：打印&lt；文件&gt；|&#34；文本&34；站点在打印机上执行自定义命令：站点&lt；命令&&gt;退出解释程序。</p><p>┌─┬──┐│命令│ps│pjl│pcl│描述│├─┼─。──┤│ls│✓│列出远程目录的内容。││获取│✓│接收文件：获取&lt；文件&&gt;││PUT│✓│SEND FILE：PUT&lt；本地文件&&gt;││追加│✓│✓││附加到文件：APPED&lt；FILE&&gt;lt；││DELETE│✓│删除远程文件：DELETE&lt；FILE&gt；││Rename│✓│││Rename远程文件：Rename&lt；old&gt；&lt；new&gt；││Find│✓│✓││递归列出目录内容。││将远程文件系统镜像到本地目录的│✓│✓││镜像。││CAT│✓│将远程文件输出到标准输出。││编辑│✓│使用VIM编辑远程文件。││Touch│✓│✓││更新文件时间戳：Touch&lt；文件&&gt;││mkdir│✓│✓││创建远程目录：mkdir&lt；路径&&gt;。│├─┼──┤│CD│✓│✓││更改远程工作目录。││pwd│✓│✓││显示设备上的工作目录。││CHVOL│✓│✓││更改远程卷：CHVOL&lt；卷&gt；││遍历│✓│✓││设置路径遍历：遍历&lt；路径&gt；│├─┼──┤│Format│✓│✓││初始化打印机的文件系统。││FUZZ│✓│✓││文件系统模糊：FUZZ&lt；Category&gt；│├─┴───┴─┤│Path-使用路径遍历策略探索文件系统结构。││写入-首先放入/追加文件，然后检查其是否存在。││对现有文件(如/etc/passwd)进行盲读测试。│├─┬──┤│DF│✓│✓││显示卷信息。││空闲│✓│显示可用内存。│└─┴──┘。</p><p>ID显示设备信息。version显示PostScript解释器版本。device显示可用的I/O设备。uptime显示系统正常运行时间(可能是随机的)。date显示打印机的系统日期和时间。pagecount显示打印机的页面计数器。lock设置startjob和系统参数密码。解锁取消设置startjob和系统参数密码。重新启动PostScript解释器。重置PostScript设置为出厂默认设置。禁用打印功能。销毁对打印机造成物理损坏。在所有硬拷贝上交叉放置打印机涂鸦：Cross&lt；font&&gt;；；text&gt；替换要打印文档中的字符串：替换&lt；旧&&gt;；新&&gt;；捕获捕获要在此设备上打印的更多作业。按住启用作业保留。在最上面的词典中将关键字设置为值：设置&lt；key=value&gt；已知列表支持的PostScript运算符：已知&lt；运算符&&gt;搜索所有字典。CATEGORY&&gt;[DUMP]转储字典：DUMP&lt；dict&gt；字典：-system dict-statusdict-userdict-global aldict-serverdict-errordict-inderdict-CurrentSystems params-CurrentUserparams-currentpagedeviceconfig更改打印机设置：配置&lt；设置&gt；双面打印。副本数-设置副本数。经济模式--设定经济模式。底片-设置底片打印。镜像设置镜像倒置。</p><p>并非所有命令都受每台打印机支持。尤其是兄弟公司和京瓷公司的设备使用他们自己的PostScript克隆--BR-SCRIPT和KPDL--而不是授权原始的“Adobe PostScript”。PostScript语言的这种风格可能不是100%兼容的，特别是在捕获打印作业等安全敏感功能方面。大多数打印机都支持对文件系统的访问，但通常仅限于特定的沙盒目录。</p><p>ID显示设备信息。状态启用状态消息。版本显示固件版本或序列号(来自信息配置)。页面计数操作打印机的页面计数器：页面计数；数字&&gt;打印v显示打印机环境变量：printenv；var&&gt;；env显示环境变量(信息变量的别名)。set设置打印机环境变量：set&lt；var=。重新启动打印机。重置为出厂默认设置。selftest执行各种打印机自检。禁用打印功能。销毁会对打印机的NVRAM造成物理损坏。泛洪泛洪用户输入，可能会泄漏缓冲区溢出。锁定锁定控制面板设置和磁盘写入访问。解锁控制面板设置和磁盘写入访问。保持锁定启用作业保留。nvram NVRAM操作：NVRAM&lt；operation；NVRAM dump[ALL]-DUMP。NVRAM环</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/RUB-NDS/PRET">https://github.com/RUB-NDS/PRET</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开发/">#开发</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/打印/">#打印</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/打印机/">#打印机</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/printer/">#printer</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034768.html"><img src="http://img2.diglog.com/img/2020/11/thumb_a5ab568f810c56bd7816499f6b8dee4f.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034768.html">由伦敦大学学院和加州大学伯克利分校开发的软件可以达到90%的准确率</a></div><span class="my_story_list_date">2020-11-12 22:16</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034653.html"><img src="http://img2.diglog.com/img/2020/11/thumb_d03228d7ff1d5e4e8d10be75ae5e1e69.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034653.html">总部位于肯塔基州的Venminder是一家开发工具来帮助企业分析供应商风险的公司，该公司在Silversmith Capital Partners的带领下筹集了3300万美元的C系列资金</a></div><span class="my_story_list_date">2020-11-12 4:40</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034520.html"><img src="http://img2.diglog.com/img/2020/11/thumb_ca7ab737fdb82980c2814c6815a90fc8.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034520.html">养成专业开发团队习惯</a></div><span class="my_story_list_date">2020-11-11 21:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034501.html"><img src="http://img2.diglog.com/img/2020/11/thumb_fe6347209b37a886567884b6eb29599e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034501.html">是什么帮助我成为一名更有效率的软件开发人员</a></div><span class="my_story_list_date">2020-11-11 17:48</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>