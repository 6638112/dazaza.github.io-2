<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Nx：具有多阶段编译的多维张量Elixir lib（CPU / GPU） Nx: Multi-dimensional tensors Elixir lib with multi-staged compilation (CPU/GPU)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Nx: Multi-dimensional tensors Elixir lib with multi-staged compilation (CPU/GPU)<br/>Nx：具有多阶段编译的多维张量Elixir lib（CPU / GPU） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-18 00:46:17</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/6a6b1eec0de5a63aba2179183e85ac25.png"><img src="http://img2.diglog.com/img/2021/2/6a6b1eec0de5a63aba2179183e85ac25.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Nx is a multi-dimensional tensors library for Elixir with multi-staged compilation to the CPU/GPU. Its high-level features are:</p><p>Nx是Elixir的多维张量库，具有对CPU / GPU的多阶段编译。它的高级功能是：</p><p> Typed multi-dimensional tensors, where the tensors can be unsigned integers (sizes 8, 16, 32, 64), signed integers (sizes 8, 16, 32, 64), floats (sizes 32, 64) and brain floats (sizes 16);</p><p> 类型化的多维张量，其中的张量可以是无符号整数（8、16、32、64的大小），有符号整数（8、16、32、64的大小），浮点数（32、64的大小）和脑浮点数（16的大小） ）;</p><p> Named tensors, allowing developers to give names to each dimension, leading to more readable and less error prone codebases;</p><p> 命名张量，使开发人员可以为每个维度命名，从而使代码库更具可读性，并且不易出错。</p><p> Automatic differentiation, also known as autograd. The  grad function provides reverse-mode differentiation, useful for simulations, training probabilistic models, etc;</p><p> 自动分化，也称为autograd。梯度函数提供反向模式微分，可用于仿真，训练概率模型等；</p><p> Tensors backends, which enables the main  Nx API to be used to manipulate binary tensors, GPU-backed tensors, sparse matrices, and more;</p><p> 张量后端，使主要的Nx API可以用于处理二进制张量，GPU支持的张量，稀疏矩阵等；</p><p> Numerical definitions, known as  defn, provide multi-stage compilation of tensor operations to multiple targets, such as highly specialized CPU code or the GPU. The compilation can happen either ahead-of-time (AOT) or just-in-time (JIT) with a compiler of your choice;</p><p> 数值定义（称为defn）为多个目标（例如高度专业的CPU代码或GPU）提供张量操作的多阶段编译。使用您选择的编译器，编译可以提前进行（AOT）或及时进行（JIT）。</p><p> You can find planned enhancements and features in the issues tracker. If you need one particular feature to move forward, don&#39;t hesitate to let us know and give us feedback.</p><p> 您可以在问题跟踪器中找到计划的增强功能。如果您需要一项特定功能来向前迈进，请随时告知我们并提供反馈。 </p><p> Nx&#39;s mascot is the Numbat, a marsupial native to southern Australia. Unfortunately the Numbat are endangered and it is estimated to be fewer than 1000 left. If you enjoy this project, consider donating to Numbat conservation efforts, such as  Project Numbat and  Australian Wildlife Conservancy.</p><p>Nx的吉祥物是Numbat，它是原产于澳大利亚南部的有袋动物。不幸的是，Numbat濒临灭绝，估计还不到1000。如果您喜欢这个项目，可以考虑捐赠Numbat保护工作，例如Numbat项目和澳大利亚野生动物保护组织。</p><p> For Python developers,  Nx currently takes its main inspirations from   Numpy and   JAX but packaged into a single unified library.</p><p> 对于Python开发人员而言，Nx当前主要从Numpy和JAX汲取灵感，但打包到一个统一的库中。</p><p>    Discussions about Nx are also welcome in any of the Elixir community spaces, such as the  Elixir Forum and the other channels listed  on the sidebar of elixir-lang.org.</p><p>    在Elixir的任何社区空间（例如Elixir论坛和elixir-lang.org侧边栏中列出的其他频道）中，也欢迎对Nx进行讨论。</p><p>  In order to use  Nx, you will need Elixir installed. Then create an Elixir project via the  mix build tool:</p><p>  为了使用Nx，您将需要安装Elixir。然后通过混合构建工具创建一个Elixir项目：</p><p>  Then you can add  Nx as dependency in your  mix.exs. At the moment you will have to use a Git dependency while we work on our first release:</p><p>  然后，您可以在mix.exs中添加Nx作为依赖项。目前，在我们开发第一个版本时，您将不得不使用Git依赖项：</p><p>      iex &gt; t  =  Nx. tensor([[ 1,  2], [ 3,  4]])iex &gt;  Nx. divide( Nx. exp(t),  Nx. sum( Nx. exp(t)))  #Nx.Tensor&lt; f64[ 2][ 2] [ [ 0.03205860328008499,  0.08714431874203257], [ 0.23688281808991013,  0.6439142598879722] ] &gt;</p><p>      iex＆gt; t = Nx。张量（[[1，2]，[3，4]] iex＆gt; Nx。除法（Nx.exp（t），Nx.sum（Nx.exp（t）））＃Nx.Tensor＆lt; f64 [2] [2] [[0.03205860328008499，0.08714431874203257]，[0.23688281808991013，0.6439142598879722]]＆gt;</p><p>  By default,  Nx uses pure Elixir code. Since Elixir is a functional and immutable language, each operation above makes a copy of the tensor, which is quite innefficient.</p><p>  默认情况下，Nx使用纯Elixir代码。由于Elixir是一种功能性且不变的语言，因此上述每个操作都会复制张量，这是非常低效的。 </p><p> However,  Nx also comes with numerical definitions, called  defn, which is a subset of Elixir tailored for numerical computations. For example, it overrides Elixir&#39;s default operators so they are tensor-aware:</p><p>但是，Nx还带有称为defn的数字定义，这是为数字计算量身定制的Elixir的子集。例如，它会覆盖Elixir的默认运算符，因此它们可感知张量：</p><p>  defn supports multiple compiler backends, which can compile said functions to run on the CPU or in the GPU. For example,  using the  EXLA compiler, which provides bindings to Google&#39;s XLA:</p><p>  defn支持多个编译器后端，这些后端可以编译所述函数以在CPU或GPU中运行。例如，使用EXLA编译器，该编译器提供了对Google XLA的绑定：</p><p>  Once  softmax is called,  Nx.Defn will invoke  EXLA to emit a just-in-time and high-specialized compiled version of the code, tailored to the tensor type and shape. By passing  client: :cuda or  client: :rocm, the code can be compiled for the GPU. For reference, here are some benchmarks of the function above when called with a tensor of one million random float values:</p><p>  调用softmax后，Nx.Defn将调用EXLA来生成针对张量类型和形状量身定制的即时且高度专业的代码编译版本。通过传递client：：cuda或client：：rocm，可以为GPU编译代码。作为参考，以下是使用一百万个随机浮点值的张量调用时上述函数的一些基准：</p><p> Name ips average deviation median 99th %xla gpu f32 keep 15308.14 0.0653 ms ±29.01% 0.0638 ms 0.0758 msxla gpu f64 keep 4550.59 0.22 ms ±7.54% 0.22 ms 0.33 msxla cpu f32 434.21 2.30 ms ±7.04% 2.26 ms 2.69 msxla gpu f32 398.45 2.51 ms ±2.28% 2.50 ms 2.69 msxla gpu f64 190.27 5.26 ms ±2.16% 5.23 ms 5.56 msxla cpu f64 168.25 5.94 ms ±5.64% 5.88 ms 7.35 mselixir f32 3.22 311.01 ms ±1.88% 309.69 ms 340.27 mselixir f64 3.11 321.70 ms ±1.44% 322.10 ms 328.98 msComparison:xla gpu f32 keep 15308.14xla gpu f64 keep 4550.59 - 3.36x slower +0.154 msxla cpu f32 434.21 - 35.26x slower +2.24 msxla gpu f32 398.45 - 38.42x slower +2.44 msxla gpu f64 190.27 - 80.46x slower +5.19 msxla cpu f64 168.25 - 90.98x slower +5.88 mselixir f32 3.22 - 4760.93x slower +310.94 mselixir f64 3.11 - 4924.56x slower +321.63 ms</p><p> 名称ips平均偏差中位数99th％xla gpu f32保持15308.14 0.0653 ms±29.01％0.0638 ms 0.0758 msxla gpu f64保持4550.59 0.22 ms±7.54％0.22 ms 0.33 msxla cpu f32 434.21 2.30 ms±7.54％2.26 ms 2.69 msxla gpu f32 398.45 2.51 ms±2.28％2.50 ms 2.69 msxla gpu f64 190.27 5.26 ms±2.16％5.23 ms 5.56 msxla cpu f64 168.25 5.94 ms±5.64％5.88 ms 7.35 mselixir f32 3.22 311.01 ms±1.88％309.69 ms 340.27 mselixir f64 3.11 321.70 ms±1.44％ 322.10 ms 328.98 ms比较：xla gpu f32保持15308.14xla gpu f64保持4550.59-慢3.36x +0.154 msxla cpu f32 434.21-慢35.26x +2.24 msxla gpu f32 398.45-38.42x慢+2.44 msxla gpu f32 -2.464 xxla gpu f64 46。 5.19 msxla cpu f64 168.25-慢90.98x +5.88 mselixir f32 3.22-4760.93x慢+310.94 mselixir f64 3.11-4924.56x慢+321.63 ms</p><p>  defn relies on a technique called multi-stage programming, which is built on top of Elixir functional and meta-prgramming capabilities: we transform Elixir code to emit an AST that is then transformed to run on the CPU/GPU. Ultimately, the  defn compiler is pluggable, which means developers can implement bindings for different tensor compiler technologies and choose the most appropriate one.</p><p>  defn依靠一种称为多阶段编程的技术，该技术建立在Elixir功能和元编程功能的基础上：我们将Elixir代码转换为发出AST的代码，然后将其转换为在CPU / GPU上运行。最终，defn编译器是可插入的，这意味着开发人员可以为不同的张量编译器技术实现绑定并选择最合适的技术。</p><p> Many of Elixir features are supported inside  defn, such as the pipe operator, aliases, conditionals, pattern-matching, and more. Other features such as loops and in-place updates are on the roadmap.  defn also support  transforms, which allows numerical definitions to be transformed at runtime. Automatic differentiation, via the  grad function, is one example of transforms.</p><p> defn中支持Elixir的许多功能，例如管道运算符，别名，条件，模式匹配等。路线图上还包含其他功能，例如循环和就地更新。 defn还支持转换，该转换允许在运行时转换数字定义。通过grad函数自动进行区分是转换的一个示例。</p><p>   Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);you may not use this file except in compliance with the License.You may obtain a copy of the License at  http://www.apache.org/licenses/LICENSE-2.0</p><p>   根据Apache许可证2.0版（＆＃34; License＆＃34;）获得许可，除非遵守该许可，否则不得使用此文件。您可以从http：//www.apache获得该许可的副本。 org / licenses / LICENSE-2.0 </p><p> Unless required by applicable law or agreed to in writing, softwaredistributed under the License is distributed on an &#34;AS IS&#34; BASIS,WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.See the License for the specific language governing permissions andlimitations under the License.</p><p>除非适用法律要求或书面同意，否则根据许可协议分发的软件将按“原样”分发。 没有任何形式的保证或条件的基础，无论明示或暗示。请参见许可以了解用于管理许可下的许可和限制的特定语言。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/elixir-nx/nx/tree/main/nx">https://github.com/elixir-nx/nx/tree/main/nx</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/编译/">#编译</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/阶段/">#阶段</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/multi/">#multi</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/张量/">#张量</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>