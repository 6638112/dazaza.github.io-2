<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>不推荐使用SHA1</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">不推荐使用SHA1</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-24 08:11:44</div><div class="page_narrow text-break page_content"><p>Hi,I&#39;m turning to this mailing list to seek advice about how to deal withSHA1-based self signatures. I have two concrete questions, which areat the bottom of the email. But first, I want to present the concreteproblem and my thoughts so far.Based on the &#34;SHA-1 is a Shambles&#34; paper [1] we decided to changeSequoia to reject signatures that use SHA1 by default [2]. Thisincludes both signatures over data, as well as self signatures of allkinds including primary key binding signatures (aka backsigs). [1]  https://sha-mbles.github.io/ [2]  https://docs.sequoia-pgp.org/sequoia_openpgp/policy/struct.StandardPolicy.html#method.reject_hash_atA Secure Drop developer recently contacted us, and indicated that ourpolicy was too strict: some of the Secure Drop installations haveoffline keys that use SHA1, and the users have no easy way (or lackthe will) to update those keys.This prompted me to investigate the use of SHA1 in general.Unfortunately, it appears that many actively used certificates fromtechnically sophisticated users still rely on SHA1. The results of myinvestigation are here:  https://gitlab.com/sequoia-pgp/sequoia/-/issues/595First, I found that Microsoft&#39;s &#34;Security Notifications PGP Key&#34; [3],which was created less than a year ago (Oct 2019) uses SHA-1. Giventhe use of the  preferred-email-encoding@pgp.com notation, I suspectthat they are using a Symantec PGP product. [3]  https://www.microsoft.com/en-us/msrc/pgp-key-security-notificationsLooking at the Debian Keyring, I found that: - 106 of the 884 certificate (12%) use SHA1 for all User ID binding signatures and direct key signatures - 63 more (7%) use SHA1 to protect at least one non-revoked User ID. - 234 have a non-revoked, live signing capable subkey - 19 of those have binding signatures that use SHA1 in some way (8%). - 9 use something stronger for the subkey binding signature, but SHA1 for the backsig. (This appears to be a bug in GnuPG, which I reported [4].) [4]  https://dev.gnupg.org/T5110As Debian Developers are perhaps the most sophisticated OpenPGP users,this is pretty damning.For Arch developers, the situation is worse: 2 of the 5 master (&#34;CA&#34;)keys rely on SHA1. Of the 72 developer keys, 26 (36%) use SHA1 forall User ID self signatures and direct key signatures. Of the 46remaining certificates, 2 use SHA1 for a non-revoked, livesigning-capable subkey.Looking at the Fedora Project&#39;s signing Keys [5]: all 7 use SHA1exclusively. When I spoke with the person responsible for thisinfrastructure, we discovered that this was due to a configurationerror, which they promptly fixed. [5]  https://getfedora.org/static/fedora.gpgGiven these results, we decided to reevaluate our bad listing of SHA1.As the SHA1 paper indicates that SHA1&#39;s preimage resistance is notbroken, I thought that we might be able to accept SHA1 for selfsignatures, and not for documents [6]. But, Azul pointed out [7] thatMallory could create a collision for a document and a self-signature,and then convince Alice to sign the document. This could work inpractice because Mallory can predict everything in the signature, butthe timestamp, and if Alice is an automated signing service, there isa good chance that Mallory would be able to get Alice to sign thedocument at the right time. [6]  https://gitlab.com/sequoia-pgp/sequoia/-/issues/595 [7]  https://gitlab.com/sequoia-pgp/sequoia/-/issues/595#note_433768966If the signature included a salt, Mallory would have had a much hardertime coercing Alice to sign the document with the right metadata. Assuch, we plan to include a salt in all signatures that Sequoia makesso that should, say, SHA256 suffer the same fate as SHA1, we can stillrely on preimage resistance to allow us to continue to accept selfsignatures that use SHA256 for a while [8]. [8]  https://gitlab.com/sequoia-pgp/sequoia/-/issues/597So, two questions: - Does anyone see a safe way to accept SHA1 self-signatures today? Or (ouch!), if we want to be safe, do we have to convince ~10% of the sophisticated OpenPGP users to re-sign or regenerate their keys? - What do people think about including a salt in the hash to make the content of the hash less predictable as described in [7]?Thanks!:) Neal</p><p>嗨，我现在转向这个邮件列表，寻求如何处理基于SHA1的自我签名的建议。我有两个具体的问题，在电子邮件的底部。但首先，我想介绍一下具体的问题和我到目前为止的想法。基于SHA-1是一篇乱七八糟的文章[1]，我们决定更改Sequoia以拒绝默认使用SHA1的签名[2]。这既包括数据签名，也包括所有类型的自签名，包括主键绑定签名(也称为Backsigs)。[1]https://sha-mbles.github.io/[2]https://docs.sequoia-pgp.org/sequoia_openpgp/policy/struct.StandardPolicy.html#method.reject_hash_atA Secure Drop Developer最近与我们联系，并指出我们的策略过于严格：一些安全Drop安装具有使用sha1的脱机密钥，用户没有轻松的方法(或缺乏意愿)更新这些密钥。这促使我调查sha1的一般使用情况。不幸的是，似乎许多来自技术成熟用户的频繁使用的证书仍然依赖sha1。我的调查结果如下：https://gitlab.com/sequoia-pgp/sequoia/-/issues/595First，我发现微软创建不到一年(2019年10月)的安全通知PGP密钥[3]使用的是SHA-1。考虑到首选电子邮件编码@pgp.com符号的使用，我怀疑他们使用的是赛门铁克PGP产品。[3]https://www.microsoft.com/en-us/msrc/pgp-key-security-notificationsLooking在Debian Keyring，我发现：-884个证书中的106个(12%)使用sha1作为所有用户ID绑定签名和直接密钥签名-63个(7%)使用sha1来保护至少一个未撤销的用户ID。-234个具有不可撤销的实时签名能力的子密钥-其中19个具有绑定签名，以某种方式使用了sha1(8%)。对子密钥绑定签名使用更强的标记，但对Backsig使用-9\f25 SHA1-9\f6。[4]OpenPdebian开发人员可能是最老练的https://dev.gnupg.org/T5110As用户，这是相当糟糕的。对于ArchDebian开发人员来说，情况更糟：5个主(&#34；CA&34；)密钥中有2个依赖于SHA1.。在72个开发者密钥中，26个(36%)使用SHA1进行所有用户ID自签名和直接密钥签名。在剩余的46个证书中，有2个使用SHA1作为未撤销的、支持实时签名的子密钥。查看Fedora项目的签名密钥[5]：所有7个证书都独占使用SHA1。当我与负责此基础设施的人员交谈时，我们发现这是由于配置错误造成的，他们立即修复了该错误。[5]https://getfedora.org/static/fedora.gpgGiven这些结果后，我们决定重新评估我们糟糕的SHA1列表。由于SHA1的论文指出SHA1的前像阻力没有损坏，我想我们或许可以接受SHA1用于自我签名，而不是用于文档[6]。但是，阿祖尔指出[7]马洛里可能会造成文档和自签名的冲突，然后说服爱丽丝在文档上签名。这在实践中是可行的，因为Mallory可以预测签名中的所有内容，除了时间戳，如果Alice是自动签名服务，那么Mallory很有可能能够让Alice在正确的时间签署文档。[6]https://gitlab.com/sequoia-pgp/sequoia/-/issues/595[7]https://gitlab.com/sequoia-pgp/sequoia/-/issues/595#note_433768966If签名包括盐，如果马洛里强迫爱丽丝用正确的元数据在文档上签名，那就难得多了。因此，我们计划在红杉制作的所有签名中加入一种盐，这样如果SHA256遭受与SHA1相同的命运，我们仍然可以依靠前像阻力来允许我们在一段时间内继续接受使用SHA256的自我签名[8]。[8]https://gitlab.com/sequoia-pgp/sequoia/-/issues/597So，有两个问题：-今天有没有人看到接受sha1自签名的安全方法？或者(哎呀！)，如果我们想要安全，我们需要说服大约10%的经验丰富的OpenPGP用户重新签名或重新生成他们的密钥吗？-人们对在散列中加入盐以使散列内容更难预测(如[7]所述)有何看法？谢谢！：)Neal</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://mailarchive.ietf.org/arch/msg/openpgp/Rp-inhYKT8A9H5E34iLTrc9I0gc/">https://mailarchive.ietf.org/arch/msg/openpgp/Rp-inhYKT8A9H5E34iLTrc9I0gc/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/签名/">#签名</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>