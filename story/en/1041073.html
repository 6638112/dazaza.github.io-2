<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>通用缓解措施 Generic Mitigations</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Generic Mitigations<br/>通用缓解措施 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-22 01:54:35</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/9d5a67e4e39b78f8b4415ea222afaca7.jpg"><img src="http://img2.diglog.com/img/2020/12/9d5a67e4e39b78f8b4415ea222afaca7.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Greetings, fellow reader of articles on the internet! Do you work on a service that you (and, presumably, your users) would like to keep working? Well, if so, I’m here to convince you that your service should have at least one or two generic mitigations ready to go. If it doesn’t, you’re in for a bad time. If it does, treasure them, maintain them, and  use them, lest they rot beneath your feet.</p><p>问候，互联网上文​​章的读者！您是否正在使用您（以及可能是您的用户）想要继续工作的服务？好吧，如果是这样，我在这里是要说服您，您的服务应至少准备好一两个通用缓解措施。如果不是这样，那您将陷入困境。如果这样，请珍惜它们，加以维护并使用，以免它们在您的脚下腐烂。</p><p>  Alrighty. From the top: a  mitigation is any action you might take to reduce the impact of a breakage, generally in production. A hotfix is a mitigation. SSHing into an instance and clearing the cache is a mitigation. Duct-taping a spare battery to a shoddy laptop counts, too. Cutting off power to a datacenter to close down a vulnerability is a mitigation, I guess, in the same way a guillotine cures the common cold.</p><p>  好的从顶部开始：缓解是您可能会采取的减少断裂影响的任何措施，通常是在生产中。修补程序是一种缓解措施。 SSH进入实例并清除缓存是一种缓解措施。将次要电池用管道输送给劣质笔记本电脑也很重要。我想，切断数据中心的电源以消除漏洞是一种缓解措施，就像断头台治愈普通感冒一样。</p><p>   A  generic mitigation, then, is one that is useful in mitigating a wide variety of outages.</p><p>   因此，通用缓解措施可用于缓解各种中断。</p><p> For example, a binary rollback is probably the most common generic mitigation. Many multi-homed services will have an emergency drain-the-traffic-off-the-broken-replica button, which is a good generic mitigation for query-based services. Others might have separate data rollbacks, or a tool to quickly add a whole bunch of additional capacity.</p><p> 例如，二进制回滚可能是最常见的通用缓解措施。许多多宿主服务都将有一个紧急耗用流量中断的副本按钮，对于基于查询的服务，这是一个很好的通用缓解方法。其他人可能有单独的数据回滚，或者是一种快速添加一大堆额外容量的工具。</p><p> The most important characteristic of a generic mitigation is this:  You don’t need to fully understand your outage to use it.</p><p> 通用缓解措施的最重要特征是：您无需完全了解中断就可以使用它。</p><p>   Okay, let me expand on that: you want to understand your outage  after it is mitigated. Let’s draw a quick picture of a typical outage.</p><p>   好的，让我对此进行扩展：您希望了解缓解后的中断。让我们快速了解一下典型的停机情况。</p><p>  The goal of building good generic mitigations is to have a weapon ready to wield as early in the timeline as possible. If the only mitigations available to you are problem-specific, then you will be unable to help your users until you understand the problem in detail. It is very difficult to decrease the time it takes to understand a problem; if we could easily find problems, then we most likely wouldn’t have caused them in the first place.</p><p>  建立良好的通用缓解措施的目的是要准备在时间轴上尽早使用武器。如果唯一可用的缓解措施是特定于问题的，那么您将无法帮助您的用户，除非您详细了解该问题。减少理解问题所花费的时间非常困难。如果我们可以轻松地发现问题，那么我们很可能根本不会造成问题。 </p><p> So let’s assume that the measure of success for a team’s incident management is not “time to fix,” but “time to mitigate,” and that the thing we want to minimize is the time our users spend utterly broken.  It is far easier to build mitigations with broad application than it is to make root-causing faster.</p><p>因此，我们假设团队事件管理成功与否的衡量标准不是“修复时间”，而是“缓解时间”，而我们要最小化的事情是用户的总花费时间。建立具有广泛应用的缓解措施要比使根源更快变得容易得多。</p><p>    That’s a nonsense sentence. Let’s try again. A good, generic something-terrible-is-happening fix-it-quick button is simple (and safe!) to use in an emergency; a solid generic mitigation tool takes a lot of work beforehand to create and needs to be carefully tailored to the service it is mitigating.</p><p>    那是一句废话。让我们再试一次。一个好的通用的，发生故障的快速修复按钮很容易（而且安全！）在紧急情况下使用。可靠的通用缓解工具需要事先进行大量工作才能创建，并且需要针对要缓解的服务进行精心定制。</p><p> There are, however, some very good  general patterns for generic mitigations that we can learn from, though these will need careful tweaking to make them fit your specific service.</p><p> 但是，我们可以从中学习一些非常好的通用缓解模式，尽管这些模式需要仔细调整才能使其适合您的特定服务。</p><p>   Rollback This reverts your service—most commonly, your binary, but there are other options—to a known-good state. Almost every service can implement a version of this strategy. Far too many  think they have safe rollbacks, only to learn otherwise during an outage.</p><p>   回滚这会将您的服务（最常见的是二进制文件）还原到已知良好的状态。几乎每个服务都可以实现此策略的一个版本。太多的人认为他们有安全的回滚，只是在停电期间学习其他方法。</p><p> Data rollback  This is a sub-case of the previous one—it reverts just your data. Content-heavy services are more likely to find this useful, particularly those building data from pipelines.</p><p> 数据回滚这是前一个的子情况，它仅还原您的数据。内容密集型服务更可能发现此功能有用，尤其是那些通过管道构建数据的服务。</p><p> Degrade  Is your service overloaded? Having a way to do less work but stay up is a huge improvement over crashing. Attempts to create a new degradation mechanism while your system burns will always bite you.</p><p> 降级您的服务过载了吗？有一种方法可以减少工作量但又可以保持正常工作，这是对崩溃的巨大改进。在系统刻录过程中尝试创建新的降级机制总是会伤您。</p><p> Upsize  Got too much traffic? Or is everything running hot for no reason? Add more replicas. It’s expensive, but cheaper than pissing off users with an outage. Note that this is rarely as simple as “scale up one binary”; system scaling is complex.</p><p> 大型流量过多？还是一切都没有理由热起来？添加更多副本。它很昂贵，但是比因中断而惹怒用户便宜。注意，这很少像“按比例放大一个二进制文件”那样简单。系统扩展很复杂。 </p><p> Block list  Got a query of death? Single spammy user taking out a zone? Block them.</p><p>阻止列表是否有死亡查询？单个垃圾邮件用户正在删除区域？阻止他们。</p><p> Drain  Move your traffic to a different place. This one works great if you’re multi-homed and traffic driven: if one region sees high errors, move the requests elsewhere.</p><p> 排水将您的交通移至其他地方。如果您是多宿主和交通拥堵者，那么此方法非常有用：如果一个地区出现高错误，请将请求移到其他地方。</p><p> Quarantine  A good way to address the “bad instance” problem is to enforce a quarantine. Isolate a given unit of your usage—a hot DB row, a spammy user, a poisoned traffic stream—so whatever bug it is hitting stops breaking others.</p><p> 隔离解决“坏实例”问题的一种好方法是强制执行隔离。隔离给定的使用单位（热数据库行，垃圾用户，有毒流量），因此无论遇到什么错误，它都不会破坏其他漏洞。</p><p>   Yeah, you’d look pretty silly if you drained an instance because a recent release triggered errors, only to see the same errors 30 minutes later when the next instance upgrades. None of these are magic: you need to diagnose to the level of understanding the  kind of failure scenario you’re dealing with.</p><p>   是的，如果因为最近的版本触发了错误而耗尽了一个实例，您看起来会很傻，直到下一个实例升级30分钟后才看到相同的错误。这些都不是魔术：您需要进行诊断才能了解您要处理的故障情况。</p><p>  These patterns are also not all equally useful to all services. For example, draining is nonsense for a lot of localized products whose users are pinned to a single physical zone. Quarantining is no use when your workloads are inseparable or when they’re already perfectly isolated. Degraded mode isn’t always an option.</p><p>  这些模式也并非对所有服务都同样有用。例如，对于许多本地化产品，将用户固定在单个物理区域上，浪费资源是无稽之谈。当工作负载不可分割或已经完全隔离时，隔离是没有用的。降级模式并非总是一种选择。</p><p> So ask yourself what strategies make sense for your service. Make that part of your  production readiness review—write down existing generic mitigations, and plan to add more if you’re falling short. (But not too many! Quality over quantity!) The better and more standardized your mitigations, the easier it is to scale support; there’ll be no need to page an expert awake at 2 AM if the mitigation will hold ‘til the morning.</p><p> 因此，问问自己哪些策略对您的服务有意义。在您的生产准备情况审查中，包括减少现有的通用缓解措施，并计划在不足的情况下增加更多。 （但不要太多！质量胜于数量！）缓解措施越规范，越标准化，支持扩展就越容易；如果缓解措施持续到早上，则无需在凌晨2点呼叫专家醒来。</p><p>  Unfamiliar tooling is dangerous even in the hands of skilled oncallers. Whatever means you choose—running drills, adding automated tests, writing little checklists new team members must complete to gain production credentials—make  certain your team has touched your mitigations. After all: tape backups no one’s ever practiced restoring might as well be fancy paperweights, for all the help they’ll be the first time someone runs  rm -r /* in prod.</p><p>  即使在熟练的呼叫者手中，陌生的工具也是危险的。无论您选择什么，都要进行钻探，添加自动化测试，编写新的清单以确保新团队成员必须完成才能获得生产证书，从而确保您的团队已经触及了缓解措施。毕竟：磁带备份从来没有人尝试过进行还原，这可能不是花哨的纸镇，因为所有帮助都是他们第一次在产品中运行rm -r / *。 </p><p>  There’s a secondary benefit, too: by exercising your mitigations regularly, you validate their behaviors. Our systems are complex enough that you cannot know the knock-on effects of actually using your generic mitigation until you’ve used it for real.</p><p>还有第二个好处：通过定期执行缓解措施，可以验证其行为。我们的系统非常复杂，以至于您不了解实际使用通用缓解措施所产生的连锁反应。</p><p> The goal is to create easy, safe, frictionless panic buttons for your service that any oncall feels comfortable using at the slightest suspicion they might help. That’s not easy to build. But it is far, far cheaper to build them in advance than it is to endure the lengthy, unmitigatable outages you’ll see without.</p><p> 目标是为您的服务创建简单，安全，无摩擦的紧急按钮，使任何通话时都感到舒适，而丝毫怀疑它们可能会有所帮助。搭建起来并不容易。但是，相比于忍受长时间无休止的停机，提前构建它们要便宜得多。</p><p>  In brief:  The most expensive stretch of an outage is the time when users can see it. A quick path to “mostly working” is far better for the user than waiting for “perfectly fixed.” If you’re driving a majestic old Toyota Corolla, sometimes the best tactic is making sure there’s duct tape in the glove box so you can make it to the mechanic when the wing mirror falls off.</p><p>  简而言之：中断中最昂贵的部分是用户可以看到的时间。对于用户来说，快速进入“大部分工作状态”的途径比等待“完全解决”问题要好得多。如果您驾驶的是雄伟的旧丰田卡罗拉，有时最好的策略是确保手套箱中有胶带，以便在后视镜掉落时可以将它贴在机修工身上。</p><p>    This post is a collaboration between O’Reilly and Google.  See our statement of editorial independence.</p><p>    这篇文章是O’Reilly和Google之间的合作。请参阅我们关于编辑独立性的声明。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.oreilly.com/content/generic-mitigations/">https://www.oreilly.com/content/generic-mitigations/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/缓解/">#缓解</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/generic/">#generic</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/服务/">#服务</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>