<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>阿帕奇箭头2.0.0锈色亮点</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">阿帕奇箭头2.0.0锈色亮点</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-07 18:11:34</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/11/fbae8366a92252684fa42b8b22c473bc.png"><img src="http://img2.diglog.com/img/2020/11/fbae8366a92252684fa42b8b22c473bc.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Apache Arrow 2.0.0 is a significant release for the Apache Arrow project in general (release notes), and the Rust subproject in particular, with almost 200 issues resolved by 15 contributors. In this blog post, we will go through the main changes affecting core Arrow, Parquet support, and DataFusion query engine. The full list of resolved issues can be found here. While the Java and C/C++ (used by Python and R) Arrow implementations likely remain the most feature-rich, with the 2.0.0 release, the Rust implementation is closing the feature gap quickly. Here are some of the highlights for this release. Core Arrow Crate Iterator Trait Primitive arrays (e.g., array of integers) can now be converted to and initialized from an iterator. This exposes a very popular API - iterators - to arrow arrays. Work for other types will continue throughout 3.0.0. Improved Variable-sized Arrays Variable sized arrays (e.g., array of strings) have been internally refactored to more easily support their larger (64-bit size offset) version. This allowed us to generalize some of the kernels to both (32 and 64) versions and perform type checks when building them. Kernels There have been numerous improvements in the Arrow compute kernels, including: New kernels have been added for string operations, including substring, min, max, concat, and length. Aggregate sum is now implemented for SIMD with a 5x improvement over the non-SIMD operation Many kernels have been improved to support dictionary-encoded arrays Some kernels were optimized for arrays without nulls, making them significantly faster in that case. Many kernels were optimized in the number of memory copies that are needed to apply them and also on their implementation. Other Improvements The Array trait now has get_buffer_memory_size and get_array_memory_size methods for determining the amount of memory allocated for the array. Parquet A significant effort is underway to create a Parquet writer for Arrow data. This work has not been released as part of 2.0.0, and is planned for the 3.0.0 release. The development of this writer is being carried out on the rust-parquet-arrow-writer branch, and the branch is regularly synchronized with the main branch. As part of the writer, the necessary improvements and features are being added to the reader. The main focus areas are: Supporting nested Arrow types, such as List> Ensuring correct round-trip between the reader and writer by encoding Arrow schemas in the Parquet metadata Improve null value writing for Parquet A new parquet_derive crate has been created, which allows users to derive Parquet records for simple structs. Refer to the parquet_derive crate for usage examples. DataFusion DataFusion is an in-memory query engine with DataFrame and SQL APIs, built on top of base Arrow support. DataFrame API DataFusion now has a richer DataFrame API with improved documentation showing example usage, supporting the following operations: select_columns select filter aggregate limit sort collect explain Performance & Scalability DataFusion query execution now uses async/await with the tokio threaded runtime rather than launching dedicated threads, making queries scale much better across available cores. The hash aggregate physical operator has been largely re-written, resulting in significant performance improvements. Expressions and Compute Improved Scalar Functions DataFusion has many new functions, both in the SQL and the DataFrame API: Length of an string COUNT(DISTINCT column) to_timestamp IsNull and IsNotNull Min/Max for strings (lexicographic order) Array of columns Concatenation of strings Aliases of aggregate expressions Many existing expressions were also significantly optimized (2-3x speedups) by avoiding memory copies and leveraging Arrow format’s invariants. Unary mathematical functions (such as sqrt) now support both 32 and 64-bit floats and return the corresponding type, thereby allowing faster operations when higher precision is not needed. Improved User-defined Functions (UDFs) The API to use and register UDFs has been significantly improved, allowing users to register UDFs and call them both via SQL and the DataFrame API. UDFs now also have the same generality as DataFusion’s functions, including variadic and dynamically typed arguments. User-defined Aggregate Functions (UDAFs) DataFusion now supports user-defined aggregate functions that can be used to perform operations than span multiple rows, batches, and partitions. UDAFs have the same generality as DataFusion’s functions and support both row updates and batch updates. You can check out this example to learn how to declare and use a UDAF. User-defined Constants DataFusion now supports registering constants (e.g. “@version”) that live for the duration of the execution context and can be accessed from SQL. Query Planning & Optimization User-defined logical plans The Logical Plan enum is now extensible through an Extension variant which accepts a UserDefinedLogicalPlan trait using dynamic dispatch. Consequently, DataFusion now supports user-defined logical nodes, thereby allowing complex nodes to be planned and executed. You can check this example to learn how to declare a new node. Predicate push-down DataFusion now has a Predicate push-down optimizer rule that pushes filter operations as close as possible to scans, thereby speeding up the physical execution of suboptimal queries created via the DataFrame API. SQL DataFusion now uses a more recent release of the sqlparser crate, which has much more comprehensive support for SQL syntax and also supports multiple dialects (Postgres, MS SQL, and MySQL). It is now possible to see the query plan for a SQL statement using EXPLAIN syntax. Benchmarks The benchmark crate now contains a new benchmark based on TPC-H that can execute TPC-H query 1 against CSV, Parquet, and memory data sources. This is useful for running benchmarks against larger data sets. Integration Testing / IPC Arrow IPC is the format for serialization and interprocess communication. It is described in arrow.apache.org and is the format used for file and stream I/O between applications wishing to interchange Arrow data. The Arrow project released IPC version 5 of the Arrow IPC format in version 1.0.0. Before that, a message padding change was made in version 0.15.0 to change the default padding to 8 bytes, while remaining in IPC version 4. Arrow release 0.14.1 and earlier were the last releases to use the legacy 4 byte alignment. As part of 2.0.0, the Rust implementation was updated to comply with the changes up to release 0.15.0 of Arrow. Work on supporting IPC version 5 is underway, and is expected to be completed in time for 3.0.0. As part of the conformance work, Rust is being added to the Arrow integration suite, which tests that supported language implementations (ARROW-3690): Comply with the Arrow IPC format Can read and write each other’s generated data IPC version 4 is being verified through the above work. Roadmap for 3.0.0 and Beyond Here are some of the initiatives that contributors are currently working on for future releases: Support stable Rust Improved DictionaryArray support and performance Implement inner equijoins Support for various platforms like ARMv8 Supporting the C Data Interface from Rust to better support interoperability with other Arrow implementations How to Get Involved If you are interested in contributing to the Rust subproject in Apache Arrow, you can find a list of open issues suitable for beginners here and the full list here. Other ways to get involved include trying out Arrow on some of your data and filing bug reports, and helping to improve the documentation.</p><p>对于整个Apache Arrow项目(发行说明)，特别是Rust子项目，Apache Arrow 2.0.0是一个重要的发行版，15个贡献者解决了近200个问题。在这篇博客文章中，我们将介绍影响核心箭头、Parquet支持和DataFusion查询引擎的主要更改。可在此处找到已解决问题的完整列表。虽然Java和C/C++(由Python和R使用)Arrow实现可能仍然是功能最丰富的，但在2.0.0版本中，Rust实现正在迅速缩小功能差距。以下是此次发布的一些亮点。Core Arrow Crate Iterator特征基元数组(例如整数数组)现在可以转换为迭代器并从迭代器进行初始化。这将一个非常流行的API-迭代器-暴露给箭头数组。其他类型的工作将持续到3.0.0。改进的可变大小数组可变大小数组(例如，字符串数组)已经进行了内部重构，以便更容易地支持其更大的(64位大小偏移量)版本。这允许我们将一些内核概括到(32和64)两个版本，并在构建它们时执行类型检查。内核在Arrow计算内核中有许多改进，包括：为字符串操作添加了新的内核，包括子串、最小、最大、连接和长度。现在对SIMD实现了聚合求和，比非SIMD操作提高了5倍。许多内核都进行了改进，以支持字典编码的数组。一些内核针对没有空值的数组进行了优化，使其在这种情况下速度大大加快。许多内核都在应用它们所需的内存副本数量和实现上进行了优化。其他改进数组特征现在有了GET_BUFFER_MEMORY_SIZE和GET_ARRAY_MEMORY_SIZE方法来确定分配给数组的内存量。拼花目前正在努力为Arrow数据创建拼花写入器。此工作尚未作为2.0.0的一部分发布，计划在3.0.0版本中发布。该写入器的开发是在铁锈镶木箭写器分部进行的，该分部与主分部定期同步。作为编写器的一部分，阅读器正在添加必要的改进和功能。主要关注点是：支持嵌套的Arrow类型，如LIST&lt;Struct&lt;[Dictionary，String]&gt;&gt;通过在拼图元数据中编码箭头模式来确保读取器和写入器之间的正确往返。改进了拼图的空值写入。创建了一个新的PARQUET_DRIVE框，它允许用户为简单的结构派生拼图记录。有关用法示例，请参阅PARQUET_DRIVE板条箱。DataFusion DataFusion是一个内存查询引擎，带有DataFrame和SQL API，构建在基本箭头支持之上。DataFrame API DataFusion现在有一个更丰富的DataFrame API，改进了显示示例用法的文档，支持以下操作：SELECT_COLUMNS SELECT Filter Aggregate Limit Sort Collect解释性能和可扩展性DataFusion查询执行现在使用与Tokio线程运行时的异步/等待，而不是启动专用线程，从而使查询在可用内核间的伸缩性更好。散列聚合物理运算符已在很大程度上进行了重写，从而显著提高了性能。表达式和计算改进的标量函数DataFusion在SQL和DataFrame API中都有许多新函数：字符串长度Count(DISTINCT列)to_Timestamp IsNull和IsNotNull最小/最大字符串(字典顺序)列的数组字符串连接聚合表达式的别名通过避免内存副本和利用Arrow格式的不变量，许多现有的表达式也得到了显著优化(加速2-3倍)。一元数学函数(如SQRT)现在同时支持32位和64位浮点数，并返回相应的类型，从而在不需要更高精度时允许更快的运算。改进的用户定义函数(UDF)使用和注册UDF的API已得到显著改进，允许用户注册UDF并通过SQL和DataFrame API调用它们。UDF现在还具有与DataFusion函数相同的通用性，包括可变的和动态类型的参数。用户定义的聚合函数(UDAF)DataFusion现在支持用户定义的聚合函数，这些聚合函数可用于执行跨多行、批处理和分区以外的操作。UDAF与DataFusion的函数具有相同的通用性，并且同时支持行更新和批处理更新。您可以查看此示例以了解如何声明和使用UDAF。用户定义的常量DataFusion现在支持注册常量(例如“@Version”)，这些常量在执行上下文的持续时间内存在，并且可以从SQL访问。查询规划与优化用户定义的逻辑计划逻辑计划枚举现在可以通过一个扩展变量进行扩展，它接受</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://arrow.apache.org/blog/2020/10/27/rust-2.0.0-release/">https://arrow.apache.org/blog/2020/10/27/rust-2.0.0-release/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/rust/">#rust</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/阿帕奇/">#阿帕奇</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/apache/">#apache</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/arrow/">#arrow</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1033669.html"><img src="http://img2.diglog.com/img/2020/11/thumb_e701e646c1b569e0c396f4921a8f1be3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033669.html">消息来源：联邦贸易委员会可能在11月底前以违反垄断为由起诉Facebook，联邦贸易委员会主席乔·西蒙斯倾向于将诉讼保留在内部</a></div><span class="my_story_list_date">2020-11-7 14:20</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033369.html"><img src="http://img2.diglog.com/img/2020/11/thumb_5a03040c738a2663177752933c2ed379.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033369.html">美国司法部提起反垄断诉讼，挑战Visa以53亿美元收购Played</a></div><span class="my_story_list_date">2020-11-6 4:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033050.html"><img src="http://img2.diglog.com/img/2020/11/thumb_48db8eb787e01587afbae8abe49292fa.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033050.html">Bevy 0.3：锈迹斑斑的游戏引擎</a></div><span class="my_story_list_date">2020-11-4 5:28</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032933.html"><img src="http://img2.diglog.com/img/2020/11/thumb_0803f67b2dea838dffa8a2a38c7afff6.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032933.html">Scipio：适用于Rust和Linux的每核线程机箱</a></div><span class="my_story_list_date">2020-11-3 14:45</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>