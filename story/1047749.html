<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>深入了解Raspberry Pi RP2040可编程IO </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">深入了解Raspberry Pi RP2040可编程IO </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-17 18:18:25</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/967dbc1d46356c5474ac58fd938e8396.png"><img src="http://img2.diglog.com/img/2021/2/967dbc1d46356c5474ac58fd938e8396.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>由RP2040微控制器提供支持的Raspberry Pico电路板的普及使每个读者都想了解有关该电路板和芯片的更多信息。因此，今天我们将讨论RP2040的可编程IO，该功能使其不同于大多数其他微控制器板。</p><p> RP2040中的两个PIO块或我们称之为硬件接口的每个都有四个状态机。这两个PIO模块可以同时执行程序来操纵GPIO和传输原始数据。现在，这些状态机做什么？好吧，PIO状态机执行从各种来源获取的程序。有时，这些程序来自PIO库（UART，SPI或I2C）或用户软件。</p><p>   通常，所有板卡都对数字通信协议（例如I2C，SPI和UART）提供硬件支持。但是，如果计划使用的这些接口多于板上可用的接口，则可以使用RP2040微控制器中提供的可编程IO。</p><p> 嗯，它具有的功能超出人们的想象。假设您现在想通过可编程I / O来输出DPI视频或“与AliExpress上的串行设备通信”。顾名思义，“可编程” IO使其可以直接编程以支持多种接口，包括SD卡接口，VGA输出和更高速度的数据传输。不挂断！我们在文章中最激动人心的部分是“如何对这些可编程I / O进行编程以使您的工作变得轻松”。</p><p>  Pico SDK（软件开发工具包）提供了必要的头文件，库和构建系统，这些文件为使用C，C ++或Arm汇编语言为基于RP2040的设备（例如Raspberry Pi Pico）编写程序编写程序所必需。</p><p> 如果您打算使用Python进行编码，则只需在开发板上安装合适的编辑器（例如Thonny）和MicroPython。但是对于C / C ++，您需要使用CMake文件，该文件可以告诉Pico SDK如何将C文件转换为基于RP2040的微控制器板的二进制应用程序，如我们最近针对Raspberry Pi Pico的MicroPython和C教程所述。</p><p> PIO汇编器解析一个PIO源文件并输出准备好包含在RP2040应用程序中的汇编版本。这包括针对Pico SDK构建的C和C ++应用程序，以及在RP2040 MicroPython端口上运行的Python程序。 </p><p>要开始为您的PIO应用程序编程状态机，基于C / C ++的程序包含三个组件。</p><p> 一个CMake文件，描述了如何将二者组合成程序映像以加载到基于RP2040的开发板上。</p><p>  现在，在对这些IO接口进行编程时，有9条汇编指令“ JMP，WAIT，IN，OUT，PUSH，PULL，MOV，IRQ和SET”。尽管大多数人可能对使用C / C ++或Python语言对PIO接口进行编程感兴趣，但让我们研究一下用于IO接口的一些汇编语言指令。</p><p> JMP：此“跳转”指令可以是条件语句，也可以是非条件语句。在这种情况下，它通过更改指令指针寄存器来传输执行流程。简而言之，使用“ jmp”语句，执行流程进入代码的另一部分。</p><p> 等待：该指令使代码的执行停止。除非被暂停（使用WAIT指令），否则每条指令需要一个周期。</p><p> OUT：该指令将数据从输出移位寄存器一次移至其他目的地，每次1…32位。</p><p>    为了简化操作，我们将研究hello_world程序，该程序使用可编程IO和TX FIFO的32位数据（PULL指令）使板载LED闪烁。 </p><p>#include＆＃34; pico / stdlib.h＆＃34; #include＆＃34; hardware / pio.h＆＃34; //我们的汇编程序：#include＆＃34; hello.pio.h＆＃34; int main （）{//选择要使用的PIO实例（有两个实例）PIO pio = pio0; //我们的汇编程序需要加载到此PIO指令存储器中。此SDK函数将在//指令存储器中找到一个位置（偏移），在该位置有足够的空间供我们的程序使用。我们需要//记住这个位置！ uint偏移量= pio_add_program（pio，＆amp; hello_program）; //在我们选择的PIO上找到一个空闲状态机（如果没有//则出错）。配置它以运行我们的程序，并使用我们包含在.pio文件中的// helper函数启动它。 uint sm = pio_claim_unused_sm（pio，true）; hello_program_init（pio，sm，偏移量，PICO_DEFAULT_LED_PIN）; //状态机正在运行。我们推送到其TX FIFO的任何值都将//出现在LED引脚上。 while（true）{//闪烁pio_sm_put_blocking（pio，sm，1）; sleep_ms（500）; //布隆克pio_sm_put_blocking（pio，sm，0）; sleep_ms（500）; }}</p><p> //状态机正在运行。我们推送到其TX FIFO的任何值都会</p><p> 上面的C / C ++代码以1秒钟的完整周期闪烁LED。对LED进行编程的方式是：先点亮500毫秒，然后熄灭500毫秒。但是，在状态机可以运行程序之前，我们需要将程序加载到该指令存储器中。 “函数pio_add_program（）在给定的PIO指令存储器中查找程序的可用空间，并将其加载。”这样，我们将状态机配置为将其数据输出到板载LED。</p><p> 如下所示的.pio文件的汇编代码具有所有C助手功能来设置C / C ++代码。</p><p> .program helloloop：拉出引脚，1个jmp循环％c-sdk {静态内联void hello_program_init（PIO pio，uint sm，uint offset，uint pin）{pio_sm_config c = hello_program_get_default_config（offset）; //将状态机的OUT引脚组映射到一个引脚，即此函数的“ pin”参数。 sm_config_set_out_pins（＆amp; c，pin，1）; //设置此引脚的GPIO功能（将PIO连接到焊盘）pio_gpio_init（pio，pin）; //将引脚方向设置为在PIO上输出pio_sm_set_consecutive_pindirs（pio，sm，pin，1，true）; //加载我们的配置，然后跳转到程序的开头pio_sm_init（pio，sm，offset，＆amp; c）; //设置运行pio_sm_set_enabled（pio，sm，true）;}％}的状态机</p><p> 除此之外，您还需要CMake文件，该文件描述如何将.pio和.c文件构建到适合加载到Raspberry Pi Pico开发板上的二进制文件中。</p><p> 没有使用MicroPython编写的等效示例，但是我们可以看到一个更简单的PIO MicroPython代码，用于使板载LED闪烁： </p><p>从rp2导入时间，从PIO导入PIO，从机器导入，asm_pio导入Pin＃定义闪烁程序。它有一个GPIO绑定到set指令上，该指令是一个输出引脚。＃使用大量延迟以使眨眼可见。@ asm_pio（set_init = rp2.PIO.OUT_LOW）def blink（）：wrap_target（） set（pins，1）[31] nop（）[31] nop（）[31] nop（）[31] nop（）[31] set（pins，0）[31] nop（）[31] nop（ ）[31] nop（）[31] nop（）[31] wrap（）＃使用闪烁程序以1000Hz实例化状态机，并将其绑定到Pin（25）（rp2板上的LED）（sm = rp2） .StateMachine（0，闪烁，freq = 1000，set_base = Pin（25））＃运行状态机3秒钟。 LED应该闪烁.sm.active（1）时间.sleep（3）sm.active（0）</p><p> ＃定义闪烁程序。它在set指令上有一个绑定到的GPIO，它是一个输出引脚。</p><p>                 ＃使用闪烁程序以1000Hz实例化状态机，并将其绑定到Pin（25）（rp2板上的LED）</p><p> 在这种情况下，没有单独的.pio文件，并且MicroPython和汇编代码都放置在.py文件中。</p><p> 请注意，即使可以使用MicroPython对PIO进行编程，但Python SDK文档指出该PIO当前不稳定/正在进行中，因此建议使用C / C ++。</p><p> 通过在RGB十六进制格式的帮助下添加要显示的颜色，可以对代码进行许多修改。但是，有许多现实生活中的示例，例如PWM，UART甚至是NeoPixels接口。对于那些感兴趣的人，您可以在GitHub存储库中的C和MicroPython示例中找到许多PIO编程示例。</p><p>  RP2040可编程IO具有同时执行程序以支持VGA输出和高速数据传输等接口的能力。您可以查看C / C ++和Python的SDK文档中的第3章，以了解有关RP2040可编程IO的更多信息。 </p><p>Abhishek Jadhav是一名工程专业的学生，RISC-V大使，自由技术作家，开放硬件开发人员社区的负责人。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.cnx-software.com/2021/01/27/a-closer-look-at-raspberry-pi-rp2040-programmable-ios-pio/">https://www.cnx-software.com/2021/01/27/a-closer-look-at-raspberry-pi-rp2040-programmable-ios-pio/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ios/">#ios</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/编程/">#编程</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/了解/">#了解</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/raspberry/">#raspberry</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1047547.html"><img src="http://img2.diglog.com/img/2021/2/thumb_f43786db62dfa897935353f37d36ebbc.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047547.html">很快，您就可以在iOS中更改默认音乐服务 </a></div><span class="my_story_list_date">2021-2-9 21:14</span></div><div class="col-sm"><div><a target="_blank" href="/story/1047464.html"><img src="http://img2.diglog.com/img/2021/2/thumb_29d1132d166b7237ddef42ae54415ac4.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047464.html">在iOS 14.5 Beta中，Apple终于添加了使用Siri播放歌曲时设置默认音乐流服务（包括Spotify）的功能。 </a></div><span class="my_story_list_date">2021-2-9 20:44</span></div><div class="col-sm"><div><a target="_blank" href="/story/1047282.html"><img src="http://img2.diglog.com/img/2021/2/thumb_d64e4f3c1b8449bc6c8d45fce5a529eb.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1047282.html">报告：Google正在考虑针对Android使用iOS风格的反跟踪功能 </a></div><span class="my_story_list_date">2021-2-6 21:0</span></div><div class="col-sm"><div><a target="_blank" href="/story/1046907.html"><img src="http://img2.diglog.com/img/2021/1/thumb_ccd2e02fec037b0458734bd726059753.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1046907.html">专家说，苹果的应用程序跟踪透明度功能将损害Facebook的核心业务。 该功能将限制来自85K + iOS应用程序的Facebook数据收集 </a></div><span class="my_story_list_date">2021-1-30 22:56</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>