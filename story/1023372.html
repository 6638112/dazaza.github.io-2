<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>重新审视DNS查询隐私</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">重新审视DNS查询隐私</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-12 00:42:42</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/ed3733518e5d722a318db26be7b735e5.png"><img src="http://img2.diglog.com/img/2020/9/ed3733518e5d722a318db26be7b735e5.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>我在2019年8月写了这篇帖子的第一个版本，并以这样的评论结束：“很可能在一年左右的时间里，我们会回到这个衡量QNAME最小化使用情况的标准上，看看今天的情况是否有什么变化。”</p><p>好了，一年过去了，现在是回顾这个主题的时候了，看看DNS解析环境在过去12个月里发生了什么变化。</p><p>最近，关于域名系统(DNS)作为查看终端系统行为和推断用户行为的一种手段的使用，人们已经说了很多，也写了很多。</p><p>几乎每一笔交易都以DNS查询开始，如果要将互联网用户生成的完整的DNS查询集合起来，就有可能对他们的在线活动进行相对完整的描述。多年来，DNS的这一方面作为观察他人活动的一种手段，很少受到主流的关注，但最近对国家和私人数字监视的敏感性已经引起了对DNS隐私这一总体主题的极大关注。</p><p>引起如此关注的另一个原因是，在隐私方面，DNS解析协议遗憾地缺乏一些基本的隐私保护。DNS名称解析协议在设计时没有将隐私作为首要考虑因素。查询和响应是未加密的，这使得它们很容易受到恶意的中间人操纵，并且它们会将多余的信息泄露给第三方旁观者。</p><p>第一种方法是通过对DNS事务使用加密来使窃听DNS查询变得更加困难。围绕加密的问题以及使用DNS-over-TLS(DOT)和DNS-over-HTTP(DoH)的努力是当前DNS世界非常感兴趣的话题。</p><p>第二种方法是通过减少每个DNS查询中的信息量来减少信息泄漏。IETF发布了一种使用一种名为“查询名称最小化”(QNAME最小化或Qmin)的技术来实现这一点的方法，该技术在一份实验性RFC文件(RFC 7816，“DNS查询名称最小化以改善隐私”，由Stephan Bortzmeyer，2016年3月)中进行了描述。</p><p>在这篇文章中，我们将更详细地再看一看QNAME最小化，并展示我们测量这种解析器查询技术在当今互联网中的当前使用水平的一些结果。</p><p>RFC 7816中描述的技术是一种基于在RFC 6973中描述的原理的查询管理方法，该原理可以概括为“您发出的数据越少，您可能遇到的隐私问题就越少”。</p><p>DNS通常为了简单和性能而优化其行为。DNS名称解析协议中的基本因素是，DNS递归解析器不一定事先知道哪些服务器是给定区域的权威服务器，因此它必须发现此信息。此外，如果一个名称有多个标签，则解析器不一定知道标签之间发生区域剪切的位置。</p><p>例如，区域c.example.com可能包含标签b的委派记录。区域b.c.example.com可能包含标签a的委派记录。区域a.b.c.example.com可能包含此名称的资源记录。在这种情况下，域名a.b.c.example.com中存在b和c之间以及a和b之间的区域剪切。或者，区域c.example.com可能包含标签A.B的资源记录，在该记录中，c.example.com下没有进一步的区域削减。</p><p>这里的要点是，解析器不能仅仅通过检查区域切割可能在哪里的域名来提前确定。它们由解析器在名称解析过程中发现。</p><p>区域剪切可以涉及区域管理员部分将区域管理角色分割到不同服务器的愿望，它们还可以涉及管理控制的改变，其中剪切下的名称空间被委托给不同的管理实体。</p><p>IETF于2014年特许成立了DBIND工作组，致力于制定一种方法，明确这些与行政控制变更相关的授权点。其想法是允许DNS自我描述DNS名称层次结构本身内的这些管理控制点的更改点。这项努力旨在取代志愿者运营的公共后缀列表，该列表存在一些令人担忧的缺点。DBIND工作组花了几年时间编写一份问题陈述。该组织在2017年初被关闭，没有发表任何作为RFC的工作。取而代之的是，我们继续依靠Mozilla基金会的志愿者努力来维护公共后缀列表，目前我们在脑海中别无选择。也许这种对志愿者努力的依赖可能会在未来几个月作为一个问题重新浮出水面，因为目前不利的经济状况影响着Mozilla。</p><p>这种对志愿者昔日工作的隐性依赖是早期互联网的一个特点，或许也是它当时的核心优势之一。如今，互联网是一个价值万亿美元的行业，当志愿者的努力支撑着互联网的大量商业运营服务基础设施时，仍然发现对志愿者努力的关键依赖似乎有点不舒服。</p><p>在没有关于命名空间结构的这种元信息的情况下，DNS递归解析器在所有查询中使用完整的查询名称，因为它沿着名称分层结构向下查找最低级别的权威名称服务器，因为这种迭代技术将暴露每个区域的区域切割和名称服务器。</p><p>在此稍加说明，DNS解析是以“自上而下”的方式进行的，当区域的权威服务器接收到对只能在委派的从属区域中解析的名称的查询时(即，在区域层次结构中比此权威服务器所服务的区域更低的区域层次结构中的级别)，它在其响应(“NODATA”响应)中返回NOERROR代码和无应答部分(No Answer Section)。该响应包括下一个较低级别的委派区域的名称及其名称服务器，如响应的授权记录(区域切割点)中所列举的，并且假设这些地址对于权威服务器是已知的，则将这些名称服务器的IP地址包括在响应的第二附加部分中。</p><p>DNS是一个严格的分层命名空间，因此每台服务器只知道立即委派的区域。名称解析过程将在层次结构中向下迭代，以到达可以为此查询名称提供权威响应的服务器，或者获得指示该名称在DNS中不存在的响应。此过程如图1所示。</p><p>当然，高效的递归解析器将在任何可能的时候使用缓存的信息，因此该过程通常远不像从非正式描述中看起来的那样详尽和缓慢。</p><p>这种描述并不完全适用于所有情况。服务器可以是‘父’区域及其委托的‘子’区域的一些或全部的权威服务器。查询不指定哪个区域是其查询的预期主题，从而允许服务器使用名称层次结构中与查询名称部分匹配的最特定服务区域中的数据来回答查询。</p><p>实现QNAME最小化并且其高速缓存中还没有答案的解析器不是向上游发送完整的QNAME和原始QTYPE，而是向授权的名称服务器发送请求，以寻找原始QNAME的最接近的已知祖先。该请求是通过以下方式完成的：</p><p>作为原始QNAME的QNAME，仅剥离为服务器授权区域之外的一个标签</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.apnic.net/2020/09/11/dns-query-privacy-revisited">https://blog.apnic.net/2020/09/11/dns-query-privacy-revisited</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/dns/">#dns</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/query/">#query</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1020123.html"><img src="http://img.diglog.com/img/2020/8/thumb_25f95f35187862ff584fa9374b738374.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1020123.html">了解BIND区域文件的DNS解析</a></div><span class="my_story_list_date">2020-8-25 11:20</span></div><div class="col-sm"><div><a target="_blank" href="/story/1015433.html"><img src="http://img.diglog.com/img/2020/7/thumb_5a97e0283c35599f009961468952a9ca.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1015433.html">DNSSEC解释道：为什么您可能想要在您的域上实现它</a></div><span class="my_story_list_date">2020-7-31 23:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1014743.html"><img src="http://img.diglog.com/img/2020/7/thumb_2f43e081c403cfbe5df539c856c37913.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1014743.html">TLS上的DNS与HTTPS上的DNS</a></div><span class="my_story_list_date">2020-7-29 2:36</span></div><div class="col-sm"><div><a target="_blank" href="/story/1013038.html"><img src="http://img.diglog.com/img/2020/7/thumb_7cefec5d1c9cfda7f528ac6a8c08f3ca.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1013038.html">原来一半的互联网都有一个叫做“云闪光”的单点故障</a></div><span class="my_story_list_date">2020-7-20 22:1</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>