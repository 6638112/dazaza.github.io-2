<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>EBPFSnitch：基于EBPF的Linux应用程序防火墙 EBPFSnitch: An eBPF based Linux Application Firewall</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">EBPFSnitch: An eBPF based Linux Application Firewall<br/>EBPFSnitch：基于EBPF的Linux应用程序防火墙 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-14 22:00:11</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/3/ae0e73f33526d88e454a336a382f5d77.jpeg"><img src="http://img2.diglog.com/img/2021/3/ae0e73f33526d88e454a336a382f5d77.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>eBPFSnitch is a Linux Application Level Firewall based on eBPF and NFQUEUE.It is inspired by  OpenSnitch, and Douane, but utilizing modern kernel abstractions,without a kernel module.</p><p>EBPFSnitch是一个基于EBPF和NFQueue的Linux应用程序级防火墙。它由OpenSnitch和Douane的启发，但利用现代内核抽象，而无需内核模块。</p><p> The eBPFSnitch daemon is implemented in C++ 20. The control interfaceis implemented in Python 3 utilizing Qt5.</p><p> EBPFSnitch守护程序在C ++ 20中实现。利用QT5在Python 3中实现的控制接口。</p><p>   This is an experimental project. The security of this application hasnot been audited by a 3rd party, or even myself. Thereare likely mechanisms by which it could be bypassed. Currently the daemoncontrol socket is unauthenticated, and an attacker could impersonate theuser interface to self authorize.</p><p>   这是一个实验项目。此申请的安全性已由第三方审核，甚至是自己。可能是可以绕过的机制。目前，DaemonControl套接字未经身份验证，攻击者可能会使Self授权的用户界面核发。</p><p>  eBPFSnitch supports filtering all outgoing IPv4 based protocols(TCP / UDP / ICMP / etc). Filtering for IPv6, and incoming connections shouldbe supported in the near future.</p><p>  EBPFSnitch支持过滤所有基于IPv4的协议（TCP / UDP / ICMP / etc）。过滤IPv6，应在不久的将来支持传入连接。</p><p> A core goal of this project is to integrate well with containerizedapplications. If an application is running in a container that containercan be controlled independently of the base system or other containers.</p><p> 该项目的核心目标是与集装箱化应用相容。如果应用程序在容器中运行，则包含独立于基本系统或其他容器控制的容器。</p><p> Additionally targeting can occur against specific system users. Blanketpermissions for every instance of Firefox for every user are not required.</p><p> 另外，可以针对特定系统用户出现目标。不需要为每个用户的Firefox的每个实例的BlanketPermissions。</p><p>   eBPFSnitch Allowed options: -h [ --help ] produce  help message -v [ --version ] print version --remove-rules remove iptables rules --group arg group name  for control socket --rules-path arg file to load / store firewall rules</p><p>   EBPFSnitch允许的选项：-h [--help]生成帮助消息-v [--version]打印版本--remove规则删除iptables规则 -  Group Socket  -  Rules-Path arg文件加载/存储防火墙规则 </p><p>  The control interface and daemon communicate utilizing a Unix socket. By defaultthe socket can be accessed by any system user. It is recommended to associatea specific group with the socket to limit access. For example  --group=&#39;wheel&#39;.</p><p>控制接口和守护程序使用UNIX套接字进行通信。默认情况下，任何系统用户都可以访问套接字。建议将特定组与套接字连接到限制访问权限。例如 -  Group =＆＃39;轮子＆＃39;</p><p>  Firewall rules that are marked as persistent are stored on the filesystem in aJSON encoding. By default the current working directory is used to store thefile  rules.json. To specify a custom path use the  --rules-path option.</p><p>  标记为持久性的防火墙规则存储在AJSON编码中的文件系统上。默认情况下，当前工作目录用于存储File规则.JSON。要指定自定义路径，请使用--rules-path选项。</p><p>  eBPFSnitch currently requires a recent kernel. The minimum supported versionis Linux 5.8. This required version may be lowered in the future.</p><p>  EBPFSnitch目前需要最近的内核。最低支持的Versionis Linux 5.8。将来可能会降低此所需版本。</p><p>  Each rule is comprised of a set of clauses, and a verdict. Each clause matchesa property of a packet to value. If every clause in a rule matches then thepacket matches the rule, and the verdict for that rule is used (allow / deny).</p><p>  每个规则由一组条款组成，以及判决。每个子句与数据包的属性Matchesa属性。如果规则匹配中的每个子句，则该包与该规则匹配，并且使用该规则的验证（允许/拒绝）。</p><p> Rules are sorted by a configured priority. Each rule is tried until a match isfound, and a verdict can be determined. If no rule matches a packet the daemonwill send a query to the interface which then displays a dialog asking to createa new rule to match that packet.</p><p> 规则由配置优先级排序。每条规则都会尝试直到匹配isfound，并且可以确定判决。如果没有规则与数据包匹配，则DaemonWill将查询发送到接口，然后显示一个对话框，要求创建新规则以匹配该数据包。</p><p> By default rules are not persisted to disk, and when the daemon restarts ruleswill be lost. If through the dialog you check the  persistent box, the new rulewill be saved to disk, and be active when the daemon is restarted.</p><p> 默认规则不持久地持续到磁盘，并且当守护程序重新启动规则丢失时丢失。如果通过对话框检查持久性框，则将新rulewilt保存到磁盘，并在重新启动守护程序时处于活动状态。</p><p>        sudo apt-get install cmake clang libboost-all-dev libspdlog-dev \ libnetfilter-queue-dev libmnl-dev linux-tools-common nlohmann-json3-dev \ libbpf-dev linux-tools-generic python3 python3-pyqt5</p><p>        sudo apt-get安装cmake clang libboost-all-dev libspdlog-dev \ libnetfilter-queue-dev libmnl-dev linux-tools-common nlohmann-json3-dev \ libbpf-dev linux-tools-generic python3 python3-pyqt5 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/harporoeder/ebpfsnitch">https://github.com/harporoeder/ebpfsnitch</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ebpf/">#ebpf</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/规则/">#规则</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012 - 2021 diglog.com </div></div></body></html>