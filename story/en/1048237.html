<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>精确地：适用于Python的Matcher库 Precisely: Matcher Library for Python</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Precisely: Matcher Library for Python<br/>精确地：适用于Python的Matcher库 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-18 18:45:23</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/854d319fd17ee6ffa2d8558ee6b73dcb.jpeg"><img src="http://img2.diglog.com/img/2021/2/854d319fd17ee6ffa2d8558ee6b73dcb.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Precisely allows you to write precise assertions so you only test the behaviour you&#39;re really interested in.This makes it clearer to the reader what the expected behaviour is,and makes tests less brittle.This also allows better error messages to be generated when assertions fail.Inspired by  Hamcrest.</p><p>精确地允许您编写精确的断言，以便仅测试您真正感兴趣的行为。这使读者可以更清楚地了解预期的行为，并使测试不那么脆弱。这还可以生成更好的错误消息断言失败时受Hamcrest的启发。</p><p> For instance, suppose we want to make sure that a  unique function removes duplicates from a list.We might write a test like so:</p><p> 例如，假设我们要确保一个唯一函数从列表中删除重复项，我们可以编写如下测试：</p><p> from  precisely  import  assert_that,  contains_exactly def  test_unique_removes_duplicates():  result  =  unique([ &#34;a&#34;,  &#34;a&#34;,  &#34;b&#34;,  &#34;a&#34;,  &#34;b&#34;])  assert_that( result,  contains_exactly( &#34;a&#34;,  &#34;b&#34;))</p><p> 从精确导入assert_that，contains_exactly def test_unique_removes_duplicates（）：结果=唯一（[＆＃34; a＆＃34 ;、＆＃34; a＆＃34 ;、＆＃34; b＆＃34 ;、＆＃34; a＆＃34 ;，＆＃34; b＆＃34;]）assert_that（结果，contains_exactly（＆＃34; a＆＃34 ;,＆＃34; b＆＃34;））</p><p> The assertion will pass so long as  result contains  &#34;a&#34; and  &#34;b&#34; in any order,but no other items.Unlike, say,  assert result == [&#34;a&#34;, &#34;b&#34;], our assertion ignores the ordering of elements.This is useful when:</p><p> 只要结果包含＆＃34; a＆＃34 ;，声明就会通过。和＆＃34; b＆＃34;不同于断言结果== [＆＃34; a＆＃34 ;,＆＃34; b＆＃34;]，我们的断言忽略元素的顺序。当以下情况时，此方法很有用：</p><p> the ordering isn&#39;t specified in the contract of  unique.If we assert a particular ordering, then we&#39;d be testing the implementation rather than the contract.</p><p> 如果唯一声明了特定的顺序，则我们将测试实现而不是合同。</p><p> the ordering is specified in the contract of  unique,but the ordering is tested in a separate test case.</p><p> 订单是在唯一性合同中指定的，但订单是在单独的测试用例中进行测试的。</p><p> When the assertion fails,rather than just stating the two values weren&#39;t equal,the error message will describe the failure in more detail.For instance, if unique has the value  [&#34;a&#34;, &#34;a&#34;, &#34;b&#34;],we&#39;d get the failure message:</p><p> 当断言失败时，错误消息将不仅仅是更详细地描述失败，而不仅仅是声明两个值不相等。例如，如果unique具有值[＆＃34; a＆＃34 ;,＆＃ 34; a＆＃34;，＆＃34; b＆＃34;]，我们会收到失败消息： </p><p> Expected: iterable containing in any order: * &#39;a&#39; * &#39;b&#39;but: had extra elements: * &#39;a&#39;</p><p>预期：以任意顺序包含的可迭代：*＆＃39; a＆＃39; *＆b＆＃39;但是：有额外的元素：*＆＃39; a＆＃39;</p><p>       Many matchers are composed of other matchers.If they are given a value instead of a matcher,then that value is wrapped in  equal_to().For instance,  has_attrs(name=&#34;bob&#34;) is equivalent to  has_attrs(name=equal_to(&#34;bob&#34;)).</p><p>       许多匹配器由其他匹配器组成。如果给它们一个值而不是一个匹配器，则该值将被包装在equal_to（）中，例如has_attrs（name =＆＃34; bob＆＃34;）等同于has_attrs（名称= equal_to（＆bob＆＃34;））。</p><p> has_attr(attribute_name, matcher): matches a value if it has the specified attribute.Using  has_attrs is generally considered more idiomatic when the attribute name is constant.For instance, instead of:</p><p> has_attr（attribute_name，matcher）：如果具有指定的属性，则匹配一个值。当属性名称为常数时，通常认为has_attrs更惯用，例如，代替：</p><p> assert_that( result,  contains_exactly( &#34;a&#34;,  &#34;b&#34;)) # Matches [&#34;a&#34;, &#34;b&#34;] and [&#34;b&#34;, &#34;a&#34;], # but not [&#34;a&#34;, &#34;a&#34;, &#34;b&#34;] nor [&#34;a&#34;] nor [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;]</p><p> assert_that（结果，contains_exactly（＆＃34; a＆＃34 ;,＆＃34; b＆＃34;））＃匹配[＆＃34; a＆＃34 ;、＆＃34; b＆＃34;]和[＆＃ 34; b＆＃34;，＆＃34; a＆＃34;]，但不是[[## a＆＃34;，＆＃34; a＆＃34;，＆＃34; b＆＃34;] ＆＃34; a＆＃34;]或[＆＃34; a＆＃34 ;、＆＃34; b＆＃34 ;、＆＃34; c＆＃34;]</p><p> is_sequence(*args): matches an iterable if it has the same elements in the same order.For instance:</p><p> is_sequence（* args）：如果一个元素具有相同的顺序，则匹配一个iterable，例如：</p><p> assert_that( result,  is_sequence( &#34;a&#34;,  &#34;b&#34;)) # Matches [&#34;a&#34;, &#34;b&#34;] # but not [&#34;b&#34;, &#34;a&#34;] nor [&#34;a&#34;, &#34;b&#34;, &#34;c&#34;] nor [&#34;c&#34;, &#34;a&#34;, &#34;b&#34;]</p><p> assert_that（result，is_sequence（＆＃34; a＆＃34 ;,＆＃34; b＆＃34;））＃匹配[＆＃34; a＆＃34 ;,＆＃34; b＆＃34;]＃但不匹配[ ＆＃34; a＆＃34;]或[＆＃34; a＆＃34 ;、＆＃34; b＆＃34 ;、＆＃34; c＆＃34;]或[＆ ＃34; c＆＃34;，＆＃34; a＆＃34;，＆＃34; b＆＃34;]</p><p> assert_that( result,  includes( &#34;a&#34;,  &#34;b&#34;)) # Matches [&#34;a&#34;, &#34;b&#34;], [&#34;b&#34;, &#34;a&#34;] and [&#34;a&#34;, &#34;c&#34;, &#34;b&#34;] # but not [&#34;a&#34;, &#34;c&#34;] nor [&#34;a&#34;] assert_that( result,  includes( &#34;a&#34;,  &#34;a&#34;)) # Matches [&#34;a&#34;, &#34;a&#34;] and [&#34;a&#34;, &#34;a&#34;, &#34;a&#34;] # but not [&#34;a&#34;]</p><p> assert_that（结果，包括（＆＃34; a＆＃34 ;、＆＃34; b＆＃34;））＃匹配[＆＃34; a＆＃34 ;、＆＃34; b＆＃34;]，[＆＃ 34; b＆＃34;，＆＃34; a＆＃34;]和[＆＃34; a＆＃34;，＆＃34; c＆＃34;，＆＃34; b＆＃34;]＃而非[＆ ＃34; a＆＃34;，＆＃34; c＆＃34;]或[＆＃34; a＆＃34;] assert_that（结果，包括（＆＃34; a＆＃34 ;、＆＃34; a＆＃34 ;））＃匹配[＆＃34; a＆＃34 ;,＆＃34; a＆＃34;]和[＆＃34; a＆＃34 ;、＆＃34; a＆＃34 ;、＆＃34; a＆＃ 34;]＃，但不是[＆＃34; a＆＃34;] </p><p>  is_mapping(matchers): matches a mapping, such as a  dict, if it has the same keys with matching values.An error will be raised if the mapping is missing any keys, or has any extra keys.For instance:</p><p>is_mapping（matchers）：如果映射具有相同的键和匹配的值，则匹配一个映射，例如dict。如果该映射缺少任何键或具有任何额外的键，则会引发错误，例如：</p><p> mapping_includes(matchers): matches a mapping, such as a  dict, if it has the same keys with matching values.An error will be raised if the mapping is missing any keys, but extra keys are allowed.For instance:</p><p> mapping_includes（matchers）：如果映射具有相同的键和匹配的值，则匹配一个映射，例如dict。如果该映射缺少任何键，但允许额外的键，则会引发错误，例如：</p><p> assert_that( result,  mapping_includes({  &#34;a&#34;:  equal_to( 1),  &#34;b&#34;:  equal_to( 4),})) # Matches {&#34;a&#34;: 1, &#34;b&#34;: 4} and {&#34;a&#34;: 1, &#34;b&#34;: 4, &#34;c&#34;: 5} # but not {&#34;a&#34;: 1} nor {&#34;a&#34;: 1, &#34;b&#34;: 5}</p><p> assert_that（result，mapping_includes（{＆＃34; a＆＃34 ;: equal_to（1），＆＃34; b＆＃34 ;: equal_to（4），}））＃匹配{＆＃34; a＆＃34 ;: 1，＆＃34; b＆＃34 ;: 4}和{＆＃34; a＆＃34 ;: 1，＆＃34; b＆＃34 ;: 4，4，＆＃34; c＆＃34 ;: 5}＃但不是{＆＃34; a＆＃34 ;: 1}也不是{＆＃34; a＆＃34 ;: 1，＆＃34; b＆＃34 ;: 5}</p><p>             For clarity, it often helps to extract the use of  has_feature into its own function:</p><p>             为了清楚起见，它通常有助于将has_feature的使用提取到其自己的函数中：</p><p>   PyHamcrest is another Python implemention of matchers. I prefer the errormessages that this project produces, but feel free to judge for yourself:</p><p>   PyHamcrest是匹配器的另一个Python实现。我更喜欢该项目产生的错误消息，但可以自行判断：</p><p> # Precisely from  precisely  import  assert_that,  is_sequence,  has_attrs assert_that( [  User( &#34;bob&#34;,  &#34;jim@example.com&#34;),  User( &#34;jim&#34;,  &#34;bob@example.com&#34;), ],  is_sequence(  has_attrs( username = &#34;bob&#34;,  email_address = &#34;bob@example.com&#34;),  has_attrs( username = &#34;jim&#34;,  email_address = &#34;jim@example.com&#34;), )) # Expected: iterable containing in order: # 0: attributes: # * username: &#39;bob&#39; # * email_address: &#39;bob@example.com&#39; # 1: attributes: # * username: &#39;jim&#39; # * email_address: &#39;jim@example.com&#39; # but: element at index 0 mismatched: # * attribute email_address: was &#39;jim@example.com&#39; # Hamcrest from  hamcrest  import  assert_that,  contains,  has_properties assert_that( [  User( &#34;bob&#34;,  &#34;jim@example.com&#34;),  User( &#34;jim&#34;,  &#34;bob@example.com&#34;), ],  contains(  has_properties( username = &#34;bob&#34;,  email_address = &#34;bob@example.com&#34;),  has_properties( username = &#34;jim&#34;,  email_address = &#34;jim@example.com&#34;), )) # Hamcrest error: # Expected: a sequence containing [(an object with a property &#39;username&#39; matching &#39;bob&#39; and an object with a property &#39;email_address&#39; matching &#39;bob@example.com&#39;), (an object with a property &#39;username&#39; matching &#39;jim&#39; and an object with a property &#39;email_address&#39; matching &#39;jim@example.com&#39;)] # but: item 0: an object with a property &#39;email_address&#39; matching &#39;bob@example.com&#39; property &#39;email_address&#39; was &#39;jim@example.com&#39;</p><p> ＃准确地从精确导入assert_that，is_sequence，has_attrs assert_that（[User（＆＃34; bob＆＃34 ;,＆＃34; jim@example.com&#34;），User（＆＃34; jim＆＃34;，＆ ＃34; bob@example.com&#34;），]，is_sequence（has_attrs（用户名=＆＃34; bob＆＃34 ;、电子邮件地址=＆＃34; bob@example.com&#34;），has_attrs（用户名= ＆＃34; jim＆＃34 ;, email_address =＆＃34; jim@example.com&#34;），））＃预期的：可迭代的包含顺序：＃0：属性：＃*用户名：＆＃39; bob＆＃ 39; ＃* email_address：＆＃39; bob@example.com&#39; ＃1：属性：＃*用户名：＆＃39; jim＆＃39; ＃* email_address：＆＃39; jim@example.com&#39; ＃但是：索引0处的元素不匹配：＃*属性email_address：是＆＃39; jim@example.com&#39; ＃hamcrest从hamcrest导入assert_that，包含has_properties assert_that（[User（＆＃34; bob＆＃34 ;,＆＃34; jim@example.com&#34;），User（＆＃34; jim＆＃34 ;,＆ ＃34; bob@example.com&#34;），]，包含（has_properties（用户名=＆＃34; bob＆＃34 ;、电子邮件地址=＆＃34; bob@example.com&#34;），has_properties（用户名= ＆＃34; jim＆＃34 ;, email_address =＆＃34; jim@example.com&#34;），））＃Hamcrest错误：＃预期值：包含[（具有属性＆＃39; username＆＃的对象的对象的序列39;匹配＆＃39; bob＆＃39;和具有&&＃39; email_address＆＃39;匹配＆＃39; bob@example.com&#39;的对象）（具有＆＃39;用户名＆＃39;匹配＆＃39; jim＆＃39;和对象的属性＆＃39; email_address＆＃39;匹配＆＃39; jim@example.com&#39;）]＃但：项目0：对象具有属性＆＃39; email_address＆＃39;匹配＆＃39; bob@example.com&#39;财产＆＃39;电子邮件地址＆＃39;是＆＃39; jim@example.com&#39; </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/mwilliamson/python-precisely">https://github.com/mwilliamson/python-precisely</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/matcher/">#matcher</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/具有/">#具有</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>