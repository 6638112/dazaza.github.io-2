<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>加密网站和API的常见安全漏洞 Common security vulnerabilities with crypto websites and APIs</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Common security vulnerabilities with crypto websites and APIs<br/>加密网站和API的常见安全漏洞 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-22 20:16:32</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/d7b7d866ec3f0a080c360a8351dbf995.png"><img src="http://img2.diglog.com/img/2020/12/d7b7d866ec3f0a080c360a8351dbf995.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>There are many crypto startups coming up with the increasing popularity of cryptocurrencies.   As a FinTech enthusiast, I explore as many crypto websites, wallets, DeFi systems as possible and as a bug bounty hunter – I get to test some of them.</p><p>有许多加密货币初创公司提出了越来越多的加密货币流行的想法。作为一名金融科技爱好者，我会尽可能多地探索加密网站，钱包，DeFi系统以及作为漏洞赏金猎人-我将对其进行测试。</p><p> This week I tested a couple of crypto applications and there seems to be a pattern in security vulnerabilities among these applications.</p><p> 本周，我测试了几个加密应用程序，这些应用程序之间似乎存在某种安全漏洞。</p><p> Most of these security issues were related to injection, bypassing disabled forms, and access control.</p><p> 这些安全问题大部分与注入，绕过禁用的表单和访问控制有关。</p><p>  Injection via X-forwarded-for header:  As a general practice most crypto websites save log-in IPs and have some functionality around IP whitelisting.       an example of login notification – also present in the dashboard  Without a proper validation on the server side, this field can be injected using XFF header.  These Injection can range from a harmless XSS to server side code injection, here’s an example:      an example of XFF injection  Most of these application uses REST architecture, hence these API injections can lead to severe damage depending on where you are using these JSON fields.</p><p>  通过X-forwarded-for标头注入：通常，大多数加密网站都会保存登录IP，并具有一些围绕IP白名单的功能。登录通知的示例–也出现在仪表板中如果没有在服务器端进行适当的验证，则可以使用XFF标头注入该字段。这些注入的范围从无害的XSS到服务器端代码注入，下面是一个示例：XFF注入的示例这些应用程序中的大多数都使用REST体系结构，因此，根据您在这些JSON字段中的使用位置，这些API注入会导致严重的损害。</p><p> Bypassing disabled input fields:  Some of the input fields are disabled in the dashboard (of crypto/FinTech websites).  In most cases, these fields are name, username and email – disabling them make sense because these fields shouldn’t be updated regularly for KYC and compliance issues.   Just disabling them from HTML forms on the client side is a bad idea, it can be easily bypassed through a browser proxy like Burp and Zap.   Sometimes even fields which aren’t supposed to be updated like currency, language and timezone can get injected.   here’s an example:     Again, because of REST architecture if you are using these user data elsewhere – it can create injection issues ranging from XSS to server side code execution</p><p> 绕过禁用的输入字段：在某些面板中（Crypto / FinTech网站的）禁用了某些输入字段。在大多数情况下，这些字段是名称，用户名和电子邮件-禁用它们是有道理的，因为不应针对KYC和合规性问题定期更新这些字段。只是在客户端从HTML表单禁用它们是一个坏主意，可以通过Burp和Zap这样的浏览器代理轻松绕过它。有时，甚至不应该更新的字段（例如货币，语言和时区）也可以注入。这是一个示例：同样，由于REST架构，如果您在其他地方使用这些用户数据，则可能会导致注入问题，从XSS到服务器端代码执行</p><p> Access control: This one is complex and deep topic but I’ll share two examples:  weak auth token and  improper session managements.   There are many ways to authenticate a user in REST from HTTP basic auth, JWT to a complex implementation of cryptography. No matter what variation of auth token you are using, make sure you are not just encoding BASE64 of user data like user ID and some timestamp.   In case of JWT, use a longer secret with HMAC enabled, RS256(asymmetric algorithm) is recommended over HS256(symmetric) is the  alg header.   Also, there are some known issues with JWT, you can read more about it at  https://www.cvedetails.com/product/35664/Jwt-Project-JWT.html?vendor_id=16053 and  https://auth0.com/blog/brute-forcing-hs256-is-possible-the-importance-of-using-strong-keys-to-sign-jwts/  Coming to session management – the most common issue here is session fixation.  It is recommended to end the session when a user log-out. All the cookies and session ids shouldn’t work in a new session but that’s not the case most of the time.   In some cases, even where new session IDs are generated old session IDs are not disabled.  This was the case with Remitano, where I submitted the issue in their bug bounty program on Hackerone: Here is the video POC for the same:   https://youtu.be/543g_6UbIS0   Again make sure, session IDs are not predictable.</p><p> 访问控制：这是一个复杂而深入的主题，但我将分享两个示例：身份验证令牌弱和会话管理不当。从HTTP基本身份验证，JWT到复杂的加密实现，有很多方法可以在REST中对用户进行身份验证。无论您使用什么形式的身份验证令牌，请确保您不只是对用户数据（例如用户ID和时间戳）进行BASE64编码。如果是JWT，请在启用HMAC的情况下使用更长的机密，建议使用RS256（非对称算法），而alg标头应使用HS256（对称）。另外，JWT存在一些已知问题，您可以在https://www.cvedetails.com/product/35664/Jwt-Project-JWT.html?vendor_id=16053和https://auth0.com上了解更多有关JWT的信息。 / blog / brute-force-hs256-可能是使用强键签名jwts的重要性/进入会话管理–这里最常见的问题是会话固定。建议在用户注销时结束会话。所有Cookie和会话ID均不应在新会话中使用，但在大多数情况下并非如此。在某些情况下，即使已生成新的会话ID，也不会禁用旧的会话ID。 Remitano就是这种情况，我在其关于Hackerone的漏洞赏金计划中提交了该问题：这是相同的视频POC：https://youtu.be/543g_6UbIS0再次确保会话ID是不可预测的。</p><p> That’s all for now, hope you found this short post useful.  And if you are a crypto or FinTech startup and looking for security audit – we should talk 🙂  If you have any questions, suggestion regarding this post – feel free to reach out on my  Twitter.</p><p> 到此为止，希望您对这篇简短的帖子有所帮助。如果您是加密货币或金融科技创业公司，并且正在寻求安全审计，我们应该谈谈🙂如果您有任何疑问，关于此帖子的建议，请随时与我的Twitter联络。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://introvertmac.wordpress.com/2020/12/22/common-security-issues-with-crypto-websites-and-apis/">https://introvertmac.wordpress.com/2020/12/22/common-security-issues-with-crypto-websites-and-apis/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/security/">#security</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>