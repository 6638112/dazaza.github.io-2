<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使用Terminal.gui用C#开发CLI音乐播放器(第一部分)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">使用Terminal.gui用C#开发CLI音乐播放器(第一部分)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-26 12:55:11</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/7d2650058dc365736b30d405882e6fa8.png"><img src="http://img2.diglog.com/img/2020/10/7d2650058dc365736b30d405882e6fa8.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>下一步是实现顶级菜单，幸运的是，使用Terminal.Gui很容易做到这一点。就在top.add(Win)之上，我创建了以下代码：</p><p>//创建菜单栏。Var Menu=new menubar(new MenuBarItem[]{new MenuBarItem(&#34；_File&#34；，new MenuItem[]{new MenuItem(&#34；_Open&#34；，&#34；，)=&&gt;；应用程序。RequestStop())，新的MenuItem(&#34；_Open Stream&#34；，&#34；，&#34；打开流&#34；，()=&gt；应用程序。RequestStop())，新建MenuItem(&#34；_Quit&34；，&#34；退出MusicSharp&#34；，()=&gt；应用程序。RequestStop()，})，新建MenuBarItem(&#34；_Help&#34；，new MenuItem[]{new MenuItem(&#34；_About&#34；，String。空，()=&gt；{MessageBox。Query(&#34；Music Sharp 0.2.0&#34；，&#34；，&#34；\nMusic Sharp是用C#编写的轻量级CLI\n音乐播放器。\n\n由Mark-James McDougall\n开发，并按照GPL v3授权。\n&#34；，&#34；Close&#34；)；})，})；</p><p>在这里，我做了几件事。首先，我创建了一个新的菜单栏，它将包含菜单栏项目。接下来，我创建了每个菜单项(File和Help)，并用我们的UI中需要的方便的子项填充它们。这些子级以名称、可选描述符和方法作为参数，目前我对它们中的每一个调用Application.RequestStop()以退出应用程序(稍后我将在编写这些方法后将它们替换为实际的方法)。此外，我还创建了一个简单的About对话框，作为熟悉Terminal.Gui的一种方式。到目前为止，编译我们的代码会产生以下菜单：</p><p>虽然我仍然需要添加一些额外的菜单项(如保存/加载播放列表功能)，但这为下一部分提供了一个很好的起点，让基本的音频功能正常工作！</p><p>现在已经创建了一个非常简单的UI，我的下一个任务是测试NAudio，看看如何播放MP3文件作为简单的概念证明。为此，我创建了一个名为Player.cs的新文件来存放音频播放相关功能。我对Player类使用了单例模式，因为大多数音频处理都是在循环中进行的，我们不需要同时播放多个音频流。</p><p>在Player类内部，我创建了一个PlayAudioFile()方法，该方法从我的PC上的静态位置读取MP3文件，然后使用NAudio播放它。代码如下所示：</p><p>/&lt；Summary&gt；/Player类处理音频播放。/&lt；/Summary&gt；公共静态类播放器{/&lt；Summary&gt；/实现从文件播放音频的方法。/&lt；/Summary&gt；public static void PlayAudioFile(){string file=@&#34；C：\MusicSharp\zhund-Dusty.mp3&#34；；//加载音频文件并选择输出设备。Using var AudioFile=new AudioFileReader(File)；using var outputDevice=new WaveOutEvent()；outputDevice。Init(AudioFile)；outputDevice。Play()；//睡眠到播放结束。While(outputDevice.。PlaybackState==PlaybackState。播放){线程。睡眠(1000)；}。</p><p>最后一个任务是将PlayAudioFile()方法连接到UI，为此，我将Gui.cs中的Open菜单代码行替换为以下内容：</p><p>在编译并打开播放器后，我现在听到了甜美的音乐声！虽然这么早听到音乐是令人兴奋的，但还是有相当多的收获。这些措施包括：</p><p>尽管缺少这些功能，但每当我能够在项目中取得切实进展时，我仍然觉得非常令人兴奋，它提供了一些动力来完成一些更乏味的部分。</p><p>在本指南的第一部分中，我们了解了如何使用Terminal.GUI实现简单的UI，然后使用它通过NAudio播放音频文件。我本来想让MusicSharp成为跨平台的，但不幸的是，NAudio严重依赖于Windows库，并且与其他操作系统不兼容。出于好奇，我在我的Macbook Pro(运行Catalina)上测试了MusicSharp，程序运行了，但当我试图打开MP3时，它崩溃了：</p><p>在这些早期测试阶段，MusicSharp当前在调试模式下运行时消耗了15MB内存和微不足道的CPU使用量，随着播放器功能的进一步充实，看看这个数字的结果会很有趣。请务必关注本指南的第二部分，因为我们将继续研究UI和Player元素！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://markjames.dev/2020-10-25-developing-a-cli-music-player-csharp/">https://markjames.dev/2020-10-25-developing-a-cli-music-player-csharp/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/开发/">#开发</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/c#/">#c#</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cli/">#cli</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/播放/">#播放</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1031097.html"><img src="http://img2.diglog.com/img/2020/10/thumb_c3efa904682e069f89569fb53a11a7f2.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031097.html">为您的开发团队创建有效的教程</a></div><span class="my_story_list_date">2020-10-25 23:2</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031016.html"><img src="http://img2.diglog.com/img/2020/10/thumb_4c7caf2581b4d14b9be121f26f94dc9c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031016.html">三个开源Sonos项目：Rust中高效的嵌入式开发</a></div><span class="my_story_list_date">2020-10-25 6:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031004.html"><img src="http://img2.diglog.com/img/2020/10/thumb_d5b982d96e1f9f061348f7cfba88a88e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031004.html">数百名应用程序开发人员希望加入新的挑战苹果的联盟</a></div><span class="my_story_list_date">2020-10-25 3:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030986.html"><img src="http://img2.diglog.com/img/2020/10/thumb_637d367c078935f65f76e45864acdc28.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030986.html">产品开发的四大危险动物</a></div><span class="my_story_list_date">2020-10-25 3:10</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>