<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>冗余反对什么？ Redundant Against What?</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Redundant Against What?<br/>冗余反对什么？ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-16 02:51:04</div><div class="page_narrow text-break page_content"><p>There&#39;s basically one fundamental reason that distributed systems can achieve better availability than single-box systems: redundancy. The software, state, and other things needed to run a system are present in multiple places. When one of those places fails, the others can take over. This applies to replicated databases, load-balanced stateless systems, serverless systems, and almost all other common distributed patterns.</p><p>基本上，分布式系统可以实现比单箱系统更好的可用性：冗余。运行系统所需的软件，状态和其他事项存在于多个位置。当其中一个地方失败时，其他地方可能会接管。这适用于复制的数据库，负载平衡无状态系统，无服务器系统以及几乎所有其他常见的分布式模式。</p><p> One problem with redundancy is that it  adds complexity, which may reduce availability. Another problem, and the one that people tend to miss the most, is that redundancy isn&#39;t one thing. Like  security, redundancy is a single word that we mean that our architectures and systems are resistant to different kinds of failures. That can mean infrastructure failures, where redundancy could mean multiple machines, multiple racks, multiple datacenters or even multiple continents. It can mean software failures, where common techniques like canary deployments help systems to be redundant when one software version failures. I can also mean logical failures, where we recognize that  state can affect the performance or availability of our system, and we try ensure that the same  state doesn&#39;t go to every host. Sometimes that state is configuration, sometimes it&#39;s stored data or requests and responses.</p><p> 冗余的一个问题是它增加了复杂性，这可能会降低可用性。另一个问题，以及人们倾向于错过的另一个问题，是冗余ISN＆＃39; t一件事。像安全性一样，冗余是一个单词，我们的意思是我们的架构和系统对不同类型的故障抵抗。这可能意味着基础设施故障，冗余可能意味着多台机器，多个机架，多个数据中心甚至多个大洲。它可以意味着软件故障，其中包括金丝雀部署等公共技术在一个软件版本故障时帮助系统冗余。我还可以指的是逻辑失败，在那里我们认识到该状态会影响我们系统的性能或可用性，我们尝试确保相同的国家不会进入每个主机。有时该状态是配置，有时它＆＃39; s存储的数据或请求和响应。</p><p>  Unfortunately, when we talk about system designs, we tend to forget these multiple definitions of redundancy and instead just focus on infrastructure. To show why this matters, let&#39;s explore an example.</p><p>  不幸的是，当我们谈论系统设计时，我们倾向于忘记这些冗余的多种定义，而是只关注基础架构。展示为什么这一事项，让＆＃39; s探索一个例子。</p><p> Event logs are rightfully a popular way to build large-scale systems. In these kinds of systems there&#39;s an ordered log which all changes (writes) flows through, and the changes are then applied to some systems that hang off the log. That could be read copies of the data, workflow systems taking action on the changes, and so on. In the simple version of this pattern one thing is true: every host in the log, and every consumer, sees the same changes in the same order.</p><p> 事件日志是合适的一种流行的方式来构建大规模系统。在这些类型的系统中，其中所有更改（写入）流过的有序日志，然后将更改应用于挂起日志的某些系统。这可以读取数据的副本，工作流系统对更改进行操作等。在此模式的简单版本中，有一件事是真的：日志中的每个主机和每个消费者，都以相同的顺序看到相同的更改。</p><p>  One advantage of this architecture is that it can offer a lot of redundancy against infrastructure failures. Common event log systems (like Kafka) can easily handle the failure of a single host. Surviving the failure of a single replica is also easy, because the architecture makes it very easy to keep multiple replicas in sync.</p><p>  这种架构的一个优点是它可以提供很多违反基础架构故障的冗余。常见事件日志系统（如Kafka）可以轻松处理单个主机的故障。幸存下单个副本的失败也很容易，因为架构使得在同步中保持多个副本非常容易。</p><p>  Now, consider the case where one of the events that comes down the log is a  poison pill. This simply means that the consumers don&#39;t know how to process it. Maybe it says something that&#39;s illegal (&#34;I can&#39;t decrement this unsigned 0!&#34;), or doesn&#39;t make sense (&#34;what&#39;s this data in column X? I&#39;ve never heard of column X!&#34;). Maybe it says something that only makes sense in a future, or past, version of the software. When faced with a poison pill, replicas have basically two options: ignore it, or stop.</p><p>  现在，考虑到日志下降的事件之一是毒药的情况。这只是意味着消费者不知道如何处理它。也许它说了一些非法（＆＃34;我可以和＃39; t递减这个未签名的0！＆＃34;），或者没有意义（＆＃34;什么＆＃34;什么＆＃34;什么X列中的这个数据？i＆＃39;从未听说过列x！＆＃34;）。也许它说了一个只在未来或过去，软件版本中只有意义的东西。当面对毒药时，副本基本上有两种选择：忽略它或停止。</p><p>  Ignoring it could lead to data loss, and stopping leads to writes being unavailable. Nobody wins. The problem here is a lack of redundancy: running the same (deterministic) software on the same state is going to have the same bad outcome every time.</p><p>  忽略它可能导致数据丢失，并且停止导致写入不可用。没有人赢。这里的问题是缺乏冗余：运行相同的（确定性）软件在同一状态下每次都会具有相同的坏结果。 </p><p>  This problem doesn&#39;t only apply to event log architectures. Replicated state machines, famously, suffer from the same problem. So does primary/backup replication. It&#39;s not a problem with one architecture, but a problem with distributed systems designs in general. As you design systems, it&#39;s worth asking the question about what you&#39;re getting from your redundancy, and what failures it protects you against. In some sense, this is the same kind of thinking that security folks use when they do  threat modeling:</p><p>此问题不会应用于事件日志体系结构。复制的国家机器，着名，遭受同样的问题。主/备份复制也是如此。它不是一个架构的问题，而是一般分布式系统设计的问题。当您设计系统时，它值得询问关于您的冗余＆＃39;从冗余中获取的问题，以及它保护您的失败。在某种意义上，这是同样的意思，即安全人员在威胁建模时使用：</p><p> Threat modeling answers questions like “Where am I most vulnerable to attack?”, “What are the most relevant threats?”, and “What do I need to do to safeguard against these threats?”.</p><p> 威胁建模答案问题就像“我最容易受到攻击的地方？”，“最相关的威胁是什么？”，“我需要做些什么来保护这些威胁？”。</p><p> A few years ago, I experimented with building a  threat modeling framework for distributed system designs, called CALISTO, but I never found something I loved. I do love the way of thinking, though. &#34;What failures am I vulnerable to?&#34;, &#34;Which are the most relevant failures?&#34;, &#34;What do I need to do to safeguard against those failures?&#34;</p><p> 几年前，我尝试了为分布式系统设计构建威胁建模框架，称为Calisto，但我从未找到过我所爱的东西。但是，我做了思维方式。 ＆＃34;我很容易受到伤害的？ 34;</p><p> If your answer to &#34;What failures am I vulnerable to?&#34; doesn&#39;t include software bugs, you&#39;re more optimistic than me.</p><p> 如果你的回答＆＃34;我易受伤害的失败？＆＃34;没有包括软件错误，你＆＃39;比我更乐观。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://brooker.co.za/blog/2021/04/14/redundancy.html">https://brooker.co.za/blog/2021/04/14/redundancy.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/redundant/">#redundant</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/系统/">#系统</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>