<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>了解间接飞行时间深度感应 Understanding Indirect Time-of-Flight Depth Sensing</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Understanding Indirect Time-of-Flight Depth Sensing<br/>了解间接飞行时间深度感应 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-20 15:06:06</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/4/c3f7d93476060629a99d8cb18871824d.jpg"><img src="http://img2.diglog.com/img/2021/4/c3f7d93476060629a99d8cb18871824d.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Now that you’ve had a chance to read the  Intro to Indirect Time-of-Flight (ToF) post, let’s dig a little deeper into the mechanics behind the Microsoft implementation of time-of-flight depth sensing, as well as a couple functional advantages it presents.</p><p>现在你有机会阅读间接飞行时间（TOF）帖子的介绍，让我们深入了解微软实施飞行时间深度感应的机制，以及一对夫妇它提供的功能优势。</p><p>  To recap, “time-of-flight” refers to emitting light at an object and measuring how long it takes to bounce back and return, then converting the time measurement into distance using the speed of light, giving us the object’s shape and position in its surroundings.</p><p>  回顾，“飞行时间”是指在物体上发光并测量反弹和返回的时间需要多长时间，然后使用光速将时间测量转换为距离，使我们成为物体的形状和位置它的周围环境。</p><p>   In practice, we don’t use the actual round-trip time – to get millimeter precision, we would need picosecond stopwatch circuits for every pixel! Instead, we take the “indirect” approach, where we emit light with a periodic or “modulated” pattern, then calculate the shift in the return measurement.</p><p>   在实践中，我们不使用实际的往返时间 - 获得毫米精度，我们需要为每个像素进行PicoSecond StopWatch电路！相反，我们采取“间接”方法，在那里我们发光，用周期性或“调制”模式，然后计算返回测量的换档。</p><p>  Figure 2. Plots of modulated signal energy as time elapses, both transmitted and received, and the mathematical relationship between phase shift and distance.</p><p>  图2.作为时间经过的调制信号能量的曲线，包括传输和接收，以及相移和距离之间的数学关系。</p><p> How do we measure this phase shift? At the silicon level, each pixel in the Microsoft ToF sensor is comprised of two detectors, or “wells”, that receive photons and turn them into electric charge. Each well can be opened or closed by the sensor control circuit. If we keep each well open for half of a modulation period – side A in sync with the emitter, and side B exactly out of sync – then the returning photons will be split between the two detectors, but at least one well is always ready to catch them. Based on the proportion of photons that accumulate in detector A vs. detector B, we can calculate the shift of the returned signal. (We wait for the modulation period to repeat a few times to accumulate charge – this is referred to as “integration time”, much like shutter speed on a color camera.)</p><p> 我们如何衡量这一阶段班次？在硅层处，Microsoft ToF传感器中的每个像素由两个检测器或“井”组成，该探测器或“孔”接收光子并将它们转换为电荷。每个孔可以通过传感器控制电路打开或关闭。如果我们将每个孔打开一个调制周期的一半 - 与发射器同步，并且侧面b完全相同 - 然后返回光子将在两个探测器之间分开，但至少有一个井总是准备好抓住他们。基于在探测器A与检测器B中累积的光子的比例，我们可以计算返回信号的偏移。 （我们等待调制周期重复几次以累积充电 - 这被称为“集成时间”，就像彩色相机上的快门速度一样。）</p><p>  Figure 3a. Animation showing the synchronized emitter-sensor operation. Modulated light leaves the emitter on the far right, strikes the target on the left, and returns to a certain pixel in the sensor on the middle-right. Detector A (in green) is open while the emitter is active, and Detector B (in cyan) is open during the inactive part of the cycle. Because of the phase shift, returning photons will not necessarily arrive in sync.</p><p>  图3A。动画显示同步发射器传感器操作。调制光在右侧的右侧离开发射器，击中左侧的目标，并在中间右侧返回传感器中的某个像素。当发射器处于活动状态时，检测器A（以绿色为单位），并且在循环的非活动部分期间检测器B（在青色）打开。由于相移，返回光子不一定会同步到达。</p><p>  Figure 3b. 2D plots of light energy over time in the same scenario. The difference in accumulated charge between the two detectors will be the “output” of this pixel.</p><p>  图3B。在同一场景中的2D斑点随着时间的推移。两个探测器之间的累积电荷的差异将是该像素的“输出”。 </p><p>  However, we can’t stop here. If a second object appears in the scene, at a distance that gives it the same phase shift but the opposite direction, what happens? The split of accumulated charge in the pixel is just like it was before, but we have no way to know that detector A was charged at the end of the return instead of the beginning. This means that our measurement is ambiguous.</p><p>但是，我们不能停止这里。如果场景中出现第二个对象，则在一个距离处，使其具有相同的相移，但相反的方向，会发生什么？像素中的累积电荷的分裂就像之前一样，但我们没有办法知道探测器A在返回结束时被收取而不是开始。这意味着我们的测量是模棱两可的。</p><p> Figure 4. The same scenario as above, but contrasted with a hypothetical second target that’s about one-third of a modulation period farther away. Our (A – B) output has not changed…</p><p> 图4.与上述相同的场景，但与一个假设的第二个目标形成鲜明对比，这是一个大约三分之一的调制时间。我们的（A  -  B）输出没有改变......</p><p> There are a few ways to remove the ambiguity. The most common method is to repeat the measurements immediately, but push the sensor out of phase, filling out the picture of the returned wave. In this example, we modulate the sensor 90 degrees out of phase with respect to the light source, changing the open-close pattern of the charge accumulators in the pixel:</p><p> 有几种方法可以消除歧义。最常见的方法是立即重复测量，但将传感器推出相位，填充返回波的图片。在该示例中，我们在相对于光源调制传感器90度，改变像素中电荷累加器的开闭图案：</p><p>  Figure 5. Another pair of measurements in the original scenario adds information that can be used to disambiguate.</p><p>  图5.原始方案中的另一对测量添加了可用于消除歧义的信息。</p><p> Seeing how the returned light “projects” itself onto the synchronized and 90-degree wells, we can use complex numbers to reconstruct the original phase shift, discarding the false second solution. This complex sum gives us both the phase shift (angle from the real axis) we were originally after  and the brightness of the returned light (as the magnitude of the complex number). From this brightness calculation, we can extract object reflectivity, or monochrome images of the scene in infrared!</p><p> 看到返回的光线“将”自身恢复为同步和90度井，我们可以使用复数来重建原始相移，丢弃错误的第二次解决方案。这种复杂的总和使我们两个相移（来自真实轴的角度）我们最初在返回的光线之后和亮度的亮度（作为复数的大小）。从这种亮度计算，我们可以提取对象反射率，或在红外线中的场景的单色图像提取。</p><p>    Now consider a case where the modulated light from our camera is not the only light present in the scene. It’s common for other sources, such as the sun, to provide “ambient” light strong enough to show up in our measurements. This has a diluting effect, dropping extra photons onto our detectors whenever they are open.</p><p>    现在考虑来自我们相机的调制光不是场景中唯一的光的情况。对于其他来源（如Sun）是常见的，以提供“环境”光足够强，可以在我们的测量中出现。这具有稀释效果，每当打开时将额外的光子放入我们的探测器上。</p><p> Since this extra light is generally unmodulated, it will impact both detectors about equally. However, our phase shift measurements depend only on the difference between the two, which means that we can tolerate a lot of ambient light without introducing a systematic bias! Not only that, we don’t have to dynamically tailor our shutter speed to the environment, unless we observe light levels so high that pixels are “saturating”, or completely filling the charge wells during an exposure. These benefits of differential measurement turn a lot of potentially challenging scenarios into plug-and-play simplicity.</p><p> 由于这种额外的光通常是未经调配的，因此它将影响两个探测器。然而，我们的相移测量只取决于两者之间的差异，这意味着我们可以在不引入系统偏压的情况下容忍大量环境光线！不仅如此，我们不必动态定制我们的快门速度，除非我们观察光线，如此高，像素在暴露期间完全填充充电孔。这些差异测量的这些好处转化了很多潜在挑战的情景，进入即插即用简单。 </p><p>  Figure 7. The ambient light energy contributes about the same offset to each detector measurement, leaving the difference unaffected.</p><p>图7.环境光能量达到每个检测器测量的相同偏移量，留下不受影响的差异。</p><p> Now, I hate to attenuate the sunny overview we’ve had so far, but it’s important to note that the indirect time-of-flight system is not without its sources of error. Ambient light may not cause interference by matching up with modulation, but it still adds its own variation, or “noise”, to the measurements. There is also noise in the system itself – pixels may respond more strongly or weakly to the same amount of light; the light source can experience time or intensity fluctuations. If ambient light begins to overfill the pixels, it compresses the space that the two wells need to differentiate themselves from each other, which intensifies the effect of any noise contributions. We can’t completely avoid this, but to reduce it, we select a wavelength for our emitter from an atmospheric absorption band, and add a sensor bandpass filter to help screen photons we didn’t produce ourselves.</p><p> 现在，我讨厌透明我们到目前为止的阳光明媚的概述，但重要的是要注意间接的飞行时间系统并非没有其错误来源。环境光可能不会通过调制匹配而导致干扰，但它仍然会增加其自身的变化或“噪声”，或“噪声”。系统本身还有噪音 - 像素可能更强烈或弱到相同的光量;光源可以经历时间或强度波动。如果环境光开始填充像素，则压缩两个井中需要彼此区分的空间，这加剧了任何噪声贡献的效果。我们无法完全避免这种情况，但要减少它，我们从大气吸收带中选择光泽的波长，然后添加传感器带通滤波器，以帮助屏幕光子我们没有产生自己。</p><p> In conclusion, differential response of modulated light as an indirect time-of-flight measurement brings a lot to the table, even in this basic form: robust accuracy even in the presence of extra light, performance without much prior knowledge of the environment, additional measurement streams such as reflectivity and monochrome IR imaging. In future posts, we’ll cover even more benefits of our ToF sensor and the improvements that we made on the basic indirect ToF mechanism.</p><p> 总之，即使在这种基本形式的情况下，调制光作为间接飞行时间测量的差异响应会给桌面带来很多：即使在这种基本形式中，即使在存在额外的光线下，鲁棒精度也在额外的光线下，额外的环境知识，额外的表现测量流，例如反射率和单色IR成像。在未来的帖子中，我们将介绍我们的TOF传感器的更多好处以及我们在基本间接TOF机制上所做的改进。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://devblogs.microsoft.com/azure-depth-platform/understanding-indirect-tof-depth-sensing/">https://devblogs.microsoft.com/azure-depth-platform/understanding-indirect-tof-depth-sensing/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/时间/">#时间</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/indirect/">#indirect</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>