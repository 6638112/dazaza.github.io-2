<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Amazon Time Stream通常可用</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Amazon Time Stream通常可用</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-01 08:12:01</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/45a7c12eb6f5e645dbbde0b210058e65.png"><img src="http://img2.diglog.com/img/2020/10/45a7c12eb6f5e645dbbde0b210058e65.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>时间序列是描述事物如何随时间变化的一种非常常见的数据格式。一些最常见的来源是工业机器和物联网设备、IT基础设施堆栈(如硬件、软件和网络组件)，以及随时间共享其结果的应用程序。有效地管理时间序列数据并非易事，因为数据模型不适合通用数据库。</p><p>因此，我很高兴地告诉大家，Amazon Time Stream现已全面上市。TimeStream是一种快速、可扩展且无服务器的时间序列数据库服务，可轻松收集、存储和处理每天数万亿次的时间序列事件，速度最高可达关系数据库的1000倍，而成本仅为关系数据库的十分之一。</p><p>这是通过TimeStream管理数据的方式实现的：最新数据保留在内存中，历史数据根据您定义的保留策略移动到成本优化的存储中。所有数据始终跨同一AWS区域的多个可用区(AZ)自动复制。将新数据写入内存存储，在此存储中跨三个AZ复制数据，然后返回操作成功。数据复制是基于仲裁的，因此节点或整个AZ的丢失不会破坏持久性或可用性。此外，作为额外的预防措施，内存存储中的数据会持续备份到Amazon Simple Storage Service(S3)。</p><p>查询可跨层自动访问和组合最新数据和历史数据，无需指定存储位置，并且支持特定于时间序列的功能，可帮助您近乎实时地识别数据中的趋势和模式。</p><p>没有前期费用，您只需为您写入、存储或查询的数据付费。根据负载，TimeStream会自动向上或向下扩展以调整容量，而无需管理底层基础架构。</p><p>TimeStream与流行的数据收集、可视化和机器学习服务集成，使其易于与现有和新的应用程序配合使用。例如，您可以直接从AWS IoT Core、Amazon Kinesis Data Analytics for Apache Flink、AWS IoT Greengrass和Amazon MSK获取数据。您可以从Amazon QuickSight可视化存储在TimeStream中的数据，并使用Amazon SageMaker将机器学习算法应用于时间序列数据，例如用于异常检测。您可以使用TimeStream细粒度的AWS Identity and Access Management(IAM)权限轻松地从AWS Lambda函数获取或查询数据。我们提供在开源平台(如Apache Kafka、Telegraf、Prometheus和Grafana)上使用TimeStream的工具。</p><p>在TimeStream控制台中使用Amazon TimeStream，我选择了create database。我可以选择创建一个Standard数据库或一个用示例数据填充的示例数据库。我继续使用标准数据库，并将其命名为MyDatabase。</p><p>默认情况下，所有时间流数据都是加密的。我使用默认主密钥，但您也可以使用您使用AWS密钥管理服务(KMS)创建的客户管理密钥。这样，您就可以控制主密钥的轮换，以及谁有权使用或管理它。</p><p>我完成了数据库的创建。现在我的数据库是空的。我选择create table并将其命名为MyTable。</p><p>每个表都有自己的数据保留策略。第一个数据被摄取到内存存储中，在那里可以存储最少一个小时到最多一年的时间。之后，它会自动移到磁性商店，在那里它可以保存最少一天到最多200年，之后就会被删除。在我的例子中，我选择了1小时的内存存储保留和5年的磁性存储保留。</p><p>在TIMESTREAM中写入数据时，不能插入早于内存存储保留期的数据。例如，在我的情况下，我将无法插入超过1小时的记录。同样，您不能插入具有未来时间戳的数据。</p><p>我完成了表的创建。正如您注意到的，我没有被要求提供数据模式。当数据被摄取时，TimeStream会自动推断出这一点。现在，让我们将一些数据放入表中！</p><p>在Amazon Time Stream中加载数据时间流表中的每个记录都是时间序列中的单个数据点，包含：</p><p>度量名称、类型和值。每条记录可以包含单个度量值，但是不同的度量值名称和类型可以存储在同一个表中。</p><p>描述度量值并可用于筛选或聚合数据的零个或多个维度。表中的记录可以有不同的维度。</p><p>例如，让我们构建一个简单的监控应用程序，从服务器收集CPU、内存、交换和磁盘使用情况。每台服务器由主机名标识，并具有表示为国家/地区和城市的位置。</p><p>表中的记录将测量不同的东西。我使用的度量名称是：</p><p>对于监控应用程序，我使用Python。要收集监控信息，我使用psutil模块，该模块可以与以下内容一起安装：</p><p>进口时间导入boto3导入Psutil从botocore.config导入配置数据库名称=&#34；我的数据库&#34；Table_name=&#34；MyTable&#34；国家=&#34；英国&#34；城市=&#34；伦敦&#34；Hostname=&#34；MyHostname&#34；#您可以使用socket.gethostname()将其动态化间隔=1#秒定义准备记录(MEASURE_NAME，MEASURE_VALUE)：记录={&#39；时间&#39；：字符串(CURRENT_TIME)，&#39；尺寸&#39；：尺寸标注、&#39；MeasureName&#39；：MEASURE_NAME，&#39；MeasureValue&#39；：str(MEASURE_VALUE)，&#39；MeasureValueType&#39；：&#39；Double&#39；}退货记录定义写入记录(记录)(_R)：尝试：结果=write_client.write_records(DatabaseName=DATABASE_NAME，TableName=TABLE_NAME，记录=记录，CommonAttributes={})状态=result[&#39；ResponseMetadata&#39；][&#39；HTTPStatusCode&#39；]打印(&#34；已处理%d条记录。写入记录状态：%s&#34；%(镜头(记录)，状态)除异常错误外：打印(&#34；错误：&#34；，错误)如果__名称__==&#39；__Main__&#39；：Session=boto3.Session()WRITE_CLIENT=session.client(&#39；timestream-Write&#39；，config=Config(READ_TIMEOUT=20，MAX_POOL_CONNECTIONS=5000，RETRIES={&#39；MAX_ATTENTIONS&#39；：10}))Query_client=session.client(&#39；timestream-query&#39；)尺寸=[{&#39；名称&#39；：&#39；国家/地区&#39；，&#39；值&#39；：国家/地区}，{&#39；名称&#39；：&#39；城市&#39；，&#39；值&#39；：城市}，{&#39；名称&#39；：&#39；主机名&#39；，&#39；值&#39；：主机名}，]记录=[]当为True时：Current_time=int(time.time()*1000)CPU利用率=psutil.cpu_Percent()内存利用率=psutil.virtual_memory().百分比交换利用率=psutil.exchange_memory().百分比磁盘利用率=psutil.disk_use(&#39；/&#39；).百分比Records.append(prepare_record(&#39；cpu_utilization&#39；，CPU_利用率))Records.append(PREPARE_RECORD(&#39；内存利用率&#39；，内存利用率))Records.append(prepare_record(&#39；swap_utilization&#39；，交换利用率))Records.append(prepare_record(&#39；disk_utilization&#39；，磁盘利用率))打印(&#34；记录{}-CPU{}-内存{}-交换{}-磁盘{}&#34；.format(LEN(记录)、CPU利用率、内存利用率交换利用率、磁盘利用率))如果len(记录)==100：写入记录(记录)(_R)记录=[]时间.休眠(间隔)。</p><p>我启动Collect.py应用程序。每100条记录中，数据写入MyData表：</p><p>$python3收集器.py记录4-CPU 31.6-内存65.3-交换73.8-磁盘5.7记录8-CPU 18.3-内存64.9-交换73.8-磁盘5.7记录12-CPU 15.1-内存64.8-交换73.8-磁盘5.7。。。记录96-CPU 44.1-内存64.2-交换73.8-磁盘5.7记录100-CPU 46.8-内存64.1-交换73.8-磁盘5.7处理了100条记录。写入记录状态：200记录4-CPU 36.3-内存64.1-交换73.8-磁盘5.7记录8-CPU 31.7-内存64.1-交换73.8-磁盘5.7记录12-CPU 38.8-内存64.1-交换73.8-磁盘5.7。。。</p><p>现在，在TimeStream控制台中，我看到MyData表的模式根据接收的数据自动更新：</p><p>请注意，由于表中的所有度量都是DOUBLE类型，因此MEASURE_VALUE：：DOUBLE列包含所有度量的值。如果度量是不同类型的(例如，int或BIGINT)，我会有更多的列(如MEASURE_VALUE：：INT和MEASURE_VALUE：：BIGINT)。</p><p>在控制台中，我还可以看到表中有哪些类型的度量、它们对应的数据类型以及用于该特定度量的维度的概要：</p><p>从控制台查询数据我可以使用SQL查询时间序列数据。内存存储针对快速时间点查询进行了优化，而磁性存储针对快速分析查询进行了优化。但是，查询会自动处理所有存储(内存和磁盘)上的数据，而不必在查询中指定数据位置。</p><p>我直接从控制台运行查询，但我也可以使用JDBC连接来访问查询引擎。我从一个基本查询开始，查看表中的最新记录：</p><p>让我们来试试更复杂的东西。我希望看到过去两小时内按主机名在5分钟间隔内聚合的平均CPU利用率。我根据MEASURE_NAME的内容过滤记录。我使用函数bin()将时间舍入为间隔大小的倍数，使用函数ago()比较时间戳：</p><p>选择主机名，Bin(时间，5M)，表示binned_time，AVG(MEASURE_VALUE：：DOUBLE)AS AVG_CPU_EXPLICATION来自MyDatabase.MyTable其中MEASURE_NAME=‘CPU利用率&#39；和Time&gt；之前(2h)按主机名、bin分组(时间，5M)。</p><p>收集时间序列数据时，可能会遗漏一些值。这在分布式架构和物联网设备中尤为常见。TimeStream有一些有趣的函数，您可以使用它们来重新填充缺失值，例如使用线性插值，或者基于上一次结转的观测结果。</p><p>更广泛地说，TimeStream提供了许多函数来帮助您使用数学表达式、操作字符串、数组和日期/时间值、使用正则表达式以及使用聚合/窗口。</p><p>要体验可以对TimeStream执行的操作，您可以创建示例数据库并添加我们提供的两个IoT和DevOps数据集。然后，在控制台查询界面中，查看示例查询以了解一些更高级的功能：</p><p>将Amazon Time Stream与Grafana结合使用TimeStream最有趣的方面之一是与许多平台的集成。例如，您可以使用Grafana 7.1或更高版本可视化时间序列数据并创建警报。Time Stream插件是Grafana开源版本的一部分。</p><p>我向数据库中添加了一个新的Grafan aDemo表，并使用另一个示例应用程序来持续获取数据。该应用程序模拟从运行在数千台主机上的微服务体系结构收集的性能数据。</p><p>我在Amazon Elastic Compute Cloud(EC2)实例上安装Grafana，并使用Grafana CLI添加时间流插件。</p><p>在Grafana控制台中，我使用正确的AWS凭据以及时间流数据库和表配置了插件。现在，我可以使用不断收集性能数据的Grafan aDemo表中的数据，选择作为时间流插件一部分分发的样例仪表板：</p><p>Amazon Time Stream现已在美国东部(弗吉尼亚州北部)、欧洲(爱尔兰)、美国西部(俄勒冈州)和美国东部(俄亥俄州)提供。您可以将TimeStream与控制台、AWS命令行界面(CLI)、AWS SDK和AWS CloudForment配合使用。使用TimeStream时，您可以根据写入次数、查询扫描的数据和使用的存储进行付费。更多信息，请查看定价页面。</p><p>您可以在此repo中找到更多示例应用程序。要了解更多信息，请参阅文档。处理时间序列(包括数据接收、保留、访问和存储分层)从未像现在这样简单。让我知道你要建造什么！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://aws.amazon.com/blogs/aws/store-and-access-time-series-data-at-any-scale-with-amazon-timestream-now-generally-available/">https://aws.amazon.com/blogs/aws/store-and-access-time-series-data-at-any-scale-with-amazon-timestream-now-generally-available/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/amazon/">#amazon</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/数据/">#数据</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1027414.html"><img src="http://img2.diglog.com/img/2020/10/thumb_2dbf26e3d9e82e980dcfef8578359aed.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027414.html">欧盟数据规则草案针对苹果、谷歌、Facebook和亚马逊</a></div><span class="my_story_list_date">2020-10-1 5:26</span></div><div class="col-sm"><div><a target="_blank" href="/story/1027389.html"><img src="http://img2.diglog.com/img/2020/10/thumb_7c02c503b05a57a6204dfef1bf613cef.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027389.html">采访亚马逊40名员工和政府文件：亚马逊新冠肺炎回应缺乏监督和透明度，工人安全政策不完善</a></div><span class="my_story_list_date">2020-10-1 4:11</span></div><div class="col-sm"><div><a target="_blank" href="/story/1027284.html"><img src="http://img2.diglog.com/img/2020/9/thumb_048379ab96152c65bb5fff6be70eabea.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027284.html">亚马逊仓库爆炸性数据显示，多年来严重伤害人数一直在上升，机器人使这项工作变得更加危险</a></div><span class="my_story_list_date">2020-9-30 21:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1027190.html"><img src="http://img2.diglog.com/img/2020/9/thumb_83653b775281210f7958d64a5a63e884.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027190.html">与亚马逊的PillPack和沃尔玛的CareZone竞争的在线药店DivyDose被UnitedHealth收购；消息人士称交易价值超过3亿美元</a></div><span class="my_story_list_date">2020-9-30 10:56</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>