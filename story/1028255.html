<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Awfice-小型办公套件应用程序的集合</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Awfice-小型办公套件应用程序的集合</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-12 19:31:58</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/3cd67f8c773c5df13d60d9d2e7f8918c.png"><img src="http://img2.diglog.com/img/2020/10/3cd67f8c773c5df13d60d9d2e7f8918c.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>我们都熟悉传统的办公套件--文字处理器、电子表格、演示文稿程序，可能还有图表或笔记应用程序。我们已经在Microsoft Office和Google Docs中看到了这一切。它们真的很强大而且很大。但是，构建办公套件所需的最少代码量是多少呢？</p><p>显然，我们的办公套件不会是桌面GUI应用程序--它们需要大量的代码和精力来构建。同样的情况也适用于本地移动应用程序。我们可能会考虑构建一个控制台(基于终端的)应用程序，实际上已经有了小得离谱的文本编辑器或电子表格，但是如果我们以浏览器为目标，事情会容易得多。</p><p>浏览器已经提供了一个不错的富文本编辑器(可内容编辑)，并且对于数学表达式来说是非常好的(虽然不安全)求值器。</p><p>是的，就是这样。此外，你可以把它变成一个独立的URL，当我需要一个便签簿来做快速笔记时，我就是这样用它的：</p><p>尝试将其粘贴到您的地址栏中。如果您的浏览器很适合您，您应该能够使用Ctrl+B或Ctrl+I来使文本显示为粗体或斜体。</p><p>我们可以通过添加一些样式来进一步增强它(是的，我相信一些小的排版改进很重要)：</p><p>我已经将其添加到书签中，现在我的零权重文本编辑器离我只有一个按键的距离。您还可以将其用作粘贴文本甚至图片的临时剪贴板。</p><p>当然，这可以进一步扩展以支持各种标题样式、列表或缩进。</p><p>稍微压缩上面的代码并将其转换为数据URL将产生以下大约600字节长的富幻灯片编辑器：</p><p>通过将幻灯片打印到文件中，可以将幻灯片导出为PDF，然后可以在任何计算机上显示幻灯片。</p><p>不久前，我构建了https://onthesamepage.online，以便与其他人协作快速草拟想法，但尽管它很简单，但它仍然比我们这里所做的要大。</p><p>至少，我们只能在画布上画线条。我们需要一个&lt；canvas&gt；元素、几个鼠标/触摸处理程序和一个标志，以指示在按下鼠标时鼠标移动实际上正在绘制。</p><p>这里值得一提的是，具有id的元素可以作为window[id]或window.id进行访问。很长一段时间没有标准化的东西，一直是IE的黑客，现在已经成为标准了。</p><p>另外，我将光标位置处理移动到单独的短函数，以便在MouseDown和Mousemove处理程序中重用它们。最后，我重置了Body元素的边距以使画布全屏显示。</p><p>精简后的代码大约为400字节，允许您用鼠标绘图，不多也不少：</p><p>&lt；Canvas id=&#34；v&#34；&gt；&lt；脚本&gt；d=文档，//文档d的快捷方式。身体。风格。边距=0，//重置样式f=0，//鼠标按下标志c=v。GetContext(&#34；2d&#34；)，//canvas context v.。Width=innerWidth，//使画布元素全屏v。Height=innerHeight，c.。Line Width=2，//将线条加宽x=e=&gt；e。客户端X||e。触及[0]。ClientX，//从鼠标获取X位置/触摸y=e=&gt；e。客户端Y||e。触及[0]。ClientY，//从鼠标获取Y位置/触摸d。Onousedown=d。Ontouch start=e=&gt；{f=1，e.。Prevention entDefault()，c.。Moveto(x(E)，y(E))，c.。EginPath()}，d。Onouse semove=d.。Ontouch chmobile=e=&gt；{f&amp；&amp；(c.。Line to(x(E)，y(E))，c.。笔划())}，d。OnMouseUp=d。Ontouch chend=e=&gt；f=0&lt；/script&gt；</p><p>这可能是最复杂也是最大的一个，但我们将尽量保持在每个应用程序1KB的限制以下。</p><p>布局会很简单。HTML附带表格，我们为什么不使用它们呢？由于电子表格单元格通常可以通过“字母”+“数字”寻址，因此让我们将表格限制为26x100个单元格。在循环中动态创建行和单元格是有意义的。一些基本的样式会让我们的电子表格看起来更漂亮：</p><p>&lt；表ID=&#34；t&#34；&gt；t。风格。BorderColrapse=&#34；折叠&#34；；//删除(设i=0；i&lt；101；i++){const row=t.。Insert tRow(-1)；for(let j=0；j&lt；27；j++){//将列索引j转换为字母(&#34；A&#34；的字符代码为65)常量Letter=String。FromCharCode(65+j-1)；//1=A，2=B，3=C等常量单元格=ROW。插入单元格(-1)；单元格。风格。BORDER=&#34；1px纯银&#34；；//制作薄灰色边框单元格。风格。TextAlign=&#34；right&#34；；//右对齐，如excel if(i&gt；0&amp；&amp；j&gt；0){//添加可识别的输入字段，这里是公式输入常量字段=文档。CreateElement(&#39；input&#39；)；字段。ID=Letter+i；//即，&#34；B3&#34；单元格。AppendChild(Field)；}Else If(i&gt；0){//行号单元格。InnerHTML=i；}Else if(j&gt；0){//列字母单元格。InnerHTML=Letter；}。</p><p>现在我们有一个由行和列组成的大型单元格网格。添加表达式计算器的时间到了。我们可以使用3个数组来实现一个复杂但主要有效的求值器-所有输入字段的数组(以获取其实际输入的值、数字或公式)，具有智能getter的数组，如果请求变量并且它链接到带有公式的输入字段，则调用eval()，以及每个字段最后输入的值的缓存：</p><p>Input=[]；//假设我们为上述循环中的每个字段输入了puts.ush(Field)data={}；//智能数据访问objectcache={}；//cache//重新计算所有fieldsconst calc=()=&gt；{inputs.map(field=&gt；{try{field.value=D[field.id]；}catch(E){/*Ignore*/}})；}；//我们还需要自定义字段初始化代码：field.onocus=()=&gt；{//当元素被聚焦时-将其计算值替换为其公式字段。value=cache[field.id]||&#34；&#34；；}；field.onblur=()=&gt；{//当元素失去焦点时-将公式放入缓存中，并重新计算所有内容cache[field.id]=field.value；calc()；}；//字段的Smart getter如果需要dconst get=()=&gt；{letvalue=cache[field.id]||&#34；&#34；；If(value.chat At(0)==&#34；=&#34；){//使用&#34；with&#34；hack：with(Data)return eval(value.substring(1))；}Else{//原样返回值，如果可能，转换为数字：return isNaN(parseFloat(Value))？Value：parseFloat(Value)；}}；//将智能getter添加到大小写变量的数据数组中：Object.fineProperty(data，field.id，{get})，Object.fineProperty(data，field.id.toLowerCase()，{get})。</p><p>现在电子表格应该可以工作了，例如，如果您将“42”放入A1，将“=A1+3”放入A2-当您将焦点从A2移开时，您应该会看到“45”。</p><p>嗯，它绝对不能取代真正的办公套间。但它很好地展示了极简主义和微小的代码。所有这些应用程序都是昙花一现的，如果你刷新页面，它们就会失去它们的状态，而且看起来数据URL没有办法保持它们的状态。但是，如果你不需要打开繁重的“真正的”办公应用程序来计算几个比特或起草一些快速便条，它们作为快速书签可能会很有帮助。作为额外的好处，所有这些小应用最终都尊重你的隐私，不会分享你的数据(也不要存储数据)。</p><p>因此，是的，与其说这是一个严肃的应用程序，不如说是一个玩笑，但我还是为这些小应用程序创建了一个repo，以防任何人想要使用它们或根据自己的需求进一步定制：http://github.com/zserge/awfice.。欢迎使用PRS和进一步改进！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://zserge.com/posts/awfice/">https://zserge.com/posts/awfice/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/套件/">#套件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/gt/">#gt</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1028065.html"><img src="http://img2.diglog.com/img/2020/10/thumb_d3334852ab33b71b938fd161c8bbc2e0.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1028065.html">240多个Android应用程序在显示断章取义的广告时被抓获</a></div><span class="my_story_list_date">2020-10-11 16:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1028019.html"><img src="http://img2.diglog.com/img/2020/10/thumb_c68fbc88cfdc4789b78dfe46b987f415.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1028019.html">创建使用更少资源的Slake应用程序</a></div><span class="my_story_list_date">2020-10-11 16:30</span></div><div class="col-sm"><div><a target="_blank" href="/story/1027942.html"><img src="http://img2.diglog.com/img/2020/10/thumb_0311ac3b4a64b83a31346579b885dd4a.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027942.html">Julia程序设计语言的不合理有效性</a></div><span class="my_story_list_date">2020-10-11 15:46</span></div><div class="col-sm"><div><a target="_blank" href="/story/1027900.html"><img src="http://img2.diglog.com/img/2020/10/thumb_a11989acc6f5528002f1596ca436c0d1.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027900.html">您的单页应用程序现在是多边形填充</a></div><span class="my_story_list_date">2020-10-8 15:43</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>