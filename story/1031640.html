<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>外部GPU和Raspberry PI计算模块4</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">外部GPU和Raspberry PI计算模块4</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-28 06:41:23</div><div class="page_narrow text-break page_content"><p>Raspberry PI计算模块4避开了内置的USB 3.0控制器，并提供了1x PCI Express通道。</p><p>稍微老一点的Raspberry Pi 4型号B可能会被黑进PCIe车道(在此过程中牺牲了VL805 USB 3.0控制器芯片)，但这是一个有点微妙的操作，只有少数胆大妄为的人尝试过。</p><p>观看此视频，了解更多关于我在CM4上使用这些GPU的体验：在Raspberry PI计算模块4上使用GPU！</p><p>既然CM4的IO板有一个1X插槽，那么插入任何PCI Express卡并用Raspberry PI测试它的功能就变得微不足道了。还有我的测试！我在我的Raspberry Pi PCIe设备兼容性数据库中详细介绍了我测试过的所有卡和结果，您可以查看相关问题以了解有关每张卡的更多信息。</p><p>PI&#39；的BCM2711 SoC包括一个VideoCore 6 GPU，能够实现H.265 4Kp60解码、H.264 1080p60解码和1080p30编码等功能。它还支持OpenGL ES 3.0，就其成本而言，它并不是一个糟糕的小GPU。</p><p>但是有很多人想知道你是否可以使用带有PI的NVIDIA或AMD GPU，我试着回答了这个问题。</p><p>部分原因是BCM2711 ARM SoC上缺乏对I/O条空间的支持，部分原因可能是驱动程序错误或仅在X86或某些ARM架构上支持的功能。</p><p>我尝试了以下驱动程序，但都未能以某种方式完全初始化卡：</p><p>新的开源驱动程序(您必须重新编译Raspberry PI OS内核才能启用它)。</p><p>RADEON开源驱动程序(您必须重新编译Raspberry PI OS内核才能启用它)。</p><p>AMDGPU开源驱动程序...。在尝试使用后，我发现它不适用于像我试过的那样旧的显卡！</p><p>仅仅是将硬件插入可能就是您的第一个挑战，因为许多(事实上，几乎所有)GPU的物理插槽都无法插入IO板的x1 PCIe插槽。您可以砍掉中间的位以使卡在物理上合适，这样就可以工作了，但幸运的是，x1到x16适配器允许将较大的卡插入x1插槽(尽管没有增加带宽通道)。</p><p>大多数卡在可用通道较少的情况下都工作得很好；它们只是不能在GPU和CPU之间获得足够的带宽。</p><p>在我运行lspci时，这两张卡都被正确识别，所以至少有一线希望：</p><p>#NVIDIA GeForce GT 71001：00.0VGA兼容控制器：NVIDIA Corporation GK208[GeForce GT710B](版本A1)(PROG-IF 00[VGA控制器])子系统：Zotac International(MCO)Ltd.GK208B[GeForce GT710]标志：600000000(32位，不可预取)[禁用][大小=16M]内存&lt；未分配&gt；(64位，可预取)[禁用]&lt；(64位，可预取)[禁用]I/O端口位于&lt；未分配&gt；(64位，可预取)[禁用]I/O端口位于&lt；未分配&gt；(64位，可预取)[禁用]I/O端口位于&lt；未分配&gt；(64位，可预取)[禁用]I/O端口位于&lt；未分配&gt；(64位，可预取)[禁用]I/O端口位于&lt；未分配&gt；[DISABLED][虚拟]601000000扩展只读存储器[DISABLED][SIZE=512K]功能：[60]电源管理版本3功能：[68]MSI：ENABLE-COUNT=1/1 MASKABLE-64BIT+功能：[78]Express旧式端点，MSI 00功能：[100]虚拟通道功能：[128]电源预算&lt；？&gt；功能：[600]供应商特定信息：ID=0001rev=1 LEN=024&lt；？&gt；#AMD RADEON 545001：00.0VGA兼容控制器：Advanced Micro Devices，Inc.。[AMD/ATI]CEDAR[RADEON HD5000/6000/7350/8350系列](PROG-IF 00[VGA控制器])子系统：VISIONTEK CEDAR[RADEON HD5000/6000/7350/8350系列]标志：快速设备，IRQ255内存&lt；未分配&gt；(64位，可预取)[已禁用]内存600000000(64位，不可预取)[已禁用][大小=128K]&lt；未分配&gt；I/O端口；[DISABLED][虚拟]600020000扩展只读存储器[DISABLED][SIZE=128K]功能：[50]电源管理版本3功能：[58]Express旧式端点，MSI00功能：[A0]MSI：ENABLE-COUNT=1/1 MASKABLE-64BIT+功能：[100]供应商特定信息：ID=0001rev=1 LEN=010&lt；？&gt；功能：[150]高级错误报告。</p><p>PCI Express设备需要BAR(基地址寄存器)空间才能初始化内存并将其映射到计算机自己的内存空间，PI目前为此为设备提供了64MB的RAM。</p><p>对于普通PI4中使用的VL805USB 3.0控制器这样的简单设备，以及NVMe驱动器和SATA适配器等设备来说，这都没问题。但是GPU需要更多的条形空间，所以经过一些研究，在PI论坛上的几位工程师的帮助下，我记录了将PI上的条形空间扩展到1 GB的过程。</p><p>NVIDIA GPU对只有256MB的RAM很满意，但AMD Radeon想要1 GB。这也意味着，当您想要将某些应用程序与PCIe设备配对时，最低端的1 GB计算模块4可能不足以满足这些应用程序的需要。</p><p>一旦我解决了条形图空间问题，并且dmesg显示所有的MEM空间都已正确分配(尽管IO空间没有正确分配，因为BCM2711没有任何用于PCIe设备的IO寄存器)，我就开始尝试我能找到的所有驱动程序：</p><p>Nvidia显卡的新开源驱动程序必须编译成一个自定义的PI内核--PI OS和Ubuntu for PI都没有默认的内核(以节省镜像中的空间)。一旦我编译了它，如果我插入了卡，PI在引导期间就完全锁定了。没有串行输出，什么都没有。</p><p>由于大量错误，NVIDIA ARM32驱动程序将无法编译内核模块；我不确定此驱动程序目前是否可以安装在任何ARM设备上。</p><p>NVIDIA ARM64驱动程序已编译并加载，但在卡初始化期间输出RmInitAdapter失败！我就是忘不了这一点。</p><p>**RADEON开源驱动**也需要编译，几乎初始化了板卡，但抱怨找不到PCI I/O BA。哦，好吧。</p><p>我想也许我仍然可以在NVIDIA卡上使用CUDA，即使GPU不能初始化并通过HDMI输出信号，也不能与Xorg一起工作。但是可惜的是，CUDA工具似乎需要卡以与图形位相同的方式初始化，所以我得到了相同的RmInitAdapter失败！Dmesg中的消息。</p><p>这也证明了710可能与CUDA 11不兼容，因为它没有在GPU兼容性页面上列出(即使705、720、730和720是)，即使它被宣传为有192个CUDA内核。啊好吧。</p><p>看起来最接近使用带有现成ARM主板的GPU的人是@sahajsarup，在这个96Boards的直播流中，他演示了通过96Boards Oxalis硬件通过HDMI获得控制台输出。不过，这块木板的价格超过了400美元，所以它的价格范围很难与覆盆子圆周率相提并论！</p><p>在计算模块4发布之前，有几个人破解了VL805芯片，并通过外部提升管对PCIe总线进行了布线，其中最著名的是@Domipheus，他走得和我一样远，似乎也撞到了墙上。</p><p>此外，正如特利姆提到的那样，看起来在ROCKPro64的土地上也有类似的麻烦：</p><p>我不认为NVIDIA卡可以在ROCKPro64上工作，这是因为显卡需要很大的IO内存范围。</p><p>由于TL Lim是Pine64的创始人，我想说他的观点是相当可靠的。</p><p>每次我发布一个失败或猜测的故事，马上就会有一些后续的建议，如果我都试过了……。嗯，我再也做不成别的事了。</p><p>但有几件事确实很突出，当我有时间的时候，我可能会试一试：</p><p>如果GPU没有通过PI&#39；自己的PCIe电路获得更多的电力，那么使用外部供电的Riser卡是否会有任何帮助。(我有一个Riser卡，但还没有电源适配器让它转起来)。</p><p>在树莓上试用Windows--我对它的效果不抱太高期望，但这至少是一个很好的借口，至少可以让它去兜风。</p><p>尝试查看是否有其他方法来解决IO栏空间限制。据我采访过的一些人说，他们已经让这些卡可以在其他ARM设备上使用，但他们总是对具体是哪种设备三缄其口(我猜可能是像AWS的Graviton这样的设备，他们可能不能详细讨论这一点？)。</p><p>测试稍新的卡，如AMD RADEON RX 550，它没有BIOS(使用UEFI)，但总体架构较新，由amdgpu驱动程序支持。</p><p>无论如何，这是一次相当大的冒险，最后，尽管我没有让GPU从PI输出视频信号，但我确实学到了很多关于PCIE、Linux内核和Raspberry PI计算模块4的知识。</p><p>请务必查看我的Raspberry PI Compute Module 4！上的视频GPU，以及我记录了所有使用CM4：Raspberry PI PCIe设备兼容性数据库进行测试的PCIe卡的网站。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.jeffgeerling.com/blog/2020/external-gpus-and-raspberry-pi-compute-module-4">https://www.jeffgeerling.com/blog/2020/external-gpus-and-raspberry-pi-compute-module-4</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/raspberry/">#raspberry</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/gpus/">#gpus</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pi/">#pi</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1031559.html"><img src="http://img2.diglog.com/img/2020/10/thumb_0bd6eed177f932bb7cac3ac128fa1f32.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031559.html">Raspberry PI计算模块4上的GPU</a></div><span class="my_story_list_date">2020-10-28 2:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031226.html"><img src="http://img2.diglog.com/img/2020/10/thumb_b5d0f1167a86fdbbb8945644fc4c54f6.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031226.html">用Caddy和SSH隧道让树莓PI上线</a></div><span class="my_story_list_date">2020-10-26 21:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030782.html"><img src="http://img2.diglog.com/img/2020/10/thumb_bcb3841209fad2020316acfcfd1c2494.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030782.html">国产树莓PI立式书桌控制器</a></div><span class="my_story_list_date">2020-10-24 3:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1008709.html"><img src="http://img.diglog.com/img/2020/6/thumb_3b429968b20266908b8a0355016e3ad9.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1008709.html">TwisterOS-Raspberry Pi-Win或OS X UI，并在ARM上运行x86应用程序(box86、DOSBOX)</a></div><span class="my_story_list_date">2020-6-28 18:25</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>