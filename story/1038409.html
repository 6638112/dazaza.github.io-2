<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>将ASR33电传打字机连接到ESP32 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">将ASR33电传打字机连接到ESP32 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-08 19:57:11</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/3c4bc2fd27a7f09fa971b5840a362f30.jpg"><img src="http://img2.diglog.com/img/2020/12/3c4bc2fd27a7f09fa971b5840a362f30.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>如您所知，我现在可以使用ASR33电传打字机（有关恢复说明，请参见此处）。即使还有很多事情要做，值得注意的是，我还是决定现在该做点什么了。</p><p> 获得电传打字机并使其正常工作只是纯粹的怀旧之情，而我实际上并没有考虑过要用它做些甚至有用的事情，更不用说乐趣了。但是我做了一些假设。</p><p> 一个想法是一个简单的linux终端，因此将电传打字机连接到Raspberry Pi。</p><p>    在内部，计算机组件通常使用二进制1和0来工作，它们表示为相对于＆＃34;地＆＃34;的电压。因此，通常0V为0，工作电压为1，例如5V或3.3V。一些现代芯片在不同的地方使用各种不同的电压，但是原理是相同的。</p><p> 我确定大家都听过这首歌，不是吗？无论如何，当我长大时，选择的串行接口是RS232。因此，您需要一种将内部设备连接到RS232的方法。这涉及驱动器芯片。</p><p> RS232实际上使用+ 12V或-12V的电压（相对于地面），尽管现代型号使用+ 5V和-5V甚至更低。原始规范允许相当宽的电压范围有效。</p><p> 将Raspberry Pi之类的东西连接到RS232只需涉及获得合适的USB适配器。简单。 </p><p>但是，电传打字机使用的旧标准称为20mA电流环路。它使用一对导线（-和+）代替接地和电压，它们产生20mA或什么都不代表二进制值。这样做的好处是，无论电缆有多长，如果在一端插入20mA电流，在另一端输出20mA电流。这就是电流的工作方式。这确实意味着长电缆在开始时需要相当高的电压（长电缆上的电压确实会随着距离的下降而下降），但是如果您可以施加必要的电压来馈入20mA的电流，则您知道远端正在获得20mA的信号并且信号正在通过。</p><p> 遗憾的是，似乎很难找到一个简单的USB 20mA电流环路接口，但是可以从20mA电流环路获得RS232适配器。</p><p>  不幸的是，这并不容易。首先，接口盒（超过100英镑）需要电源，所以我需要为它提供某种DC插头顶部电源。这是将20mA电流发送给电传打字机。</p><p> 但是，更糟糕的是，电传打字机始终不会发送20mA电流。它希望您提供一个20mA的电流源，可以通过它开关。开启和关闭。因此，对于电传打字机，我需要第二个20mA恒定电流供应，以便它可以向适配器提供20mA的电流，然后将适配器转换为RS232，然后我通过USB将其提供给Raspberry Pi。</p><p>   现在，我玩过ESP芯片，另一种想法是连接到ESP32，以连接电传打字机WiFi，从而提供更大的灵活性。</p><p> 我在这里使用的技术相距约55年。电传打字机使用的是1963年版本的ASCII字轮，它的日期可能在1965年之前，因为1965年的字轮带有下划线而不是箭头。 ESP32于去年问世。是的，相隔55年，是的，和我一样大，这太可怕了！</p><p>  我的意思是，这真的是旧技术，而另一方面是新技术。 55年前什至没有使用3.3V的东西，从我所见，甚至没有使用5V TTL。 </p><p>我碰巧躺在一个100Ω的电阻器上，花费几便士。是的，我可以在RS232至20mA适配器上花费超过100英镑，在USB RS232上花费更多，并为两个电源花费更多，或者我可以使用它，就是这样。真的，仅此而已。</p><p>   电传打字机的输入只需要20mA即可，ESP32仅产生3.3V无关紧要。通过馈入一个100Ω电阻，我测得2.2V的压降为22mA，这很好。打印机将其输入到晶体管（Q1）中，该晶体管（Q1）驱动另一个功率晶体管，该功率晶体管将功率切换到螺线管，螺线管驱动选择器，该选择器以机械方式将数据计时输出到打印（和打孔）机构。</p><p> 因此事实证明，ESP32上的3.3V输出GPIO引脚到20mA电流环路实际上只需要一个3p100Ω电阻即可，这真是不可思议。</p><p> 因此，ESP32很高兴将其配置为110个波特率的8个数据位和2个停止位，并且可以正常工作。 （是的，ASR33从技术上讲是偶校验，但是实际上机器忽略了奇偶校验。如果您想在纸带打孔机上打印空间侵略者，您实际上想要干净的8位，因为我还没有看到奇偶校验空间侵略者。）</p><p>  答案实际上甚至更简单。我知道，怎么可能，但是确实如此。电传打字机设计用于＆＃34;切换＆＃34;一个20mA的电流源，这意味着在内部它只是一个电气触点，它通过分配器打开和关闭以发送串行数据。</p><p> 这就是键盘触点的样子。电线通过按键起作用的条以某种方式推出，并且它们以某种方式接触底部的条，或者不接触底部的条以发送数据位。</p><p>  这就是解决这些问题的方法。键盘上的每个触点都在外部，并依次连接，分别为一个起始位，8个数据位和一个停止位计时。键盘本身会为按下的键生成偶数奇偶校验。 </p><p>但是最终，只有两根电线像按钮一样工作，所以一根连接到GND，一根连接到配置了上拉的输入引脚，您已经将数据输入到ESP32！</p><p> 您确实必须连接到正确的引脚，否则最终会在ESP32引脚上施加80V左右的电压并释放出魔力，而您又不想这样做了，或者一遍又一遍！</p><p> ESP32的设置也相当方便，使它的输入反相，这在进行这样的接线时很有必要。您还需要告诉它一次给您一个字符，因为UART通常会更快得多，并且您希望一次获得几个字节。设置完成后，您可以轻松进行本地回显，然后在键入时将键入的键发回打印。</p><p>  我可以连接到背面的螺丝端子。然后，一切都很好，整洁了，我们有一个连接WiFi MQTT的ASR33电传打字机！</p><p>  ESP32通过WiFi连接到MQTT，我可以通过该命令发送原始的8位数据或轻度熟的文本（为了获得纸带甚至发送奇偶校验;将回车符添加到换行符;换行为72个字符;并为任何智能标记驴试图发送UTF-8表情符号来打印向上箭头）。它还允许将按键发送回原始（即，具有奇偶校验，但允许纸带中的所有8位）以及行缓冲（剥离奇偶校验）。所有在github中供您娱乐（在这里）。</p><p> 我还把一个Sonoff Basic（Tasmotizer）串联到主电源上，因此ESP32在要打印时可以通过MQTT自动打开和关闭电源。</p><p> 然后，我有一个简单的脚本来处理号码上的传入SMS，并通过MQTT发送到ASR33。工作请客！打印机开机，打印消息，然后关机。 </p><p>鉴于它只能打印大写字母，因此计划进行的又一个步骤是使它打印来自（即将成为前任）美国总统的推文。 似乎合适一些。 （更新：我做到了！在这里） </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.revk.uk/2020/12/connecting-asr33-teletype-to-esp32.html">https://www.revk.uk/2020/12/connecting-asr33-teletype-to-esp32.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/电传/">#电传</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/asr33/">#asr33</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/打印/">#打印</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>