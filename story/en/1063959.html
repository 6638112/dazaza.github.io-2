<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>WD1007V命令 WD1007V Commands</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">WD1007V Commands<br/>WD1007V命令 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-07 08:16:33</div><div class="page_narrow text-break page_content"><p>While researching material for a  previous article, I wanted to examine the only AT-compatible ESDI controller I have, a Western Digital WD1007V-SE2. My board was made in 1990, the firmware is from 1989, and the controller was likely introduced in 1988 judging by the copyright date on the PCB.</p><p>在研究前一篇文章的材料时，我想检查一个唯一兼容的ESDI控制器，我拥有西部数字WD1007V-SE2。我的董事会成立于1990年，固件是1989年，该控制员可能会在1988年由PCB上的版权日期判断。</p><p>  There is no real technical documentation for this controller. That is to say, the core chip, the WD42C22A ‘Venus’ is reasonably well documented, but the one thing this otherwise very capable chip does  not do is process AT task file commands. That’s all handled by a separate microcontroller/firmware.</p><p>  此控制器没有真正的技术文档。也就是说，核心芯片，WD42C22A'Venus'是合理的记录，但这否则这一点非常有能力的芯片不做的是任务文件命令的过程。这完全由单独的微控制器/固件处理。</p><p> Under normal circumstances, I would first try to probe the controller from the host side and see what commands it responds to, but without a functioning ESDI drive that is not an option, and finding a working ESDI drive for a sane price appears to be no longer possible. Reverse engineering it is, then.</p><p> 在正常情况下，我首先尝试从主机侧探测控制器，并查看它响应的命令，但没有功能的eSDI驱动器不是一个选项，并为智典价格找到工作的ESDI驱动器似乎是没有更长的可能。然后，逆向工程是。</p><p>  As luck would have it, this controller uses an Intel 80C188 SoC to run the firmware, and the actual code is on a standard EPROM chip. So I pulled the firmware chip out, popped it into my PROM reader, read out the contents, and loaded the resulting file into IDA.</p><p>  运气将具有它，该控制器使用Intel 80C188 SoC运行固件，并且实际代码位于标准EPROM芯片上。所以我将固件芯片拉出来，将其突破到我的舞会读取器中，读出内容，并将结果文件加载到IDA中。</p><p> The firmware is big enough but not huge (16KB PROM, not full), so it didn’t take me long to identify the dispatch table (actually two) that handles commands. I hesitate to say ATA commands, since this is obviously not an IDE controller, but the register and command interface is extremely similar to ATA.</p><p> 固件足够大但不是巨大的（16KB舞会，不满），所以它不需要我才能识别处理命令的调度表（实际上是两个）。我犹豫地说ATA命令，因为这显然不是IDE控制器，但寄存器和命令界面非常类似于ATA。</p><p>   The command names above are the same as the ATA specification where applicable. Some of these commands warrant a closer look.</p><p>   上面的命令名称与适用的ATA规范相同。其中一些命令保证仔细看看。</p><p> SET FEATURES — the Feature Register must contain AAh or 55h; in response, the command enables or disables read-ahead, respectively. Other values cause the command to fail.</p><p> 设置功能 - 功能寄存器必须包含AAH或55H;在响应中，命令分别启用或禁用重新提升。其他值导致命令失败。 </p><p> SET MULTIPLE MODE — if the value in Sector Count Register is zero, READ/WRITE MULTIPLE is disabled. Values from 1 to 14 enable READ/WRITE MULTIPLE. Other values cause SET MULTIPLE MODE to fail; while ATA specifies that this disables READ/WRITE MULTIPLE, the WD1007V does not change the multiple mode setting in this case.</p><p>设置多个模式 - 如果扇区计数寄存器中的值为零，则禁用读/写多倍。值1到14启用读/写多个。其他值原因设置多个模式失败;虽然ATA指定此禁用读/写多倍，但在这种情况下，WD1007V不会更改多模式设置。</p><p> ESDI COMMAND — this is obviously not an ATA command; in fact ATA says that the E0h command code is used for STANDBY IMMEDIATE. This command is used to send a 16-bit command to the attached ESDI drive and get a 16-bit response back. The WD1007V BIOS uses this command quite a bit. The Cylinder Low/High registers are used for input and output, but with byte swapping (the low byte of the 16-bit command word/result is in Cylinder High Register). At least some SMS OMTI ESDI controllers also supported this command.</p><p> eSDI命令 - 这显然不是ATA命令;实际上ATA说，E0H命令代码用于待机状态。此命令用于向连接的ESDI驱动器发送16位命令并获得16位响应。 WD1007V BIOS使用此命令非常一点。汽缸低/高寄存器用于输入和输出，但具有字节交换（16位命令字/结果的低字节是圆柱高寄存器）。至少一些SMS OMTI ESDI控制器也支持此命令。</p><p> A0h, ADh — these commands do not exist in ATA (the A0h command code was later used for the PACKET command designed for ATAPI devices). I don’t know what these commands do, but they do communicate with the drive. The A0h command is used by the WD1007V BIOS when formatting. These commands might be accessing some kind of a service cylinder on the drive.</p><p> A0H，ADH  -  ATA中不存在这些命令（A0H命令代码稍后用于为ATAPI设备设计的分组命令）。我不知道这些命令做了什么，但他们确实与驱动器进行通信。格式化时，WD1007V BIOS使用A0H命令。这些命令可能正在驱动器上访问某种服务圆柱。</p><p> IDENTIFY — this command returns a surprisingly large subset of what the first version of ATA defined. The first 10 words are simply what the ESDI drive itself returns through the REQUEST CONFIGURATION command. The serial number is all zeros, which is quite interesting—obviously the controller has no way to provide a drive serial number, yet bothers providing something that sort of looks like one. The firmware revision is ‘REV. A5’ and the model number ‘WD1007V’. The firmware also fills out the buffer type and size (32KB), ECC length (4 or 7 bytes, depending on a jumper setting), and the current MULTIPLE MODE setting.</p><p> 识别 - 此命令返回一个令人惊讶的大小的ATA定义版本的子集。前10个单词只是ESDI驱动器本身通过Request Configuration命令返回的内容。序列号是所有零，它们非常有趣 - 显然控制器无法提供驱动程序序列号，但困扰提供一种如此如上所述的东西。固件修订版是'Rev。 A5'和型号'WD1007V'。固件还填充缓冲类型和大小（32KB），ECC长度（4或7个字节，根据跳线设置），以及当前多模式设置。</p><p> The very last word of the IDENTIFY buffer is used to report the controller’s current jumper settings. I’m told this was initially a debug-only feature inadvertently left enabled in a late night build, discovered by Compaq, and requested as a permanent feature.</p><p> 识别缓冲区的最后一个单词用于报告控制器的当前跳线设置。我被告知这是最初在康复发现的深夜构建中无意中留下的调试 - 唯一的功能，并要求作为永久性功能。</p><p> All in all, the WD1007V firmware is largely ATA command set compatible, and includes several enhancements to the basic AT disk command set: IDENTIFY, READ/WRITE BUFFER, READ/WRITE MULTIPLE and SET MULTIPLE, as well as the SET FEATURES command to enable/disable read-ahead.</p><p> 总而言之，WD1007V固件主要是ATA命令集兼容，并包括磁盘命令集的基本增强功能：识别，读/写缓冲区，读/写多倍并设置多个，以及集合要启用/禁用预读。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.os2museum.com/wp/wd1007v-commands/">https://www.os2museum.com/wp/wd1007v-commands/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/wd1007v/">#wd1007v</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/命令/">#命令</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>