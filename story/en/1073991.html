<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>微控制器改进型麦克风Microcontroller-Modified Microphone</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Microcontroller-Modified Microphone<br/>微控制器改进型麦克风</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-19 02:09:37</div><div class="page_narrow text-break page_content"><p>I&#39;ve owned a  Blue Yeti microphone for a little over five years, now. It&#39;s a pretty decent microphone for video calls, and I really like that it has its own audio interface for (pass-through) earphones, and a dedicated hardware mute feature. I&#39;ve used it on probably 1500 calls, with only one complaint: the mute button makes noise.</p><p>我&#39；我拥有一个蓝色雪人话筒已有五年多了。它&#39；它是一款相当不错的视频通话话筒，我非常喜欢它有自己的（直通式）耳机音频接口，以及专用的硬件静音功能。我&#39；我在大约1500次通话中使用了它，但只有一个问题：静音按钮会发出噪音。</p><p> For most of that five years, my colleagues could usually tell when I wanted into the conversation because the mute button has a satisfying ka-chunk tactile feedback that—unfortunately—transfers vibration into the thing to which it is attached, and that thing is a highly-sensitive vibration transducing machine… a microphone!</p><p>在那五年的大部分时间里，我的同事通常都能告诉我什么时候想加入对话，因为静音按钮有一个令人满意的触觉反馈，不幸的是，它将振动传递到它所连接的东西上，而这个东西是一个高度敏感的振动传感器……一个麦克风！</p><p> The ka-chunk noise has bothered me for years. Not so much for the signifier that I&#39;m about to speak, but that I couldn&#39;t unmute myself without people  expecting me to speak. Plus, it&#39;s kind of fundamentally annoying to me that a microphone has a button that makes noise.</p><p>这种噪音困扰了我好几年了。对于能指而言，我并没有那么多，我&#39；我正要发言，但我不能&#39；不要在没有人期待我说话的情况下让自己哑口无言。另外，它&#39；It’麦克风上有个按钮会发出噪音，这让我有点恼火。</p><p> So, I set out to fix this. I&#39;ve been playing with these  ESP32 microcontrollers from Espressif. These inexpensive chips (and development boards) are full of features and are way overpowered compared to the first-generation Arduinos I was  playing with 15 years ago. They have WiFi and Bluetooth built in, come with enough RAM to do some basic stuff (and off-chip serial-bus-accessible RAM for more intensive work), and are easy to program (both from a software and hardware standpoint).</p><p>所以，我开始着手解决这个问题。我&#39；我一直在玩Espressif的这些ESP32微控制器。这些价格低廉的芯片（和开发板）功能齐全，与15年前我使用的第一代Arduinos相比，它们的性能非常强大。它们内置WiFi和蓝牙，有足够的RAM来做一些基本的事情（以及片外串行总线可访问的RAM，用于更密集的工作），并且易于编程（从软件和硬件的角度来看）。</p><p> One of the cool built-in features of the ESP32 is a  capacitive touch sensor. There are actually several of these sensors on board, and they&#39;re often used to sense touch for emulating buttons… silent buttons. You can see where I&#39;m going with this.</p><p>ESP32酷炫的内置功能之一是电容式触摸传感器。实际上船上有几个这样的传感器，它们&#39；我们经常用来感知触摸来模拟按钮…无声按钮。你可以看到我&#39；我同意这个。</p><p> I laid out a test circuit on a breadboard, and wrote a little bit of firmware (including some rudimentary debouncing) using the Arduino framework, then tested:</p><p>我在试验板上布置了一个测试电路，并使用Arduino框架编写了一点固件（包括一些基本的去抖动），然后进行了测试：</p><p>  (This is on a ESP32 WROOM development board that&#39;s not ideal for some of my other projects, where I prefer the WROVER for the extra RAM, but is ideal—if not serious overkill—for this project.)</p><p>（这是在一个ESP32 WROOM开发板上，对于我的其他一些项目来说并不理想，我更喜欢WROVER作为额外的RAM，但对于这个项目来说，如果不是严重的过度开发，也是理想的。）</p><p> Not bad. But now I had to do the hard part: figure out how the microphone handles that button press. I looked around the Internet a little for someone who&#39;d already done something similar, and I found some  teardown videos, but  couldn&#39;t track down a schematic.</p><p>不错。但现在我必须做最难的部分：弄清楚麦克风是如何处理按键的。我在网上找了一个&#39；我已经做了类似的事情，我找到了一些撕下的视频，但无法&#39；I don’我找不到示意图。</p><p> I took the microphone apart, dug into the Yeti&#39;s board, and found the button. It was a bit more complicated than I&#39;d imagined, mostly because the button is both illuminated (the built-in and light-piped LED will flash when muted, and will be lit solidly when unmuted), and mode-less (it&#39;s a momentary button). With some creative probing with a volt-meter and some less-than-ideal hotwiring of the +5V/GND provided by the USB interface, I tracked the button press down to a single pin on the switch, which was sunk low when the button is pressed. I soldered on a wire to use with my project:</p><p>我把麦克风拆开，把雪人挖了进去；s板，找到了按钮。这比我&#39；d想象中的情况，主要是因为该按钮既亮起（内置和光管LED在静音时闪烁，在取消静音时亮起），又无模式（它是一个瞬时按钮）。通过电压表和USB接口提供的+5V/GND的一些不太理想的热接线进行一些创造性的探索，我跟踪按钮按下到开关上的一个针脚，当按下按钮时，该针脚降低。我焊接在一根电线上，用于我的项目：</p><p>  I also soldered on a way-too-big barrel connector to tap into the USB interface&#39;s +5V and Ground lines. (Use what you have on-hand, right? Try not to get the connector genders backwards like I did… and also maybe solder better than me.)</p><p>我还焊接了一个太大的桶形连接器，无法接入USB接口#39；s+5V和接地线。（用你手头的东西，对吗？尽量不要像我那样把连接器的性别向后拉……而且可能比我焊接得更好。）</p><p>  My code would need to be modified to simulate this button &#34;press&#34;. In addition to the debouncing, I&#39;d have to pretend to press and release the button, and also instead of providing +5 volts to an output pin (the normal way to signal something like this), I&#39;d actually have to sink the 5V to ground. Here&#39;s the (Arduino framework) code I ended up with (including some Serial debuggery):</p><p>我的代码需要修改以模拟这个按钮&#34；按&#34；。除此之外，我&#39；d必须假装按下并松开按钮，也不是向输出引脚提供+5伏电压（发出类似信号的正常方式），而是I&#39；实际上，我必须把5V电压降到地上。这里&#39；这是我最终得到的（Arduino框架）代码（包括一些串行调试）：</p><p> #include  &lt;Arduino.h&gt;  #define TOUCH_PIN 4 #define LED_PIN 2 #define EXT_LED_PIN 15 #define PULSE_DELAY 500 unsigned  int  threshold  =  20 ; // the last time the output pin was toggled: unsigned  long  lastDebounceTime  =  0 ; // the debounce time unsigned  long  debounceDelay  =  500 ; unsigned  long  pulseStartTime  =  0 ; bool  toggledLow  =  false ; void  gotTouch ()  {  if  ( millis ()  &lt;  ( lastDebounceTime  +  debounceDelay ))  {  return ;  }  lastDebounceTime  =  millis ();  Serial . println ( &#34;Touched.&#34; );  // pulse the button  digitalWrite ( LED_PIN ,  LOW );  digitalWrite ( EXT_LED_PIN ,  LOW );  Serial . println ( &#34;(low)&#34; );  pulseStartTime  =  millis ();  toggledLow  =  true ; } void  setup ()  {  Serial . begin ( 9600 );  delay ( 100 );  Serial . println ( &#34;Started.&#34; );  pinMode ( LED_PIN ,  OUTPUT );  pinMode ( EXT_LED_PIN ,  OUTPUT );  digitalWrite ( LED_PIN ,  HIGH );  digitalWrite ( EXT_LED_PIN ,  HIGH );  touchAttachInterrupt ( T0 ,  gotTouch ,  threshold ); } void  loop ()  {  // Touch0, T0, is on GPIO4  Serial . println ( touchRead ( T0 ));  // get value using T0  Serial . println ( &#34;&#34; );  delay ( 100 );  if  ( toggledLow  &amp;&amp;  ( millis ()  &gt;  ( pulseStartTime  +  PULSE_DELAY )))  {  digitalWrite ( LED_PIN ,  HIGH );  digitalWrite ( EXT_LED_PIN ,  HIGH );  toggledLow  =  false ;  Serial . println ( &#34;(high)&#34; );  } }</p><p>#包括&lt；阿杜伊诺。h&gt#定义触摸屏引脚4#定义LED引脚2#定义外部LED引脚15#定义脉冲延迟500无符号整数阈值=20；//上次切换输出引脚的时间：unsigned long lastDebounceTime=0；//去盎司时间无符号长去盎司延迟=500；无符号长脉冲起始时间=0；bool-toggledLow=false；void gotTouch（）{if（millis（）&lt；（lastDebounceTime+debounceDelay））{return；}lastDebounceTime=millis（）；电视连续剧println（&#34；触摸。&#34；）//脉冲数字写入按钮（LED_引脚，低电平）；digitalWrite（外部LED引脚，低电平）；电视连续剧println（&#34；（低）&#34；）；脉冲起始时间=毫秒（）；toggledLow=true；}void setup（）{Serial.begin（9600）；delay（100）；Serial.println（&#34；start.&#34；）；引脚模式（LED_引脚，输出）；引脚模式（外部LED引脚，输出）；数码写入（LED_引脚，高）；数码写入（外部LED引脚，高电平）；touchAttachInterrupt（T0，gotTouch，阈值）；}void loop（）{//Touch0，T0位于GPIO4 Serial.println（touchRead（T0））//使用T0 Serial.println（&#34；&#34；）获取值；延迟（100）；如果；（pulseStartTime+PULSE_DELAY））{digitalWrite（LED_引脚，高）；digitalWrite（EXT_LED_引脚，高）；toggledLow=false；Serial.println（&#34；（高）&#34；）}</p><p> Please at least attempt to refrain from making fun of my weak C++ skills… but this seems to be surprisingly stable code in practice.</p><p>请至少试着避免嘲笑我的弱C++技能……但是这在实践中似乎是惊人的稳定代码。</p><p> Now, I&#39;d need to attach the ESP32 dev board, and reassemble the microphone part-way. The case of the Yeti is cast aluminum (or another softish metal, but I assume aluminum). This means that I could maybe—hopefully—use the case of the the Yeti itself as the touch sensor. I rigged up a sensor wire to loosely connect to the mounting hole (which gets a thumb-screwed bolt, and will, by force, make a good connection to the case), since it&#39;s a huge pain (at best) to solder to aluminum:</p><p>现在，我&#39；d需要连接ESP32开发板，并部分重新组装麦克风。雪人的情况是铸铝（或另一种软金属，但我假设是铝）。这意味着我可能有希望使用雪人本身作为触摸传感器。我装配了一根传感器线，将其松散地连接到安装孔上（安装孔上有一个用拇指拧紧的螺栓，通过用力将其与外壳进行良好连接），因为它&#39；这是一个巨大的痛苦（最多）焊接到铝：</p><p>  Then, some bench testing before  really putting it back together: it works! (You can see the blinking light in the middle of the Yeti&#39;s board go solid and back to blinking when I touch the unassembled-but-connected case.)</p><p>然后，在重新组装之前进行一些台架测试：它很有效！（你可以看到雪地灯中部的闪烁光39，S板变硬，当我碰到未装配但连接的情况时，它会闪烁。）</p><p>  Great! Success! I managed to do that mostly in a single evening! I put the microphone back together, including putting the case-mounting bolts back in and… suddenly it no longer worked. I disassembled, hooked up the serial monitor via USB, and… well… it works! Maybe I just pinched a connection or shorted a pin or something. More Kapton tape! Reassembled, and… failed again. So I ran a cable through the volume knob hole and reassembled, and tested it in-situ. Weird. The capacitance numbers are all very low. In fact, the might be always just (very near)  0 plus some occasional noise. What?</p><p>太棒了成功我几乎在一个晚上就做到了！我把麦克风放回原处，包括把机箱安装螺栓放回原处，突然它就不工作了。我拆开，通过USB连接串行监视器，然后…好吧…它工作了！也许我只是掐了一个接头或是短路了一个针脚什么的。更多卡普顿录音带！重新组装，又失败了。所以我用一根电缆穿过音量旋钮孔，重新组装，并在现场进行测试。奇怪的电容值都很低。事实上，噪音可能总是（非常接近）0加上一些偶尔的噪音。什么</p><p> After a day or two of head-scratching, and then some measuring to confirm the hypothesis, I realized that when the bolts go into the case, the case gets connected to the chassis, and the chassis is grounded to the board, then through to the USB ground. So the case itself gets grounded. And that&#39;s  bad for a floating capacitance sensor. Turns out it  didn&#39;t work after all.</p><p>经过一两天的挠头，然后进行一些测量以确认假设，我意识到当螺栓进入机箱时，机箱连接到机箱，机箱接地到电路板，然后通过USB接地。所以这个案子本身就被搁置了。那&#39；这对浮动电容传感器不利。结果它没有&#39；我根本不工作。</p><p>  This led to experimentation with some insulating enamel paint for transformers, and me certainly burning through a few too many brain cells with the fumes from said paint. I gave up on isolating the case from ground (which is probably good, anyway, all things considered), and made a little touch pad out of some aluminum ducting tape, some solderable copper tape, and a chunk of cardboard, that I happened to have on hand (back to  using what you have here).</p><p>这导致了一些变压器用绝缘瓷漆的实验，我当然用这些漆产生的烟雾烧穿了太多的脑细胞。我放弃了将外壳与地面隔离（不管怎样，从各方面考虑，这可能都是好的），并用一些铝导管胶带、一些可焊接铜带和一块硬纸板制作了一个小触摸板，碰巧我手头有这些（回到使用你们这里的东西）。</p><p>   As you can see in the video, I also added a little toggle switch to the back of the microphone that could allow me to completely detach the switching line from the microphone, just in case my hack started to fail, and I was on an important call—the stock mute button still works, of course. But, I&#39;m happy to report that it&#39;s been nothing but stable for the past few weeks—it didn&#39;t even overflow the  millis() checks, somehow, which still surprises me—and I use the new ka-chunk-free touch-to-mute-unmute feature of my microphone every day.</p><p>正如你在视频中看到的，我还在麦克风背面添加了一个小拨动开关，可以让我完全从麦克风上断开开关线，以防我的黑客攻击开始失败，我正在接一个重要的电话。当然，stock mute按钮仍然有效。但是，我&#39；我很高兴地告诉大家&#39；在过去的几周里，情况一直很稳定；我甚至没有溢出millis（）的检查，这仍然让我感到惊讶，我每天都使用新的ka chunk free touch使麦克风静音。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/改进型/">#改进型</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/modified/">#modified</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/按钮/">#按钮</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>