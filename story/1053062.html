<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>每秒亿次在毫秒延迟的事件：Giga-Scale的Nexmark </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">每秒亿次在毫秒延迟的事件：Giga-Scale的Nexmark </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-18 03:36:06</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/3/95e30af2803e1b62dc04dbd82ab78efe.jpg"><img src="http://img2.diglog.com/img/2021/3/95e30af2803e1b62dc04dbd82ab78efe.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>我们＆＃39;重新在Hazelcast Jet上准备一个科学纸，基于对称，数据本地非阻塞分布式处理，描述了其架构。作为这项努力的一部分，我们实施了Vendor-Neutral NexmarkbenchmarkMarkmarkMarkmark套件，该套件包括8个流询问，该查询旨在刺激ickutypical＆＃39;重新询问您的真实时间。</p><p> 查询处理拍卖，卖方和出价的域模型。 forexample，查询5要求：＆＃34;哪些拍卖已经达到了最高的Price，最后一个时期？＆＃34;</p><p> 与我们以前的基准相比，这主要集中在单个联线葡萄项（特别是GC引起的延迟尖峰）上，这次我们侧重于水平可扩展性：Jet＆＃39;延迟和吞吐量的行为如何添加越来越多的节点？</p><p> 在45个节点和720个VCPU的集群中，喷气机达到每秒1亿甚至26毫秒的99％延迟。</p><p>    在我们以前的经历中，我们不需要任何低级GC调整参数来获得JVM的杰出结果，但您必须使用最近的JDK。我们让JVM使用其默认的G1收集器并使用所需的暂停目标配置。此外，请注意，我们的尺寸喷射器＆＃39; S线程池有点低于系统容量：16-VCPU机器上最多14个线程。 TheiMimportant技巧允许GC在背景中工作，使用Jet＆＃39;实时计算。</p><p> 至于测量方法，它与以前相同。事件Comefrom作为喷射在相同的JVM内存的发电机。每一个事件都有预定的发生时刻，它是发电机＆＃39;一旦时间到来，就尽快履行它。任何潜在境内介绍事件对报告的延迟计数。</p><p> 在输出方面，我们只需尽快停止延迟时钟，我们观察到与最新结果对应的SomeData项。我们将系统分级与查询结果理想的时刻进行比较。例如，如果查询涉及时间窗口，那么窗口＆＃34的那一刻;关闭＆＃34;，是理想的时刻。 </p><p>我们不要求Jet将结果发送到任何外部系统，因为我们希望我们的结果专注于喷气式飞机＆＃39;单独的性能。在Ghithmark中涵盖的代码可在GitHub上使用。</p><p>  对于第一个基准测试我们提出了这个问题：使用每秒50个结果更新的时间分辨率和100万赛量的输入速率，不同的簇大小的99.99％延迟是多少？</p><p> 该基准测试的主要部分是深入探测可能导致延迟尖峰的稀有SystemEvents，但是Nexmark查询的原始定义询问更低的更新频率（一旦Perminute一次）。此时，几乎足够的足球数据来报告第99百分位数，整整一周才需要100分钟，以获得99.99百分点。因此，我们每秒改变为50次（20毫秒的更新期）。</p><p> 必须每20毫秒报告另一套完整的结果（10,000个数据点），喷气机没有时间从任何HiccupGreater恢复超过几毫秒。出于此原因，我们将GCPAuse目标配置为5毫秒（-xx：maxgcpausemillis = 5）。</p><p> Nexmark NON＆＃39; t定义了临时涉及的不同键的数量，我们将其设置为10,000的基准。</p><p> 我们使用每个节点的12个喷射线程的设置，主要是因为那个＆＃39;我们在以前的基准中使用的swhat。我们得到了这些结果：</p><p>  最大的最坏情况是最大群集（20个节点）中的查询5，并出现为16毫秒。 </p><p>我们的第二个问题是：这是每秒达到十亿个事件的吞吐量需要多少的硬件，同时保持其实际级别的延迟？</p><p> 为测试此测试，我们选择了似乎最棘手的Nexmark查询，似乎是基准1的结果。这是查询5，其中在20节点群集中显示99.99％的延迟16毫秒。</p><p> 从这次我们＆＃39; LL在输入方面为输入方产生了更大的压力，旨在获得最高的吞吐量，我们放宽了时间升级。我们每秒询问两个更新（每500milliSecs设置的新结果），因此必须将百分位数调整为99％，以使其实用。我们还放宽了GC时序，设置-XX：maxgcpausemillis = 50。</p><p> 我们从一个节点开始，找到最大的事件速率Jetcan跟上。 ＆＃34的定义;保持＆＃34;是在测试期间偏向的延迟界限，并不断增加。在增加群集尺寸时被宣布了这个过程，直到达到了十亿美元的OURGOAL。这是我们发现的：</p><p>  首先，喷气机能够在Asingle节点上处理每秒2500万场比赛，甚至更令人印象深刻地，这一数字保持缩放线性，一直到我们的目标，它以40节的大小达到。</p><p> 在此过程中，我们意识到我们可以让喷气喷射使用更多的线程毫无影响延迟，并且由于我们想要尽量减少EC2Stances的数量，我们让它使用14个线程。这仍然将2个VCPUS留给赫卡地GC工作等系统需求。如果仔细看，You·You an看到图表中的曲线在20-nodemark上略微向上弯曲，这是使用每节点的8.6％的线程（14与12）使用8.6％的线程拍摄的40节点测量的工件（14 vs.12）。</p><p> 最大吞吐量的标准只是跟上输入，允许延迟暂时达到更高的值，只要itsettles返回。为了衡量喷射器＆＃39;在各种群体的各种级别的稳定延迟下，我们在每个簇大小的最大概率的80％下进行了另一轮测试。这给了我们以下latencyChart： </p><p>我们可以看到，虽然它的增加，延迟保持较平坦的尺寸范围远远超过了你在现实生活中的射流射流。  最后，我们从安装程序开始，支持十亿个事件持续（40节点）并继续添加节点，直到我们得到稳定的低级性。 这是我们的结果：45个节点，26毫秒。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://jet-start.sh/blog/2021/03/17/billion-events-per-second">https://jet-start.sh/blog/2021/03/17/billion-events-per-second</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/事件/">#事件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/events/">#events</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/延迟/">#延迟</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1052886.html"><img src="http://img2.diglog.com/img/2021/3/thumb_f7f07b73f9e0eee5cc27ee4decb95e19.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1052886.html">Twitter黑客背后的青少年'mastermind'被判处三年的监狱 </a></div><span class="my_story_list_date">2021-3-17 8:3</span></div><div class="col-sm"><div><a target="_blank" href="/story/1052596.html"><img src="http://img2.diglog.com/img/2021/3/thumb_0a8bd0437f81d04d698969277eb64997.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1052596.html">github行动退化了 </a></div><span class="my_story_list_date">2021-3-16 6:18</span></div><div class="col-sm"><div><a target="_blank" href="/story/1052067.html"><img src="http://img2.diglog.com/img/2021/3/thumb_8c72e9bf7229efd12ebfd90fde1a94fc.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1052067.html">安全事件损失了华盛顿人的个人信息 </a></div><span class="my_story_list_date">2021-3-13 4:34</span></div><div class="col-sm"><div><a target="_blank" href="/story/1051648.html"><img src="http://img2.diglog.com/img/2021/3/thumb_6f327457c187833544c1e879c92ce58f.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1051648.html">Oracle Cloud无法访问 </a></div><span class="my_story_list_date">2021-3-11 9:23</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>