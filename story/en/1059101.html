<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>卷曲那些有趣的IPv4地址 Curl those funny IPv4 addresses</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Curl those funny IPv4 addresses<br/>卷曲那些有趣的IPv4地址 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-19 22:17:34</div><div class="page_narrow text-break page_content"><p>Everyone knows that on most systems you can specify IPv4 addresses just 4 decimal numbers separated with periods (dots). Example:</p><p>每个人都知道，在大多数系统上，您可以指定IPv4地址只有4个十进制数，其中包含周期（点）。例子：</p><p>  Useful when you for example want to ping your local wifi router and similar. “ping 192.168.0.1”</p><p>  当您例如想要ping本地WiFi路由器和类似时有用。 “ping 192.168.0.1”</p><p>  The IPv4 string is usually parsed by the   inet_addr() function or at times it is passed straight into the name resolver function like  getaddrinfo().</p><p>  IPv4字符串通常由INET_ADDR（）函数解析，或者有时它将其直接传递给GetAddrinfo（）等名称解析器函数。</p><p> This address parser supports more ways to specify the address. You can for example specify each number using either octal or hexadecimal.</p><p> 此地址解析器支持更多方法来指定地址。您可以例如使用八进制或十六进制指定每个数字。</p><p>       An IPv4 address is a 32 bit number that when written as 4 separate numbers are split in 4 parts with 8 bits represented in each number. Each separate number in “a.b.c.d” is 8 bits that combined make up the whole 32 bits. Sometimes the four parts are called quads.</p><p>       IPv4地址是32位编号，当写入4个单独的数字时，在4个部分中拆分，每个数字中表示8位。 “a.b.c.d”中的每个单独编号是8位，组合整个32位。有时四个部分被称为四边形。</p><p> The typical IPv4 address parser however handles more ways than just the 4-way split. It can also deal with the address when specified as one, two or three numbers (separated with dots unless its just one).</p><p> 但是，典型的IPv4地址解析器处理了比仅仅4路分裂更多的方式。当指定为一个，两个或三个数字时，它也可以处理地址（除非仅为一点）。</p><p> If given as a single number, it treats it as a single unsigned 32 bit number. The top-most eight bits stores what we “normally” with write as the first number and so on. The address shown above, if we keep it as hexadecimal would then become:</p><p> 如果作为单个号码给出，它将其视为单个无符号32位数。最顶层八位的八位存储我们“通常”的写入作为第一个数字等。如上所示的地址，如果我们将其保留为十六进制将成为： </p><p>       If you instead write the IP address as two numbers with a dot in between, the first number is assumed to be 8 bits and the next one a 24 bit one. And you can keep on mixing the bases as you see like. The same address again, now in a hexadecimal + octal combo:</p><p>如果您在介于两者之间将IP地址写入两个数字，则假设第一个数字为8位，下一个数字为24位。当您看起来像你看，你可以继续混合基地。同样的地址再次，现在在十六进制+八进制组合中：</p><p>  This allows for some fun shortcuts when the 24 bit number contains a lot of zeroes. Like you can shorten “ 127.0.0.1” to just “ 127.1” and it still works and is perfectly legal.</p><p>  当24位数包含很多零时，这允许一些有趣的快捷方式。就像你可以缩短“127.0.0.1”到“127.1”，它仍然有效，是完全合法的。</p><p>  Now the parts are supposed to be split up in bits like this: 8.8.16. Here’s the example address again in octal, hex and decimal:</p><p>  现在，这些部件应该以这样的比例分成：8.8.16。这是八进制，十六进制和十进制中再次的示例地址：</p><p>   All of these versions shown above work with most tools that accept IPv4 addresses and sometimes you can bypass filters and protection systems by switching to another format so that you don’t match the filters. It has previously caused problems in  node and  perl packages and I’m guessing numerous others. It’s a feature that is often forgotten, ignored or just not known.</p><p>   如上所述的所有这些版本都使用大多数工具接受IPv4地址，有时您可以通过切换到另一种格式来绕过滤波器和保护系统，以便您不匹配过滤器。它以前在节点和Perl包中造成了问题，我猜测了许多其他人。这是一个经常忘记，忽略或刚知的功能。</p><p> It begs the question  why this very liberal support was once added and allowed but I’ve not been able to figure that out – maybe because of how it matches  class A/B/C networks. The support for this syntax seems to have been  introduced with the inet_aton() function in the  4.2BSD release in 1983.</p><p> 它乞求为什么这个非常自由主义的支持曾被添加和允许的原因，但我无法弄清楚 - 也许是因为它如何与A / B / C网络匹配。对此语法的支持似乎已在1983年的4.2BSD发布中引入INEt_Aton（）函数。</p><p>  URLs have a host name in them and it can be specified as an IPv4 address.</p><p>  URL中有一个主机名，可以指定为IPv4地址。</p><p>  The  RFC 3986 URL specification’s section 3.2.2 says an IPv4 address must be specified as:</p><p>  RFC 3986 URL规范的第3.2.2节表示IPv4地址必须指定为： </p><p>  … but in reality very few clients that accept such URLs actually restrict the addresses to that format. I believe mostly because many programs will pass on the host name to a name resolving function that itself will handle the other formats.</p><p>...但实际上，很少有人接受此类URL的客户实际上将地址限制为该格式。我相信主要是因为许多程序将在主机名上传递给名称解析功能，本身将处理其他格式。</p><p>  The  Host Parsing section of this spec allows the many variations of IPv4 addresses. (If you’re anything like me, you might need to read that spec section about three times or so before that’s clear).</p><p>  本规范的主机解析部分允许IPv4地址的许多变体。 （如果您与我一样，您可能需要在明确之前读取该规范部分左右三次左右）。</p><p> Since the browsers all obey to this spec there’s no surprise that browsers thus all allow this kind of IP numbers in URLs they handle.</p><p> 由于浏览器所有遵循此规范，因此浏览器因此允许所有允许这种IP号码在他们处理的URL中。</p><p>  curl has traditionally been in the camp that mostly accidentally somewhat supported the “flexible” IPv4 address formats. It did this because if you built curl to use the system resolver functions (which it does by default) those system functions will handle these formats for curl. If curl was built to use c-ares (which is one of curl’s optional name resolver backends), using such address formats just made the transfer fail.</p><p>  传统上卷曲在营地中，主要是意外地支持的“灵活”IPv4地址格式。它做到了这一点，因为如果你建立了使用系统解析器函数（默认情况下的卷曲），那么这些系统功能将处理这些格式的卷曲。如果建立卷曲以使用C-ARES（这是卷曲的可选名称解析程序后端之一），则使用此类地址格式刚刚使传输失败。</p><p> The drawback with allowing the system resolver functions to deal with the formats is that curl itself then works with the original formatted host name so things like HTTPS server certificate verification and sending  Host: headers in HTTP don’t really work the way you’d want.</p><p> 缺点允许系统解析器函数来处理格式的卷曲是卷曲本身与原始格式的主机名一起工作，因此HTTPS服务器证书验证和发送主机如HTTP中的标题并不真正正常工作。</p><p>  Starting in curl 7.77.0 (since  this commit ) curl will “natively” understand these IPv4 formats and normalize them itself.</p><p>  从卷曲7.77.0开始（由于此提交）卷曲将“本身”了解这些IPv4格式并将其归一化其本身。</p><p>     16843009 gets normalized to 1.1.1.1 which then gets used as  http://1.1.1.1 (because curl will assume HTTP for this URL when no scheme is used) which returns a 301 redirect over to  https://1.1.1.1/ which  -L makes curl follow…</p><p>     16843009将标准化为1.1.1.1，然后将其用作http://1.1.1（因为在使用方案时卷曲将假定此URL），其中返回301重定向到https://1.1.1.1/ -l让卷曲跟随...... </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://daniel.haxx.se/blog/2021/04/19/curl-those-funny-ipv4-addresses/">https://daniel.haxx.se/blog/2021/04/19/curl-those-funny-ipv4-addresses/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ipv4/">#ipv4</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/funny/">#funny</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/卷曲/">#卷曲</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>