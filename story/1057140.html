<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在FreeBSD监狱运行Bhyve  - 从森林里面的景色（2020年） </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">在FreeBSD监狱运行Bhyve  - 从森林里面的景色（2020年） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-09 04:11:43</div><div class="page_narrow text-break page_content"><p>我＆＃39; ll设置了一个致力于运行Bhyve VM的监狱，为监狱创作i＆＃39; lluse bastillebsd</p><p>     按照https://bastillebsd.org/getting-started/ i＆＃39; m使用zfs so / usr / local / etc / bastille / bastille.conf我必须编辑bastille.conf（此可能在引导前完成释放）。</p><p>   创建一组规则以允许在监控编辑/ etc / devfs.rules内运行bhyve，如果不存在，则会创建它。</p><p> [devfs_rules_bhyve_jail = 25]添加包括$ devfsrules_jailadd路径VMM Unideadd Path VMM / *无人机路径点击*无人驾驶道路MEM HOMDEAD DATH km y kmem honvideadd路径nmdm * hovideadd路径pci无与伦及的路径Io未取消联系方式</p><p>        test-bhyve {devfs_ruleset = 25; Enforce_statfs = 2; exec.clean; exec.consolelog = /var/log/bastille/test-bhyve_console.log; exec.start =＆＃39; / bin / sh / etc / rc＆＃39 ;; exc.stop =＆＃39; / bin / sh /etc/rc.shutdown&#39 ;; host.hostname = test-bhyve; mount.devfs; mount.fstab = / usr / local / bastille / jails / test-bhyve / fstab;路径= / usr / local / bastille / jails / test-bhyve / root; Securelevel = 2; allow.vmm; allow.raw_sockets; vnet; vnet.Interface = e0b_bastille0; exc.prestart + =＆＃34; jib addm bastille0 em0＆＃34 ;; exec.poststop + =＆＃34; jib destreatle bastille0＆＃34 ;;}〜</p><p>        PKG安装VM-BHYVESSYSRC VM_ENABLE =＆＃34;是＆＃34; mkdir / vmssysrc vm_dir =＆＃34; / vms＆＃34; / vms＆＃34; vm initcp / usr / local / share / emplice / vm-bhyve / * /vms/.templates / VM Switch Create PructionVM Switch添加公共vtnet0vm Iso https://download.freebsd.org/ftp/releases/iso-images/12.2/freebsd-12.2-release-amd64-12.2-release-amd64-bootonly.isovm create testvm install-f test freebsd-12.2 -Release-amd64-bootonly.iso</p><p> 默认情况下，VM-BHYVE VM有256MB，如果您需要更多，则需要托伦 </p><p>如果您将在VM上使用DHCP，则需要配置接口以使用SYNCDHCP。根据使用SyncdhCP的工作，但我们需要先重启VM。</p><p> 这为我提供了一个名为vnet0的界面，我可以通过监狱＆＃39; s rc.conf。出于某种原因，Syncdhcp Workbut在guest rc.conf中没有DHCP。</p><p>  我们需要掩盖将传递给访客的设备，以执行此操作我们需要将条目添加到/boot/loader.conf。首先让＆＃39; s确定theDevice，你可以使用</p><p> root @ test-bhyve：〜pciconf -lvsubclass = ethernetigb0 @ pci0：1：0：0：类= 0x020000卡= 0x12a28086芯片= 0x150e8086 rev = 0x01 hdr = 0x00 vendor =＆＃39;英特尔公司＆＃39;设备=＆＃39; 82580千兆网络连接＆＃39; class = network.</p><p>  root @ test-bhyve：〜＃VM Passthrudevice Brevve Deacter DescriptionHostB0 0/0/0 No Xeon E3-1200 V5 / E3-1500 V5 / 6th Gen Core Processor Host Bridge / DRAM RegistersPcib1 0/1/0无Xeon E3-1200 V5 / E3-1500 V5 / 6th Gen Core Processor PCIe Controller（X16）XHCI0 0/0号NO 100系列/ C230系列芯片组家庭USB 3.0 XHCI Controllernone0 0/22/0 No 100系列/ C230系列芯片组Family Mei Controllernone1 0 / 22/3 NO 100系列/ C230系列芯片组家族KT重定向达0/23/0否Q170 / Q150 / B150 / H170 / H110 / Z170 / CM236芯片组SATA控制器[AHCI MODE] PCIB2 0/29/0 No 100系列/ C230系列芯片组家庭PCI Express Root PortiSab0 0/31/0否C236芯片组LPC / ESPI Collecternone2 0/31/2 No 100系列/ C230系列芯片组家庭电源管理控制器HDAC1 0/31/3 No 100系列/ C230系列芯片组家族HD音频控制器3 0/31/4 No 100系列/ C230系列芯片组Family Smbusem0 0/31/6无以太网连接（2）I219-LMIGB0 1/0/0 No 82580千兆网络连接TigB1 1/0/1 No 82580千兆网Workigb2 1/0/2 No 82580千兆网络连接Tigb3 1/0/3 No 82580千兆网络连接vgapci0 2/0/0 no gm107gl [quadro k620]</p><p>   到我的/boot/loader.conf，应用然后重新启动。该设备应该将Guest VM标记为PPT0。</p><p> PPT0 @ PCI0：1：0：0：类= 0x020000卡= 0x12a28086芯片= 0x150e8086 rev = 0x01 hdr = 0x00 vendor =＆＃39;英特尔公司＆＃39;设备=＆＃39; 82580千兆网络连接＆＃39; Class =网络子类=以太网 </p><p>Warning: Can only detect less than 5000 characters</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://neirac.byteswizards.com/posts/run-bhyve-in-freebsd-jails/">https://neirac.byteswizards.com/posts/run-bhyve-in-freebsd-jails/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/2020/">#2020</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/监狱/">#监狱</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/bhyve/">#bhyve</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/vm/">#vm</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1056826.html"><img src="http://img2.diglog.com/img/2021/4/thumb_34b84c05fa6bb6fd9ff639c35063da60.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1056826.html">墨西哥二手汽车市场Kavak率为485万美元，估值485万美元，高于10月20日10日的1.15亿美元，将其总筹集成900米+ </a></div><span class="my_story_list_date">2021-4-8 1:25</span></div><div class="col-sm"><div><a target="_blank" href="/story/1056720.html"><img src="http://img2.diglog.com/img/2021/4/thumb_82f500fe55a4d38baabc3bb9f9d7970d.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1056720.html">Emarketer表示，亚马逊在2019年的7.8％的2020年份额增长了10.3％，并估计收入增长至15.73亿美元，同比增长52.5％ </a></div><span class="my_story_list_date">2021-4-7 19:42</span></div><div class="col-sm"><div><a target="_blank" href="/story/1056667.html"><img src="http://img2.diglog.com/img/2021/4/thumb_a8129e3636a6fdbaa17a77a955949338.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1056667.html">2P和2英镑的硬币生产暂停十年（2020年） </a></div><span class="my_story_list_date">2021-4-7 11:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1056614.html"><img src="http://img2.diglog.com/img/2021/4/thumb_c47df8166e40a254a3a2b3ada9df9c72.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1056614.html">信号 - 服务器代码不公开2020年4月22日 </a></div><span class="my_story_list_date">2021-4-7 5:39</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>