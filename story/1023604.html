<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>程序员相信时间的谎言(2017)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">程序员相信时间的谎言(2017)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-13 03:09:04</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/b52bd88ce0a3a903bce41e9c29315fcc.jpg"><img src="http://img2.diglog.com/img/2020/9/b52bd88ce0a3a903bce41e9c29315fcc.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>在过去的几年里，我花了很多时间调试其他工程师的测试代码。这是一项有趣的工作，有时令人沮丧，但总是内容丰富。人们可能不会立即认为测试代码会有错误，但当然所有代码都有错误，测试也不例外。</p><p>我一再困惑地发现，测试和应用程序代码中有多少错误都源于对时间的误解或误解。这里我指的是计算机处理时间的有趣方式，以及我们人类如何构建日历的内在根本问题-夏令时只是冰山一角。</p><p>事实上，我在别人的(和我自己的)程序中看到了太多这样的误解，所以我认为在这里收集一个更常见的问题清单是值得的。</p><p>任何24小时的时间段都将始终在同一天(或周或月)开始和结束。</p><p>好吧，那不是真的。但至少程序必须运行的时区永远不会改变。</p><p>嗯，当然，必须在生产中运行的程序所在的时区永远不会改变。</p><p>系统时钟将始终设置为与正确的本地时间相差不大的时间。</p><p>如果系统时钟不正确，它至少会始终保持一致的秒数。</p><p>服务器时钟和客户端时钟将始终设置为大致相同的时间。</p><p>好的，但是服务器时钟上的时间和客户端时钟上的时间不会相差几十年。</p><p>如果服务器时钟和客户端时钟不同步，它们至少会始终相差一致的秒数。</p><p>系统时钟永远不会设置为遥远的过去或遥远的未来的时间。</p><p>系统时钟上的一分钟与任何其他时钟上的一分钟的持续时间完全相同。</p><p>好的，但是系统时钟上一分钟的持续时间与大多数其他时钟上一分钟的持续时间非常接近。</p><p>好的，但是系统时钟上一分钟的持续时间永远不会超过一个小时。</p><p>无需将系统时间设置为正确的本地时间以外的任何值。</p><p>好的，测试可能需要将系统时间设置为正确的本地时间以外的值，但在生产中永远不需要这样做。</p><p>CentOS上的旧版本KVM中有一个令人着迷的bug。具体地说，KVM虚拟机没有意识到它没有在物理硬件上运行。这意味着，如果主机操作系统将虚拟机置于挂起状态，则虚拟化系统时钟将保留挂起时的时间。例如，如果VM在13：00挂起，然后在两小时后(15：00)返回活动状态，则VM上的系统时钟仍将反映本地时间13：00。其结果是，每次KVM进入休眠状态时，主机操作系统都会将其置于挂起状态，并且VM的系统时钟将开始偏离实际情况，有时会出现很大的偏差，这取决于VM保持空闲的时间有多长。</p><p>可以安装cron作业，以使虚拟化系统时钟与主机操作系统的硬件时钟保持一致。但是在新的虚拟机上很容易忘记这样做，如果不这样做会导致很多有趣的事情。该错误已在较新版本中修复。</p><p>这篇文章要归功于帕特里克·麦肯齐(Patrick McKenzie)关于用户名的一篇规范的博客文章，多年来我一直在反复阅读这篇文章，并厚颜无耻地抄袭了它的概念和风格。如果你还没有读过这本珍品，现在就去读吧。我保证你会喜欢的。</p><p>我要感谢在BoingBoing和Hacker News以及Reddit和MetaFilter上对这篇帖子发表评论的每一个人，以及在Twitter上分享他们与时代周刊的奇怪经历的每一个人。</p><p>你提供了这么多有趣的边缘案例，我已经忘记了，也提供了很多我没有意识到的奇怪之处。例如：在犹太历法中，一天从日落开始，而不是从午夜开始。正如布鲁斯·斯特林(Bruce Sterling)指出的那样，我甚至没有考虑到当计算机在绕黑洞轨道运行的宇宙飞船上时会发生什么。</p><p>有足够的材料再做一次(更长的！)。发布关于此主题的帖子。但首先，我必须读完你们所有&500英镑的评论，以及链接的大量令人惊叹的研究材料。</p><p>再次感谢您的热情和令人难以置信的细节水平。在过去的24小时里，我学到了很多关于时间的知识。书呆子们，我向你们致敬。</p><p>程序员相信时间的谬误现在有一个规范的永久链接，你可以在引用这篇文章时使用。</p><p>特别感谢SWAlChemist，在我不小心弄丢了这个TLD后，他帮我找回了它！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time">https://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/相信/">#相信</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/时间/">#时间</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1023469.html"><img src="http://img2.diglog.com/img/2020/9/thumb_ed470c8edf50cbc010eec3e606cea3eb.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1023469.html">微软表示，苹果App Store的变化仍然给游戏玩家带来了糟糕的体验，他们想要一个目录应用程序，而不是“被迫下载100多个应用程序”</a></div><span class="my_story_list_date">2020-9-12 5:15</span></div><div class="col-sm"><div><a target="_blank" href="/story/1023448.html"><img src="http://img2.diglog.com/img/2020/9/thumb_ad70319592bda662005760a840324733.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1023448.html">并非所有攻击都是平等的：理解和防止Web应用程序中的DoS</a></div><span class="my_story_list_date">2020-9-12 3:40</span></div><div class="col-sm"><div><a target="_blank" href="/story/1023420.html"><img src="http://img2.diglog.com/img/2020/9/thumb_0413b79867aa8f19615f0d0463f799f7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1023420.html">苹果修订了App Store指导方针，澄清了从某些类别的应用程序和iOS 14功能(包括应用程序剪辑和小部件)进行应用内购买的规则</a></div><span class="my_story_list_date">2020-9-12 3:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1023358.html"><img src="http://img2.diglog.com/img/2020/9/thumb_c29f8db28896da1a54c25cff49f297c2.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1023358.html">现代Ruby序列化程序</a></div><span class="my_story_list_date">2020-9-12 0:8</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>