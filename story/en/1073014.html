<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>AVX/AVX-512调整不会为LibreOffice的计算电子表格带来回报AVX/AVX-512 Tuning Doesn't Payoff for LibreOffice's Calc Spreadsheets</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">AVX/AVX-512 Tuning Doesn't Payoff for LibreOffice's Calc Spreadsheets<br/>AVX/AVX-512调整不会为LibreOffice的计算电子表格带来回报</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-14 10:47:27</div><div class="page_narrow text-break page_content"><p>We Rely On Your Support: Did you know that the hundreds of articles written on Phoronix each month are mostly authored by one individual working insane hours? Phoronix.com doesn&#39;t have a whole news room with unlimited resources and relies upon people reading our content without blocking ads and alternatively by people  subscribing to Phoronix Premium for our ad-free service with other extra features. You can also consider  a tip via PayPal.   While Advanced Vector Extensions (AVX) can provide some big performance boosts when software is properly tuned for it and most often we are writing about projects  adding support for it, in the case of LibreOffice they are now going ahead and removing their AVX and AVX-512 tuning.   Last year AVX and AVX-512 support was added to LibreOffice such as for calculating the sum of a column of numbers within the Calc spreadsheet program. While the initial numbers were promising for delivering better performance over the SSE2 path, it turned out that the maintenance involved wasn&#39;t worthwhile and that AVX/AVX-512 tuning is now being removed from LibreOffice.   Yesterday Calc saw the  removal of its AVX and AVX-512 code. Luboš Luňák commented, &#34; It&#39;s been a source of numerous problems since the beginning. Poor separation of C++ code causing the compiler to emit some generic code as CPU-specific, compiler optimizations moving CPU-specific code out of #ifdef to unguarded static initialization, etc.&#34;   He also cites the performance not being to worthwhile, but for his reference is using a sluggish Ryzen 5 2500U. &#34; on my Ryzen2500U for one full column (1m cells) sumArray() takes about 1.6ms with AVX, 1.9ms with SSE2 and 4.6ms with generic code. So SSE2 code is perhaps worth it, especially given that SSE2 is our baseline requirement on x86_64 everywhere and x86 on Windows, but AVX+ is nowhere near worth the trouble.&#34;   He doesn&#39;t rule out CPU-specific code for LibreOffice but that it should be working, maintained, and worth the extra effort involved. A new code comment in the merged change goes on to note, &#34; IMPORTANT: Having CPU-specific routines turned out to be a maintenance problem, because of various problems such as compilers moving CPU-specific code out of #ifdef code into static initialization or our code using C++ features that caused the compiler to emit code that used CPU-specific instructions (even cpuid.hxx isn&#39;t safe, see the comment there). The only safe usage is using CPU-specific code that&#39;s always available, such as SSE2-specific code for x86_64. Do not use for anything else unless you really know what you are doing (and you check git history to learn from past problems).&#34;    This AVX/AVX-512 support was quietly added for LibreOffice 7.3 and at the time of writing the patches was billed as &#34;great speed improvements to statistical functions&#34; but alas didn&#39;t turn out exactly as planned.</p><p>我们依赖你的支持：你知道吗，每个月在Phoronix上写的数百篇文章大多是由一个人在疯狂的工作时间撰写的？福罗尼克斯。com没有&#39；我们没有一个拥有无限资源的整个新闻室，依靠人们阅读我们的内容而不屏蔽广告，或者通过订阅Phoronix Premium的人来使用我们的无广告服务和其他额外功能。你也可以通过贝宝考虑小费。虽然高级向量扩展（Advanced Vector Extensions，AVX）可以在软件进行适当调整时提供一些大的性能提升，而且我们经常写的是添加对它的支持的项目，但对于LibreOffice，他们现在正在进行并删除其AVX和AVX-512调整。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/带来/">#带来</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/doesn/">#doesn</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/支持/">#支持</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>