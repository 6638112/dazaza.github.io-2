<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>有史以来最聪明的软盘保护吗？ 西部保安有限公司 The cleverest floppy disc protection ever? Western Security Ltd</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">The cleverest floppy disc protection ever? Western Security Ltd<br/>有史以来最聪明的软盘保护吗？ 西部保安有限公司 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-15 03:34:18</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/58b19928352cb949d118c334943d639a.png"><img src="http://img2.diglog.com/img/2020/12/58b19928352cb949d118c334943d639a.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>I&#39;ve been on a bit of a floppy disc protection odyssey recently. This will probably be the last floppy disc related post for some time, so how better to end things than describe a stroke of genius I came across during my research of BBC Micro disc protection?</p><p>我最近有点软盘保护漫游。这可能是一段时间以来有关软盘的最后一篇文章，那么，结束这些事情比描述我在研究BBC Micro光盘保护过程中遇到的天才之处要好得多吗？</p><p> In my previous posts, we&#39;ve already covered (directly or tangentially) some interesting floppy disc protection schemes:</p><p> 在我以前的文章中，我们已经（直接或切向）介绍了一些有趣的软盘保护方案：</p><p>  Weak bits. [ link: Weak bits floppy disc protection: an alternate origins story on 8-bit]. &#34;Weak bits&#34; protection is where a patch of disc surface is left empty of magnetic flux transitions. Absent a signal, the floppy disc drive itself will turn up the gain on its amplifier and see noise, which manifests as non-deterministic digital reads from the disc.</p><p>  弱位。 [链接：弱位软盘保护：8位上的替代起源故事]。 ＆＃34;弱位＆＃34;保护是使磁盘表面的一块区域没有磁通量过渡。如果没有信号，软盘驱动器本身将提高其放大器的增益并看到噪声，这表现为从磁盘上不确定的数字读取。</p><p> Fuzzy bits. [ link: Technical Documentation - Dungeon Master and Chaos Strikes Back - Detailed analysis of Atari ST Floppy Disks]. &#34;Fuzzy bits&#34; protection is where magnetic flux transitions are recorded at intervals that are out-of-spec with regards to timing expectations (e.g. MFM). By using intervals right in the middle of a pair of expected values (e.g. 5us instead of the expected 4us or 6us), it&#39;s possible to cause the disc controller to return non-deterministic digital reads.</p><p> 模糊位。 [链接：技术文档-《地牢大师与混沌反击-对Atari ST软盘的详细分析》。 ＆＃34;模糊位＆＃34;保护是指以不符合时序预期的间隔（例如MFM）记录磁通量跃迁的位置。通过使用恰好在一对期望值（例如5us而不是期望的4us或6us）中间的间隔，可以使磁盘控制器返回不确定的数字读取。</p><p> Long / short tracks. [ link: Turning a £400 BBC Micro (1981) into a $40,000 disc writer (1987)] [see the &#34;Capabilities Unlocked&#34; section]. Long track protection is where flux transitions are written a little bit faster than they should be. This could be the whole track or just part of a track. In either case, the track will appear to contain more bytes than a track normally should. This works because the floppy disc controller usually has a broad tolerance of bitrate, to cater for disc drives naturally spinning at different speeds.</p><p> 长/短轨道。 [链接：将400英镑的BBC Micro（1981）变成4万美元的光盘刻录机（1987）] [参见＆＃34; Capabilities Unlocked＆＃34;部分]。远距离保护是在磁通过渡处写入比预期速度快一点的地方。这可能是整个轨道，也可能只是轨道的一部分。在任何一种情况下，该轨道似乎包含比正常情况下更多的字节。之所以可行，是因为软盘控制器通常具有宽的比特率容限，以适应以不同速度自然旋转的磁盘驱动器。</p><p> Now, we&#39;re going to cover something else entirely, with some unique properties that I think are clever.</p><p> 现在，我们将完全覆盖其他内容，并提供一些我认为很聪明的独特属性。</p><p>    It&#39;s not readily possible to find any &#34;Western Security, Ltd.&#34; company associated with the BBC Micro. So how do we know such a thing exists? Two reasons. Firstly, when developing my beebjit [ link] emulator, I made numerous mistakes and had tons of bugs. While grappling with accurate floppy disc emulation -- in order to load original protected disc images -- I hit this:</p><p>    很难找到任何西方安全有限公司。与BBC Micro相关的公司。那么我们怎么知道这样的事情存在呢？有两个原因。首先，在开发我的beebjit [link]模拟器时，我犯了很多错误并且有很多错误。在努力进行准确的软盘仿真时-为了加载受保护的原始光盘映像-我遇到了这个问题： </p><p>    Of course, the original author here missed out an amusing case. Either the disc is faulty (no), it&#39;s an illegal copy (not really?).... or a buggy emulator. Here&#39;s another error screen. Perhaps an earlier version of the protection scheme? The message uses &#34;disk&#34; instead of &#34;disc&#34; and does not entertain the fact the disc may be at fault:</p><p>当然，这里的原始作者错过了一个有趣的案例。光盘有故障（否），它是非法副本（不是真的吗？）或错误的模拟器。这是另一个错误屏幕。也许是保护方案的早期版本？该消息使用＆＃34; disk＆＃34;而不是＆＃34;光盘＆＃34;并且不接受光盘可能有故障的事实：</p><p>    (At the risk of digressing heavily, here&#39;s another screenshot. This is unrelated to Western Security Ltd., but follows the pattern of a dedicated screen for when the disc protected loader fails. This case is interesting because there&#39;s an entire decent image hidden from normal view!)</p><p>    （这有很大的风险，这是另一个屏幕快照。这与Western Security Ltd.没有关系，但是遵循磁盘保护的加载器发生故障时专用屏幕的模式。这种情况很有趣，因为在那里是从普通视图中隐藏的整个不错的图像！）</p><p>    The second reason we know the name Western is from disc duplicator markers. A disc duplicator marker is a special track written by some commercial disc duplication solutions. It is typically one track after the end of the normal disc, i.e. the 41st track or 81st track of the disc. Despite being &#34;out of bounds&#34;, most disc drives will seek at least one track out of bounds. On the track, you&#39;ll typically find a single sector header, and a sector body with a CRC error. This is an unusual construction and it sticks out, for example when my discbeast program [ link] looks at the Jolly Jack Tar disc:</p><p>    我们知道Western的第二个原因是来自光盘复制器标记。光盘复制器标记是一些商业光盘复制解决方案所写的特殊磁道。它通常是普通光盘结束后的一个磁道，即光盘的第41磁道或第81磁道。尽管“超出范围”，但大多数磁盘驱动器仍将寻找至少一条超出范围的磁道。在轨道上，您通常会找到一个扇区头，以及一个带有CRC错误的扇区主体。这是一种不寻常的构造，并且会突出显示，例如，当我的Discbeast程序[链接]查看Jolly Jack Tar光盘时：</p><p>    There&#39;s a date and a text string or two embedded in the duplicator marker. The Jolly Jack Tar instance is:</p><p>    复制器标记中嵌入了一个日期和一个或两个文本字符串。 Jolly Jack Tar实例是：</p><p>      There&#39;s one other less common duplicator marker string we see associated with Western security, for example Tens and Units by Sherston Software. It appears to be an earlier prototype version:</p><p>      我们看到了另一种与西方安全相关的不太常见的复制标记字符串，例如Sherston Software的Tens和Units。它似乎是早期的原型版本：</p><p>       Before diving in to how the Western Security protection works, let&#39;s recap the fundamentals of disc protection. The specifics are nuanced but the general principle is pleasantly simple:</p><p>       在深入探讨西方安全保护的工作原理之前，让我们回顾一下磁盘保护的基本原理。细节有些细微差别，但总的原则很简单：</p><p>   The disc  has to be relatively easy to read. If the disc couldn&#39;t be read by standard disc controllers, you couldn&#39;t sell the disc because customers would not be able to load it!</p><p>   光盘必须相对易于读取。如果标准光盘控制器无法读取该光盘，则您将无法出售该光盘，因为客户将无法加载该光盘！ </p><p>  And the  correct way to make a disc hard to write is to carefully understand consumer disc controller chips and disc drives and make the disc  impossible to write with standard kit.</p><p>使光盘难以写入的正确方法是，仔细了解消费者的光盘控制器芯片和光盘驱动器，并使其无法使用标准套件进行写入。</p><p>  The BBC Micro disc protection journey did not follow this route -- the earlier discs, and many of the later discs, were exotic but not particularly hard to create with the standard disc controller. But you did need a special program. The software companies had their special mastering program and the customers did not, so in a sense the disc was &#34;hard&#34; to write. But then, general copying programs such as Disc Duplicator 3 appeared and suddenly the discs were &#34;easy&#34; to write, if you or a friend had the advanced disc copying program.</p><p>  BBC Micro光盘保护之旅并没有遵循这一路线-早期的光盘以及许多后来的光盘都是奇特的，但使用标准的光盘控制器创建起来并不是特别困难。但是您确实需要一个特殊的程序。软件公司有其特殊的母版制作程序，而客户则没有，因此从某种意义上说，光盘是“硬”的。来写。但是随后，出现了诸如Disc Duplicator 3之类的通用复制程序，并且突然间光盘变得“容易”。如果您或朋友有高级光盘复制程序，则可以进行写操作。</p><p>  However, a few BBC Micro pioneers did write discs that &#34;can&#39;t&#34; be written with the standard disc controller, most notably:</p><p>  但是，一些BBC Micro的先驱确实编写了无法播放的光盘。用标准的光盘控制器写的，最值得注意的是：</p><p> [1] One of a disc controller&#39;s main jobs is to write precise disc surfaces, i.e. to  never write weak bits. However in the modern era I did find a way to trick the Intel 8271 controller into writing weak bits. Best I know, this technique was not discovered or used back in the day.</p><p> [1]磁盘控制器的主要工作之一是写入精确的磁盘表面，即从不写入弱位。但是，在现代时代，我确实找到了一种诱骗Intel 8271控制器写入弱位的方法。据我所知，这种技术并不是在今天发现或使用的。</p><p> [2] With a bit of clever programming, I believe data between sectors could be written with standard disc controllers. It would involve writing to a track multiple times and resetting the disc controller at critical timing junctures. I&#39;ve not seen any historic disc copying program that attempts to copy such discs, though.</p><p> [2]通过一些巧妙的编程，我相信可以使用标准的磁盘控制器来写入扇区之间的数据。这将涉及多次写入磁道并在关键的时序关头重置光盘控制器。不过，我没有看到任何试图复制此类光盘的历史性光盘复制程序。</p><p>        There&#39;s nothing too unusual here. The red block at the end denotes a track with 1 sector that has a CRC error. It&#39;s not part of the disc protection; it&#39;s the duplicator marker. The green color represents a standard sector layout with nothing particularly exotic present. The &#34;D&#34; indicates the presence of deleted sectors. This is disc protection, but not exotic or hard to copy. However, loading the disc in my beebjit emulator, using the Western Digital WD1770 floppy disc controller and  -log disc:commands, yields something highly unusual:</p><p>        这里没有什么异常之处。末尾的红色块表示具有1个扇区的轨道，该轨道具有CRC错误。它不是光盘保护的一部分；它是复制标记。绿色代表标准的行业布局，没有特别奇特的外观。 ＆＃34; D＆＃34;表示存在已删除的扇区。这是光盘保护，但不是特殊保护或难以复制。但是，使用Western Digital WD1770软盘控制器和-log disc：commands将光盘加载到我的beebjit仿真器中会产生非常不寻常的结果：</p><p> info:disc:1770: command $E4 tr 1 sr 3 dr 1 cr $29 ptrk 1 hpos 1884</p><p> 信息：光盘：1770：命令$ E4 tr 1 sr 3 dr 1 cr $ 29 ptrk 1 hpos 1884 </p><p> Command $E4 is &#34;read track&#34;. It is not used in the normal operation of disc loading, or indeed in any other known protected loaders.</p><p>命令$ E4是＆＃34;读轨道＆＃34;。它不用于光盘加载的正常操作，或者实际上不用于任何其他已知的受保护的加载器。</p><p> It&#39;s time to walk through the loader a little to see what is going on. The goal of this post is not to give a detailed walk through of all the gnarly corners of the loader. Like many protected loaders, it is &#34;encrypted&#34; or more accurately, obfuscated. It de-obfuscates itself using many layers of self-modification. At PC $0657, a disc call is set up to load a bit more of the loader from deleted sectors in track 9. This could easily be confused as being the extent of the protection, but it is not. Later, at PC $3CF7, there is a loop:</p><p> 现在该花些时间穿过装载机了，看看发生了什么事。这篇文章的目的不是要详细介绍装载机的所有弯角。像许多受保护的加载程序一样，它已被加密。或更准确地说，是模糊的。它使用多层自我修改来模糊自身。在PC $ 0657，设置了光盘调用以从磁道9中已删除的扇区中加载更多的加载器。这很容易造成混淆，因为它是保护的范围，但事实并非如此。稍后，在PC $ 3CF7处出现一个循环：</p><p>    It&#39;s not expected to be clear from this fragment alone (without all the subroutines), but what is going on here is a loop across tracks 1-8 inclusive. For each track, it is read fully and the length of the track is stored in a table at $3F71. Later, at PC $3CB6, these lengths are checked against a table located at $3D9B. The check is particularly interesting. For the copy protection to pass, a count is taken of each track length that falls within +-1 of the expectation, and this count must be 7 or 8.  Immediately we see that this protection is not a precise technology. This is to be expected: discs are analog storage mediums underneath it all and there will be a bit of noise at the beginning or end of the track. From read-to-read, the same disc, drive and controller can and does see slight variations of track length. Looking at the load in beebjit, here are the encountered vs. expected lengths. (0x4A == 3122 bytes.)</p><p>    不能仅从这个片段（没有所有子例程）中清除它，但是这里发生的是一个遍历1-8个磁道的循环。对于每个磁道，将对其进行完全读取，并将磁道的长度存储在$ 3F71的表中。后来，在PC $ 3CB6，将对照位于$ 3D9B的表检查这些长度。这项检查特别有趣。为了通过复制保护，需要对每个轨道长度进行计数，该轨道长度应在期望值的+ -1之内，并且该计数必须为7或8。立即我们可以看到，这种保护不是一种精确的技术。这是可以预料的：光盘是其下方的模拟存储介质，并且在磁道的开头或结尾会有一点噪音。从读取到读取，同一张光盘，驱动器和控制器可以而且确实看到磁道长度略有变化。查看beebjit中的负载，这是遇到的长度与预期的长度。 （0x4A == 3122字节。）</p><p>      As can be seen, my disc reads almost exactly to expectations except track 2, which was 3125 bytes instead of the expected 3124. That&#39;s within the +-1 range so all 8 tracks pass the check (7 or more are required).</p><p>      可以看出，我的光盘读取的数据几乎完全符合预期，但磁道2为3125字节，而不是预期的3124字节。该值在+ -1范围内，因此所有8条磁道都通过了检查（要求7条或更多条记录）。</p><p> To spell it out, the protected loader expects the track length (in FM encoded bytes) for tracks 1-8 inclusive to be 3122, 3124, 3123, 3122, 3123, 3124, 3123, 3122. That&#39;s an incredible level of precision and accuracy of writing for 1985 technology. Each byte covers about 64us on a spinning disc, but disc drives of the era would often specify running RPM variation of &#34;less than +-1.5%&#34;. At 300rpm, +-1.5% is +-3ms per rotation! In my experience, drives are much much better than that but still! How did 1985 technology cope??</p><p> 清楚地说，受保护的加载程序期望包含1-8的磁道的磁道长度（以FM编码的字节为单位）为3122、3124、3123、3122、3123、3124、3123、3122。这是一个令人难以置信的水平1985年技术的写作准确性和准确性。在旋转的磁盘上，每个字节大约占64us，但是那个时代的磁盘驱动器通常会将运行RPM变量指定为小于-1.5％的RPM。在300rpm时，每旋转+ -1.5％是+ -3ms！以我的经验，驱动器比这要好得多，但仍然如此！ 1985年的技术如何应对？</p><p> One further note, on the WD1770 vs. Intel 8271 disc controllers. We&#39;ve focused our analysis on the protection as seen by the WD1770. This disc also loads fine with an Intel 8271 controller. It uses a  completely different code path to indirectly calculate track length in this case. It works because the padding bytes up to the end of the track are all 0x00 instead of the usual 0xFF. An &#34;over-read&#34; past the final sector on the track is used, and track length is detected by the change from reading 0x00 to 0xFF.</p><p> 关于WD1770与Intel 8271光盘控制器的进一步说明。我们将分析重点放在了WD1770所看到的保护上。该光盘还可以很好地与Intel 8271控制器一起装载。在这种情况下，它使用完全不同的代码路径间接计算磁道长度。之所以起作用，是因为直到磁道末尾的填充字节都是0x00，而不是通常的0xFF。过度阅读使用磁道上最后一个扇区之后，磁道长度通过从读取0x00变为0xFF来检测。</p><p>  And then we realize the genius of this scheme. What if they didn&#39;t write the tracks with extreme precision, because the technology wasn&#39;t there?  What if they just wrote the track any-old-how and then examined the result? I think this what they did:</p><p>  然后我们意识到了该方案的天才。如果他们没有该技术，就不能以极高的精度编写曲目该怎么办？如果他们只是以任意方式编写了曲目，然后检查了结果怎么办？我认为这是他们所做的： </p><p>  Format the disc. (That&#39;s it. Just format the disc normally and you&#39;ve created a fiendishly protected disc.)</p><p>格式化光盘。 （就是这样。只需对光盘进行正常格式化，就可以创建受保护良好的光盘。）</p><p>  On a per-disc basis, generate, obfuscate and write the required table of expected track lengths into the loader on track 9.</p><p>  在每个磁盘的基础上，生成，混淆并把所需的预期轨道长度表写入轨道9的加载器中。</p><p> What a trick! These discs are savagely hard to copy, even  with dedicated hardware of the era. In fact, this trick is so clever that it requires us to revisit the fundamentals of disc protection. Here&#39;s our earlier statement:</p><p> 真是个把戏！即使使用那个时代的专用硬件，也很难复制这些光盘。实际上，此技巧非常巧妙，以至于需要我们重新审视光盘保护的基础知识。这是我们之前的声明：</p><p>    But the Western Security Ltd. protection is quite easy to write -- you just format a disc. So perhaps we should say:</p><p>    但是Western Security Ltd.的保护非常容易编写-只需格式化光盘即可。所以也许我们应该说：</p><p> The Western Security protection is easy to write, easy to read but very hard to copy. One of the advantages of such a protection is that you could use a home computer to write it cheaply if the economics worked for you. That said, many discs I&#39;ve seen appear to have duplicator markers typically found with expensive disc duplicating machines.</p><p> Western Security防护易于编写，易于阅读，但很难复制。这种保护措施的优点之一是，如果经济因素对您有利，那么您可以使用家用计算机廉价地编写它。就是说，我见过的许多光盘似乎具有通常在昂贵的光盘复制机中发现的复制器标记。</p><p>  How can we support our theory? One way is to find a second disc of the same title, The Wizard&#39;s Revenge, and see if it differs at all. I did find one, and it does. My disc as per above:</p><p>  我们如何支持我们的理论？一种方法是找到第二张同名的光碟《巫师的复仇》，看看它是否有所不同。我确实找到了，而且确实如此。上面的光盘：</p><p>          As can be seen, the sector data (covered by the CRC32s) of the discs is the same except for track 9, which is where the table of expected track lengths resides. And the track lengths themselves are different. In both cases there&#39;s track length wobble and in the case of the latter discs, the tracks are all a little longer. This means that the drive that formatted the disc was running at a slightly slower RPM, enabling more bytes to be written in a single revolution.</p><p>          可以看出，磁盘的扇区数据（由CRC32覆盖）与磁道9相同，而磁道9是预期磁道长度表所在的位置。轨道长度本身是不同的。在这两种情况下，轨道长度都摆动，而在后一种光盘的情况下，轨道都稍长一些。这意味着格式化光盘的驱动器以稍慢的RPM运行，从而使一圈写入更多的字节。 </p><p>  And there&#39;s a second way to support the theory. I just asked Simon Hosler, who wrote a lot of Sherston Software games back in the 1980s, if he remembered anything. He recalls,</p><p>还有第二种方法来支持该理论。我只是问西蒙·霍斯勒（Simon Hosler）是否记得任何东西，西蒙·霍斯勒（Simon Hosler）早在1980年代就写了很多Sherston Software游戏。他回忆说，</p><p>  &#34;Western Security –  this wasn’t my system but I think it worked like this... It works because each disk drive runs at slightly different speeds. So when a drive creates a track on the disk – after it has added all of the headers and sectors etc, it has a bit of space to fill up, so adds a few extra ‘fill in’ bits that do nothing. The number of fill in bits will depend on the exact speed of the original formatting drive. So will be different if it was copied. I remember this system became a pain because disk drives were changing (?) all the time. [...] the system was called &#39;Fingerprinting&#39;&#34;</p><p>  ＆＃34; Western Security –这不是我的系统，但我认为它的工作原理是这样的……之所以有效，是因为每个磁盘驱动器的运行速度略有不同。因此，当驱动器在磁盘上创建轨道时（在添加所有标头和扇区等之后），它有一定的空间可以填充，因此添加了一些额外的“填充”位，它们什么都不做。填充位数将取决于原始格式化驱动器的确切速度。因此，如果将其复制将有所不同。我记得这个系统很麻烦，因为磁盘驱动器一直在变化（？）。 [...]系统被称为＆＃39;＆＃39;＆＃34;</p><p> There remains the mystery of how a commercial duplicator could handle making these discs. One thing I&#39;ve come across is references to a &#34;Freeform&#34; script [ link], used in conjunction with Trace duplicators. I haven&#39;t been able to find a manual for this scripting language. There are some strange fragments in the memory of the loader after de-obfuscation; could it be related?</p><p> 商业复制器如何处理这些光盘仍然是个谜。我遇到的一件事是对＆＃34; Freeform＆＃34;的引用脚本[链接]，与跟踪复制器一起使用。我还没有找到此脚本语言的手册。混淆后，加载程序的内存中有一些奇怪的片段；可能相关吗？</p><p> 3F80: 54 70 00 41 44 44 20 20 20 20 20 72 00 4D 4F 56  Tp.ADD     r.MOV 3F90: 45 54 4F 20 20 74 00 55 4E 49 54 20 20 20 20 75  ETO  t.UNIT    u 3FA0: 00 54 52 41 43 4B 20 20 20 76 00 53 45 43 54 4F  .TRACK   v.SECTO 3FB0: 52 20 20 77 00 54 4F 50 54 52 41 43 4B 78 00 55  R  w.TOPTRACKx.U</p><p> 3F80：54 70 00 41 44 44 20 20 20 20 20 72 00 4D 4F 56 Tp.ADD r.MOV 3F90：45 54 4F 20 20 74 00 55 4E 49 54 20 20 20 20 75 75 ETO t.UNIT u 3FA0：00 54 52 41 43 4B 20 20 20 76 00 53 45 43 54 4F .TRACK v.SECTO 3FB0：52 20 20 77 00 54 4F 50 54 52 41 43 4B 78 00 55 R. w.TOPTRACKx.U</p><p>  I happen to have a couple of very different disc drives, so I thought I&#39;d try them out. I formatted a disc in each drive, then had a look at the track lengths (in bytes) read back by a WD1772 disc controller in a real BBC Micro model B.</p><p>  我碰巧有两个非常不同的光盘驱动器，所以我想尝试一下。我在每个驱动器中格式化了一张光盘，然后查看了由实际BBC Micro模型B中的WD1772光盘控制器回读的磁道长度（以字节为单位）。</p><p>   [...] Track 1 sectors 10 length 3137 fixups 1 CRC32 67F0950E Track 2 sectors 10 length 3138 fixups 1 CRC32 67F0950E Track 3 sectors 10 length 3138 fixups 1 CRC32 67F0950E Track 4 sectors 10 length 3139 fixups 1 CRC32 67F0950E Track 5 sectors 10 length 3138 fixups 1 CRC32 67F0950E Track 6 sectors 10 length 3140 fixups 1 CRC32 67F0950E Track 7 sectors 10 length 3140 fixups 1 CRC32 67F0950E Track 8 sectors 10 length 3139 fixups 1 CRC32 67F0950E Track 9 sectors 10 length 3140 fixups 1 CRC32 67F0950E Track 10 sectors 10 length 3140 fixups 1 CRC32 67F0950E [...]</p><p>   [...]轨道1扇区10长度3137固定1 CRC32 67F0950E轨道2扇区10长度3138固定1 CRC32 67F0950E轨道3扇区10长度3138固定1 CRC32 67F0950E轨道4扇区10长度3139固定1 CRC32 67F0950E轨道5扇区10长度3138固定1 CRC32 67F0950E轨道6扇区10长度3140固定1 CRC32 67F0950E轨道7扇区10长度3140固定1 CRC32 67F0950E轨道8扇区10长度3139固定1 CRC32 67F0950E轨道9扇区10长度3140固定1 CRC32 67F0950E轨道10扇区10长度3140修补程序1 CRC32 67F0950E [...]</p><p>  [...] Track 1 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 2 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 3 sectors 10 length 3118 fixups 0 CRC32 67F0950E Track 4 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 5 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 6 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 7 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 8 sectors 10 length 3119 fixups 1 CRC32 67F0950E Track 9 sectors 10 length 3118 fixups 1 CRC32 67F0950E Track 10 sectors 10 length 3119 fixups 1 CRC32 67F0950E [...]</p><p>  [...]轨道1扇区10长度3119固定1 CRC32 67F0950E轨道2扇区10长度3119固定1 CRC32 67F0950E轨道3扇区10长度3118固定0 CRC32 67F0950E轨道4扇区10长度3119固定1 CRC32 67F0950E轨道5扇区10长度3119固定1 CRC32 67F0950E磁道6扇区10长度3119固定1 CRC32 67F0950E磁道7扇区10长度3119固定1 CRC32 67F0950E磁道8扇区10长度3119固定1 CRC32 67F0950E磁道9扇区10长度3118固定1 CRC32 67F0950E磁道10扇区10长度3119修补程序1 CRC32 67F0950E [...] </p><p> These two drives definitely have unique fingerprints! The older drive has a bit more variance / wobble in individual track lengths. In fact, it seems to fit more bytes per track on the later sectors -- most of the latter tracks are length 3142. The older drive also generally fits 20 or so more bytes per track. This means it is spinning a little slower. By contrast, the newer drive runs like clockwork with minimal track-to-track variance. This might make it a little less suitable for generating varied per-disc fingerprints, but copying the disc on home computing hardware would still be tricky -- the machine used would need to have a similarly precise drive, and the drive would also need to be running at the exact same speed as the drive that made the original disc.</p><p>这两个驱动器肯定具有独特的指纹！较旧的驱动器在各个磁道长度上会有更多的变化/摆动。实际上，似乎在以后的扇区中每个轨道都可以容纳更多的字节-后者的大多数轨道的长度为3142。较旧的驱动器通常也可以在每个轨道中容纳20个左右的字节。这意味着它的旋转速度稍慢。相比之下，较新的驱动器就像发条一样运转，磁道间差异最小。这可能会使它不太适合生成各种光盘指纹，但是在家庭计算硬件上复制光盘仍然很棘手-所使用的机器将需要具有类似精度的驱动器，并且该驱动器还必须具有以与制作原始光盘的驱动器完全相同的速度运行。</p><p> One last look at track lengths, this time from a Phantom Combat game disc, by Doctor Soft. This disc uses Western Security Ltd. protection:</p><p> 最后看一下轨道长度，这是Soft Doctor制作的Phantom Combat游戏光盘。该光盘使用Western Security Ltd.的保护：</p><p>  [...] Track 1 sectors 10 length 3152 fixups 0 CRC32 67F0950E Track 2 sectors 10 length 3152 fixups 1 CRC32 67F0950E Track 3 sectors 10 length 3152 fixups 0 CRC32 67F0950E Track 4 sectors 10 length 3152 fixups 1 CRC32 67F0950E Track 5 sectors 10 length 3151 fixups 0 CRC32 67F0950E Track 6 sectors 10 length 3152 fixups 0 CRC32 67F0950E Track 7 sectors 10 length 3150 fixups 0 CRC32 67F0950E Track 8 sectors 10 length 3151 fixups 0 CRC32 67F0950E [...]</p><p>  [...]轨道1扇区10长度3152固定0 CRC32 67F0950E轨道2扇区10长度3152固定1 CRC32 67F0950E轨道3扇区10长度3152固定0 CRC32 67F0950E轨道4扇区10长度3152固定1 CRC32 67F0950E轨道5扇区10长度3151固定0 CRC32 67F0950E磁道6扇区10长度3152固定0 CRC32 67F0950E磁道7扇区10长度3150固定0 CRC32 67F0950E磁道8扇区10长度3151固定0 CRC32 67F0950E [...]</p><p> This is disc protection hidden in plain sight. These 8 protected tracks are in fact 100% default format tracks (CRC32 67F0950E). There&#39;s the correct number of sectors and there are no deleted sectors. discbeast would show these tracks as plain green, aka. move on, nothing to see here!</p><p> 这是看不见的光盘保护。实际上，这8条受保护的轨道是100％默认格式轨道（CRC32 67F0950E）。扇区数正确，没有删除的扇区。 Discbeast会将这些轨迹显示为纯绿色，也就是。继续前进，这里什么也看不到！</p><p> There&#39;s a bit of track length wobble from track to track, but the tracks are also unusually long (the ideal is 3125 bytes). It is not clear whether the tracks were deliberately laid down a little long, but it definitely helps the disc protection. Any disc drive used to attempt to re-create these tracks is unlikely to be spinning at that speed because it is 0.8% slow and the disc drive motor technology is generally better than that. It&#39;s interesting to note that simple long track protection is just another variant in the Western Security scheme.</p><p> 磁道之间的磁道长度有些波动，但是磁道也异常长（理想的是3125字节）。尚不清楚是否故意将磁道放了很长时间，但这绝对有助于光盘保护。用于尝试重新创建这些轨道的任何磁盘驱动器都不太可能以该速度旋转，因为它的速度慢了0.8％，并且磁盘驱动器电动机技术通常要好于该速度。有趣的是，简单的长距离保护只是Western Security方案的另一个变体。</p><p> This disc was probably written from a BBC Micro itself, rather than a fancy duplication machine, as evidenced by the lack of a duplicator marker and by the fact the game data sectors show evidence of being written sector-at-a-time, not track-at-a-time. Who knows, maybe there was a deliberate attempt to find a slow drive; some older drives even have a twiddleable variable resistor to vary motor speed.</p><p> 该光盘可能是由BBC Micro本身而不是精美的复制机写入的，这表明缺少复制器标记，并且游戏数据扇区显示出一次写入而不是跟踪扇区的事实。一次。谁知道呢，也许有人在故意寻找慢速行驶的机会。一些较旧的驱动器甚至具有可旋转的可变电阻器来改变电动机速度。</p><p> We&#39;ve reviewed the most powerful BBC Micro model B disc protection scheme I found, across an audit of most of the copy protected discs released for the machine. It&#39;s clever in that you don&#39;t need specialized hardware to create the disc, or read the disc. But you&#39;re going to struggle to duplicate the disc. My suspicion is that even modern hardware -- a Greaseweazle perhaps -- might struggle to hit byte-perfect precision, unless it is paired with a high quality disc drive that rotates very consistently (such as my Mitsubishi MF504C).</p><p> 我们审核了为该机器发行的大多数受复制保护的光盘，从而查看了我发现的功能最强大的BBC Micro B型B光盘保护方案。它很聪明，因为您不需要专门的硬件来创建光盘或读取光盘。但是您将很难复制光盘。我的怀疑是，即使现代硬件（也许是Greaseweazle）也可能难以达到字节完美的精度，除非它与旋转非常稳定的高质量磁盘驱动器（例如我的Mitsubishi MF504C）配对使用。 </p><p> Talking again to Simon, as far as he&#39;s aware, this was the work of George Keeling, who I&#39;d love to contact if only to tell him I think this work was awesome.</p><p>就他所知，西蒙再次与他交谈，这是乔治·基林的工作，我很想与他联系，只是告诉他我认为这项工作很棒。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://scarybeastsecurity.blogspot.com/2020/12/the-cleverest-floppy-disc-protection.html">https://scarybeastsecurity.blogspot.com/2020/12/the-cleverest-floppy-disc-protection.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/软盘/">#软盘</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/floppy/">#floppy</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/光盘/">#光盘</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>