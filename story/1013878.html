<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>为什么每种语言都需要下划线</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">为什么每种语言都需要下划线</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-24 08:00:51</div><div class="page_narrow text-break page_content"><p>(这是我在PyCon和DevDay上的一次演讲的改编。幻灯片和视频有俄语版本)。</p><p>你知道下划线是什么吗？一般而言，让生活变得更美好的是JavaScript库。适用于任何用JavaScript编写的人。我主要编写Python，我也想让我的生活更好，所以我继续为Python编写了一个类似的库。但问题是，你需要理解某种东西背后的魔力，才能恰当地复制它。那么，这背后的魔力是什么呢？</p><p>要回答这个问题，我们应该看看这种图书馆解决的问题。为了了解一些情况，我将用代码对它们进行说明。这是用Python编写的，但是所有的想法都是通用的，所以不要害怕。</p><p>对于URL中的url，图像=[]：对于范围内的尝试(Download_Tries)：try：images。APPEND(download_image(Url))除HttpError：IF尝试+1==Download_TRIES：RAISE之外的中断。</p><p>这里有几件事情纠缠在一起，但我的观点是，这段文字可以写得更短：</p><p>如果一开始看起来很难，那就没问题了。它涉及一些函数和控制流抽象，您可能对此很陌生。一旦您习惯了它，您会发现后一种变体不仅更短，而且更简单。</p><p>对于请求中的k，v，d={}。Items()：尝试：d[k]=int(V)Exclude(TypeError，ValueError)：d[k]=None。</p><p>在这里，我们检查字典，并通过将其值强制为int来清除它们。或者，如果这是不可能的，那就什么都不做。清除输入和忽略格式错误的数据是一项相当频繁的任务，但它需要付出如此多的努力。我想这样写：</p><p>使用Funcy完全可以做到这一点。不过，让我们转到下一个。</p><p>序列中x的prev=NONE：如果prev不是NONE并且x&lt；=prev：is_ascending=false Break prev=x否则：is_ascending=True。</p><p>啊，迭代一个序列，跟踪前一个元素。你这样做过几次了？应该有一个函数来抽象它：</p><p>而配对就是这样做的。它使我们能够按相邻对顺序迭代。所以我们只需要检查一下它们是否都是按顺序订购的。</p><p>所有这些示例都有一个共同的属性-红色变体有更多的代码。和更多代码：</p><p>显然，下划线、函数式和好友可以帮助我们编写更少的代码(至少在这三个示例中是这样)。但他们是如何做到这一点的呢？</p><p>让我们再看一看第一个示例。它在一段代码中做三件事：</p><p>URL中的url的图像=[]：对于范围内的尝试(Download_Tries)：try：images.append(download_image(Url))中断，HttpError：IF尝试+1==download_tries：RAISE</p><p>如你所见，三种颜色在这里交错。这暗示相应的方面是纠缠在一起的。我所说的“纠缠”是指它们不能单独重复使用。假设我们需要在其他地方重试失败，我们可能最终会复制整个块并对其进行一些更新。不完全是“代码重用”的最佳实践。</p><p>另一方面，如果我们设法分离RETIES，那么我们的代码将如下所示：</p><p>现在红色代码在顶部被很好地分组。绿色和蓝色仍然混合在一起，但现在它们代表了一种非常常见的模式，以至于大多数现代语言都有一个内置函数来处理这种情况：</p><p>最后一个变体有一些可爱的特性：手头任务(下载图像)的每个部分只出现一次，整个迭代方面由单个map()调用处理，重试被抽象到retry函数中。</p><p>将常见行为提取到高阶函数中是让您的生活变得更美好的第一个技巧、下划线和功能使用。</p><p>现在是回到第二个例子的时候了。我将放弃错误处理，以使代码段更加均匀：</p><p>现在他们都是一行程序，那么第一个有什么更好的呢？让我们确定每个代码变体的每个不同组件：</p><p>第二个看起来像彩虹。但是，除了看起来不错之外，这意味着每次你写或读它的时候，你都需要把所有这些成分加载到你的大脑中，占据你所有的认知资源。这就是一线更好的方式。</p><p>这样我们就可以看到，第二行大约有一半是低级别的细节。低级别意味着你不需要知道所有的细节就能理解正在发生的事情。</p><p>对于序列中的x，prev=NONE：如果prev不是NONE并且x&lt；=prev：is_ascending=false Break prev=x Else：is_ascending=True#从空的prev开始，迭代序列，记账prev现状，每个周期上的#如果prev存在并且当前元素小于或等于它#，则将is_ascending设置为false并中断。#If循环不是&#39；t断集is_ascending to True is_ascending=all(l&lt；r表示l，r成对(Seq))#set is_ascending到相邻序列对中小于右侧的所有左侧元素#。</p><p>显然，代码越多，发出的文本就越多。更高级别的代码利用更高级别的抽象生成解释。这样，我们不仅可以在编码中使用更大的构建块，而且可以在解决问题时使用更大的构建块。</p><p>我们经历的所有事情都是完全独立于语言的。所以每种语言都要加下划线？不完全是，更重要的是，直截了当的端口并不总是一个好主意：抽象的常见行为因语言而异，尤其是每种应用程序。正确的做法应该是遵循核心理念。或者四处看看是否有人已经这么做了。</p><p>附注：如果你使用的是JVM，你可能还想看看Scala，如果你使用的是.NET，你可能还想看看F#。</p><p>另外，请停止对黑客新闻的评论，一项有争议的处罚正在扼杀这篇帖子。改用reddit线程。遗憾的是，HN不再是一个讨论的地方。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://hackflow.com/blog/2014/06/22/why-every-language-needs-its-underscore/">http://hackflow.com/blog/2014/06/22/why-every-language-needs-its-underscore/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/需要/">#需要</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/language/">#language</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1013486.html"><img src="http://img.diglog.com/img/2020/7/thumb_260d6fcd14c2990e7e23ac23d2dd5aa5.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1013486.html">11种人类需求</a></div><span class="my_story_list_date">2020-7-22 22:36</span></div><div class="col-sm"><div><a target="_blank" href="/story/1013325.html"><img src="http://img.diglog.com/img/2020/7/thumb_731a6eeb1078e5ce307de276388b33a7.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1013325.html">如何选择适合您的机器学习算法</a></div><span class="my_story_list_date">2020-7-22 2:16</span></div><div class="col-sm"><div><a target="_blank" href="/story/1013067.html"><img src="http://img.diglog.com/img/2020/7/thumb_accb2f0780f8929796ba1a411dd620fd.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1013067.html">关于AutoGreens：全自动机械农场和家用电器的未来</a></div><span class="my_story_list_date">2020-7-21 0:29</span></div><div class="col-sm"><div><a target="_blank" href="/story/1012208.html"><img src="http://img.diglog.com/img/2020/7/thumb_9b0b498e5e5a307ea112492ede5f96f7.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012208.html">想要改进吗？你一定要读一读</a></div><span class="my_story_list_date">2020-7-16 10:19</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>