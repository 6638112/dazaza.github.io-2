<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>当一个被删除的文件从维护开始需要20分钟，但是你生命中的一年</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">当一个被删除的文件从维护开始需要20分钟，但是你生命中的一年</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-07 10:21:37</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/7/e464ba48f3e19bf77c97112c1a3f551a.jpg"><img src="http://img.diglog.com/img/2020/7/e464ba48f3e19bf77c97112c1a3f551a.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>赞扬UNIX并知道何时故意将服务器推向悬崖。</p><p>谁，我吗？周末已被删除。在你开始你自己的职场冒险之旅之前，请稍作停顿，享受另一次奥普斯维尔之旅，这是由谁，我提供的？</p><p>今天的故事来自吉姆，讲述了他和一位同事对一家日报的出版系统进行通宵硬件、操作系统、数据库和应用程序升级的情况，该系统运行在Sun/Sybase系统上。</p><p>令人遗憾的是，Sun Microsystems的命运已经有了很好的记录，而Sybase仍然是一件事情(尽管SAP早就放弃了这个名字)。</p><p>当时两个人都很健康，吉姆和他的朋友被聘为Sun/Sybase VAR和ISV的工程师，报酬丰厚。</p><p>升级是按计划进行的。他解释说，用户和我们的培训团队希望在早上到达，并登录到一个完全升级的系统。在升级的关键阶段进行到一半时，我的伙伴(他仍然是我的伙伴)突然安静下来--这总是一个坏兆头。</p><p>它泄露了吉姆的搭档一直在玩Solaris的漂亮的GUI文件管理器，并在Sybase主设备文件运行时不小心删除了它。&#34；的合作伙伴一直在玩Solaris的快速GUI文件管理器，并且在它运行时不小心删除了Sybase主设备文件。</p><p>很难描述这是一场多大的灾难。主设备文件的丢失将使Sybase非常糟糕。然而，对于粗心大意的人来说，这是一个很容易犯的错误。</p><p>这个黑客深情地回忆起上个世纪末的一段时间，当时一个特别过于自信的DBA决定通过运行del*.*&#34；从Microsoft SQL Server数据库目录中删除残渣，因为它需要的文件将被锁定，对吗？&#34；</p><p>20多年过去了，他那句话仍然铭刻在我的记忆中：Windows NT按照命令，愉快地粉碎了一个又一个生产数据库。没有，没有最近的备份。</p><p>对吉姆来说，事情并没有那么可怕。在Solaris(和其他UNIX系统)中，删除文件只是将其从其目录中取消链接。</p><p>只要文件被某个进程保持打开状态，文件空间就不会被回收。</p><p>因此，即使切除了一个相对较大的器官，数据库仍将继续工作。但是，没有新的进程会找到该文件，因此不能转储系统数据库。也不能正常关闭，因为文件将被关闭，其字节将被丢弃。</p><p>吉姆做了明智的备份，但是从备份中恢复会耗尽整个维护窗口，而且很可能会让这个项目再中止一周。(工业和信息化部电子科学技术情报研究所陈皓)。</p><p>出乎意料的是，Jim决定通过在控制台输入中断序列来使系统崩溃(而不是停止)。服务器将没有机会完全关闭该文件.。</p><p>他回忆道：我们做了一个小小的祈祷，祈祷，启动服务器，等待文件系统检查(Fsck)来修复我们造成的损害。</p><p>当被问及是否想要重新链接孤立的信息节点时，我从未如此仔细地键入过这封信。</p><p>随着心率的加快，吉姆登录并检查了文件系统的Lost+Found目录。</p><p>果不其然，有几个文件具有整数名称(&#34；他解释说，fsck知道的只是inode编号，所以它就成了文件名&#34；)。经过一点调查之后，他把最有可能的文件放回原处，屏住呼吸，启动了数据库。</p><p>耗尽了我所有的好运，数据库开始腾飞，我们完成了升级。</p><p>我不会戏剧性地说我因此得了创伤后应激障碍，但重述这个故事仍然让我毛骨悚然。</p><p>它距离我们的维护窗口只花了20分钟，但距离我的寿命至少一年。</p><p>Unix文件系统的设计者是否保存过您的培根？或者，由于同事的好奇心，看到一项简单的任务突然变得威胁到工作的比例？通过电子邮件向我发送电子邮件，分享您的险些失手和险些命中的故事？</p><p>The Register-独立于科技界的新闻和观点。情况发布的一部分</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.theregister.com/2020/07/06/who_me/">https://www.theregister.com/2020/07/06/who_me/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/文件/">#文件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/file/">#file</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1009178.html"><img src="http://img.diglog.com/img/2020/7/thumb_8e522c3119aaaafcd96d0d2f4b046912.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009178.html">新的Mac勒索软件通过盗版传播</a></div><span class="my_story_list_date">2020-7-1 6:37</span></div><div class="col-sm"><div><a target="_blank" href="/story/1008779.html"><img src="http://img.diglog.com/img/2020/6/thumb_1ff4cd858ac0b98e999e94769966f47a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1008779.html">微软新的“Windows文件恢复”工具可恢复已删除的数据</a></div><span class="my_story_list_date">2020-6-29 4:50</span></div><div class="col-sm"><div><a target="_blank" href="/story/1008152.html"><img src="http://img.diglog.com/img/2020/6/thumb_f591be31de31e30349fec0ae2450c88e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1008152.html">来自200多个美国警察机构的数百万份文件发布在“蓝色泄密”宝库</a></div><span class="my_story_list_date">2020-6-25 18:59</span></div><div class="col-sm"><div><a target="_blank" href="/story/1007999.html"><img src="http://img.diglog.com/img/2020/6/thumb_43951e80d2c309ceba6596bd8ca3dfba.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007999.html">法院规定，警察强行解锁手机是违宪的</a></div><span class="my_story_list_date">2020-6-25 2:18</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>