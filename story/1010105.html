<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>约293个中间CA将在7天内被撤销</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">约293个中间CA将在7天内被撤销</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-06 20:20:38</div><div class="page_narrow text-break page_content"><p>我已经创建了一批新的证书，这些证书违反了BRS的4.9.9，这是在ASA必须满足的基准要求的第一个版本中引入的。这是https://misissued.com/batch/138/。</p><p>在受影响的CA中快速检查包括以下O个字段：Quovadis、GlobalSign、Digicert、HARICA、Certinomis、AS Sertifitseimiskeykus、Actalis、ATOS、AC Camerfirma、SECOM、T-Systems、WISeKey、SCEE和CNNIC。BRS第4.9.9节要求OCSP委派响应器MUST包括id-pkix-ocsp-nocheck扩展。RFC 6960在第4.2.2.2节中定义了OCSP委派响应器，id-KP-OCSPSigning作为EKU的存在表明了这一点。这些证书缺少必要的扩展，因此违反了BRS。由于绝大多数证书是在2013-02-01(Mozilla Root CA Policy v2.1生效日期)或之后发布的，因此这些证书未被起诉。您也可以考虑生效日期为2013-05-15(稍后在[1]中描述)，而不更改结果。此批次并不全面。根据crt.sh的数据，大约有293个证书符合&#34；的标准，这些证书是由受信任的、支持TLS的CA颁发的，带有OCSPSigning EKU，没有pkix-nocheck&34；。由于其他不符合标准，misissued.com在解析某些证书时遇到了一些问题，因此我只包含了一个样本。Censys.io知道大约有276个证书符合此标准，如您在[2]中所见。观点上的差异突出了CA需要仔细检查他们颁发的证书以了解的重要性。CA理解这与安全相关非常重要。根据基线要求第4.9.1.2节的定义，他们应在七(7)天内撤销这些CA，但此问题的严重程度也证明需要见证的密钥销毁报告是合理的，以便维护这些证书颁发者(可能包括CA的根)的完整性。原因很简单：在我检查的每个案例中，这些证书名义上似乎旨在颁发CA，而不是OCSP响应者证书。似乎许多CA在构建其证书配置文件时并不熟悉RFC 6960，并且在过去[3]中类似地忽略了对此问题的讨论，这突出了此问题的安全影响。我已经将此标记为CA需要仔细检查的安全问题，因为在除颁发CA之外的第三方操作此类证书的情况下，颁发CA已将生成任意ocsp响应的能力委托给该第三方！例如，考虑一下像https://crt.sh/?id=2657658699这样的证书。此证书来自HARICA，在技术上符合Mozilla对TLS的约束定义，因为它缺少id-kp。但是，因为它包括OCSP签名EKU，所以此证书可用于为HARICA的Root！签名任意OCSP消息！这也适用于不受技术约束的子CA。例如，考虑此证书https://crt.sh/?id=21606064。它是由DigiCert颁发给微软的，授予微软为Digicert的巴尔的摩CyberTrustRoot颁发的任何证书提供OCSP响应的能力。我们从DigiCert披露的信息中得知，该证书是由微软独立运行的。不幸的是，吊销该证书根本不足以保护Mozilla TLS用户。这是因为该子CA可以为自己提供成功验证的OCSP，并为其他已撤销的子CA提供OCSP，即使它已被撤销。也就是说，如果此子CA的密钥被恶意用来为自己签署良好的响应，它将被接受。这些安全问题在RFC 6960的4.2.2.2.1节中进行了讨论，并且与对CRL的依赖有关。Mozilla用户可以通过使用OneCRL得到保护，尽管这不会保护其他PKI参与者或不使用OneCRL的用例。略多于三分之一的受影响证书已经被吊销，这是令人鼓舞的。但是，我不知道有任何事件报告讨论此故障，也没有任何密钥破坏报告来保证这些密钥不会被恶意使用。虽然这看起来像是我们使用了错误的配置文件的良性故障，但它对最终用户造成了重大的安全影响，即使它是出于善意。这从第一个版本开始就是BRS的一项要求，并在OCSP RFC和CA中进行了详细说明。这样的疏忽是不可原谅的，特别是如果它是(最有可能的)解决某个特定CA软件供应商的产品的问题。回想一下，同样的理由(解决供应商产品中的一个问题)已经被用来证明MITM拦截是正当的。不幸的是，无知和恶意往往难以区分，因此必须一视同仁。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.mail-archive.com/dev-security-policy@lists.mozilla.org/msg13493.html">https://www.mail-archive.com/dev-security-policy@lists.mozilla.org/msg13493.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ca/">#ca</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/cas/">#cas</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/证书/">#证书</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>