<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Elasticsearch的新功能：2020年回顾 Elasticsearch new features: 2020 year in review</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Elasticsearch new features: 2020 year in review<br/>Elasticsearch的新功能：2020年回顾 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-01 08:55:37</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/1/1ba34dbb1895d1321584bcab73c0ae04.png"><img src="http://img2.diglog.com/img/2021/1/1ba34dbb1895d1321584bcab73c0ae04.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Now that 2020 is (finally!) over, we highlight the changes and additions Elasticsearch received during the year, that we believe could make a big difference to you - a developer working with Elasticsearch.</p><p>既然2020年（最终！）结束了，我们重点介绍一下Elasticsearch在这一年中收到的更改和增加，我们相信这可能对您-与Elasticsearch合作的开发人员产生很大的影响。</p><p>  What a year 2020 has been! Social distancing and a lot of very weird situations. For some it was a year full of difficulties, and hopefully a lot of growth and some good things too.</p><p>  2020年真是太好了！社会疏远和很多非常奇怪的情况。对于有些人来说，这是充满困难的一年，希望它有很多成长和一些美好的事物。</p><p> It has definitely been an interesting year for Elasticsearch. Many things happened, new features added and the product evolved significantly. We wanted to recap and share highlights of new features and usage recommendation. This post is about the things we consider as big changes, and important steps forward, based on our experience and what we see as important while actively working with hundreds of customers on Elasticsearch clusters of all shapes and sizes, from full-text search to log analytics and anomaly detection.</p><p> 对于Elasticsearch来说，绝对是有趣的一年。发生了很多事情，添加了新功能，并且产品发生了重大变化。我们想回顾并分享新功能和使用推荐的重点。这篇文章基于我们的经验以及我们认为重要的事情，讨论了我们认为是重大变化的事情以及向前迈出的重要步骤，同时积极与数百名客户合作，研究各种形状和大小的Elasticsearch集群，从全文搜索到日志分析和异常检测。</p><p> As always, upgrading to a more recent Elasticsearch version will grant you significant performance boosts, depending on your usage. This year as well, Elasticsearch has seen many performance and memory optimizations, most notably in the 7.8 and 7.9 releases. Those are too many and too low-level to list in detail here, so we won&#39;t.</p><p> 与往常一样，升级到最新的Elasticsearch版本会根据您的使用情况显着提高性能。同样在今年，Elasticsearch看到了许多性能和内存优化，最著名的是7.8和7.9版本。这些太多了，而且级别太低，无法在此处详细列出，因此我们不会。</p><p> In this post we will focus on high-level technical details that we believe could make a big difference to you - a developer working with Elasticsearch. For the sake of brevity, we will only highlight, and give you links for further investigation.</p><p> 在这篇文章中，我们将重点介绍我们认为可能对您产生重大影响的高级技术细节-与Elasticsearch合作的开发人员。为了简洁起见，我们仅突出显示并为您提供链接以供进一步研究。</p><p> One important note about licensing, before we start: recently, many new features are added under the X-Pack license, and not as part of the open-source product. Most are indeed free (X-Pack Basic) but some require a paid subscription license. In this post, we are focusing on the features that we believe are important to know about, and will be useful to you - but are still in the free tier and usable without purchasing a license.</p><p> 在开始之前，有关许可的重要说明：最近，许多新功能是在X-Pack许可下添加的，而不是作为开源产品的一部分。多数确实是免费的（X-Pack Basic），但有些需要付费订阅许可证。在这篇文章中，我们将重点介绍我们认为重要的，对您有用的功能，但是这些功能仍然是免费的，无需购买许可证即可使用。</p><p>   There are three ways to page through search results (aka &#34;do paging&#34;) in Elasticsearch: from/size, scroll, and search_after.  Each has it&#39;s downsides (slowness, instability of result sets, the requirement to sort on a field, and so on).  In recent Elasticsearch versions a new API was added, namely the  PIT (Point in Time) API . Essentially, it is a lightweight version of the scroll API and is meant to replace it, making deep paging possible and more efficient but still some limitations remain.</p><p>   在Elasticsearch中，可以通过三种方式分页搜索结果（又名“分页”）：from / size，scroll和search_after。每个都有其缺点（缓慢，结果集的不稳定性，在字段上排序的要求等）。在最新的Elasticsearch版本中，添加了新的API，即PIT（时间点）API。本质上，它是滚动API的轻量级版本，旨在替代它，从而可以进行深度分页并提高效率，但仍然存在一些限制。 </p><p> Our recommendation is to still not  over-use it - and in general avoid deep paging with Elasticsearch. But when you do need to scroll, e.g. for copying data to external jobs and so on - prefer the new PIT API over the (now discouraged) scroll API.  A good summary and discussion are in the  official documentation for the PIT API .</p><p>我们的建议是仍然不要过度使用它-通常避免使用Elasticsearch进行深度分页。但是当您确实需要滚动时，例如用于将数据复制到外部作业等-与（现在不建议使用）滚动API相比，首选新的PIT API。 PIT API的官方文档中有一个很好的摘要和讨论。</p><p>  In 2020 Elastic has moved off the premise of having many beats (Filebeat, Packetbeat, Metricbeat and so on), to supporting a single data collection agent that can deliver all that functionality. Under the hood the Elastic Agent runs all the beats, but it&#39;s going to be easier to deploy and manage the unified Elastic Agent. Also new is the option of managing them through  Fleet, and a centralized Ingest Manager in Kibana.  Read more here.</p><p>  在2020年，Elastic已经摆脱了许多节拍（Filebeat，Packetbeat，Metricbeat等）的前提，转而支持可以提供所有功能的单个数据收集代理。尽管Elastic Agent发挥了全部作用，但是部署和管理统一的Elastic Agent会变得更加容易。还可以通过Fleet和在Kibana中的集中式摄取管理器进行管理。在这里阅读更多。</p><p>  In essence,  Data Streams is just an improved API and a better user-experience for using the  Rollover API for partitioning data into more indexes. In the last couple of years we stopped using shards and moved to index-level sharding - essentially partitioning the data to different indexes, and the new Data Streams API plays an important role in making your clusters more efficient and more stable.</p><p>  从本质上讲，Data Streams只是一个改进的API，并且使用Rollover API将数据分区到更多索引中时，它具有更好的用户体验。在过去的两年中，我们停止使用分片，而转而使用索引级分片-实际上是将数据分区到不同的索引，而新的Data Streams API在使集群更高效，更稳定方面起着重要作用。</p><p>     Composable index templates were introduced in Elasticsearch 7.8, and are in fact a results of a  4-year long discussion started in 2016. With composable index templates you finally get a fine-grained control over how templates are built and applied,  see the docs for a comprehensive discussion and example.</p><p>     可组合索引模板是在Elasticsearch 7.8中引入的，实际上是2016年开始的为期4年的讨论的结果。有了可组合索引模板，您最终可以对模板的构建和应用方式进行细粒度的控制，请参阅参考资料。全面的讨论和示例。</p><p>   The Transform APIs became GA since 7.7, and in their core they are essentially a managed ETL process run by Elasticsearch within the Elasticsearch cluster, to copy and transform data from one index to another.</p><p>   Transform API从7.7开始成为GA，从本质上讲，它们是由Elasticsearch集群内的Elasticsearch运行的托管ETL流程，用于将数据从一个索引复制和转换到另一个索引。</p><p> This allows for compacting (&#34;roll up&#34;), executing self-joins on write (e.g. folding events into a session), enriching and cleaning up data from the ingest layer into indexes that will serve the serving layer.  See the docs here.</p><p> 这允许压缩（＆＃34;汇总＆＃34;），在写入时执行自联接（例如，将事件折叠到会话中），从摄取层将数据丰富和清理为将为服务层提供服务的索引。请参阅此处的文档。</p><p> Our recommendation is to keep using dedicated ETL tools for any real-world or heavy use-cases, and to only use the Transforms API for minor use-cases, or during development. We usually prefer running ETLs with tools that were built to do it - like Flink, Airflow, Nifi and such, as they provide significantly better development experience, ability to debug, write testable code, and much more predictable and manageable  ETL processes.</p><p> 我们的建议是继续将专用的ETL工具用于任何实际或繁重的用例，并且仅将Transforms API用于次要用例或在开发过程中。我们通常更喜欢使用Flink，Airflow，Nifi等内置工具来运行ETL，因为它们提供了显着更好的开发经验，调试，编写可测试代码的能力以及更可预测和可管理的ETL流程。 </p><p>  The async search API lets you asynchronously execute a search request, monitor its progress, and retrieve partial results as they become available. It was introduced in Elasticsearch 7.7, and is designed to support more responsive search experience.  See the docs here.</p><p>异步搜索API使您可以异步执行搜索请求，监视其进度以及在部分结果可用时检索部分结果。它是在Elasticsearch 7.7中引入的，旨在支持更快速的搜索体验。请参阅此处的文档。</p><p>  Geo-spatial search got a lot of love in 2020, most notably by making  geo-shapes BKD-backed in Elasticsearch , which translates  to significant precision, efficiency and speed gains. This also allowed to add more geo-types, queries and aggregations.</p><p>  地理空间搜索在2020年备受青睐，最显着的是在Elasticsearch中制作了BKD支持的地理形状，这转化为显着的精度，效率和速度提升。这还允许添加更多的地理类型，查询和聚合。</p><p>  *  Histogram  - A field to store pre-aggregated numerical data representing a histogram. This data is defined using two paired arrays - values and counts.</p><p>  *直方图-用于存储表示直方图的预聚合数值数据的字段。使用两个成对的数组（值和计数）定义此数据。</p><p> *  Constant keyword data type -  Constant keyword is a specialization of the keyword field for the case that all documents in the index have the same value.</p><p> *常量关键字数据类型-对于索引中所有文档具有相同值的情况，常量关键字是关键字字段的一种特殊形式。</p><p> * Arbitrary  Shape and Point data types - The shape data type facilitates the indexing of and searching with arbitrary x, y Cartesian  shapes such as rectangles and polygons. It can be used to index and query geometries whose coordinates fall in a 2-dimensional planar coordinate system.</p><p> *任意形状和点数据类型-形状数据类型便于索引和搜索任意x，y笛卡尔形状（例如矩形和多边形）。它可用于索引和查询其坐标属于二维平面坐标系的几何。</p><p> *  Wildcard field  - A wildcard field stores values optimized  for wildcard grep-like queries. Wildcard queries are possible on other field types but are usually slower and has analysis limitation (case sensitivity and others). The Wildcard field is an important addition - it finally allows a case insensitive wildcard search, and when used in conjunction with the  search_as_you_type field type it allows to provide great search experiences.</p><p> *通配符字段-通配符字段存储针对类似通配符grep的查询优化的值。在其他字段类型上也可以使用通配符查询，但是通配符查询通常速度较慢并且具有分析限制（区分大小写和其他）。通配符字段是重要的补充-它最终允许不区分大小写的通配符搜索，并且当与search_as_you_type字段类型结合使用时，它可以提供出色的搜索体验。</p><p>  *  Histogram Aggregation - A multi-bucket values source based aggregation that can be applied on numeric values or numeric range values extracted from the documents *  Normalize Aggregation - A parent pipeline aggregation which calculates the specific normalized/rescaled value for a specific bucket value.   *  Moving Percentiles Aggregation - Given an ordered series of percentiles, the Moving Percentile aggregation will slide a window across those percentiles and allow the user to compute the cumulative percentile.   *  Moving Function Aggregation - Given an ordered series of data, the Moving Function aggregation will slide a window across the data and allow the user to specify a custom script that is executed on each window of data.   *  Pipeline inference aggregation - A parent pipeline aggregation which loads a pre-trained model and performs inference on the collated result fields from the parent bucket aggregation.   *  T-test aggregation - A new aggregation that will tell you if the difference between two population means are statistically significant and did not occur by chance alone.   *  Box plot aggregation - The boxplot aggregation returns essential information for making a  box plot: minimum, maximum, median, first quartile (25th percentile) and third quartile (75th percentile) values.</p><p>  *直方图聚合-基于多存储桶值源的聚合，可应用于从文档中提取的数值或数字范围值*归一化聚合-父管道聚合，用于计算特定存储桶值的特定归一化/重新缩放值。 *移动百分位数聚合-给定一系列有序百分位数，移动百分位数聚合将在这些百分位数之间滑动一个窗口，并允许用户计算累积百分位数。 *移动功能聚合-给定一系列有序数据，移动功能聚合将在数据上滑动一个窗口，并允许用户指定在每个数据窗口上执行的自定义脚本。 *管道推断聚合-父管道聚合，它加载了预先训练的模型，并根据父存储桶聚合中的整理结果字段进行推断。 * T检验汇总-一种新的汇总，它将告诉您两种总体均值之间的差异是否在统计上显着并且不是偶然发生的。 *箱形图聚合-箱形图聚合返回制作箱形图的基本信息：最小值，最大值，中位数，第一个四分位数（第25个百分位数）和第三个四分位数（第75个百分位数）值。 </p><p>  The  Event Query Language (EQL) is a query language for event-based time series data, such as logs, metrics, and traces. It&#39;s a new query language that was recently added to Elasticsearch, mostly aimed for SIEM users but not only. It joins the traditional Lucene query syntax and Elasticsearch JSON queries, and also the SQL support and Kuery - the Kibana query language.  Full docs here.</p><p>事件查询语言（EQL）是用于基于事件的时间序列数据（例如日志，指标和跟踪）的查询语言。它是一种新的查询语言，最近已添加到Elasticsearch中，主要针对SIEM用户，但不仅限于此。它加入了传统的Lucene查询语法和Elasticsearch JSON查询，还加入了SQL支持和Kuery（Kibana查询语言）。完整的文档在这里。</p><p>  For years Kibana was about creating simple visualizations that can be added as components to a dashboard, and only recently they started adding additional capabilities like Timelion, Visual Time Series Builder and Vega. Lens is the most recent addition, with the purpose of simplifying building dashboards even further.</p><p>  多年来，Kibana一直致力于创建可作为组件添加到仪表板的简单可视化，直到最近，他们才开始添加其他功能，例如Timelion，Visual Time Series Builder和Vega。 Lens是最新添加的，目的是进一步简化构建仪表板的目的。</p><p> Lens is the easiest and most intuitive way to visualize data in Elasticsearch with a simple drag-and-drop interface that lets anyone instantly begin exploring data for insights, regardless of their previous Kibana experience, which we think is a great new addition that will allow reducing the barrier of entry for new users beginning with Kibana.</p><p> Lens是通过简单的拖放界面在Elasticsearch中可视化数据的最简单，最直观的方式，无论以前的Kibana经验如何，任何人都可以立即开始探索数据以获取见解，我们认为这是一个很棒的新功能，它将允许从Kibana开始降低了新用户的进入门槛。</p><p>  For a very long while, the Elastic Stack lacked support for alerting. There was Watcher , which still exists, but it always was very limited and not trivial to use. It did start receiving a lot of improvements in the last 2 years or so, and very much so in 2020 when Alerting has become more streamlined all throughout Kibana. In 2020, a lot of features were added that help creating alerts, and good alerts, from pretty much everywhere in Kibana. However, most of the new Alerting features are on the premium (paid) tiers, and still has a lot missing for it.</p><p>  很长时间以来，Elastic Stack缺乏警报支持。有Watcher，它仍然存在，但是它总是非常有限并且使用起来并不琐碎。在过去的两年左右的时间里，它开始获得很多改进，而在2020年，整个Kibana的Alerting变得更加精简时，它就开始获得很大的进步。 2020年，添加了许多功能，可帮助从Kibana的几乎所有地方创建警报和良好警报。但是，大多数新的警报功能都在高级（付费）层上，仍然缺少很多功能。</p><p> This is good progress, but we still think there is a lot to go. A couple of months ago we reviewed all the possibilities to enable alerting on top of Elasticsearch  in a webinar, and this content is still relevant today as well:</p><p> 这是一个很好的进展，但是我们仍然认为还有很多事情要做。几个月前，我们在网络研讨会上回顾了在Elasticsearch上启用警报的所有可能性，并且今天该内容仍然适用：</p><p>   Our team is the most experienced Elasticsearch consultants out there. Find out if your cluster is fully optimized for spend, stability, and performance.  Contact us for a quick, complementary review at info@bigdataboutique.com.</p><p>   我们的团队是经验最丰富的Elasticsearch顾问。了解您的集群是否针对支出，稳定性和性能进行了完全优化。请通过info@bigdataboutique.com与我们联系，以进行快速补充评论。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.bigdataboutique.com/2020/12/elasticsearch-new-features-2020-year-in-review-g5wyqy">https://blog.bigdataboutique.com/2020/12/elasticsearch-new-features-2020-year-in-review-g5wyqy</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/2020/">#2020</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>