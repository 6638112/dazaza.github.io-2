<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>主机防火墙（2020年）Host Firewalls (2020)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Host Firewalls (2020)<br/>主机防火墙（2020年）</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-24 21:57:29</div><div class="page_narrow text-break page_content"><p>If you work in some kind of computer or IT industry, when you hear firewallyou probably think mostly about network firewalls, the 1U or so appliances thatyou install in between your delicate assets and the internet. These arego-between devices, they receive somebody else&#39;s packets and decide whether ornot to pass them on based on inscrutable rules that you have to file a ticketto get changed.</p><p>如果你在某种计算机或IT行业工作，当你听到防火墙时，你可能会想到的主要是网络防火墙，即安装在你脆弱的资产和互联网之间的1U左右的设备。这些是介于设备之间的，它们接收其他人#39；根据你必须提交一张票证才能更改的难以捉摸的规则来决定是否传递它们。</p><p> But there&#39;s also a different world of firewalls, host-based firewalls that rundirectly on your various computers. Linux has iptables, BSD has pf, Windows hasWindows Defender Firewall with Advanced Security, apparently. No one evercommended Microsoft on their product naming. But there&#39;s more or less a hostfirewall present by default on all the major operating systems, just a wholelot of people ignore it. For Linux, historically, if you ignored it it wasusually wide open with zero rules, although some distros are switching tohaving restrictive rules by default. In Windows, by default, there&#39;s a wholelot of rules and which ones are active depends on whether you tell it a networkis &#34;private&#34; or &#34;public.&#34; In a lot of cases, it&#39;s still pretty wide open.</p><p>但是有&#39；这也是一个不同的防火墙世界，基于主机的防火墙直接在各种计算机上运行。Linux有iptables，BSD有pf，Windows有Windows Defender防火墙，显然具有高级安全性。从来没有人在产品命名上称赞过微软。但是有&#39；默认情况下，所有主要操作系统上或多或少都存在一个主机防火墙，只是有一大群人忽略了它。对于Linux，历史上，如果你忽略它，它通常是完全开放的，没有规则，尽管一些发行版在默认情况下会切换到有限制的规则。默认情况下，Windows中有&#39；这是一整套规则，哪些规则是有效的取决于你是否告诉它一个网络是&#34；私人&#34；或&#34；公众&#34; 在很多情况下，它&#39；它仍然非常开放。</p><p> There&#39;s also sort of another kind of host firewall, the Norton Defender McAfeeMalwareBytes by Symantec kind. These mostly went out of fashion in the 2000sbecause they were, frankly, irritating as shit. But there was some value inthem, value which has been largely forgotten outside of a few particularuser communities.</p><p>那里&#39；它也有点像另一种主机防火墙，赛门铁克kind的Norton Defender McAfeeMalwareBytes。这些大多在2000年过时了，因为坦率地说，它们非常恼人。但它也有一些价值，这些价值在少数特定群体之外基本上被遗忘了。</p><p> The great thing about a host firewall, the thing that really makes it apowerful tool that can do things that your Third-Generation Smart Firewall inthe network rack can&#39;t, is something of a secret weapon: a host firewall canmake decisions based on not just the packet  but the process that sent or willreceive it.</p><p>主机防火墙的伟大之处在于，它是一个强大的工具，可以实现网络机架上的第三代智能防火墙所能做到的事情&#39；t、 是一种秘密武器：主机防火墙不仅可以根据数据包，还可以根据发送或接收数据包的进程来做出决定。</p><p> This kind of thing is not news to a Windows admin. The Windows firewall, theway the management interface is built, more or less views the sending/receivingprocess as the  primary information used in making a decision. TCP, UDP, ports,subnets, those are all fiddly technical considerations, secondary to theimportant part: what process is responsible?</p><p>对于Windows管理员来说，这种事情并不新鲜。Windows防火墙，即管理界面的构建方式，或多或少地将发送/接收过程视为决策中使用的主要信息。TCP、UDP、端口、子网，这些都是微妙的技术考虑，其次是重要的部分：负责什么进程？</p><p> This sounds stranger to most Linux users... It&#39;s not that Linux doesn&#39;t have thiscapability. The iptables module &#34;owner&#34; allows you to match based on theprocess, uid, gid that generated the packet and has been shipped with everyLinux distro I&#39;ve tried it on. It&#39;s a little more complicated to write rulesbased on what process will  receive packets (i.e. is listening) because theunderlying plumbing for that is complicated. It&#39;s doable, you&#39;ll just have toget your hands a bit dirty. But, honestly, this use-case is a lot less common.Processes that are listening are (usually) listening on fixed ports, we(usually) restrict or permit access to them based on port numbers.</p><p>对于大多数Linux用户来说，这听起来很陌生。。。它&#39；并不是说Linux没有&#39；我没有这种能力。iptables模块&#34；所有者&#34；允许您根据生成数据包并随everyLinux发行版I&#39一起提供的进程、uid、gid进行匹配；我试过了。它&#39；根据什么进程将接收数据包（即正在监听）编写规则要复杂一些，因为这方面的基础管道比较复杂。它&#39；这是可行的，你&#39；我得把你的手弄脏一点。但是，老实说，这个用例不太常见。正在侦听的进程（通常）在固定端口上侦听，我们（通常）根据端口号限制或允许对它们的访问。</p><p> Yet you don&#39;t see this used very often on Linux at all. Anecdotally, a lot ofpeople don&#39;t even know that it&#39;s possible. It&#39;s not that they thought &#34;match onoriginating pid&#34; was something that iptables  couldn&#39;t do, but rather, theyhad never even conceived it as something they might want to do, because mostLinux users and administrators are thoroughly steeped in a network-centric viewof firewalls as devices that think in addresses and ports, not process tablesYet iptables is right there, in the kernel, next to the process table.</p><p>然而你没有&#39；这在Linux上根本看不到经常使用。有趣的是，很多人不&#39；我甚至不知道它&#39；这是可能的。它&#39；这不是他们想的&#34；匹配原始pid和#34；是iptables无法&#39；但是，他们甚至从来没有想过这是他们可能想做的事情，因为大多数Linux用户和管理员完全沉浸在以网络为中心的观点中，将防火墙视为考虑地址和端口的设备，而不是进程表。然而，iptables就在内核中进程表的旁边。</p><p>  That takes us back to those fiddly commercial firewalls for Windows that naggedthe user every time they clicked on anything. Really, this functionality isstill there, built into the Windows Defender Firewall with Advanced Security,but Microsoft has tuned it to be a lot less (but still somewhat) maddening.Sometimes when you launch a program you get a prompt, &#34;Allow this program tocommunicate on the network?&#34;</p><p>这让我们回到了那些为Windows设计的精致的商业防火墙，每当用户点击任何东西时，它都会让用户感到不安。实际上，这个功能仍然存在，内置在Windows Defender防火墙中，具有高级安全性，但微软已经将其调整为不那么（但仍然有点）令人恼火。有时候，当你启动一个程序时，你会得到一个提示，&#34；允许此程序在网络上通信吗&#34;</p><p> What&#39;s really going on here is that, due to ephemeral ports, a conventionalfirewall policy view based on ports and addresses is unsuitable for the controlof outbound connections. Sure, you can use conventional firewall policy torestrict outbound connections, but the semantics of the situation end up ratherbadly divorced from how the user thinks about the problem. I would like Firefoxto be able to use http(s) to speak to just about anything. I would not like thesketchy native configuration utility for this whiteboxed IP camera to be ableto speak to anything  but the camera, which it does over http(s). How do wewrite conventional firewall policy for this? Not especially easily, theoutbound traffic all looks the same. As a user, I think about the problem interms of processes, not ports. And hey, that&#39;s what a host firewall can do, ifwe use it that way.</p><p>什么&#39；这里真正的情况是，由于端口短暂，基于端口和地址的传统防火墙策略视图不适合控制出站连接。当然，您可以使用传统的防火墙策略来限制出站连接，但这种情况的语义最终与用户对问题的看法完全脱节。我希望Firefox能够使用http（s）与任何东西进行对话。我不希望这个白盒IP摄像头的Kitchy本机配置实用程序能够与摄像头之外的任何东西通话，而摄像头是通过http（s）实现的。我们如何为此编写传统的防火墙策略？不太容易，所有的出界交通看起来都一样。作为一个用户，我考虑的问题是进程，而不是端口。嘿，那&#39；这就是主机防火墙可以做的，如果我们这样使用它的话。</p><p> Conceptually, the root of the idea of process-based host firewall policy comeslargely from a desire to deter malware, botnets, etc, by requiring that anadministrator allow them to generate network traffic. This leaves malware whichinstalls itself in a covert way more or less neutered. But it doesn&#39;t quitework out in practice, for a dozen reasons, many of which you can probablyreadily imagine.</p><p>从概念上讲，基于进程的主机防火墙策略思想的根源主要来自于阻止恶意软件、僵尸网络等的愿望，要求管理员允许它们生成网络流量。这使得恶意软件以一种隐蔽的方式或多或少地被阉割。但它没有&#39；我不会在实践中放弃工作，原因有十几个，其中许多你可能很容易想象。</p><p> I would argue, though, that despite this concept&#39;s many shortcomings it is morerelevant today than it ever has been, due to reasons of privacy rather than ofoutright malware. With a large number of applications trying to phone home withtelemetry and at re-targeting tips, to no real benefit to the user, it seemsvery attractive to &#34;put the power in the user&#39;s hands&#34; to decide whichapplications are allowed to communicate on the network, and to whom, at asystem policy level. This was the idea of Comodo Firewall&#39;s eighteen promptsper minute. It is still the idea behind the Windows firewall&#39;s rare prompts,but presumably in search of some kind of usability balance Microsoft hasradically reduced the level of granularity at which the user gets involved (tomore or less a one-time nothing or everything prompt per application).</p><p>不过，我认为，尽管有这个概念#39；它的许多缺点在今天比以往任何时候都更加重要，这是由于隐私而非版权恶意软件的原因。大量应用程序试图通过遥测和重新定位提示给家里打电话，但对用户没有实际好处，这似乎对&#34；将电源输入用户&#39；s的手&#34；决定允许哪些应用程序在网络上通信，以及在系统策略级别与谁通信。这就是科摩多防火墙的想法#39；现在是18分钟。这仍然是Windows防火墙背后的想法#39；微软很少有提示，但可能是为了寻求某种可用性平衡，微软已经从根本上降低了用户参与的粒度级别（每个应用程序都会出现一次性的nothing或everything提示）。</p><p> While this kind of user-interactive process-aware outbound host firewall islargely derided by the tech community, due mostly to the missteps of the late2000s, the rather dedicated fan-base of the OS X user-interactive host firewallproduct Little Snitch would seem to show that there is still a purpose thesetools serve. NetGuard provides a similar solution for Android, although becauseAndroid exposes no network policy capability at all to userspace it makes useof a VPN shim. They just need the user interaction worked out so that theydon&#39;t annoy the ever-living daylight out of typical users.</p><p>虽然这种用户交互进程感知的出站主机防火墙受到技术界的极大嘲笑，主要是由于21世纪末的失误，但OS X用户交互主机防火墙产品Little Snitch的忠实粉丝似乎表明，这些工具仍然有其服务的目的。NetGuard为Android提供了一个类似的解决方案，不过因为Android完全不向用户空间公开网络策略功能，所以它使用VPN垫片。他们只需要进行用户交互，这样他们就可以&#39；Don’不要打扰典型用户的日常生活。</p><p> Really, what we are talking about is this: what if, when Zoom sent telemetry toFacebook without your authorization or knowledge apparently because they usedsome library and didn&#39;t realize it did that, your host firewall  told you thatthis random application was shipping your most personal secrets directly toMark Zuckerburg and, even better, prevented it doing so until you consideredthe question?</p><p>真的，我们要说的是：如果Zoom在没有你的授权或知情的情况下将遥测数据发送到Facebook，显然是因为他们使用了一些库，而没有&#39；我没意识到这一点，你的主机防火墙告诉你，这个随机应用程序将你的大部分个人秘密直接发送到马克·扎克伯格，更好的是，在你考虑这个问题之前，它阻止了你这么做？</p><p> It almost sounds futuristic in the privacy sense, yet we were doing this in2008 with free security software that had &#34;pirate voice&#34; notifications as ameaningful selling point... users didn&#39;t understand this, though. They didn&#39;treally get the right information. They didn&#39;t feel in control. They were justannoyed.</p><p>从隐私的角度来看，这听起来几乎是未来主义的，但我们在2008年用的是免费安全软件，它有&#34；海盗之声&#34；通知是一个有意义的卖点。。。用户没有&#39；但我不明白这一点。他们没有&#39；真正得到正确的信息。他们没有&#39；我无法控制自己。他们只是很生气。</p><p> Because of the traditional plumbing of the Linux IP stack, it&#39;s very difficultto develop tools like this for Linux since they end up needing their own policysolution to handle the fact that users must be privileged (i.e. root) to editiptables, but users need to restricted to managing rules for their ownprocesses... the Linux world has not traditionally had a good, standardsolution to that problem. I have a great deal of ire for firewalld (what is upwith firewallctl vs. firewall-cmd, it is absolutely insane), but I must give itthe credit that one of the explicit goals of firewalld is to enable this kindof user-interactive network policy by providing a dbus interface and playingnice with recent administrative policy frameworks. I have not personally seen areal implementation of the concept for Linux yet, but it seems like thebuilding blocks are there (or at least more than they have been in the past) soperhaps something will come about.</p><p>由于Linux IP堆栈的传统管道，它&#39；为Linux开发这样的工具非常困难，因为他们最终需要自己的策略解决方案来处理这样一个事实：用户必须拥有编辑表的特权（即root权限），但用户需要仅限于管理自己进程的规则。。。传统上，Linux世界并没有一个好的、标准的解决方案来解决这个问题。我对firewalld非常愤怒（firewallctl与firewall cmd的对比，这绝对是疯狂的），但我必须承认firewalld的明确目标之一是通过提供dbus接口和最近的管理策略框架来实现这种用户交互网络策略。我个人还没有看到Linux概念的真正实现，但似乎构建块已经存在（或者至少比过去更多），预示着事情会发生。</p><p> Of course, host firewalls can also be used to restrict inbound traffic and mostpeople think about them as being first for that purpose. I feel that hostfirewalls are generally a worse solution to this problem than a networkfirewall (presents more resistance to someone who gains control of the machine)and just being careful about what&#39;s listening in the first place (as Dave Barrysaid, people get so fixated on caulking all the little gaps around the door tokeep the cold out that they forget about the big hole right in the middle). Butof course host firewalls can absolutely be useful to restrict inbound trafficas a defense-in-depth measure. Belt and suspenders and, um, tape, and all.</p><p>当然，主机防火墙也可以用来限制入站流量，大多数人认为它们是实现这一目的的首选。我觉得HostFirewall通常比networkfirewall（对控制机器的人有更大的阻力）更难解决这个问题，只是要小心什么&#39；Dave Barrysaid说，人们太专注于堵住门周围所有的小缝隙来抵御寒冷，以至于忘记了门中间的大洞。当然，作为一种纵深防御措施，主机防火墙在限制入站流量方面绝对有用。皮带，吊带，胶带等等。</p><p> There seems to be a bit of a philosophical divide here. Windows listens on somany ports for so many things that Microsoft ships it with a restrictivelyconfigured host firewall by default (at least in the &#34;public&#34; network context).The major problem tends to be people choosing the wrong network context orinstalling third-party software that listens in ways it probably shouldn&#39;t. Onthe other hand, Linux users are more prone to watch their &#34;netstat&#34; for what&#39;slistening and kill or reconfigure anything they aren&#39;t happy with.Correspondingly, until fairly recently almost no Linux distributions had anyiptables restrictions in inbound traffic at all. Many still don&#39;t. The majorproblem tends to be people who install software that listens on 0.0.0.0 bydefault with no authentication and then just leaving it that way because that&#39;scloudscale. Either way, the problem would be greatly mitigated by adopting theother platform&#39;s approach as well.</p><p>这里似乎有一点哲学上的分歧。Windows在许多端口上监听如此多的内容，以至于微软在默认情况下（至少在&#34；公共&#34；网络环境下）会为其提供一个受限配置的主机防火墙。主要的问题往往是人们选择了错误的网络环境，或者安装了第三方软件，而第三方软件的监听方式可能不应该是&#39；t、 另一方面，Linux用户更倾向于观看他们的&#34；netstat&#34；为了什么&#39；滑动、杀死或重新配置任何它们不是的东西&#39；我对你的工作不满意。相应地，直到最近，几乎没有Linux发行版对入站流量有任何iptables限制。许多人仍然没有&#39；t、 主要的问题往往是那些安装默认监听0.0.0.0的软件而不进行身份验证的人，然后就这样离开了，因为&#39；斯卢德斯卡尔。无论哪种方式，通过采用另一个平台#39；这也是我们的方法。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/2020/">#2020</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/防火墙/">#防火墙</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/host/">#host</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1072775.html"><img src="http://img2.diglog.com/img/2022/2/thumb_4b5d5833c29dc1b8594cfdb3b29bd0fe.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072775.html">谷歌表示，它的Bug赏金计划在2021个国家从62个国家支付了8.7亿美元，从62个国家的670万美元提高到662名研究人员的2020。</a></div><span class="my_story_list_date">2022-2-13 1:56</span></div><div class="col-sm"><div><a target="_blank" href="/story/1072754.html"><img src="http://img2.diglog.com/img/2022/2/thumb_8907cba0300fd2ae792d8143fffe80e7.gif" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072754.html">我们狩猎采集者的未来：气候变化、农业和不文明（2020年）</a></div><span class="my_story_list_date">2022-2-12 23:34</span></div><div class="col-sm"><div><a target="_blank" href="/story/1072551.html"><img src="http://img2.diglog.com/img/2022/1/thumb_debde01b42432d05c75483c0372bddf7.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072551.html">Facebook手私人聊天给我们警方，甚至是SANS担保（2020）</a></div><span class="my_story_list_date">2022-1-10 4:30</span></div><div class="col-sm"><div><a target="_blank" href="/story/1072361.html"><img src="http://img2.diglog.com/img/2021/8/thumb_e2299625292776cb4444e4fe1816f920.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1072361.html">PitchBook：预计 2021 年将有 3,000 多名天使投资者进行首次交易，高于 2020 年的 2,725 名；天使在 2021 年上半年投资了 $2.1B，而在 2020 年投资了 $2.6B</a></div><span class="my_story_list_date">2021-8-10 1:25</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>