<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在Hushboard打字时使麦克风静音 Mute Your Microphone While Typing with Hushboard</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Mute Your Microphone While Typing with Hushboard<br/>在Hushboard打字时使麦克风静音 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-09 17:38:05</div><div class="page_narrow text-break page_content"><p>Yesterday while surfing the ASCII highways of IRC (yes, IRC) a URL linking to a MacOS application scrolled by my screen.  Unclack is a small MacOS utility which silences the microphone of the user when they’re typing. The purpose is to prevent the noise of typing being passed through to other participants when on a Zoom / Skype / Jitsi call. Neat.</p><p>昨天，在浏览IRC的ASCII码高速公路（是IRC）时，一个URL链接到了我的屏幕上滚动的MacOS应用程序。 Unclack是一个小型的MacOS实用程序，可在用户键入时使用户的麦克风静音。目的是防止在进行Zoom / Skype / Jitsi通话时将打字的噪音传递给其他参与者。整齐。</p><p> They don’t make a Linux version, and I couldn’t see anything similar, so I did what I usually do in this instance, throw the idea towards my friendly local coder, Stuart Langridge. He was, as ever, initially bemused and then dismissive.</p><p> 他们没有制作Linux版本，而且我看不到任何类似的东西，所以我做了这种情况下的平常工作，将想法交给了我友好的本地编码器Stuart Langridge。一如既往，他一开始就感到困惑，然后又不屑一顾。</p><p>  Alan: I reckon that’s an app which could exist on linux - unclack.app - “Unclack is the small but mighty Mac utility that mutes your keyboard while you type!”</p><p>  艾伦：我认为这是一个可以在linux上存在的应用程序-unclack.app-“ Unclack是体积小但功能强大的Mac实用程序，可在您键入时使键盘静音！”</p><p>    Stuart: I thought: the answer here is don’t be popey with the stupid noisy keyboard ;)</p><p>    斯图尔特：我想：答案不是笨笨的嘈杂键盘;）</p><p>  Alan: I reckon a little python thing that sits in the corner and can be toggled on/off would be neat</p><p>  艾伦：我认为坐在角落里可以打开/关闭的一些小python东西会很整洁</p><p>     Stuart provided me with the first iteration, able to detect keypresses, you know, like a keylogger. We spent approximately 30 seconds brainstorming a name. I came up with  automute and  unkeeb. Stuart expressed with some vigor that  unkeeb was under no circumstances going to be the name.</p><p>     Stuart为我提供了第一个迭代，能够像键盘记录器一样检测按键。我们花了大约30秒钟来集思广益。我想出了自动静音功能。斯图尔特（Stuart）充满活力地表示，在任何情况下，温基布都不是这个名字。</p><p>   By late afternoon Stuart had the basics of the utility working. We tested over a Google Meet. It would detect keypresses, mute and unmute the microphone, and display the status in the indicator area. This smelled like a Minimum Viable Product!</p><p>   到傍晚，Stuart拥有了该实用程序的基本知识。我们通过Google Meet进行了测试。它会检测按键，使麦克风静音和取消静音，并在指示器区域中显示状态。这闻起来像最低限度的可行产品！ </p><p> With Stuarts veto on the  unkeeb name, as the Ideas Man, I had to think of something else. I checked a thesaurus and came up with  calm-ivories which was even dumber than  unkeeb. Then it hit me!</p><p>Stuarts否决权是Uneebeb，即Ideas Man，我不得不考虑其他事情。我检查了一个词库，想出了镇静的象牙色，甚至比unkeeb还暗。然后打我！</p><p>  30 seconds of Internet due diligence later, and the name was settled. “ Hushboard” it is. Who says naming things is hard? Stuart does. All the time. That’s why he relies on me for these parts of the project lifecycle. That, and packaging. We were getting close to sharing the creation with the world. We decided, with no surprise to anyone, to make a snap!</p><p>  经过30秒钟的Internet尽职调查，该名称得以确定。是“滑板”。谁说很难命名？斯图尔特做到了。每时每刻。这就是为什么他在项目生命周期的这些阶段都依赖我。那和包装。我们即将与世界分享创作。我们决定毫不意外地做出决定！</p><p> So here’s what I did to package what’s essentially a tiny bit of python, and a few dependencies as a snap, so Stuart could build and  publish it in the Snap Store.</p><p> 因此，这就是我打包基本python和一些依赖项的工作，因此Stuart可以在Snap Store中构建和发布它。</p><p>  This is straightforward. The  version tag uses  git so whenever a build is published, you can refer back to the tag which it was built from. It’s going to be strictly confined. We don’t want it doing anything narfarious with all those keypresses it’s collecting!</p><p>  这很简单。版本标签使用git，因此每当发布构建时，您都可以参考其构建的标签。这将严格限制。我们不希望它对收集到的所有按键进行任何令人毛骨悚然的事情！</p><p>  We’re using  core18 which means it’s using packages from Ubuntu 18.04 for  stage-packages later, which are older than the packages used when we tested on our 20.04 / 20.10 systems.  Foreshadowing</p><p>  我们正在使用core18，这意味着它将稍后使用Ubuntu 18.04中的软件包作为阶段软件包，这比我们在20.04 / 20.10系统上测试时使用的软件包要旧。铺垫</p><p> name: hushboardbase: core18version: &#39;git&#39;summary: Mute your microphone while typingdescription: | Save your friends and colleagues from the noise of your keyboard while on audio or video calls. Hushboard detects keypresses and automatically mutes your microphone, unmuting shortly after you finish typing.grade: stableconfinement: strict</p><p> 名称：hushboardbase：core18版本：＆＃39; git＆＃39;摘要：键入时使麦克风静音说明：|在进行音频或视频通话时，可以保护您的朋友和同事免受键盘噪音的影响。 Hushboard会检测到按键并自动使您的麦克风静音，并在完成输入后立即将其静音。等级：稳定限制：严格</p><p>  First is hushboard itself. As I plan to land this in the upstream repo, the  source is  . - the current directory. I’m not using the  python plugin, because the project doesn’t have all the necessary python bits like a  setup.py. We’re literally dumping the python files into the snap and running them.</p><p>  首先是滑板本身。当我计划将其放置在上游仓库中时，来源是。 -当前目录。我没有使用python插件，因为该项目没有所有必需的python位，例如setup.py。我们实际上是将python文件转储到snap中并运行它们。 </p><p> We’re staging  gir1.2-appindicator3-0.1 so it can place a little indicator icon in the top right of the screen, so you can see what the app is doing. We also need  python3-xlib which is needed by Hushboard to hook into X11 to detect keypresses. Yes, this uses X11, no, it hasn’t been tested on Wayland. No, it almost certainly won’t work there. Patches may be welcome, so long as it doesn’t break X11 stuff.</p><p>我们将暂存gir1.2-appindicator3-0.1，以便它可以在屏幕的右上方放置一个小指示器图标，以便您查看应用程序的运行情况。我们还需要Hushboard需要使用python3-xlib来挂接到X11以检测按键。是的，它使用X11，否，尚未在Wayland上进行过测试。不，几乎可以肯定那里是行不通的。只要不破坏X11的东西，补丁可能是受欢迎的。</p><p> The  prime section is pretty neat. This means “only put these things in the snap, and nothing else”. That way we strip the snap down to the absolute minimum needed to make it run. The Xlib library is about the biggest thing in the snap, which ends up being under 200K in size.</p><p> 主要部分非常整洁。这意味着“仅将这些东西放在瞬间，别无其他”。这样一来，我们便会将快照降低到了使其运行所需的绝对最小值。 Xlib库是快照中最大的事情，最终大小不到200K。</p><p> parts: hushboard: plugin: dump source: . stage-packages: - gir1.2-appindicator3-0.1 - python3-xlib prime: - usr/lib/girepository-1.0/AppIndicator3-0.1.typelib - usr/lib/*/libappindicator3.so.* - usr/lib/python3/dist-packages/* - hushboard/* - bin/*</p><p> 零件：hushboard：插件：dump源：。阶段软件包：-gir1.2-appindicator3-0.1-python3-xlib素数：-usr / lib / girepository-1.0 / AppIndicator3-0.1.typelib-usr / lib / * / libappindicator3.so。*-usr / lib / python3 / dist-packages / *-hushboard / *-bin / *</p><p>   Here’s the launcher script. All it does is ensure python can find the dependencies we bundled (xlib) and launches the application. I could probably move the  PYTHONPART line to the  apps section as an  environment stanza, and may well have done by the time you read this.</p><p>   这是启动器脚本。它所做的只是确保python可以找到我们捆绑的依赖项（xlib）并启动应用程序。我可能会将PYTHONPART行作为环境节移动到apps部分，并且在您阅读本文时可能已经完成。</p><p>   Here we specify the binary we are going to expose to the outside world as  hushboard, which in fact launches  $SNAP/bin/launcher, that we just saw above. I definitely should add that  PYTHONPATH to the  environment section. Hang on. Ok,  done.</p><p>   在这里，我们指定将要公开给外部世界的二进制文件，它实际上启动了我们上面刚刚看到的$ SNAP / bin / launcher。我绝对应该将PYTHONPATH添加到环境部分。不挂断。 OK完成。</p><p> We’re leveraging the GNOME extension here. It means a ton of stuff is done and bundled for us.</p><p> 我们在这里利用GNOME扩展。这意味着要为我们完成大量工作并将其打包。</p><p>  That’s it. I threw a PR over to Stuart who hooked it all up to the snapcraft build system. Within an hour or so</p><p>  而已。我把公关交给了Stuart，后者把这一切都挂到了snapcraft构建系统上。一小时左右 </p><p>   When I first built the snap, the yaml looked pretty much as it does now, but without the  prime section. This caused a library conflict between GNOME libraries in the GNOME Platform Snap (gnome-3-34) and what was pulled in by my  stage-packages definition. Thanks to Ken VanDine on the Ubuntu Desktop Team and Chris Patterson from the Snapcraft team at work for helping me better understand this. We ndeeded to bundle the appindicator library, but didn’t want all the other dependencies, which caused the conflict. Using the  prime section we could allowlist only the things we want, which has a side-effect that the snap is nice and tight.</p><p>当我第一次构建快照时，yaml看起来与现在非常相似，但是没有主要部分。这在GNOME平台快照（gnome-3-34）中的GNOME库和我的阶段包定义中引入的库之间引起了库冲突。感谢Ubuntu桌面团队的Ken VanDine和Snapcraft团队的Chris Patterson的工作，他们帮助我更好地理解了这一点。我们希望捆绑appindicator库，但不希望所有其他依赖项引起冲突。使用质数部分，我们可以只列出我们想要的东西，这有一个副作用，即按扣很好而且很紧。</p><p>  When Stuart first landed the yaml and hooked up the snapcraft build service, we had build failures on the s390x and ppc64el architecture builders. That’s because the  gnome-3-34-1804-sdk component used at build time isn’t built for those architectures. So I added an  architectures stanza to limit the builds we’d support. Now the build service doesn’t even try to build s390x, ppc64el. Sorry all of you doing video calls on your IBM mainframes!</p><p>  当Stuart首次登陆yaml并连接了snapcraft构建服务时，我们在s390x和ppc64el体系结构构建器上发生了构建故障。这是因为构建时未使用gnome-3-34-1804-sdk组件。因此，我添加了一个架构节以限制我们支持的构建。现在，构建服务甚至没有尝试构建s390x，ppc64el。抱歉，在IBM大型机上进行视频通话的所有人！</p><p>   $ snap run hushboard Gtk-Message: 16:12:36.769: Failed to load module &#34;canberra-gtk-module&#34; Traceback (most recent call last): File &#34;/usr/lib/python3.6/runpy.py&#34;, line 193, in _run_module_as_main &#34;__main__&#34;, mod_spec) File &#34;/usr/lib/python3.6/runpy.py&#34;, line 85, in _run_code exec(code, run_globals) File &#34;/snap/hushboard/x19/hushboard/__main__.py&#34;, line 204, in &lt;module&gt; HushboardIndicator().run() File &#34;/snap/hushboard/x19/hushboard/__main__.py&#34;, line 150, in __init__ self.queue = queue.SimpleQueue() AttributeError: module &#39;queue&#39; has no attribute &#39;SimpleQueue&#39;</p><p>   $ snap run hushboard Gtk-消息：16：12：36.769：无法加载模块＆＃34; canberra-gtk-module＆＃34;追溯（最近一次通话）：文件＆＃34; /usr/lib/python3.6/runpy.py&#34 ;，第193行，在_run_module_as_main＆＃34; __ main __＆＃34;，mod_spec中）文件＆＃34; /usr/lib/python3.6/runpy.py&#34 ;，第85行，在_run_code exec（code，run_globals）文件＆＃34; / snap / hushboard / x19 / hushboard / __ main __。py＆＃34 ;，第204行，在＆lt; module＆gt;中HushboardIndicator（）。run（）文件＆＃34; / snap / hushboard / x19 / hushboard / __ main __。py＆＃34;行__init__ self.queue = queue.SimpleQueue（）AttributeError：module＆＃39; queue＆ ＃39;没有属性＆＃39; SimpleQueue＆＃39;</p><p> A quick search online revealed SimpleQueue which Stuart used in hushboard, was introduced in Python 3.7. We’re building on Ubuntu 18.04 due to the use of  core18 as a  base (callback). I worried this might be a significant problem. Stuart pointed out it was a  one line fix to use a different method to achieve the same thing, and be compliant with the features in Python 3.6. Awesomesauce!</p><p> 在线快速搜索显示了Python 3.7中引入了Stuart在hushboard中使用的SimpleQueue。由于使用core18作为基础（回调），因此我们在Ubuntu 18.04上进行构建。我担心这可能是一个重大问题。 Stuart指出，使用不同的方法来完成同一件事并与Python 3.6中的功能兼容是一站式修复。很棒的酱！</p><p>  I had a couple of meetings today in which I could test the newly minted  hushboard. Hushboard has an internal timer which essential starts whenever the user presses a key and the microphone is muted. If you don’t press anything for a certain period, you’re unmuted. We initially settled on 2 seconds as the delay. But this seemed weird, as the typer would have to wait 2 seconds after typing to be able to say anything. It stilted conversations.</p><p>  今天我有几次会议可以测试新铸造的滑板。 Hushboard具有一个内部计时器，每当用户按下一个键且麦克风被静音时，该计时器便必不可少。如果您在一段时间内不按任何按钮，则不会被静音。我们最初将延迟定为2秒。但这似乎很奇怪，因为打字员必须在打字后等待2秒钟才能说出任何话。它高谈阔论。</p><p> We tried  150ms but that was seen as too short a time. People in the meeting could hear my microphone strobing off and on as I typed, because I don’t necessarily type super fast all the time. We finally settled on  250ms but I expect Stuart is open to  feedback on this topic 😃.</p><p> 我们尝试了150毫秒，但这被认为太短了。参加会议的人可以听到我在键入时打开和关闭我的麦克风的声音，这是因为我不一定一直都在快速键入。我们终于在250ms上达成协议，但我希望Stuart愿意就此话题进行反馈。</p><p>  This was a fun little project. Within about 24 hours we went from idea to prototype, implementation, testing, building for multiple architectures,  publishing, made a tutorial video and a promotional blog post about this simple little utility. Do feel free to  install it and let us know your  thoughts.</p><p>  这是一个有趣的小项目。在大约24小时内，我们从构思到原型，实施，测试，为多种体系结构构建，发布，制作了有关此简单实用程序的教程视频和宣传博客。请随时安装它，并让我们知道您的想法。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://popey.com/blog/2021/01/hush-keyboards-with-hushboard/">https://popey.com/blog/2021/01/hush-keyboards-with-hushboard/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/麦克风/">#麦克风</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/构建/">#构建</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>