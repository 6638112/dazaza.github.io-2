<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>加速倍数为14,000倍，也就是。获胜的计算机科学</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">加速倍数为14,000倍，也就是。获胜的计算机科学</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-13 20:54:49</div><div class="page_narrow text-break page_content"><p>在我作为科学软件开发人员的工作中，我倾向于编写大量代码。大多数没有读过计算机科学学位的人倾向于认为CS“只是”把代码扔到屏幕上，然后运行它。我与我的许多同事和具有其他背景的同事保持着良好的工作关系。…。物理、气候科学、生物学等等。但是，当谈到开发软件时，我得到的明显印象是，人们会想，“嘿，这能有多难呢？我们只需写下几条指令，告诉计算机我们想要做什么，然后点击执行按钮，然后‘砰！’一声，我们就得到了答案！“。</p><p>这种思路的问题在于，编写与您认为的意思不符的指令非常容易。例如，计算机可能完全无法解释您的程序。此外，在不实际执行程序的情况下，几乎无法判断程序是否会真正终止。而且有很多、很多、很多种方法来编写程序，使其执行起来“很慢”。“慢”是…。真的很慢。好像要花一辈子甚至更长的时间才能真正执行。最后一个问题是我在阅读没有接受过CS教育的人编写的软件时最常遇到的问题。解决这个问题是我的工作。</p><p>关于CS，人们没有意识到的一件事是，它教会了你关于计算的理论，可计算性(也就是说，我们真的能计算什么吗？我们经常理所当然地认为我们可以！)，算法复杂性，以及所有的知识、逻辑和分析技术，并帮助您编写一个将在最少的时间或使用最少的空间内运行的程序。</p><p>请允许我向您展示一个巨大的优化示例，这是我对一个同事编写的简单脚本所做的优化。</p><p>在气候科学方面，我们做了大量的缩减工作。我们从粗尺度的全球气候模式网格中获取温度和降水读数，并将其映射到细尺度的局部网格。假设全局网格为50x25，本地网格为1000x500。对于局部网格中的每个网格单元，我们希望知道它对应于全局网格中的哪个网格单元。</p><p>考虑这个问题的一个简单方法是，我们想要最小化L[n]和G[n]之间的距离。因此，执行搜索的简单方法是：</p><p>对于每个局部像元L[i]：对于每个全局像元G[j]：计算L[i]和G[j]之间的距离查找集合L[i]*G中的最小距离返回最小值的索引。</p><p>这看起来很简单。然而，如果你仔细观察，你会注意到你必须做很多额外的工作。根据输入的大小来查看算法。</p><p>对于每个局部像元L[i]：#对每个全局像元G[j]执行此操作L次：#执行此操作L x G次计算L[i]和G[j]之间的距离(D)#执行此L x G次查找集合中的最小距离d[i*j]#读取G个像元L次(开销L x G)查找其像元与最小值匹配的索引#读取G个像元L次(开销L x G)。</p><p>Obs.lon&lt；-ncvar_get(nc.obs，&#39；lon&39；)obs.lat&lt；-ncvar_get(nc.obs，&#39；lat&lt；)n.lon&lt；-length(obs.lon)n.lat&lt；-length(obs.lat)obs.lat&lt；-Matrix(obs.lat，nrow=n.lon，nol=n.lat，byrow=true)obs.lon&lt；-Matrix(obs.lon，nrow=n.lon，ncol=n.lat)obs.time&lt；-netcdf.endar(nc.obs)gcm.lon&lt；-ncvar_get(nc.gcm，&#39；lon&39；)-360gcm.lat&lt；-ncvar_get(nc.gcm，&39；lat&39；)gcm.lats&lt；-Matrix(gcm.lat，ncol=length(gcm.lat)，nrow=length(gcm.lon)，byrow=true)gcm.lons&lt；-Matrix(gcm.lon，ncol=length(gcm.lat))gcm.lons.lats&lt；-Matrix(gcm.lon，ncolumn=length(gcm.lat)，nrow=length(gcm.lat)，nrow=length(gcm.lon)，nrow=length(gcm.lon)，nrow=length(gcm.lat)，nrow=length(gcm.lat)。-cbind(c(gcm.lons)，c(gcm.lats))#找出哪些GCM网格框与每个精细网格点相关联#将搜索限制在10度。X 10°。Neighborhooddxy&lt；-10mdist&lt；-function(x，y)Apply(abs(Sweep(data.Matrix(Y)，2，data.Matrix(X)，&#39；-&#39；)，1，sum)nn&lt；-list()for(i in seq_long(obs.lons)){if((i%%500)==0)cat(i，&#39；&#39；)gcm.lims&lt；-((gcm.lons.lats[，1]&gt；=(obs.lons[i]-dxy))&amp；(gcm.lons.lats[，1]&lt；=(obs.lons[i]+dxy))&amp；((gcm.lons.lats[，2]&gt；=(obs.lats[i]-dxy))&amp；(gcm.lons.lats[，2]&lt；=(obs.lats[i]+dxy)gcm.lims&lt；-this(gcm.lims)n.min&lt；-which.min(mdist(c(obs.lons[i]，obs.lats[i])，gcm.lons.lats[gcm.lims，]))nn[[i]]&lt；-gcm.lims[nn.min]}nn&lt；-unlist(Nn)。</p><p>所以，这似乎是一个简单的算法。“只要”计算距离，然后找出最小值。但是按照它的编写方式，随着局部网格单元数量的增加，我们的计算成本也会随着全局网格单元数量的乘积而增加。对于加拿大ANUSPLIN数据，有1068x510个单元格(总共544,680个)，假设我们的GCM有50x25个单元格(总共1250个单元格)。因此，“某个计算单元”中内循环的成本为：</p><p>其中项是对应于计算两点之间的距离、找到最小点和找到数组索引的成本的常量。实际上，我们不太关心常量项，因为它们不受输入大小的影响。所以我们可以把它们聚集在一起，称之为成本；</p><p>这看起来很多，但真的吗？电脑很快，对吧？如果我们运行这个朴素的实现，情况大概是这样的：</p><p>最终耗时1668秒，略低于半小时。</p><p>&gt；source(&#39；BCCA/naive.implementation.R&#39；)500 1000 1500 2000 2500 3000...543000 543500 544000 544500[1]&34；用户系统运行时间为1668.868 8.926 1681.728。</p><p>但是我们需要花30分钟吗？事情是这样的。我们正在比较两个网格，这两个网格都有大量我们没有利用过的结构。例如，粗格网和细格网中的纬度和经度都是按顺序排序的。因此，如果你想搜索一个数字，你不需要查看每一个数字。您可以使用平分算法，在该算法中，您可以查看中间的点，然后决定要搜索阵列的哪一半。那么搜索整个空间只需要花费搜索空间的日志(以2为基数)。</p><p>另一个我们没有利用的主要结构是纬度在维度中重复，而经度在维度中重复。所以不用做一次运算，我们可以做几次。这是一个巨大的优化。</p><p>对于每个LOCAL[x]：BICET_SEARCH(LOCAL[x]，GLOBAL[x])对于每个LOCAL[y]：BIVECT_SEARCH(LOCAL[y]，GLOBAL[y])返回每个维度的搜索结果的二维格网。</p><p>##对*排序后的向量v#返回最接近xfind最近的元素的数组索引。-function(x，v){if(length(V)==1){return(1)}if(length(V)==2){return(which.min(abs(v-x)}mid&lt；-ceuling(length(V)/2)if(x=v[mid]){return(mid)}Else if(x&lt；V[MID]){return(find.NEAREST(x，v[1：MID]))}ELSE{RETURN((MID-1)+find.NEAREST(x，v[MID：Length(V)]))}}regrid.one.dim&lt；-function(粗点，细点){return(sApply(fine.point，find.neest，粗点))}##取纬度和经度的精细比例尺(例如ANUSPLINE)栅格##并找到对应于粗略比例尺(例如GCM)栅格的索引##因为搜索实质上是2维中的最小化距离##我们实际上可以单独在每个维度中独立地搜索(其中##是巨大的优化，使运行时x+y而不是x*y)和##然后重构索引以创建完整的gridregrid.coarse.to.fin.lt；-function(coarse.lats，coarse.lons，fine.lats，fine.lons){xi&lt；-regrid.one.dim(gcm.lon，obs.lon)yi&lt；-regrid.one.dim(gcm.lat，obs.lat)##索引Xi&lt；二维网格-Matrix(xi，ncol=length(fine.lats)，nrow=length(fine.lons)，byrow=F)yi&lt；-Matrix(yi，ncolumn=length(fine.lons)，byrow=T)return(list(xi=xi，yi=yi)}。</p><p>每个平分搜索的成本是输入大小的对数。这次我们的输入大小被划分为X和Y空间，所以我们将为Global、Local、X和Y使用and。</p><p>加上我们的数字，我们估计成本为553,076英镑。55.3万听起来比6.8亿好多了。我们在运行时看到了这一点吗？</p><p>&gt；ptm&lt；-proc.time()；rv&lt；-regrid.coarse.to.Fine(gcm.lat，gcm.lon，obs.lat，obs.lon)；打印(&#39；已用时间&39；)；打印(pro.time()-ptm)[1]&34；用户系统已用时间0.117 0.000 0.117&gt；STR(房车)列表2$Xi：Num[1：1068，1：510]15 15 15...$yi：Num[1：1068，1：510]13 13 13。</p><p>0.117秒。半小时前我们花了近半个小时，现在我们花了一秒钟多一点的时间。</p><p>Soooooo…。我知道我受过做这类工作的训练，我的工作就是知道如何做这类事情。但即使是我也对这种加速是如此显著感到惊讶和自以为是。这是14000倍的加速。</p><p>此脚本过去需要很长时间，因此必须将其输出保存到磁盘，并由科学家手动检查，然后才能继续。现在你一眨眼的功夫就可以计算出来。这是一个我们必须做几百次的计算，这为我们节省了几天到几周的计算时间。它增加了与系统交互的能力，帮助我们从科学家的Time…中获得更多价值。他们不会无所事事地等待计算完成。它就这么做了。</p><p>我应该强调的是，这些史诗般的性能改进是在没有购买任何更大的计算机系统、没有并行化或增加复杂性的情况下出现的…。事实上，更快算法的代码实际上更简单、更可重用！只要阅读代码并对计算复杂性有一定的了解，这几乎是一个全面的胜利。</p><p>由Disqus提供支持的博客评论</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://james.hiebert.name/blog/work/2015/09/14/CS-FTW.html">http://james.hiebert.name/blog/work/2015/09/14/CS-FTW.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/加速/">#加速</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/science/">#science</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/搜索/">#搜索</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1027419.html"><img src="http://img2.diglog.com/img/2020/10/thumb_ce0760d68b99ddd99a4b0ebe952efd09.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1027419.html">NVIDIA和加速的Xwayland与“听起来不愉快”的代码走得更近</a></div><span class="my_story_list_date">2020-10-1 5:59</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025393.html"><img src="http://img2.diglog.com/img/2020/9/thumb_aaa320047e656ad6cad1f8f359e8bd1b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025393.html">
大流行加速了剪线，使2020年成为付费电视有史以来最糟糕的一年</a></div><span class="my_story_list_date">2020-9-22 1:3</span></div><div class="col-sm"><div><a target="_blank" href="/story/1018462.html"><img src="http://img.diglog.com/img/2020/8/thumb_995458db04ebfa2dce7f395b46560576.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1018462.html">在Retrocomputer上加速Pkgsrc</a></div><span class="my_story_list_date">2020-8-16 15:37</span></div><div class="col-sm"><div><a target="_blank" href="/story/1016434.html"><img src="http://img.diglog.com/img/2020/8/thumb_de5d731b294f002368259df3e6537dbe.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1016434.html">
随着电子商务的加速，金融科技创业公司在第二季度筹集了创纪录的1亿美元</a></div><span class="my_story_list_date">2020-8-5 23:50</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>