<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我最不喜欢的铁锈类型</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">我最不喜欢的铁锈类型</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-22 03:00:32</div><div class="page_narrow text-break page_content"><p>Struct range&lt；idx&gt；{/范围下限(含)。Pub start：idx，/范围上限(独占)。酒吧结束：IDX，}。</p><p>IDX通常是一个整数类型，但是您可以创建任何类型的范围，这将在稍后变得很重要。以下是单位范围：</p><p>射程有什么问题吗？这将是对拉斯特自己的批评。</p><p>任何Rust教程都将涉及借款、使用期限、所有权等。您认为您理解，然后是：</p><p>嘿，不，这是因为，如果你想做一款系列Vec&gt；而不是：</p><p>Range&lt；Vec&&gt;需要借钱，因此更为常见的Range&lt；usize&&gt;等也迫使它这样做。</p><p>我们还没挑完借阅支票呢。Range使您即使在没有所有权转移的情况下也可以进行克隆：</p><p>设v=vec！[1，2，3，4]；设r=1..。2；&amp；v[r.clone()]；//需要避免在下一行&amp；v[r]中使用&#34；移动值&#34；</p><p>范围可以是复制的，但有些范围也是迭代器，您可能会错误地复制一个范围：</p><p>设mut iter=0..。N；for I in ITER{if I&gt；2{Break；}}//ITER ITER.Collect()的静默副本。</p><p>因此，没有用作迭代器的Range(许多不能用作迭代器，如Range&lt；f64&gt；或Range&lt；char&gt；)要付出代价，嵌入范围的任何类型也是如此。</p><p>这是在滥用借入检查器作为一个坏的临时针。Range破坏了生命周期和所有权的故事，让借入检查员感觉很武断。</p><p>这个倒档范围有效吗？它的len()是0，它不包含()，作为迭代器不会产生任何结果。但是，如果您试图使用它来索引到一个切片中，就会出现恐慌！所以它看起来是有效的，但是已经做好了爆炸的准备！</p><p>这是因为-再说一次-你可以做任何东西的范围。如果您试图强制执行start&lt；=end，您将失去制造一系列不可比较的东西的能力。Dyn错误的范围不能无效，因此int的范围永远不会无效。</p><p>一个实际问题是编写正确的边界检查。例如，考虑Slice上的GET_UNCHECKED函数-它说“越界索引是未定义的行为”，但从未定义过越界是什么意思。那么，如何才能安全地调用此函数呢？</p><p>重申：起始为0且长度为0的范围可能超出界限。这太疯狂了。</p><p>正则表达式引擎(这里是一个)通常处理字符范围，例如/[a-z]/。它是否应该使用Range&lt；char&gt；？</p><p>不！步枪是/[\u10FFFF]/，这是最大的字符。范围&lt；字符&gt；不能表示此值，即使它有这样做的位。</p><p>RangeInclusive是更好的选择吗？这使用一个额外的布尔字段来表示…。东西，需要在几个地方分开检查。这是一个愚蠢而昂贵的表示，将RangeInclusive&lt；char&gt；推到12个字节，即使它可以容纳8个字节，还有多余的位。对于性能敏感的正则表达式算法来说，这不是一个很好的选择。</p><p>问题是射程超载了：它太灵活了，它想要成为一切。</p><p>也许为时已晚，我们必须忍受这个疣，但这是一种不同方法的食谱：</p><p>将范围限制为复制+PartialEq类型。Range&lt；String&gt；或Range&lt；BigNum&gt；可能偶尔会用到，但通常情况下不值得强行借用。</p><p>既然该范围总是知道如何比较其结束，那么在构造时强制开始&lt；=end。对于由常量构造的范围，这将是免费的。这避免了“看起来有效，实际上爆炸”的问题，并将解锁进一步的优化：</p><p>与其他集合一样，为Range提供一个ITER()方法。现在Range不是迭代器，就像VEC不是迭代器一样，Range可以很容易地复制。这确实意味着在(1..10).iter()中写入n，但是Rust已经要求集合这样做，所以更加一致。</p><p>现在Range不是迭代器，RangeInclusive可以删除它的额外布尔值。它只是一对索引，不能为空(这就是SWIFT所做的)。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://ridiculousfish.com/blog/posts/least-favorite-rust-type.html">http://ridiculousfish.com/blog/posts/least-favorite-rust-type.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/rust/">#rust</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/铁锈/">#铁锈</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/范围/">#范围</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1025246.html"><img src="http://img2.diglog.com/img/2020/9/thumb_6cc9cc63b59f52c7afaff14ef7fb1126.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025246.html">ICE：铁锈中的x86/x64反汇编器、汇编器、解码器、编码器</a></div><span class="my_story_list_date">2020-9-21 6:4</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025217.html"><img src="http://img2.diglog.com/img/2020/9/thumb_1fe95708a9cd6b3e2c5c63d6deccf74f.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025217.html">云虚拟机管理程序-用Rust编写的开源虚拟机监视器</a></div><span class="my_story_list_date">2020-9-21 2:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025202.html"><img src="http://img2.diglog.com/img/2020/9/thumb_bc07e7b059cbfb0c0dba33c608694618.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025202.html">铁锈攀登：简单、无依赖的CLI库</a></div><span class="my_story_list_date">2020-9-21 2:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025104.html"><img src="http://img2.diglog.com/img/2020/9/thumb_37a95898c224778e4213ce37a2b7e230.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025104.html">甲骨文计划阻止Java开发人员离开Rust和Kotlin</a></div><span class="my_story_list_date">2020-9-20 6:41</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>