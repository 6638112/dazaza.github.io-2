<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>将React Native Apps添加到F-Droid（2020） Adding React Native Apps to F-Droid (2020)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Adding React Native Apps to F-Droid (2020)<br/>将React Native Apps添加到F-Droid（2020） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-29 22:52:35</div><div class="page_narrow text-break page_content"><p>React Native is a popular open-source app development framework that makes it easy to build cross-platform applications using the platform’s native UI components. This makes it an ideal choice for developers building apps for all platforms.</p><p>React Native是一个流行的开源应用程序开发框架，可以轻松地使用平台的本机UI组件构建跨平台应用程序。这使其成为开发人员为所有平台构建应用程序的理想选择。</p><p> That’s why we chose it when we started working on the new  EteSync Notes app. It enabled us to build an app in a very short time reusing 100% of the code on Android, iOS, the web, and once we release the desktop clients, the desktop too.</p><p> 这就是为什么我们在开始新的Etesync Notes应用程序时选择它。它使我们能够在很短的时间内建立一个应用程序，在android，iOS，Web上的100％中重用100％，并且我们也释放桌面客户端，桌面。</p><p> Being an open-source project ourselves, and long-time (very happy) users of F-Droid, one of our main concerns before building the app was: can react-native applications be built on F-Droid? Looking online we couldn’t find a clear answer. We then looked at the  fdroiddata repository we saw some mentions of react-native, which led us to react native apps that are available on F-Droid. So we know it can be done, we were just missing the how.</p><p> 作为一个开源项目，我们的长期（非常高兴）F-Droid，我们在构建该应用程序之前的主要问题之一是：可以在F-Droid上建立反应本机应用程序吗？在线寻找我们找不到明确的答案。然后，我们看了FDROIDDATA存储库，我们看到了一些反应原住权的提到，这导致我们在F-Droid上提供的原生应用。所以我们知道它可以完成，我们只是错过了如何。</p><p> The rest of this post assumes you are familiar with the F-Droid metadata files and  how to build normal Android applications.</p><p> 此帖子的其余部分假定您熟悉F-Droid元数据文件以及如何构建正常的Android应用程序。</p><p>  React Native apps have two build and dependency management systems (the React Native one, and the Android one).</p><p>  React Native Apps有两个构建和依赖管理系统（React Native One，Android One）。</p><p>    React Native apps have pre-built dependencies that are shipped using the JavaScript dependency management systems, and we need to tell F-Droid these components are actually FLOSS and compatible with F-Droid.</p><p>    React Native App具有使用JavaScript依赖性管理系统发货的预先构建的依赖项，我们需要告诉F-Droid这些组件实际上是牙线并与F-Droid兼容。</p><p> Before we go on with explaining the important components and how they play together, here is the  working EteSync Notes spec file for your reference.</p><p> 在我们继续解释重要组成部分之前以及它们如何一起发挥作用，这里是工作的ETESync Notes Spec文件供您参考。 </p><p> The first thing you need to take care of is the  subdir directive. React Native applications have their android build system in a subdirectory of the repo rather than the root. It’s usually  android/app, but it may be different in your setup.</p><p>你需要照顾的第一件事是Subdir指令。 React Native Applications在repo的子目录中具有其Android构建系统而不是根。它通常是Android / app，但它的设置可能是不同的。</p><p> The next thing we need, which may not be required in your case, is to get a recent enough version of  node and  yarn. F-Droid uses Debian Stretch for the build system, which didn’t even have a recent enough  node version in backports. So the easiest way to get node was using a pre-built binary, and verify its checksum, and then installing  yarn using  npm. This is how it looks like:</p><p> 在您的情况下，我们需要的下一件事是为了获得近来有足够的节点和纱线版本。 F-Droid使用Debian Setress for Build System，它甚至没有在Backport中拥有足够的节点版本。因此，获得节点的最简单方法是使用预先构建的二进制文件，并验证其校验和，然后使用NPM安装纱线。这是它看起来的样子：</p><p> sudo :  -  curl -Lo node.tar.xz https://nodejs.org/dist/v10.18.1/node-v10.18.1-linux-x64.tar.xz  -  echo &#34;8cc40f45c2c62529b15e83a6bbe0ac1febf57af3c5720df68067c96c0fddbbdf node.tar.xz&#34;  | sha256sum -c -  -  tar xJf node.tar.xz  -  cp -a node-v10.18.1-linux-x64/. /usr/local/  -  npm -g install yarn</p><p> sudo： -  curl -lo node.tar.xz https://nodejs.org/dist/v10.18.1/node-v10.18.1-linux-x64.tar.xz  -  echo＆＃34; 8cc40f45c2c62529b15e83a6bbe0ac1f68067c9620df68067c96c0fddbbdf node.tar.xz＆ ＃34; | sha256sum -c- -  tar xjf node.tar.xz  -  cp -a node-v10.18.1-linux-x64 /。 / usr / local /  -  npm -g安装纱线</p><p> The next step is to install all of the JavaScript dependencies, this can be done using the  init directive, like so:  init: yarn install.</p><p> 下一步是安装所有JavaScript依赖项，这可以使用init指令完成，如：init：yarn安装。</p><p> Now we should have everything we need to get our React Native app to build, though the builds will still fail. The reason for that is that F-Droid automatically detects potentially non-free dependencies in the build, and won’t let the build continue if found. Therefore, the next thing we should do is to tell it to automatically get rid of all of the non-free dependencies pulled by our JavaScript deps, like so:</p><p> 现在我们应该拥有我们需要获取我们的React Native应用程序来构建的一切，但构建仍会失败。这就是F-Droid自动检测构建中可能的无自由依赖性，并且如果发现，则不会让Build继续。因此，我们应该做的下一件事是告诉它自动摆脱我们的JavaScript Deps拉动的所有无非依赖项，如：</p><p>  Now we are making progress, and all of the potentially non-free dependencies are being removed. Though the build will still fail because some of these dependencies were actually needed!Now, the responsibility is on us to find and make sure the deps that we require and that are indeed FLOSS and F-Droid compatible. The most common error is about an “unrecognized maven repository” pointing to  ../node_modules/.... Assuming all of your JavaScript dependencies are indeed FLOSS, these can be safely ignored, as they just mean that the deps come from a JavaScript dependency instead of through Maven (again, very common). We will deal with these in a moment.The second, more serious issue is about  .jar,  .aar and  .so files being removed. Here you need to take extra care to make sure that these files are indeed FLOSS, come from a trusted source, and are just pre-compiled for ease of distribution. Once you found all of the occurrences of the two issues above, you can tell F-Droid to ignore them. For example, this is what we have in EteSync Notes:</p><p>  现在我们正在进行进度，并且正在删除所有潜在的非自由依赖项。虽然构建仍然失败，因为实际需要一些这些依赖性！现在，责任在我们身上找到并确保我们所需的DEPS，这确实是牙线和F-Droid兼容的。最常见的错误是关于指向“无法识别的Maven存储库”./ node_modules / ....假设您的所有JavaScript依赖项都确实是牙线，这些可以安全地忽略，因为它们只是意味着DEPS来自JavaScript依赖关系而不是通过maven（再次，非常常见）。我们将在片刻处理这些问题。第二个，更严重的问题是.jar，.aar和.so文件被删除。在这里，您需要额外注意，以确保这些文件确实是牙线，来自可信源，并且只是预先编译以易于分发。一旦找到上述两个问题的所有出现，您就可以告诉F-Droid忽略它们。例如，这是我们在eteSync中拥有的：</p><p> scanignore :  -  android/build.gradle  -  node_modules/jsc-android  -  node_modules/react-native/android/com/facebook/react/react-native/*/  -  node_modules/react-native-appearance/android/build.gradle  -  node_modules/react-native-reanimated/android/build.gradle  -  node_modules/react-native-safe-area-context/android/build.gradle  -  node_modules/react-native-screens/android/build.gradle  -  node_modules/react-native-sodium/libsodium/*/lib/libsodium.so  -  node_modules/react-native-vector-icons/android/build.gradle  -  node_modules/@react-native-community/async-storage/android/build.gradle  -  node_modules/@react-native-community/masked-view/android/build.gradle  -  node_modules/@react-native-community/netinfo/android/build.gradle</p><p> scanignore： -  android / build.gradle  -  node_modules / jsc-android  -  node_modules /反应 - 本机/ android / com / facebook /反应/反应 - 本机/ * /  -  node_modules /反应 - 本机 - 外观/ android / build.gradle  - node_modules /反应 - 本机 - 重新修复/ android / build.gradle  -  node_modules /反应 - 本机 - 安全区域 -  context / android / build.gradle  -  node_modules / ract-native-screens / android / build.gradle  -  node_modules /反应 - 原生/ libsodium / * / lib / libsodium.so  -  node_modules /反应 - 本机 -  vector-icons / android / build.gradle  -  node_modules/@reacect-native-community/async-storage/android/build.gradle  -  node_modules / @reacont-native-community/masked-view/android/build.gradle  -  node_modules/@reace_native-community/netinfo/android/build.gradle. </p><p> The first three lines are required by all React Native applications. They are just the main React Native deps, which are indeed FLOSS. The rest should be added depending on your own dependencies as outlined above. Please note that some  Expo modules depend on non-free components, so they may be incompatible with F-Droid.</p><p>所有反应本机应用都需要前三条线。它们只是主要的反应天然Deps，这是牙线的。应根据您自己的依赖项如上所述，应添加其余部分。请注意，一些世博模块取决于非自由组件，因此它们可能与F-Droid不兼容。</p><p> This is it, your app should now build for F-Droid. Just make sure to go through the  contribution guidelines to make sure everything is in order.</p><p> 这是它，您的应用程序现在应该为F-Droid构建。只需务必通过贡献指南来确保一切顺利。</p><p>  As you can see, it’s quite easy to build React Native applications on F-Droid once you know how. However, there are a few improvements that could go into F-Droid that would make the process easier. It would be great if the F-Droid build machines will include an up-to-date Node, and potentially maybe a directive to include some of the above steps automatically.</p><p>  如您所见，在您知道如何，它非常容易在F-Droid上构建React本机应用程序。但是，有一些改进可以进入F-Droid，这将使过程更容易。如果F-DROID构建机器包括最新节点，并且可能是一个可以自动包含一些上述步骤的指令。</p><p> The above is everything we needed to do in order to get  EteSync Notes to correctly build on F-Droid. We, at EteSync, are trying to make it easier to build FLOSS, end-to-end encrypted, and privacy respecting applications, which is why we recently released  Etebase. If you share our passion of protecting user freedoms and privacy, please come and  join our community.</p><p> 以上是我们需要做的一切，以便获得eteSync注意到正确构建F-Droid。我们在eteSync，正试图使其更容易构建牙线，端到端加密和隐私尊重应用程序，这就是我们最近发布了etebase的原因。如果您分享了我们对保护用户自由和隐私的热情，请加入我们的社区。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://f-droid.org/en/2020/10/14/adding-react-native-app-to-f-droid.html">https://f-droid.org/en/2020/10/14/adding-react-native-app-to-f-droid.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/2020/">#2020</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/native/">#native</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/react/">#react</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/android/">#android</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>