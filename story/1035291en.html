<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>一个用于离线和分散的Web应用程序的框架</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">一个用于离线和分散的Web应用程序的框架</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-16 01:07:36</div><div class="page_narrow text-break page_content"><p>Concords is an MVP framework for building offline &amp; decentralised web apps, with a file-based approach to storing data. It has no servers or databases and is a static app built with Javascript and HTML, all code is written to run in a browser and nothing is stored outside of the browser or downloaded files.</p><p>Concords是一个MVP框架，用于构建离线和分散的Web应用程序，并采用基于文件的方法来存储数据。它没有服务器或数据库，是一个用Javascript和HTML构建的静态应用程序，所有代码都是在浏览器中运行的，没有任何东西存储在浏览器或下载的文件之外。</p><p>      SAAS applications run on servers with databases. Each interaction with the UI sends information from the browser to a server, which then likely writes something or fetches something from a centralized database.</p><p>SaaS应用程序在具有数据库的服务器上运行。与用户界面的每次交互都会将信息从浏览器发送到服务器，然后服务器很可能会从一个集中的数据库中写入或提取一些内容。</p><p>  Maintaining servers and databases is expensive, complex and time-consuming and I&#39;m not really interested in that side of software. I don&#39;t want the responsibility to look after data that is depended upon, that&#39;s neither my skill-set nor passion. I like to focus my attention on the front-end experience.</p><p>维护服务器和数据库既昂贵、复杂又耗时，而且我对软件的这一方面并不真正感兴趣。我不想要管理依赖的数据的责任，这既不是我的技能，也不是我的激情所在。我喜欢把注意力集中在前端体验上。</p><p>  I set out to build a framework for file-based SAAS apps. Multi-user collaborative apps, with data-driven user flows and advanced UI. But apps that run offline and save state to the filesystem, not send it off to a cloud-based database. Giving users full ownership and visibility of their data, with no dependency on an internet connection. Taking a progressive approach to connectivity, using it to enrich the experience, but not depend on it.</p><p>我开始为基于文件的SAAS应用程序构建一个框架。多用户协作应用程序，具有数据驱动的用户流和高级用户界面。但离线运行并将状态保存到文件系统的应用程序，不会将其发送到基于云的数据库。为用户提供对其数据的完全所有权和可见性，而不依赖于互联网连接。采取循序渐进的方式实现互联互通，利用它丰富体验，但不依赖它。</p><p>        This MVP serves to demonstrate a basic solution to a truly offline and decentralized experience in a collaborative web app. It&#39;s a static app, so just Javascript and HTML, with no servers or databases running in the background. It&#39;s a progressive web app with a service worker, that runs entirely in the browser. So once the initial load has been performed, the rest of the experience can work completely offline, where data is stored in files, downloaded and uploaded through the UI.</p><p>这款MVP展示了一个在协作Web应用中实现真正离线和分散体验的基本解决方案。这是一个静态的应用程序，所以只有Javascript和HTML，没有服务器或后台运行的数据库。这是一款先进的网络应用程序，有一名服务人员，完全可以在浏览器中运行。因此，一旦执行了初始加载，剩下的体验就可以完全脱机工作了，数据存储在文件中，通过用户界面下载和上传。</p><p>  A boards app covers a lot of functionality commonly found in SAAS applications, I figured it&#39;s a great benchmark to prove out the technology.</p><p>一款董事会应用程序涵盖了SAAS应用程序中常见的许多功能，我认为它是证明这项技术的一个很好的基准。</p><p>        With Concords, authentication is all done in the browser, without any communication to a server or external resource.</p><p>使用协和协议，身份验证全部在浏览器中完成，无需与服务器或外部资源进行任何通信。</p><p>  In the Concords authentication system, we issue a downloadable public profile which includes your public key and some basic user info. I keep mine for the MVP on my personal domain.  https://ternent.dev/concords/sam-ternent.profile.concords.json</p><p>在协和认证系统中，我们会发布一个可下载的公共配置文件，其中包括您的公钥和一些基本用户信息。我把我的MVP留在了我的个人领地上。Https://ternent.dev/concords/sam-ternent.profile.concords.json</p><p>  Anyone with access to my public key is able to encrypt data for me, that only I can read with my private key. I just have that stored on my personal machine. It’s never been online and no-one else knows it.</p><p>任何可以访问我的公钥的人都可以为我加密数据，只有我可以用我的私钥读取这些数据。我只是把它储存在我的个人电脑里。它从来没有在网上出现过，其他人也不知道。</p><p>  This key is used to log the user into the app and only a valid key combination can login and access the software.</p><p>此键用于将用户登录到应用程序，只有有效的组合键才能登录和访问软件。</p><p>  For my MVP, this is more than sufficient to complete and decent authentication flow. We can have a recognisable UX of profile/password combination to build a login system, whilst setting us up for an encrypted, multi-user, data flow.</p><p>对于我的MVP来说，这足以完成一个像样的身份验证流程。我们可以使用可识别的配置文件/密码组合的用户体验来构建登录系统，同时设置加密的多用户数据流。</p><p>      I know it&#39;s a pain to ask users to store both parts of their encryption keys themselves. If the private key is lost, it&#39;s unrecoverable and so is any encrypted data to that key. But I couldn&#39;t compromise here, it has to be this way to keep things decentralized. But it&#39;s a problem that can be fixed through software, it doesn&#39;t have to be my software - we&#39;re decentralizing things here, but key management software will fix this problem.</p><p>我知道要求用户自己存储加密密钥的两个部分是一件痛苦的事情。如果私钥丢失，它将无法恢复，该密钥的任何加密数据也将无法恢复。但我不能在这方面妥协，只有这样才能保持事情的分散化。但这是一个可以通过软件解决的问题，它不一定非要由我的软件来解决--我们正在分散处理，但密钥管理软件会解决这个问题。</p><p>    Knowing roughly what I needed to build to prove out the concept, and having already implemented User Profile and the authentication flow, the key features I chose to implement were:</p><p>大致了解我需要构建什么来证明这个概念，并且已经实现了用户配置文件和身份验证流，我选择实现的关键特性是：</p><p>          By default, a new user doesn&#39;t have edit access to a document. For the purpose of the MVP, we&#39;ve got a &#34;Join&#34; button in the left-hand sidebar. Clicking this will add the user as an entry to the data store and unlock editing. This covers the concept enough for now, but we are able to achieve direct encryption with the public/private key authentication, so that&#39;s going to be an interesting avenue to explore further outside of the MVP context.</p><p>默认情况下，新用户无权编辑文档。为了MVP的目的，我们在左边的工具栏上放了一个加盟按钮。单击此选项将把用户作为条目添加到数据存储中，并解锁编辑。目前，这个概念已经涵盖够了，但是我们能够通过公钥/私钥身份验证实现直接加密，因此这将是在MVP上下文之外进一步探索的一个有趣途径。</p><p>        The core of the framework is written in Typescript. It&#39;s a collection of functional utilities which cover the data side of the application. It runs an internal blockchain for writing data, mapped with an IndexDB instance for reading.</p><p>该框架的核心是用打字稿写成的。它是一组功能实用程序，覆盖了应用程序的数据端。它运行一个内部区块链来写入数据，并映射到一个用于读取的IndexDB实例。</p><p>    At the heart of the library is the  Merkel Tree solution. Our Merkle Tree (as used in Blockchain and git), is a functional library to act as a blockchain node, from a JSON object structure, in the browser.</p><p>该图书馆的核心是Merkel Tree解决方案。我们的Merkle Tree(如在BlockChain和Git中使用的)是一个功能库，在浏览器中充当JSON对象结构中的区块链节点。</p><p>  Built on top of that is a CRUD API which the application will interface with. When an action is performed in the app, a timestamped transaction is created for the blockchain. Once commit, all pending transactions are then added to a block on the chain. Once a block has been added to the blockchain, the hash-based data structure ensures the integrity of the app state.</p><p>在此基础上构建的是CRUD API，应用程序将与该API进行交互。当在应用程序中执行操作时，会为区块链创建带时间戳的事务。一旦提交，所有挂起的事务就会被添加到链上的一个块中。一旦区块被添加到区块链中，基于散列的数据结构就可以确保应用程序状态的完整性。</p><p>  { &#34;type&#34;: &#34;tasks&#34;, &#34;action&#34;: &#34;create&#34;, &#34;data&#34;: { &#34;title&#34;: &#34;Task Name&#34;, &#34;description&#34;: &#34;Task Description&#34;, &#34;completed&#34;: false, &#34;due_date&#34;: &#34;2020-11-02&#34;, &#34;assigned_to&#34;: &#34;a72e75a898db9247be59d1aaf9d4c54459e1d24faa43d9f5da0a5a9611a19eb&#34;, &#34;column&#34;: &#34;2bb6a2b737381377fd962b1bda0771d084abd3cab270648c78b7e06566e6b5&#34;, &#34;id&#34;: &#34;d2e25d4d6c77b34fbe87da5f387cf8c3bec25ffc76673e84bf76dbf2aa15754f&#34;, &#34;timestamp&#34;: 1604144654690 }, &#34;user&#34;: { &#34;firstName&#34;: &#34;Sam&#34;, &#34;lastName&#34;: &#34;Ternent&#34;, &#34;avatarUrl&#34;: &#34;https://ternent.dev/concords/avatar.jpeg&#34;, &#34;organisation&#34;: &#34;Team Concords&#34;, &#34;id&#34;: &#34;a72e75a898db9247be59d1aaf9d4c54459e1d24faa43d9f5da0a5a9611a19eb&#34; }, &#34;signature&#34;: &#34;NOT RELEASED&#34;}</p><p>{&#34；类型&#34；：&#34；任务&#34；，&#34；操作&#34；：&#34；创建&#34；，&#34；数据&#34；：{&#34；标题&#34；：&#34；任务名称&#34；，&#34；描述&#34；：&#34；任务描述&#34；，&#34；已完成&#34；：FALSE，&#34；到期日&#34；：&#34；2020-11-02&#34；，&#34；Assigned_to&#34；：&#34；a72e75a898db9247be59d1aaf9d4c54459e1d24faa43d9f5da0a5a9611a19eb&#34；，&#34；Column&#34；：&#34；2bb6a2b737381377fd962b1bda0771d084abd3cab270648c78b7e06566e6b5&#34；，&#34；id&#34；：&#34；d2e25d4d6c77b34fbe87da5f387cf8c3bec25ffc76673e84bf76dbf2aa15754f&#34；，&#34；Timestamp&#34；：1604144654690}，&#34；User&#34；：{&#34；FirstName&#34；：&#34；Sam&#34；，&#34；姓氏&#34；：&#34；Ternent&#34；，&#34；头像URL&#34；：&#34；https://ternent.dev/concords/avatar.jpeg&#34；，&#34；组织&#34；：&#34；Team Concords&#34；，&#34；id&#34；：&#34；a72e75a898db9247be59d1aaf9d4c54459e1d24faa43d9f5da0a5a9611a19eb&#34；}，&#34；签名&#34；：&#34；未发布&#34；}。</p><p>     Sitting on the other side of the blockchain is the DB layer. When a transaction it accepted onto the blockchain, we parse the event and perform an operation on an IndexedDB instance in the browser. Transactions are recorded as they go in, so we don’t duplicate transactions and minimise the number of write operations to the database.</p><p>区块链的另一边是DB层。当它接受区块链上的交易时，我们解析事件并在浏览器中对IndexedDB实例执行操作。事务在进入时被记录，因此我们不会重复事务，并最大限度地减少对数据库的写操作次数。</p><p>  As long as we have the blockchain data object, we have a full picture of our app and data state. We can drop and recreate a database with complete accuracy, based on secured transactional history. This is a  read only layer.</p><p>只要我们有区块链数据对象，我们就能全面了解我们的应用和数据状态。我们可以根据受保护的事务历史记录，完全准确地删除并重新创建数据库。这是只读图层。</p><p>                A quick leap here is to build this out into a desktop app using electron. Little things like saving the hash to a keychain, directly reading and writing to the filesystem. I&#39;m excited to try running the  DAT project to enable P2P connectivity to give a realtime collaborative experience.</p><p>这里的一个快速跳跃是使用电子将其构建成一个桌面应用程序。一些小事情，比如将散列保存到密钥链，直接读写文件系统。我很高兴能尝试运行DAT项目，使P2P连接能够提供实时协作体验。</p><p>    My primary goal is decentralization. I&#39;m not against storing data on the cloud, I just want to be able to make my own choice as to where. The initial standout integration I want to try is with Dropbox, syncing a folder in your filesystem to dropbox will give us the ability to introduce the &#34;push/pull&#34; aspect found in git.</p><p>我的首要目标是权力下放。我并不反对将数据存储在云上，我只是希望能够自己选择在哪里存储数据。我最初想尝试的突出集成是与Dropbox的集成，将文件系统中的文件夹同步到Dropbox将使我们能够引入Git中的推/拉(Push/Pull)方面。(=。</p><p>    I need to do further research around conflict resolution. I have the basics for a complete blockchain, which includes proof of work and consensus to ensure the validity of the underlying data structure, but it doesn&#39;t secure or handle in-app data conflicts. Visual diffs and conflicts are problems solved in various other applications, with plenty of research available. I&#39;m not sure how it will look yet, but it should be a fun one to solve.</p><p>我需要围绕冲突解决做进一步的研究。我有完整区块链的基础，包括工作证明和共识，以确保底层数据结构的有效性，但它不能保护或处理应用程序内的数据冲突。视觉差异和冲突是各种其他应用程序中解决的问题，有大量的研究可用。我还不确定它会是什么样子，但它应该是一个有趣的问题来解决。</p><p>    Using our data structure user roles and permissions are achievable. With the use of application-level permission keys, we can encrypt the access key for a specific user. They will then have access to any data under that permission level.</p><p>使用我们的数据结构，用户角色和权限是可以实现的。通过使用应用程序级别的权限密钥，我们可以加密特定用户的访问密钥。然后，他们将有权访问该权限级别下的任何数据。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://concords.app/blog/what-is-concords">https://concords.app/blog/what-is-concords</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/离线/">#离线</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/offline/">#offline</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/应用程序/">#应用程序</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1035167.html"><img src="http://img2.diglog.com/img/2020/11/thumb_16466a765904b757167c9dbf10f75946.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1035167.html">亚马逊发布了适用于Android的GameOn应用程序，该应用程序可以让手机游戏玩家录制和分享游戏片段</a></div><span class="my_story_list_date">2020-11-15 2:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1035150.html"><img src="http://img2.diglog.com/img/2020/11/thumb_1801319d968974cef0114edb73187c93.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1035150.html">应用程序信任很难，但苹果做得很好</a></div><span class="my_story_list_date">2020-11-15 0:48</span></div><div class="col-sm"><div><a target="_blank" href="/story/1035044.html"><img src="http://img2.diglog.com/img/2020/11/thumb_ca2fcc1d2b0f6a4c44f4ccf6529596ac.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1035044.html">Oculus Quest 2更新增加了对90赫兹游戏的支持；Oculus Move是一款用于在游戏中跟踪健身指标的应用程序，将于下周推出</a></div><span class="my_story_list_date">2020-11-14 9:13</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034942.html"><img src="http://img2.diglog.com/img/2020/11/thumb_b87c337b058d6b8e5d57c3a283b1b8c8.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034942.html">在PyPI上搜索恶意程序包</a></div><span class="my_story_list_date">2020-11-14 2:24</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>