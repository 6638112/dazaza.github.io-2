<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>BeOS文件系统，操作系统极客回顾展</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">BeOS文件系统，操作系统极客回顾展</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-09 15:03:37</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/9/57d4fba318ab5bab6135ca0545574952.jpg"><img src="http://img2.diglog.com/img/2020/9/57d4fba318ab5bab6135ca0545574952.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>今天是美国独立日的第二天，我们的大部分员工刚刚回到他们喜欢的工作机器上。如果现在是1997年而不是2018年，那将意味着在某些情况下启动BeOS。20多年前，从未出现过的未来操作系统出现了，因此，在这个节日到来之际，我们重新推出了这本极客指南。这篇文章最初是在2010年6月2日发布的，下面看起来没有变化。</p><p>BE操作系统文件系统，简称为BFS，是用于夏威夷、BeOS和SkyOS操作系统的文件系统。当它在90年代末作为命运多舛的BeOS项目的一部分被创建时，BFS的超前功能集立即打动了花哨的操作系统极客。该功能集包括：</p><p>十几年过去了，传奇的BFS仍然值得探索--所以我们今天继续深入讨论，从一些文件系统基础开始，接着讨论上面的特性。我们还与两个熟悉该操作系统的人进行了交谈：为BE开发BFS的人和BFS开源版本背后的开发人员。</p><p>BFS是由多米尼克·詹保罗(Dominic Giampaolo)和西里尔·默里隆(Cyril Meurillon)于1997年创立的，他们都在BE工作。它被设计为多线程和轻量级，并支持大容量的流媒体。它还旨在支持以前BE文件系统的数据库功能。尽管它是在系统通常只有8MB RAM和9 GB磁盘存储的时候编写的，但当时做出的许多前瞻性设计决策在今天仍然有效。</p><p>当BFS在未能被苹果收购后关门时，它并没有完全结束。2002年，Axel Dörfler以开源项目的形式重新实现了HAKU的BFS。本文的最后一部分是对Axel的采访。</p><p>在我们讨论BFS的特殊之处之前，我们首先必须介绍一些文件系统基础知识。</p><p>在基本级别，存在一个文件系统来管理永久存储设备上的数据。大多数文件系统常用的功能包括：</p><p>有关众多文件系统的高级概述，请参阅文章《从BFS到ZFS：过去、现在和未来的文件系统》。要更深入地了解大约2000年左右的HPFS、NTFS、ext2和XFS，请参阅实用文件系统设计的第3章。</p><p>以下术语在文件系统讨论中很常见，因此您应该浏览列表并熟悉任何您不知道的术语：</p><p>磁盘：一定大小的永久存储介质。磁盘还具有扇区或块大小，这是磁盘可以读取或写入的最小单位。磁盘的传统块大小一直是512字节，但对于较新的磁盘，它现在接近4096字节。</p><p>块：磁盘或ﬁLE系统可写入的最小单位。ﬁLE系统执行的所有操作都由对块执行的操作组成。ﬁLE系统块的大小始终等于或大于磁盘块的大小(以整数倍表示)。</p><p>位图：不是图片，而是确定磁盘上哪些块空闲或已使用的数据结构。</p><p>分区：磁盘上所有块的子集。一个磁盘可以有多个分区。</p><p>卷：指定给某些存储介质(即磁盘)上的块集合的名称。也就是说，卷可以是单个磁盘上的所有块、磁盘上块总数的某一部分，或者它甚至可以跨越多个磁盘并且是几个磁盘上的所有块。术语“卷”用于指用ﬁLE系统初始化的磁盘或分区。</p><p>超级数据块：ﬁLE系统存储其关键卷范围信息的卷区域。超级块通常包含诸如卷的大小、卷的名称等信息。</p><p>元数据：一个通用术语，指的是与某事有关但不是其直接组成部分的信息。例如，ﬁLE的大小是非常重要的信息，但它不是存储在文件本身中的数据的一部分。因此，文件元数据是关于文件的数据，而不是文件中的数据。</p><p>日志记录：一种确保ﬁLE系统元数据的正确性的方法，即使在出现电源故障或意外重新启动的情况下也是如此。</p><p>I-Node：ﬁLE系统存储有关ﬁLE的所有必要元数据的位置。I节点还提供到ﬁLE的内容和与ﬁLE相关联的任何其他数据的连接。术语“i-node”(我们将在本文中使用)由来已久，起源于Unix。I节点也称为ﬁLE控制块(Fcb)或ﬁLE记录。</p><p>属性：名称(作为文本字符串)和与名称关联的值。该值可以是deﬁNed类型(字符串、整数等)，也可以是任意数据。(1)。</p><p>现在我们已经了解了文件系统的基础知识，让我们来看看使BFS独一无二的一些功能。</p><p>首先，BFS的64位寻址意味着无论将来磁盘有多大，您都可以使用BFS格式化整个磁盘。您可以创建超过8艾字节的分区，并且根据使用的块大小，您可以创建大小超过30 GB的文件。</p><p>BFS最重要和被广泛吹捧的功能之一是它对扩展属性的支持。以MP3文件为例说明了属性重要性的示例。对MP3文件重要的信息字段是：歌曲标题、乐队、专辑、发行日期、编码率、长度、播放次数。如果要将此信息与使用常规文件系统的每个MP3文件相关联，则可能必须创建自己的数据库，以便随着音乐收藏的增长和变化来支持搜索、创建、更新或删除这些属性。相比之下，使用BFS时，可以将这些属性或任何其他属性添加到文件系统本身。这意味着编辑或播放MP3的程序不需要创建或维护数据库，因为文件系统将为您处理这些功能。BFS支持在程序控制下或从命令行将属性与文件相关联。属性可以作为任何应用程序的扩展按文件系统进行搜索和排序。如何做到这一点将在稍后详细讨论。</p><p>BFS支持创建监视文件更改的持久或“实时”查询的功能。这是一个与文件系统挂钩的查询，用于检查符合搜索条件的文件。在haiku下，这些查询很容易创建，而且令人惊讶的是它对系统资源的占用很少。</p><p>BFS是日志记录的，这意味着它可以随时跟踪某些文件系统一致性，并且不需要fsck或chkdsk等文件系统一致性工具。日志记录还有助于在意外关机后更快地启动系统。</p><p>在内部，BFS使用UTF-8字符作为目录和文件名。这意味着你几乎可以使用任何一种语言，在本地，在夏威夷语。不需要额外的努力，您就可以将文件名本地化为中文、带变音的德文字符或草写阿拉伯语。</p><p>BFS为大型文件访问提供了特殊的性能考虑。创建和读取大型视频、音频或图像文件是BFS下的优化操作。</p><p>超级块通常是文件系统的最高级别数据结构。Bfs超级块描述物理磁盘、日志区和索引。由于明显的性能原因，超级块在系统引导后保留在RAM中。</p><p>Tyecif结构DISK_SUPER_BLOCK{字符名称[B_OS_NAME_LENGTH]；Int32MAGIC1；Int32fs_byte_order；Uint32 block_size；Uint32 block_Shift；OFF_T_NUM_BLOCKS；OFF_T USED_BLOCKS；Int32inode_size；Int32 Magic2；Int32块_per_ag；Int32ag_Shift；Int32num_ags；Int32标志；BLOCK_RUN LOG_BLOCKS；Off_t log_start；Off_t log_end；Int32 Magic3；Inode_addr root_dir；Inode_addr索引；Int32 Pad[8]；}DISK_SUPER_BLOCK；</p><p>名称struct保存文件系统名称。三个幻数用于一致性检查和版本编号。FS_BYTE_ORDER保存字节顺序，BLOCK_SIZE保存显式字节计数；用作2指数的BLOCK_SHIFT还将计算块大小。这是用于文件系统一致性检查的有目的的冗余。NUM_BLOCKS保存文件系统的可用块数，USED_BLOCKS保存当前正在使用的块数。标志字段确定超级块的状态是干净的还是脏的。Root_dir指向所有文件和目录的根。索引指向扩展属性的索引部分的开头。Bfsinfo实用程序可用于将超级块转储为系统的超级块。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://arstechnica.com/open-source/news/2010/06/the-beos-filesystem.ars">https://arstechnica.com/open-source/news/2010/06/the-beos-filesystem.ars</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/操作系统/">#操作系统</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/文件系统/">#文件系统</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/file/">#file</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1022362.html"><img src="http://img2.diglog.com/img/2020/9/thumb_928ac8d0ab63452d61ca8e0295fab6e3.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1022362.html">了不起的电子纸平板电脑的自由软件操作系统</a></div><span class="my_story_list_date">2020-9-6 22:18</span></div><div class="col-sm"><div><a target="_blank" href="/story/1021219.html"><img src="http://img.diglog.com/img/2020/8/thumb_b96122a1cce07e69cae0adc2668458c8.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021219.html">Windows 95有哪些变化</a></div><span class="my_story_list_date">2020-8-30 7:32</span></div><div class="col-sm"><div><a target="_blank" href="/story/1020926.html"><img src="http://img.diglog.com/img/2020/8/thumb_18386a268dc33b50b92c8af77dd5b613.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1020926.html">消息来源：康卡斯特正在向智能电视制造商推介为其机顶盒和Flex流媒体硬件提供动力的X1软件，作为潜在的操作系统</a></div><span class="my_story_list_date">2020-8-28 22:21</span></div><div class="col-sm"><div><a target="_blank" href="/story/1020558.html"><img src="http://img.diglog.com/img/2020/8/thumb_aab1ed9e29b4b69a213af8be55664cbe.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1020558.html">苹果新iPhone操作系统令Facebook更难追踪人脸书警告将重创部分业务</a></div><span class="my_story_list_date">2020-8-27 6:23</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>