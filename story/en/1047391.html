<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>architecture.面对 Architecture.md</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Architecture.md<br/>architecture.面对 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-09 20:22:19</div><div class="page_narrow text-break page_content"><p>If you maintain an open-source project in the range of 10k-200k lines of code, I strongly encourage you to add an  ARCHITECTURE document next to  README and  CONTRIBUTING.Before going into the details of why and how, I want to emphasize that this is not another “docs are good, write more docs” advice.I am pretty sloppy about documentation, and, eg, I often use just “simplify” as a commit message.Nonetheless, I feel strongly about the issue, even to the point of pestering you:-)</p><p>如果您维护的开源项目的代码行数在1万至20万行之间，强烈建议您在“自述文件和贡献”旁边添加一个ARCHITECTURE文档。在详细介绍原因和方式之前，我想强调一下并不是另一个“文档不错，写更多文档”的建议。我对文档相当草率，例如，我经常只使用“简化”作为提交信息。尽管如此，我对这个问题还是有很强烈的看法困扰着你：-)</p><p> I have experience with both contributing to and maintaining open-source projects.One of the lessons I’ve learned is that the biggest difference between an occasional contributor and a core developer lies in the knowledge about the physical architecture of the project.Roughly, it takes 2x more time to write a patch if you are unfamiliar with the project, but it takes 10x more time to figure out  where you should change the code.This difference might be hard to perceive if you’ve been working with the project for a while.If I am new to a code base, I read each file as a sequence of logical chunks specified in some pseudo-random order.If I’ve made significant contributions before, the perception is quite different.I have a mental map of the code in my head, so I no longer read sequentially.Instead, I just jump to where the thing should be, and, if it is not there, I move it.Mental map is the source of truth.</p><p> 我在开发和维护开源项目方面都有经验，我学到的教训之一是，偶尔的贡献者和核心开发人员之间的最大区别在于对项目物理架构的了解。如果您不熟悉该项目，则需要花费2倍的时间来编写补丁，但是要花出10倍的时间才能确定应更改代码的位置。如果您一直在为某个项目工作，那么可能很难理解这种差异。如果我是代码基础的新手，我会按照伪随机顺序指定的逻辑块序列读取每个文件。如果我以前做出过重要贡献，则感觉会大不相同。代码在我的脑海中，所以我不再按顺序阅读，相反，我只是跳到应该去的地方，如果不在那儿，我就将其移动。思维导图是真理的源头。</p><p> I find  ARCHITECTURE file to be a low-effort high-leverage way to bridge this gap.As the name suggest, this file should describe the high-level architecture of the project.Keep it short: every recurring contributor will have to read it.Additionally, the shorter it is, the less likely it will be invalidated by some future change.This is the main rule of thumb for  ARCHITECTURE — specify only things which are unlikely to frequently change.Don’t try to keep it synchronized with code.Instead, revisit it a couple of times a year.</p><p> 我发现ARCHITECTURE文件是弥补这种差距的一种省力的高杠杆方式，顾名思义，该文件应描述项目的高级体系结构，请简短地说：每个经常出现的贡献者都必须阅读它。此外，它越短，将来被更改所导致的可能性就越小。这是ARCHITECTURE的主要经验法则-仅指定不太可能经常更改的内容。请勿尝试使其与代码保持同步。而是每年重新访问几次。</p><p> Start with a bird’s eye overview of the problem being solved.Then, specify a more-or-less detailed codemap.Describe coarse-grained modules and how they relate to each other.Codemap should answer “where’s the thing that does X?”.It should also answer “what does the thing that I am looking at do?”.Avoid going into details of  how each module works, pull this into separate documents or (better) inline documentation.Codemap is a map of a country, and not an atlas of maps of its states.Use this as a chance to reflect on the project structure.Are the things you want to put near each other in the codemap adjacent in  exa -TD?</p><p> 首先概述要解决的问题，然后指定或多或少的详细代码图。描述粗粒度的模块以及它们之间的关系。代码图应回答“ X在哪里？”。它还应回答“我正在看的东西做什么？”。避免深入了解每个模块的工作原理，将其放入单独的文档或（更好的）内联文档中。Codemap是一个国家/地区的地图，而不是它的状态图地图集。以此为契机来反映项目结构。您想要在exa -TD相邻的代码图中将彼此放置在一起的内容吗？</p><p> Do name important files, modules, and types.Do not directly link them (links go stale).Instead, encourage the reader to use symbol search to find the mentioned entities by name.This doesn’t require maintenance, and will help to discover related, similarly named things.</p><p> 请为重要的文件，模块和类型命名，不要直接链接它们（链接会陈旧），而是鼓励读者使用符号搜索来按名称查找所提到的实体，这不需要维护，将有助于发现相关的类似名称的事物。</p><p> Explicitly call-out architectural invariants.Often, important invariants are expressed as an  absence of something, and it’s pretty hard to divine that from reading the code.Nothing in the model layer specifically doesn’t depend on the views.</p><p> 显式地调用体系结构不变式。重要的不变式通常表示为不存在某些东西，很难通过阅读代码来区分它们。模型层中的任何内容都不完全依赖于视图。</p><p> Point out boundaries between layers and systems as well.A boundary implicitly contains information about the implementation of the system behind it.It even constraints all  possible implementations.But finding a boundary by just randomly looking at the code is hard — good boundaries have measure zero.</p><p> 还要指出层与系统之间的边界。边界隐式包含有关其背后系统实现的信息。它甚至限制了所有可能的实现。但是仅通过随机查看代码来找到边界是很难的-好边界是零。 。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://matklad.github.io//2021/02/06/ARCHITECTURE.md.html">https://matklad.github.io//2021/02/06/ARCHITECTURE.md.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>