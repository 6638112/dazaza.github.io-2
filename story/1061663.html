<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>libcurl转移状态机 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">libcurl转移状态机 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-05-10 16:11:03</div><div class="page_narrow text-break page_content"><p>我努力努力制作演示文稿，我最终呼吁引擎盖下的libcurl。该演示文稿的一部分是在解释主要的libcurl转移状态机器上，我将尝试以书面形式记录一些内容。了解Libcurl中的主要转移状态机可能对任何想要在Libcurl内部工作的人都有价值和有趣，并且可能改善它。</p><p>  状态在称为Mstate的结构字段中保持轻松句柄。此状态机的源文件称为multi.c。</p><p> 只要它存在，一个容易的手柄总是恰好的一个状态。</p><p> 此传输状态机旨在为所有协议Libcurl支持工作，但基本没有协议将通过所有状态转换。正如您在图中看到的那样，来自大量状态有许多不同的可能转变。</p><p>      转移在Init状态的表面上方启动。这是一个小的开始按钮旁边的一个黄色框。基本上，船展示了它如何从右转到Msgsent与它的完成标志，但实际路径都在表面下完成。</p><p> 黄色框（状态）是存在之前或在连接的情况下存在的框。条纹背景是针对具有与传输相关联的单个和特定ConnectData结构的所有状态。</p><p>  如果有连接限制，总计或每个主机等，转移可以被发送到待处理状态以等待变更条件。如果不是，则状态可能会移动到其中一个蓝色，以解析主机名并连接到服务器等。如果可以重用连接，它可以立即快捷方式到绿色do状态。 </p><p>绿色状态均为设置与完全连接，经过身份验证和登录状态的连接。准备发送第一个请求。</p><p>  绿色do状态是关于使用一个或多个命令发送请求，以便可以开始文件传输。有几个这样的国家可以正确支持所有协议，也有历史原因。如果我们想要，我们可能会通过一些聪明的reorg来删除一个状态。</p><p>  发出请求并转移开始时，它会转换为执行。在白色状态数据正在流动。可能很多。可能在两者或任一方向。如果在转移卷曲期间发现转移比允许的速度快，则它将转移到目标，直到它冷却一点。</p><p>  所有后转移状态都在图片中是红色的。完成是其中的第一个，并且在完成了它需要围绕转移的情况下，它将其解剖与连接并转移完成。这种状态没有条纹。解除分化意味着连接返回到连接池以便稍后重用，或者在最坏的情况下认为它无法重复使用，或者如果应用程序已指示如此，请关闭。</p><p> 您将注意到，状态机中的任何位置都没有断开连接。这只是因为断开连接并不是传输的一部分。</p><p>  这是道路的尽头。在此状态下，将创建消息并将传出队列中的用于读取的应用程序，然后作为最终的最后一步，它移动到Msgsent的内容，其中没有什么发生的。</p><p> 典型的句柄在这种状态下保持直到传输重复使用并重新启动，其中它将再次被设置为初始状态，并且旅程再次开始。可能是此时的其他传输参数和URL。或许不是。 </p><p>该状态图和解释没有显示在这些状态中，可以在每个状态中，有的协议特定处理，并且当然，这些功能中的每一个功能都有自己的国家机器来控制该做什么以及如何处理和如何处理 协议详细信息。  libcurl中的每个协议都有自己的“协议处理程序”，然后通过从通用零件的呼叫到协议_Handler-＆gt等呼叫的调用来完成libcurl中的大多数协议特定事件。proto_connect（）调用协议特定连接的proto_connect（） 程序。  这允许在本博客文章中描述的通用状态机以真正知道协议细节，并且可以支持所有当前支持26传输协议。  如果您想直接跳过状态机图和以下说明，请访问此处。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://daniel.haxx.se/blog/2021/05/10/the-libcurl-transfer-state-machine/">https://daniel.haxx.se/blog/2021/05/10/the-libcurl-transfer-state-machine/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/转移/">#转移</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/transfer/">#transfer</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/状态/">#状态</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1046621.html"><img src="http://img2.diglog.com/img/2021/1/thumb_7a1a569bc14f2295b45bb27ddf3e0aac.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1046621.html">从您的Robinhood帐户中转出股票 </a></div><span class="my_story_list_date">2021-1-29 10:48</span></div><div class="col-sm"><div><a target="_blank" href="/story/1040068.html"><img src="http://img2.diglog.com/img/2020/12/thumb_9a03ba9a78d572830ef92938f12bb7d3.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1040068.html">干洗机器人初创公司Presso筹集了160万美元，将重点转移到好莱坞 </a></div><span class="my_story_list_date">2020-12-16 22:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1025367.html"><img src="http://img2.diglog.com/img/2020/9/thumb_b48d51fce29e2284cb1f06030a90f8a7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1025367.html">窃贼转移到旧金山的家中，因为游客和他们的车都远离</a></div><span class="my_story_list_date">2020-9-22 0:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1019157.html"><img src="http://img.diglog.com/img/2020/8/thumb_785ba040e8863fa046a906c094fc5842.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1019157.html">
亲爱的索菲：我怎样才能把我的H-1B签证转移到我的创业公司？</a></div><span class="my_story_list_date">2020-8-20 0:4</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>