<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>HTTP推送已死</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">HTTP推送已死</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-13 19:34:06</div><div class="page_narrow text-break page_content"><p>One of the hot features that came with HTTP/2 was PUSH frames. The main idea isthat if the server can predict what requests a client might want to make, theserver can preemptively send request/response pairs to the client and warm it’scache.</p><p>HTTP/2附带的热门特性之一是推送帧。其主要思想是，如果服务器可以预测客户端可能想要发出的请求，那么服务器就可以抢先地向客户端发送请求/响应对，并对其进行预热缓存。</p><p> This is a feature I’ve been very interested in for a long time. I feel that itcan be incredibly useful for APIs to invalidate &amp; warm caches, remove the needfor compound requests (which I feel is a  hack, although sometimes anecessary one).</p><p>这是我很长一段时间以来一直非常感兴趣的功能。我觉得API可以让温缓存失效，消除复合请求(我觉得这是一种黑客行为，尽管有时是必要的)，这是非常有用的。</p><p> To help advance this idea, I’ve worked on a  Internet Draft to let APIclients tell the server what resources they would like to have pushed, I builta  Node.js framework with first-class, deeply integrated Push support, andadded support for  Prefer-Push to  Ketting.</p><p>为了帮助推进这个想法，我设计了一个互联网草案，让API客户端告诉服务器他们想要推送什么资源，我构建了一个Node.js框架，它具有一流的、深度集成的推送支持，并增加了对首选推送的支持，而不是Keting。</p><p> Unfortunately HTTP/2 push always felt like feature that wasn’t quite there yet.It’s usefulness was stunted due to  Cache-Digest for HTTP/2 being killedoff, and no browser APIs to hook into push events.</p><p>不幸的是，HTTP/2推送给人的感觉总是像是一种还不太存在的功能。由于HTTP/2的缓存摘要被扼杀，而且没有浏览器API可以与推送事件挂钩，它的有用性受到了阻碍。</p><p> The Chrome team has considered removing Push support since at least 2018. Themain reason being that they hadn’t really seen the performance benefit forpushing static assets. At the time, I tried to  defend the feature forthe API use-case.</p><p>Chrome团队至少从2018年就开始考虑移除推送支持。主要原因是他们没有真正看到推动静态资产带来的业绩好处。当时，我试图为API用例捍卫这一特性。</p><p> Yesterday, the Chrome team  announced to remove the feature from their HTTP/2 and HTTP/3 protocol implementations.</p><p>昨天，Chrome团队宣布从他们的HTTP/2和HTTP/3协议实现中移除该功能。</p><p> I’m a little sad that it never got to its full potential, but with this step,I no longer think it’s worthwhile to invest in this feature. So I’m ceasingmy work on  Prefer-Push, and will also remove support from the next majorKetting version.</p><p>我有点难过，因为它从来没有发挥出它的全部潜力，但有了这一步，我不再认为在这个功能上投资是值得的。因此，我将停止我在PERFER-PUSH方面的工作，并将从下一个主要的Keting版本中移除对它的支持。</p><p> On a positive note, I spent a lot of time thinking and working on this, butit is sometimes nice to just be able to close a chapter, rather than to waitand let it sizzle out. It’s not an ideal conclusion, but it’s a conclusionnonetheless.</p><p>从积极的方面来说，我花了很多时间思考和研究这一点，但有时能够结束一章，而不是等待并让它发出嘶嘶声是很好的。这不是一个理想的结论，但却是一个无结论的结论。</p><p>  Lacking server-driver push, we’re back to many small HTTP request, or compoundrequests. This means you either have the N+1 problem, or (in the case ofcompound requests) poor integration with HTTP caches.  More on this here.</p><p>由于缺少服务器驱动程序推送，我们又回到了许多小的HTTP请求或复合请求。这意味着要么存在N+1问题，要么(在复合请求的情况下)与HTTP缓存的集成不佳。有关这方面的更多信息，请点击此处。</p><p> If you’re going the ‘compound request’ route, there is a draft of a similarheader as  Prefer-Push;   Prefer: transclude, which Ketting alsosupports.</p><p>如果你采用“复合请求”路线，有一个类似的报头草案，类似于PERVER-PUSH；PERFER：Transclude，Keting也支持它。</p><p> A feature that I hoped would work well in the future with Server Push wasserver-initiated cache invalidation. We never quite got that. To work aroundthis, we use Websockets and will keep doing this for the forseeable future.</p><p>我希望服务器推送的一个特性在未来能很好地工作，那就是服务器启动的缓存失效。我们一直没有完全理解这一点。为了解决这个问题，我们使用WebSockets，并将在可预见的未来继续这样做。</p><p> To reduce general latency of fetching many things, the   103 Early Hintscan help, although this is not supported  yet in Chrome, and this is alsoonly really useful for speeding up delivery of assets like images, css andJavascript as there’s no way to hook into 1xx responses programmatically ina browser.</p><p>为了减少获取很多东西的一般延迟，103早期的Hintscan提供了帮助，尽管Chrome还不支持这一点，而且这也只对加快图像、CSS和Javascript等资产的传输非常有用，因为没有办法在浏览器中以编程方式连接到1XX响应中。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://evertpot.com/http-2-push-is-dead/">https://evertpot.com/http-2-push-is-dead/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/http/">#http</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/push/">#push</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/推送/">#推送</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034061.html"><img src="http://img2.diglog.com/img/2020/11/thumb_ba9a5ffbec05326b99ff326f7a5c40a0.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034061.html">四个强大的HTTP标头，您以前不知道</a></div><span class="my_story_list_date">2020-11-10 0:11</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033068.html"><img src="http://img2.diglog.com/img/2020/11/thumb_2657e3673b26f83372cd82988e40c6ee.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033068.html">建造一个看起来逼真的人造太阳</a></div><span class="my_story_list_date">2020-11-4 6:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030109.html"><img src="http://img2.diglog.com/img/2020/10/thumb_fd1a7bf2fa596ede87f8ecaecef8a370.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030109.html">HTTP/3说明</a></div><span class="my_story_list_date">2020-10-21 0:51</span></div><div class="col-sm"><div><a target="_blank" href="/story/1029985.html"><img src="http://img2.diglog.com/img/2020/10/thumb_deee7c290cf9b3edd3aa1948719f4fd6.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1029985.html">通往HTTP/3的漫漫长路</a></div><span class="my_story_list_date">2020-10-20 16:21</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>