<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>成为Python数据操作库Pandas的专业人士</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">成为Python数据操作库Pandas的专业人士</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-06 03:01:15</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/7/2888f827ad0be828a1f593e7fa9804d3.jpeg"><img src="http://img.diglog.com/img/2020/7/2888f827ad0be828a1f593e7fa9804d3.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>PANAAS库是Python最流行的数据操作库。受R数据帧的启发，它提供了一种通过其数据帧API操作数据的简单方法。</p><p>很好地理解熊猫的关键之一是理解熊猫主要是一系列其他Python库的包装器。主要有Numpy、SQL炼金术、Matlot库和openpyxl。</p><p>数据框的核心内部模型是一系列NumPy数组和PANDA函数，例如现在不推荐使用的“as_Matrix”函数，它们以NumPy的内部表示形式返回结果。</p><p>熊猫利用其他库将数据传入和传出数据框。例如，SQL炼金术通过read_sql和to_sql函数使用，而openpyxl和xlsx编写器用于read_excel和to_excel函数。</p><p>而Matplotlib和Seborn则用于提供一个简单的界面，使用df.lot()等命令绘制数据框内可用的信息。</p><p>您经常听到的抱怨之一是Python速度慢或难以处理大量数据。大多数情况下，这是由于编写的代码效率较低造成的。原生Python代码确实比编译后的代码要慢。尽管如此，像Pandas这样的库提供了一个Python接口来编译代码，并且知道如何正确使用该接口，让我们充分利用Pandas/Python。</p><p>熊猫和它的底层库Numpy一样，执行矢量化操作比执行循环更有效。这些效率的提高归功于矢量化操作是通过C编译代码执行的，而不是通过本机Python代码执行的。另一个因素是矢量化操作能够在整个数据集上操作，而不仅仅是当时的一个子部分。</p><p>Apply接口允许通过使用CPython接口执行循环来获得一些效率：</p><p>但是，大部分的性能提升将从使用矢量化操作本身获得，无论是直接在熊猫中使用，还是通过直接调用其内部的Numpy数组来获得。</p><p>从上图中可以看到，使用矢量化操作处理它(3.53ms)和使用Apply进行加法循环(27.8s)之间的性能差异可能非常大。通过直接调用NumPy的数组和API可以获得额外的效率，例如：</p><p>Swifter：Swifter是一个Python库，可以轻松地向量化数据框上的不同类型的操作，其API与Apply函数的API有些类似。</p><p>在将数据帧加载到内存中时，无论是通过READ_CSV、READ_EXCEL或其他数据帧读取函数，PANDA都会进行类型推断，这可能被证明是低效的。这些API允许您显式地利用数据类型指定每列的类型。指定dtype允许在内存中更有效地存储数据。</p><p>Dtype是来自Numpy的本机对象，它允许您定义用于存储某些信息的确切类型和位数。</p><p>例如，Numpy的类型np.dtype(‘int32’)将表示一个32位长的整数。熊猫默认为64位整数，使用32位可以节省一半的空间：</p><p>MEMORY_USAGE()显示每列使用的字节数，因为每列只有一个条目(行)，所以每个int64列的大小是8字节，int32是4字节。</p><p>Pandas还引入了分类dtype，它允许对频繁出现的值进行高效的内存利用。在下面的示例中，我们可以看到，当我们将字段POSTING_DATE转换为分类值时，它的内存使用率降低了28倍。</p><p>在我们的示例中，仅通过更改此数据类型，数据帧的总大小就减少了3倍以上：</p><p>使用正确的数据类型不仅允许您在内存中处理较大的数据集，而且还可以提高某些计算的效率。在下面的示例中，我们可以看到，使用分类类型可以将GROUPBY/SUM操作的速度提高3倍。</p><p>在PANDA中，您可以在数据加载期间定义数据类型(READ_)，也可以将其定义为类型转换(ASTYPE)。</p><p>CyberPandas：Cyber Pandas是不同的库扩展之一，它支持IPv4和IPv6数据类型并有效地存储它们，从而支持更广泛的数据类型。</p><p>熊猫允许以块为单位加载数据帧中的数据。因此，可以将数据帧作为迭代器来处理，并且能够处理大于可用存储器的数据帧。</p><p>在读取数据源时定义块大小和get_chunk方法的组合允许熊猫作为迭代器处理数据，例如在上面所示的示例中，数据帧一次读取两行。然后，我们可以遍历这些块：</p><p>对于df_iter中的a，i=0：#do ome chunk=df_iter.get_chunk()i+=1new_chunk=chunk.Apply(λx：do_omething(X)，new_chunk.to_csv(&#34；chunk_output_%i.csv&#34；=1)。</p><p>然后可以将其输出馈送到csv文件、腌制、导出到数据库等。…</p><p>Dask：是一个构建在Pandas之上的框架，构建时考虑到了多处理和分布式处理。它利用内存和磁盘上的熊猫数据帧块集合。</p><p>熊猫也建立在SQL炼金术的基础上，以与数据库连接。因此，它可以从各种SQL类型的数据库下载数据集，并向其中推送记录。使用SQL炼金术接口而不是熊猫的API直接允许我们执行某些在熊猫中不受本地支持的操作，例如事务或upsert：</p><p>熊猫还可以利用SQL事务来处理提交和回滚。佩德罗·卡佩拉斯特吉(Pedro Capelastegui)在他的一篇博客文章中特别解释了熊猫如何通过SQL炼金术上下文管理器利用事务。</p><p>使用SQL事务的优势在于，如果数据加载失败，事务将回滚。</p><p>Pandas有一些SQL扩展，比如Pandasql，这是一个允许在数据帧上执行SQL查询的库。通过panasql，可以像查询数据库表一样查询数据框对象。</p><p>PANDA本身不支持在支持此功能的数据库上向上插入到SQL的导出。熊猫的补丁存在，以允许这一功能。</p><p>有些Data Frame API已经集成了Matplotlib和Seborn，例如.lot命令。在熊猫的网站上，有一个相当全面的关于界面如何工作的文档。</p><p>扩展：存在不同的扩展，如Bokeh和Ploly，用于在Jupyter笔记本中提供交互式可视化，同时还可以扩展matplotlib以处理3D图形。</p><p>熊猫还有相当多的其他扩展，它们是用来处理非核心功能的。其中之一是tqdm，它为某些操作提供了进度条功能；另一个是Pretty Pandas，它允许我们格式化数据帧并添加摘要信息。</p><p>tqdm是Python中与熊猫交互的进度条扩展。用户在使用相关函数(PROGRESS_MAP和PROGRESS_APPLY)时，可以看到地图的进度，并对熊猫数据框进行操作：</p><p>PrettyPandas是一个库，它提供了一种简单的方法来格式化数据框并向其中添加表格摘要：</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/analytics-and-data/become-a-pro-at-pandas-pythons-data-manipulation-library-264351b586b1">https://medium.com/analytics-and-data/become-a-pro-at-pandas-pythons-data-manipulation-library-264351b586b1</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pandas/">#pandas</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/数据/">#数据</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1009627.html"><img src="http://img.diglog.com/img/2020/7/thumb_656faec09f514a7233919ffe7029c933.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009627.html">guietta-创建简单GUI的Python模块</a></div><span class="my_story_list_date">2020-7-3 15:34</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009451.html"><img src="http://img.diglog.com/img/2020/7/thumb_5c35becbbc4d71eacee2f845232d0e17.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009451.html">DARTS：用于时间序列处理和预测的Python库</a></div><span class="my_story_list_date">2020-7-2 18:34</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009251.html"><img src="http://img.diglog.com/img/2020/7/thumb_810d8cfa346ea0e2525b5cc0d5d2aff2.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009251.html">摩根大通Python培训指南：蛇形语言扎实入门</a></div><span class="my_story_list_date">2020-7-1 20:25</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009207.html"><img src="http://img.diglog.com/img/2020/7/thumb_39d006e6b9065b18a6737eef37410022.gif" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009207.html">Pylance：VSCode中对Python的快速、功能丰富的语言支持</a></div><span class="my_story_list_date">2020-7-1 8:57</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>