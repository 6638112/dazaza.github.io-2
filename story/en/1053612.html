<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Android逆向工程为初学者 -  Dexcalibur Android reverse engineering for beginners – Dexcalibur</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Android reverse engineering for beginners – Dexcalibur<br/>Android逆向工程为初学者 -  Dexcalibur </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-20 16:16:13</div><div class="page_narrow text-break page_content"><p>In this post I introduce you to  Dexcalibur a great tool that makes dynamic analysis reachable to beginners.This article is special since it was proof-read by Dexcalibur&#39;s developer himself!Thank you  @FrenchYeti for taking this time to read this even though I know you have a million other things to do, including a new and improved version of the tool ;)</p><p>在这篇文章中，我向你介绍了一个很好的工具，使动态分析能够对初学者进行动态分析。这篇文章是特殊的，因为它被Dexcalibur＆＃39所写的证明阅读。谢谢@Frenchyeti甚至需要读这次虽然我知道你有一百万其他事情要做，包括一个新的和改进的工具版本;）</p><p> This article is the third of a series where I use the  kbg messenger Android CTF to demonstrate the basics of Android reverse engineering. The KGB messenger CTF contains 3 challenges that should be solved sequentially:</p><p> 本文是我使用KBG Messenger Android CTF的第三个系列，以展示Android逆向工程的基础知识。 KGB Messenger CTF包含3个应按顺序解决的3个挑战：</p><p>  In this series, I use the first challenge  Alerts to introduce you to multiple Android Reverse engineering tools.In  the first post I demonstrated how to solve the challenge by decompiling the apk and patching the smali code with JADX, APKLab and apktool.In  the second post, we solved the challenge using dynamic analysis with  Frida.</p><p>  在本系列中，我使用第一个挑战警报向您介绍多个Android逆向工程工具。在第一篇文章中我演示了如何通过用Jadx，APKLAB和APKOOL修补APK和修补SMALI代码来解决挑战。邮政，我们使用Frida使用动态分析解决了挑战。</p><p>  Dexcalibur is a NodeJS tool working on Windows, macOS and GNU/Linux that uses Frida to allow you to inject snippets of code into Android applications.</p><p>  Dexcalibur是在Windows，MacOS和GNU / Linux上工作的NodeJS工具，它使用Frida允许您将代码片段注入Android应用程序。</p><p> Dexcalibur makes it easy to create hooks but does much more to help you deobfuscate the code:</p><p> Dexcalibur让您轻松创建挂钩，但更多的是帮助您使用拆除代码：</p><p> it detects code that is dynamically loaded and adds it in the workspace for you to inspect it.</p><p> 它检测到动态加载的代码，并将其添加到工作区中供您检查。</p><p>    Dexcalibur is built on NodeJS. To make sure you have the correct version, you should install  nvm, a node version manager.</p><p>    Dexcalibur建于NodeJS。要确保您拥有正确的版本，您应该安装NVM，一个节点版本管理器。 </p><p> If you use  zsh like me you can install nvm as a  zsh plugin. Basically you clone the repo with  git clone https://github.com/lukechilds/zsh-nvm ~/.oh-my-zsh/custom/plugins/zsh-nvm and add the plugin  zsh-nvm in your  .zshrc.You can then source your  .zshrc which will perform the install. You can also add the plugin  nvm for the autocompletion.</p><p>如果您使用像我这样的ZSH，您可以将NVM安装为ZSH插件。基本上你用git clone https://github.com/lukechilds/zsh-nvm〜/ .oh-my-zsh / custom / plusins / zsh-nvm克隆回购，并在你的.zshrc.you中添加插件zsh-nvm.you然后可以源您的.zshrc，它将执行安装。您还可以添加用于自动完成的插件NVM。</p><p>    The officiall Dexcalibur&#39;s documentation indicates that NodeJS 12 is necessary for the program to work.</p><p>    官方德里克西尔博尔和＃39; S文档表示NodeJS 12是用于工作程序所必需的。</p><p>   In case you have multiple node versions installed, you can list them with  nvm list then select version 12 as the default version with  nvm use v12.</p><p>   如果您安装了多个节点版本，则可以使用NVM列表列出它们，然后选择版本12作为使用NVM使用V12的默认版本。</p><p>     Frida is the tool Dexcalibur is using to create hooks. Usually, penetration testers use Frida directly to do their reverse engineering, and this process can be tedious. Dexcalibur gives us an easy way of reversing an Android application without the hassle of setting up the Frida scripts! Check out my  previous article to get started with Frida.</p><p>     Frida是Dexcalibur的工具正在使用它来创建钩子。通常，渗透测试仪直接使用Frida进行逆向工程，这一过程可能是乏味的。 Dexcalibur为我们提供了一种简单的方法，可以在没有设置Frida脚本的情况下倒换Android应用程序！查看我以前的文章以开始Frida。</p><p>        If you get an error like  python not found at the end of the installation, you might need to install a tool to make python point to python3:  sudo apt install python-is-python3.</p><p>        如果您在安装结束时找不到Python等错误，则可能需要安装一个工具，使Python指向Python3：sudo apt安装python-is-python3。</p><p>  Start the configuration process. Dexcalibur comes with sane defaults but you might want to change where the workspace is saved.</p><p>  启动配置过程。 Dexcalibur附带Sane默认值，但您可能希望更改工作空间保存的位置。</p><p>    All of our tools are installed, it is time to set up our lab composed of our phone and our test application.</p><p>    我们所有的工具都已安装，是时候设置我们的手机和测试应用程序的实验室。 </p><p>  You should refer to the  previous article to learn how to install and use  adb on your test phone.My setup consists of an Ubuntu 18.04 machine and a Samsung Galaxy S7 (SM-G930F) with a rooted LineageOS 14.1-20180712-NIGHTLY-herolte. You could also use an emulator if you don&#39;t have an Android phone to perform your tests.</p><p>您应该参考上一篇文章学习如何在测试电话上安装和使用adb.my Setup由Ubuntu 18.04机器和三星Galaxy S7（SM-G930F）组成，带有植根线果索4.1-20180712-noverly-herolte。如果您可以使用＆＃39; T有一个Android手机来执行测试，您也可以使用模拟器。</p><p> Make sure the  kgb messenger application is installed on your phone.You can install it with:</p><p> 确保在手机上安装了KGB Messenger应用程序。您可以使用：</p><p>   You also need to run frida-server on the phone.You have to make sure that the major version of frida-server matches the major version of frida-node used by Dexcalibur.If you have a bash shell you can get the version used by Dexcalibur with this command:</p><p>   您还需要在手机上运行Frida-Server.You必须确保FIDA-Server的主要版本与Dexcalibur使用的Frida-node的主要版本匹配。如果您有一个bash shell，您可以获得使用的版本Dexcalibur使用此命令：</p><p>  Here Dexcalibur uses the version 14.2.13 of frida-node, so on the  frida releases page I download the latest  frida-server with a version starting with  14, which also happens to be  14.2.13 in this case.</p><p>  在这里，Dexcalibur使用FIDA-Node的版本14.2.13，因此在Frida发行页面上，我下载了最新的Frida-Server，其中一个版本从14开始，它也发生在这种情况下为14.2.13。</p><p> Once you have the correct version of frida-server, uncompress the archive and rename the server to &#34;frida-server&#34;</p><p> 有一个正确版本的Frida-Server，解压缩存档并将服务器重命名为＆＃34; Frida-Server＆＃34;</p><p>    Next you have to start the server. This last step must be done as root:</p><p>    接下来，您必须启动服务器。最后一步必须按root完成：</p><p>  Finally run  adb devices -l to make sure the adb daemon is running.You now have a phone with adb, the target application and frida-server installed.We&#39;re ready to do some reversing!</p><p>  最后运行adb devices -l以确保adb守护程序正在运行。您现在有一个带有adb的手机，目标应用程序和frida-server .we＆＃39;准​​备好换乘折磨！ </p><p>  The purpose of this article is to get started with the tool, so I used a very simple application to do the demonstration.You&#39;ll find the detailed static analysis in the  previous article, but as quick reminder, when we open the app, we are greeted with an error message saying:</p><p>本文的目的是开始使用该工具，所以我使用了一个非常简单的应用程序来做演示。您可以在上一篇文章中找到详细的静态分析，但随着我们打开应用程序时，可以快速提醒。 ，我们被打招呼了一条错误消息，说明：</p><p>       public  void  onCreate (  bundle )  {  super . onCreate (bundle ) ;  setContentView ( ( int )   .layout .activity_main ) ;   property  =   . getProperty ( &#34;user.home&#34; ) ;   str  =   . getenv ( &#34;USER&#34; ) ;  if  (property  ==  null  || property . isEmpty ( )  ||  !property . equals ( &#34;Russia&#34; ) )  {  a ( &#34;Integrity Error&#34; ,  &#34;This app can only run on Russian devices.&#34; ) ;  }  else  if  (str  ==  null  || str . isEmpty ( )  ||  !str . equals ( getResources ( ) . getString (  .string .User ) ) )  {  a ( &#34;Integrity Error&#34; ,  &#34;Must be on the user whitelist.&#34; ) ;  }  else  { a . a ( this ) ;  startActivity ( new   ( this ,   . class ) ) ;  } }</p><p>       公共空白oncreate（捆绑）{超级。 oncreate（捆绑）; setContentView（（int）.layout .act.actity_main）;属性=。 getProperty（＆＃34; user.home＆＃34;）; str =。 GetEnv（＆＃34;用户＆＃34;）; if（property == null ||属性。isempty（）||！属性。等于（＆＃34;俄罗斯＆＃34;））{a（＆＃34;完整性错误＆＃34;，＆＃34;这个应用程序可以只在俄罗斯设备上运行。＆＃34;）; }否则如果（str == null || str。isempty（）||！str。等于（getresources（）。getstring（.string .user）））{a（＆＃34;完整性错误＆＃34;，＆＃ 34;必须在用户白名单上。＆＃34;）; }别的{a。在他的 ） ;开始活动（新（班级））; }}</p><p>    Let&#39;s start by enrolling our device in Dexcalibur.Visit  http://localhost:8000 and go into the  Device manager tab.There you should see your phone, if not try to disconnect and reconnect your phone and click refresh.</p><p>    首先通过在dexcalibur.visit http：// localhost：8000中注册我们的设备并进入Device Manager选项卡。如果不尝试断开并重新连接手机，请单击“刷新”并重新连接手机，然后单击“刷新”，然后进入“设备管理器”选项卡。</p><p>   Next, switch to the  Select an application tab and in the drop down menu choose your phone.</p><p>   接下来，切换到“选择”应用程序“选项卡，然后在”下拉菜单中“选择手机。</p><p>    Dexcalibur will start analyzing your package. Once this process is finished, you should land on the Overview page.This page just gives you a basic overview of which packages are used in the application and how much.</p><p>    Dexcalibur将开始分析您的包裹。完成此过程后，您应该在概述页面上降落。此页面只会为您提供应用程序在应用程序中使用的基本概述。</p><p>   Let&#39;s move on to the  Hook &gt; Dashboard view.On this view you have the list of every hook already created by the application.</p><p>   让＆＃39;继续前进到钩子＆gt;仪表板View.on此视图您拥有应用程序已创建的每个钩子的列表。</p><p>  For instance Dexcalibur has already created the hook for  java.security.KeyStore.getInstance().Every time this method will be called, we will have a log showing us the parameters of this function and the return value.</p><p>  例如，Dexcalibur已经创建了java.security.keystore.getInstance（）的钩子。每次调用此方法时，我们都会有一个日志向我们展示此功能的参数和返回值。 </p><p>  Let&#39;s try to run the application with these default hooks to see what happens.In the dashboard, click on  ⚡ Run (spawn).</p><p>让＆＃39; s尝试使用这些默认挂钩运行应用程序，以查看会发生什么。在仪表板中，单击“➤”运行（SPAWN）“。</p><p>  The application should launch on your phone, and Dexcalibur automatically changes the view to  Hooks &gt; Logs.There you will see all the hooked methods that were called during the execution:</p><p>  应用程序应在手机上启动，Dexcalibur自动将视图更改为挂钩＆gt;日志。您将看到在执行期间调用的所有挂钩方法：</p><p>  Here is an excerpt of the logs where we can see that the constructor  File() was called with the arguments:</p><p>  以下是日志的摘录，在那里我们可以看到使用参数调用构造函数文件（）：</p><p>    Since we have already done a static analysis of the app, we know that one of the checks looks up the property  user.home with  System.getProperty to verify that the result is &#34;Russia&#34;.Let&#39;s hook this function to bypass the first check.</p><p>    由于我们已经完成了对应用程序的静态分析，我们知道其中一个检查将使用System.getProperty查找属性User.Home以验证结果是＆＃34;俄罗斯＆＃34; .let＆＃39; s挂钩此功能以绕过第一个检查。</p><p> We start by going into the  Static analysis &gt; Search engine view.Dexcalibur provides a search utility with filters. You won&#39;t find a documentation about how to search with Dexcalibur at the moment, but the interface provides utilities to help you search methods and classes in the form of little pills acting like search wizards.</p><p> 我们首先进入静态分析＆gt;搜索引擎View.dexcalibur提供带有滤波器的搜索实用程序。您赢了＆＃39;目前查找有关如何使用Dexcalibur搜索的文档，但该界面提供了实用程序以帮助您以行为搜索向导的小药丸的形式搜索方法和课程。</p><p> Here we want to hook a method called  getProperty so click on the soft orange pill  find method by name:</p><p> 在这里我们想钩钩一个名为getProperty的方法，所以点击软橙色药丸按名称找到：</p><p>  This opens a popup where you can fill in the name of the function you are looking for.Note that you can enter a regular expression here like  getProp.* for instance.For now let&#39;s fill in  getProperty.</p><p>  这将打开一个弹出窗口，您可以在其中填写您正在寻找的函数的名称。您可以在此输入的正则表达式，如GetProp。*例如，如果现在让＆＃39;填写GetProperty。 </p><p>  Because I have already run the Dexcalibur analysis, this gives me 31 results.Notice how Dexcalibur automatically fills in the filter syntax that you could have used manually in the search box.</p><p>因为我已经运行了Dexcalibur分析，这给了我31个结果.Notice如何在搜索框中自动填充您可以在搜索框中手动使用的过滤器语法。</p><p>  I&#39;ll show you some tricks to speed up your search later. For now let&#39;s do a good old  CTRL+F and search for  System:</p><p>  我＆＃39; LL向您稍后向您展示一些诀窍来加快搜索。现在让＆＃39; s做一个很好的旧CTRL + F并搜索系统：</p><p>  Now comes the magic, if we want to hook these functions, all we have to do is click on the blue button  Probe.Once we have done that, the button switches to green with the text  Probe ON.</p><p>  现在是魔术，如果我们想钩这些功能，我们所要做的就是点击蓝色按钮探测器。我们已经完成了，按钮与文本探测器切换到绿色。</p><p>  If we go back in the view  Hook &gt; Logs and use the  🗘 Re-spawn button, the application will restart and we will see the data that passed through our new hooks.</p><p>  如果我们返回View Hook＆gt;日志和使用🗘重新生成按钮，应用程序将重新启动，我们将看到通过我们新钩子传递的数据。</p><p>   In this case the function  java.lang.System.getProperty() was called with the argument  user.home (as expected) and returned an empty string.</p><p>   在这种情况下，函数java.lang.system.getProperty（）被称为Argument User.Home（按预期）并返回一个空字符串。</p><p>    We managed to hook  System.getProperty to display its parameters and its return value.What if we wanted to modify the return value so that it always returns &#34;Russia&#34;?</p><p>    我们设法挂钩system.getProperty以显示其参数及其返回值。如果我们想要修改返回值，那么它总是返回＆＃34;俄罗斯＆＃34;</p><p> To do so, let&#39;s go back to the view  Hook &gt; Dashboard. You will see that our new hooks are listed at the bottom as  custom.In the first column, you will find a green  + button that you can click. This will open an editor where we can customise our hook.</p><p> 要这样做，让＆＃39;返回View Hook＆Gt;仪表板。您将看到我们的新钩子在底部列为自定义。在第一列中，您可以找到一个绿色+按钮，您可以单击。这将打开一个编辑，我们可以自定义我们的钩子。 </p><p>   Dexcalibur is built on top of Frida, a tool allowing us to inject QuickJS code into processes.Your JS gets executed with full access to memory, hooking functions and even calling native functions inside the process. There’s also a bi-directional communication channel that is used to talk between your app and the JS running inside the target process.</p><p>Dexcalibur建于FIDA的顶部，这是一个允许我们将QuickJS代码注入进程的工具。您可以使用完全访问内存，挂钩功能甚至调用此过程中的本机函数来执行。还有一个双向通信通道，用于在您的应用程序和目标过程中运行的应用程序之间进行通信。</p><p> The editor you see allows you to modify this JS code. If you&#39;d like to learn more about Frida, check out  my previous article.</p><p> 您看到的编辑器允许您修改此JS代码。如果您＆＃39; d想了解更多关于Frida的更多信息，请查看我以前的文章。</p><p>      Then click on &#34;Save change&#34; (the button without the refresh icon).Now go back on the  Hook &gt; Logs view and click on  🗘Respawn.The application loads with a new error message:</p><p>      然后点击＆＃34;保存更改＆＃34; （没有刷新图标的按钮）.Now返回钩子＆gt;日志视图并单击“🗘respawn”。具有新错误消息的应用程序加载：</p><p>      As stated before, Frida offers a bi-directional communication channel used to talk between your app and the JS running inside the target process. Dexcalibur uses this channel to send log data with the function  send:</p><p>      如前所述，Frida提供了一个用于在您的应用程序和目标过程内部运行的AP的双向通信通道。 dexcalibur使用此频道将日志数据发送到函数发送：</p><p>  send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; , data : {arg0 :arg0 , } , action : &#34;None before&#34; , after : false } ) ; var ret  = meth_f7b4eb07417e35b66dd2fc9687dd2fd3 . call ( this  , arg0 ) ; send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; , data : {ret :ret } , action : &#34;None before&#34; , after : true } ) ;</p><p>  发送（{id：＆＃34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njg＆＃34;，msg：＆＃34; java.lang.system.getproperty（＆lt; java.lang.string＆gt;）＆gt;＆＃34;，数据：{arg0：arg0，}，action：＆＃34;在之前和＃34之前;，之后：false}）; var ret = meth_f7b4eb07417e35b66dd2fc9687dd2fd3。致电（这，arg0）;发送（{id：＆＃34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njg＆＃34;，msg：＆＃34; java.lang.system.getproperty（＆lt; java.lang.string＆gt;）＆gt;＆＃34;，数据：{RET：RET}，动作：＆＃34;没有之前则没有*，之后：真实}）;</p><p> If you wish to send back additional data, the creator of Dexcalibur recommends to reuse the existing send functions and update the  data attribute with your additional information.</p><p> 如果要发送返回其他数据，则Dexcalibur的创建者建议重用现有的发送功能并使用其他信息更新数据属性。</p><p>  I didn&#39;t have a relevant example in mind so I just decided to list all the methods of the class  Resources and show them in the logs. Here is the modified hook of  getProperty, I added comments delimiting the added code to make it easier to read:</p><p>  我没有考虑到相关的示例，所以我刚刚决定列出类资源的所有方法，并在日志中显示它们。这是GetProperty的修改挂钩，我添加了评论界定的评论，以便更容易阅读： </p><p> var cls_68cfa6743909fdea9bcb71194c415681  =   . use ( &#39;java.lang.System&#39; ) ; var meth_f7b4eb07417e35b66dd2fc9687dd2fd3  = cls_68cfa6743909fdea9bcb71194c415681 . getProperty . overload ( &#39;java.lang.String&#39; ) ;meth_f7b4eb07417e35b66dd2fc9687dd2fd3 . implementation  =  function ( arg0 )  {  // -----------------START ADDITIONAL CODE -------------------------------  // We retrieve all the methods of the class Resources as a string array  const    =   . use ( &#34;android.content.res.Resources&#34; ) ;  const methods  =   . class . getMethods ( ) . map ( function ( m ) {  return m . toString ( ) ;  } ) ;  // -----------------END ADDITIONAL CODE ---------------------------------  send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg=&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; ,  // -----------------START ADDITIONAL CODE -----------------------------  // Here we add the object &#34;methods&#34; data : {arg0 :arg0 ,methods :methods } ,  // -----------------END ADDITIONAL CODE ------------------------------- action : &#34;None before&#34; , after : false  } ) ;  var ret  = meth_f7b4eb07417e35b66dd2fc9687dd2fd3 . call ( this  , arg0 ) ;  send ( { id : &#34;YTYwOTRkNGU4M2ViYjlmMzRjZjg5NmQ3YThlODQ1Njg=&#34; , msg : &#34;java.lang.System.getProperty(&lt;java.lang.String&gt;)&lt;java.lang.String&gt;&#34; , data : {ret :ret } , action : &#34;None before&#34; , after : true  } ) ;  return  &#34;Russia&#34; ; }</p><p>var cls_68cfa6743909fdea9bcb71194c415681 =。使用（＆＃39; java.lang.system＆＃39;）; var meth_f7b4eb07417e35b66dd2fc9687dd2fd3 = cls_68cfa6743909fdea9bcb71194c415681。 getProperty。过载（＆＃39; java.lang.string＆＃39;）; meth_f7b4eb07417e35b66dd2fc9687dd2fd3。实现=函数（arg0）{// -------------------------------------- ---------- //我们将类资源的所有方法检索为字符串阵列const =。使用（＆＃34; android.content.res.resources＆＃34;）; const方法=。班级 。 getmethods（）。映射（函数（m）{return m。toString（）;}）; // ----------------结束额外的代码------------------------------- -----发送（{id：＆＃34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njg =＆＃34;，msg：＆＃34; java.lang.system.getproperty（＆lt; java.lang.string＆gt;）＆lt; java.lang。字符串＆gt;＆＃34; ------------------------------------- -------- //我们在这里添加对象＆＃34;方法＆＃34;数据：{arg0：arg0，方法：方法}，// --------------- ----结束额外的代码---------------------------  - 行动：＆＃34;没有之前和＃34;，之后：false}）; var ret = meth_f7b4eb07417e35b66dd2fc9687dd2fd3。致电（这，arg0）;发送（{id：＆＃34; ytywotrkngu4m2viyjlmmzrjzjg5nmq3ythlodq1njg =＆＃34;，msg：＆＃34; java.lang.system.getproperty（＆lt; java.lang.string＆gt;）＆gt;＆＃34 ;，数据：{RET：RET}，动作：＆＃34;没有之前则没有*，之后：真实}）;返回＆＃34;俄罗斯＆＃34; ; }</p><p>    Earlier, when we wanted to hook  System.getProperty we used the search function in the view  Static analysis &gt; Search engine. In this section I will list some additional tips to search a function.</p><p>    早些时候，当我们想要勾取System.getProperty，我们在视图中使用了搜索功能静态分析＆gt;搜索引擎。在本节中，我将列出一些额外的提示来搜索函数。</p><p>  In our case we knew exactly the signature of your function:  java.lang.System.getProperty.We can search by signature with the filter  method(&#34;__signature__:&lt;signature_here_as_regex&gt;).</p><p>  在我们的情况下，我们确切地了解函数的签名：java.lang.System.getProperty.we可以通过剪辑搜索筛选方法（＆＃34; __签名__：＆lt; signature_hey_here_regex＆gt;）。</p><p>   Initially we searched for all methods named  getProperty with  method(&#34;name:getProperty&#34;).We can add another filter to select methods whose enclosing class is named  System:</p><p>   最初，我们搜索了与方法（＆＃34;名称：getProperty＆＃34;）的所有方法都搜索了名为getProperty的所有方法。我们可以添加另一个过滤器来选择其括号类的命名为系统的方法：</p><p>  We can use the same logic and select all methods named &#34;getProperty&#34; whose enclosing class are in the package  lang:</p><p>  我们可以使用相同的逻辑，然后选择名为＆＃34; getProperty＆＃34的所有方法;谁的封闭类是在包中的围类：</p><p>   The kgb-messenger app is easy to decompile and reverse, and as such, using Dexcalibur to solve this kind of challenge is obviously an overkill. The purpose of this article was to introduce you to the tool and the concepts of dynamic analysis. Even though we mostly relied on static analysis to solve the challenge, you should now have the basics to use Dexcalibur and perform dynamic analyses on obfuscated applications.</p><p>   KGB-Messenger应用程序易于分解和反向，因此，使用Dexcalibur来解决这种挑战显然是一个矫枉过正。本文的目的是向您介绍动态分析的工具和概念。尽管我们主要依赖于解决挑战的静态分析，但您现在应该有基础使用Dexcalibur并对混淆应用程序进行动态分析。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://braincoke.fr/blog/2021/03/android-reverse-engineering-for-beginners-dexcalibur/">https://braincoke.fr/blog/2021/03/android-reverse-engineering-for-beginners-dexcalibur/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/逆向工程/">#逆向工程</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/android/">#android</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/逆向/">#逆向</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/reverse/">#reverse</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>