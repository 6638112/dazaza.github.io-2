<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>变焦安全漏洞-破解私人会议密码</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">变焦安全漏洞-破解私人会议密码</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-29 23:41:16</div><div class="page_narrow text-break page_content"><p>缩放会议默认受6位数字密码保护，即最多100万个密码。我在Zoom web客户端中发现了一个漏洞，由于CSRF损坏且没有速率限制，该漏洞允许检查会议密码是否正确。</p><p>这使得攻击者可以在几分钟内尝试所有100万个密码，并获得访问其他人的私人(受密码保护的)Zoom会议的权限。</p><p>这也提出了一个令人不安的问题，即其他人是否已经在潜在地利用此漏洞来监听他人的电话(例如，英国内阁会议！)。</p><p>我向Zoom报告了这个问题，他很快让Web客户端离线来解决问题。他们似乎通过要求用户登录才能加入Web客户端中的会议，并将默认会议密码更新为非数字和更长的密码，从而缓解了这一问题。</p><p>3月31日，鲍里斯·约翰逊(Boris Johnson)在推特上表示，他将主持有史以来第一次数字内阁会议。我是注意到屏幕截图包含Zoom会议ID的许多人之一。Twitter上有很多人说他们正试图加入，但Zoom默认情况下会用密码保护会议(当政府使用Zoom进行辩护时就指出了这一点)。</p><p>在尝试加入后，我想看看是否能破解Zoom私人会议的密码。在接下来的几天里，我花了一些时间对Web客户端Zoom Provide的端点进行反向工程，发现我能够迭代所有可能的默认密码来发现给定私人会议的密码。</p><p>在试图加入内阁会议后，我浏览了一下Zoom应用程序，注意到默认密码是6位数字，这意味着最多有100万个密码。</p><p>密码安全的一个相当标准的原则是对密码尝试进行速率限制，以防止攻击者迭代候选密码列表并尝试所有密码。我以为Zoom会这么做，但还是决定再检查一遍。</p><p>我决定瞄准Zoom的网络客户端，但我的发现也适用于通过该应用程序的所有版本发起和进行的会议。</p><p>当用户创建新会议时，自动缩放功能会在表单(下面是虚拟数据)中生成一个供用户加入的链接：</p><p>Https://zoom.us/j/618086352?pwd=SE5OWjE6UDhwaDVJR3FJRzUyZUI3QT09它包含会议ID和自动生成的密码。我相信此密码是6位数字密码的散列版本，但我也发现Web客户端端点可以接受将其替换为6位数字版本，因此我们可以忽略散列版本，而专注于数字版本。</p><p>如果您删除pwd参数，然后访问Web客户端加入链接(https://zoom.us/wc/join/618086352)，然后您将看到登录屏幕：</p><p>这似乎触发了一个XHR GET请求，然后将您带到另一个页面。</p><p>当您第一次打开任何没有现有cookie的Web客户端页面时，会设置一个cookie，其中包含一个GUID。这似乎是您的匿名用户ID。</p><p>如果您填写了用户/通行证表单，但尚未完成隐私协议，您将被重定向至该表单。要完成它，只需向给定端点发出一个简单的GET请求，该端点包含您的GUID。在此步骤中发送了一个CSRF HTTP标头，但是如果省略它，那么无论如何请求似乎仍然工作得很好。</p><p>当您提交用户名和密码时，无论密码是否正确，您都会被302重定向到另一个页面。如果您没有完成隐私政策，您将得到200个回复。</p><p>重定向将把您带到一个新页面，该页面似乎知道服务器端您的GUID之前是否输入了正确的密码。即上一步存储状态服务器端标记您是否获得了正确的密码。</p><p>CSRF令牌上的故障使得它比其他情况下更容易被滥用，但是修复它并不能提供更多的保护来抵御这种攻击。</p><p>这个过程有点复杂，难以实现自动化，这可能就是以前没有详细研究过这个端点的原因。我跳过了一些细节，比如需要从一个请求保存到另一个请求的参数，但它们对于理解主要问题并不重要。</p><p>关于上述过程需要注意的重要一点是，对于重复密码尝试没有速率限制(每个HTTP请求包括2个HTTP请求-一个提交密码，后续请求检查服务器是否接受密码)。但是，速度受到发出HTTP请求的速度的限制，HTTP请求具有自然的延迟，这将使破解密码成为一个缓慢的过程；服务器端状态意味着您必须等待第一个请求完成，然后才能发送第二个请求。</p><p>但是，我们应该注意到状态是根据提供的GUID存储的，您可以通过发送不带cookie的HTTP请求来向服务器请求任意数量的GUID。这意味着我们可以请求一批GUID，然后将它们之间可能的100万个密码分块，并并行运行多个请求。</p><p>我把一些(相当笨重的)Python放在一起，请求一批GUID，然后产生多个线程，以便它们可以并行运行请求。在我的家用机器上运行的初始测试有100个线程：</p><p>我们可以看到，我们每秒检查大约25个密码，发现了密码(在本例中，我知道密码，因此限制了我的搜索)。我在AWS的一台机器上运行了类似的测试，在25分钟内检查了91k密码。</p><p>有了改进的线程，并且分布在4-5个云服务器上，你可以在几分钟内检查整个密码空间。这很容易做到，但我拒绝了，因为我已经演示了这个过程，并希望谨慎不要打扰Zoom的服务(我确实做了一些短期的更高速率的测试，从未被限制或阻止)。</p><p>还要注意，查找密码的预期时间会更短，因为您通常不需要搜索整个可能的密码列表。</p><p>还要注意的是，包括“个人会议ID(PMI)”在内的定期会议总是使用相同的密码，因此一旦密码被破解，您就可以持续访问。</p><p>我的攻击的初始版本只能在会议开始后运行，但我后来发现，Un-Start的DOM指示密码是否正确或不正确，这意味着您也可以破解预定的会议。</p><p>首先，请注意，虽然似乎无法更改自发会议的6位数字密码，但可以覆盖计划会议的密码，但这是更改提供的默认密码的明确步骤。我检查了我过去收到的大约20个Zoom会议邀请，这些邀请来自不同的人，我发现他们都使用默认的6位密码。</p><p>如果您确实覆盖密码并生成较长的字母数字密码，则电话用户仍可能生成6位数字密码。此密码不被接受，至少在我尝试用于Web客户端的端点上是不接受的。我不确定其他端点是否也是如此-我没有检查。</p><p>还要注意，如果密码要更新为字母数字，我估计您仍然可以在不到一个小时的时间内运行密码列表，比如说，前1000万个密码。</p><p>在其他测试中，我发现Zoom的最大密码长度为10个字符，虽然它接受非ASCII字符(如ü、EURO等)，但它会将它们全部转换为？在您保存密码之后。</p><p>最后，我在鲍里斯·约翰逊(Boris Johnson)的截图中注意到，有一个简单的名为“iPhone”的用户(见右下角)在关闭摄像头的情况下将其设为静音：</p><p>这让我想知道这个漏洞以前是否被发现过--如果我能发现它，那么似乎其他人也能发现它，这使得这个漏洞特别令人担忧。</p><p>将GUID的速率限制为合理的密码尝试次数(例如，对于给定会议，一小时内有10次[不同]次尝试失败)。</p><p>如果给定会议通过设置的密码尝试失败失败率，则速率限制或触发警告。</p><p>修复隐私条款表单上的CSRF，使自动攻击变得更加困难。</p><p>据我所知(Zoom没有让我深入了解他们采取了什么措施来缓解这个问题)，Zoom似乎做了几个改变：</p><p>开始强制用户通过Web客户端加入会议；目前还不清楚这是否是永久性的更改(据我所知，这对一些用户来说是个问题)。</p><p>已将默认密码更新为字母数字密码。这似乎是在分阶段推出，因为我有时仍然看到只有数字的密码。</p><p>我直接向Zoom报告了这个问题，他们很快让整个网络客户端离线了几天，同时他们对问题进行了分类，几天后又出现了这个问题。</p><p>我知道，鉴于新冠肺炎疫情带来的使用量突然飙升，Zoom的安全做法一直受到密切关注。从我与团队的互动中，他们似乎关心平台的安全，他们的用户和他们似乎很欣赏这份报告。</p><p>Zoom运行一个私人的，仅限邀请的错误赏金计划，这对许多组织来说是相当普遍的做法。我被邀请将这个bug提交给bug赏金计划，但我要求等待，因为我对他们正在研究的新bug赏金计划感兴趣。我想知道新的项目规则是否会保证同意披露，因为我觉得这是一个公共利益的漏洞。当新程序启动时，Zoom同意我可以在新程序下提交错误。</p><p>不幸的是，我还没有看到任何关于新的赏金计划的东西，也没有回复我最近给Zoom的消息(我肯定他们很忙，这个错误已经修复了，tbf)。因此，考虑到它已经修复了一段时间，我要披露这个bug(他们已经同意披露)。</p><p>我确实通过HackerOne上的私人程序提交了其他几个小错误，并收到了这些小错误的赏金。感谢缩放团队！🙂。</p><p>令我惊讶的是，该平台的中央机制缺乏费率限制，再加上糟糕的默认密码系统和故障的CSRF，意味着会议真的不安全。</p><p>然而，Zoom的反应很快，他们很快解决了限速问题。Zoom Meetings还获得了默认密码升级，这很棒。</p><p>在过去的几个月里，ZOOM的易用性和视频会议质量使其成为数百万人在艰难时期使用的非常有价值的工具。很多(大多数？)。完全免费使用。这是一件很棒的事情，我很感激Zoom的存在。感谢Zoom团队！</p><p>4月1日-我向Zoom报告了这个问题，并且Python POC工作正常。我通过他们的通用支持表单和电子邮件发送了这封邮件。</p><p>4月2日-我随后给出了这篇文章的草稿作为补充说明，并提供了更好的Python代码注释版本。我在Zoom上发推文询问状态，和他们在一起的DM传递了车票号码。</p><p>4月2日-从他们的团队那里得知他们正在寻找(这是在我的报告之后大约24小时)，然后收到了Zoom的CISO的跟进。</p><p>4月2日-注意到Zoom Web客户端离线，返回403。这也影响了web SDK。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.tomanthony.co.uk/blog/zoom-security-exploit-crack-private-meeting-passwords/">https://www.tomanthony.co.uk/blog/zoom-security-exploit-crack-private-meeting-passwords/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/漏洞/">#漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/密码/">#密码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/破解/">#破解</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/安全漏洞/">#安全漏洞</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/security/">#security</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1014561.html"><img src="http://img.diglog.com/img/2020/7/thumb_1c004d1122b994d25cef9f4c912e1e5c.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1014561.html">报告显示，选举官员容易受到进出口安全漏洞的影响</a></div><span class="my_story_list_date">2020-7-28 10:12</span></div><div class="col-sm"><div><a target="_blank" href="/story/1014153.html"><img src="http://img.diglog.com/img/2020/7/thumb_9f5139d758e86108845c5d627068c171.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1014153.html">黑客积极利用高度严重的网络漏洞进行攻击</a></div><span class="my_story_list_date">2020-7-26 0:32</span></div><div class="col-sm"><div><a target="_blank" href="/story/1013600.html"><img src="http://img.diglog.com/img/2020/7/thumb_a09566c780fa28929a775420bbec3f19.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1013600.html">安全漏洞暴露主要系谱数据库100多万份DNA档案</a></div><span class="my_story_list_date">2020-7-23 4:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1013544.html"><img src="http://img.diglog.com/img/2020/7/thumb_57f53a3c47605171d35f8668c0b3b31a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1013544.html">
苹果开始向顶级漏洞猎人赠送“黑客友好型”iPhone</a></div><span class="my_story_list_date">2020-7-23 1:0</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>