<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>我写了最少的C语言程序I wrote the least-C C program I could</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">I wrote the least-C C program I could<br/>我写了最少的C语言程序</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-21 15:29:14</div><div class="page_narrow text-break page_content"><p>As a fun afternoon challenge, I decided to write a C program that looked nothing like C. Not necessarily obfuscated, though there is  a competition for that if you are so inclined.</p><p>作为一个有趣的下午挑战，我决定写一个C程序，它看起来一点也不像C。不一定是模糊的，但如果你愿意的话，这是一个竞争对手。</p><p> No, instead I thought to myself, what if I turned C into an entirely different language, then wrote a program in that language, then used the C compiler to compile the program. That to me sounds like the least-C C program I could write.</p><p>不，相反，我在想，如果我把C语言变成一种完全不同的语言，然后用这种语言编写一个程序，然后用C编译器编译这个程序呢。对我来说，这听起来像是我能写的最少的C语言程序。</p><p>  #include&#34;cpaint.h&#34;var a, b, c, h, i, l, v, x, y, q, w, p size 65535 ，packed n size 13 ꞉integer ；procedure display(r,s,c) ;begin LOOP call A(Z) ; call H(y,x) ; call B(Z) POOL ; y ꞉＝ r; x ꞉＝ s; call A(c) ; call H(y,x) ; call B(c) ; call refresh()end ;procedure fill(y,x,c,a) ;begin if(y&lt;0 or y&gt;w-1 or x&lt;0 or x&gt;q-1 or c ＝ a or Z ＜＞ a)fill꞉＝ -1 ; call draw(c) ; call fill(y+1,x,c,a) ; call fill(y-1,x,c,a) ; call fill(y,x-1,c,a) ; call fill(y,x+1,c,a)end ;procedure save(r,s) ;begin i ꞉＝ 0 ; while(i&lt;13)do begin n[i] ꞉＝ 0 ; i ꞉＝ i+1 end ; call move(w&gt;&gt;1,(q&gt;&gt;1)-6) ; call printw(&#34;Save: &#34;) ; call echo() ; call getnstr(n,12) ; call noecho() ; call open(n,&#34;w+&#34;) ; call writeChar(83) ; call writeChar(w) ; call writeChar(q) ; LOOP call writeChar(Z) POOL ; y ꞉＝ r; x ꞉＝ s; call close ; call move(y,x)end ;procedure load(packed ʌ n) ;begin call open(n,&#34;r&#34;) ; call check ; LOOP readln(c); call draw(c) POOL ; c ꞉＝ 0; call closeend ;procedure m() ;begin l ꞉＝ 0 ; v ꞉＝ 1 ; call A(c) ; call H(0,0) ; call B(c) ; call refresh() ; while(v)do begin read(inp) ; &#39;/&#39;:l ꞉＝ not l ; if(l)call draw(c) ; OK &#39;k&#39;:y ꞉＝ y-1 ; if(y&lt;0)y ꞉＝ 0 ; if(l)call draw(c) ; OK &#39;j&#39;:y ꞉＝ y+1 ; if(y&gt;w-1)y ꞉＝ w-1 ; if(l)call draw(c) ; OK &#39;h&#39;:x ꞉＝ x-1 ; if(x&lt;0)x ꞉＝ 0 ; if(l)call draw(c) ; OK &#39;l&#39;:x ꞉＝ x+1 ; if(x&gt;q-1)x ꞉＝ q-1 ; if(l)call draw(c) ; OK &#39; &#39;:call draw(c) ; OK &#39;c&#39;:c ꞉＝ c+1 ; if(c ＝ M)c ꞉＝ 0 ; OK &#39;d&#39;:call draw(15) ; OK &#39;f&#39;:call fill(y,x,c,Z) ; OK &#39;s&#39;:call save(y,x) ; OK &#39;q&#39;:v ꞉＝ 0 ; OK &#39;v&#39;:c ꞉＝ c-1 ; if(c ＝ N)c ꞉＝ M-1 ; CALL display(y,x,c) endend ;procedure main(I c,packed ʌ ʌ v) ;begin call start ; call getmaxyx(stdscr,w,q) ; if(w&gt;M)w ꞉＝ M ;if(q&gt;M)q ꞉＝ M ; call start_color() ; while(x&lt;M)do begin call init_pair(x,x,x) ; x ꞉＝ x+1 end ; LOOP call draw(15) POOL ; if(c ＝ 2)call load(v[c-1]) ; call display(0,0,0) ; call m() ; call endwin()end ;call main．</p><p>#包括&#34；cpaint。h&#34；变量a、b、c、h、i、l、v、x、y、q、w、p尺寸65535，包装n尺寸13꞉整数；过程显示（r，s，c）;开始循环调用A（Z）；称为H（y，x）；呼叫B（Z）池;y꞉＝ R十、꞉＝ s呼叫A（c）；称为H（y，x）；呼叫B（c）；调用refresh（）结束;过程填充（y，x，c，a）;如果（y&lt；0或y&gt；w-1或x&lt；0或x&gt；q-1或c＝a或Z＜a）填充开始꞉＝ -1.抽签（c）；呼叫填充（y+1，x，c，a）；呼叫填充（y-1、x、c、a）；呼叫填充（y、x-1、c、a）；调用填充（y，x+1，c，a）结束;过程保存（r，s）;开始i꞉＝ 0 ; 而（i&lt；13）确实从n[i]开始꞉＝ 0 ; 我꞉＝ i+1结束呼叫移动（w&gt；&gt；1，（q&gt；&gt；1）-6）；致电printw（&#34；保存：&#34；）；调用echo（）；调用getnstr（n，12）；调用noecho（）；呼叫开放（n，&#34；w+&#34；）；呼叫writeChar（83）；呼叫writeChar（w）；呼叫writeChar（q）；循环调用writeChar（Z）池;y꞉＝ R十、꞉＝ s通话结束；调用移动（y，x）结束;过程加载（打包n）;开始调用打开;；电话查询；LOOP readln（c）；呼叫抽签（c）池;c꞉＝ 0; 调用closeend;过程m（）;开始l꞉＝ 0 ; 五、꞉＝ 1.呼叫A（c）；调用H（0,0）；呼叫B（c）；调用refresh（）；而（v）开始阅读（inp）;和#39/&#39;:L꞉＝ 不是我；如果（l）提款（c）；好的&#39；k&#39；：Y꞉＝ y-1；如果（y&lt；0）y꞉＝ 0 ; 如果（l）提款（c）；好的&#39；j&#39；：Y꞉＝ y+1；如果（y&gt；w-1）y꞉＝ w-1；如果（l）提款（c）；好的&#39；h&#39；：十、꞉＝ x-1；如果（x&lt；0）x꞉＝ 0 ; 如果（l）提款（c）；好的&#39；l&#39；：十、꞉＝ x+1；如果（x&gt；q-1）x꞉＝ q-1；如果（l）提款（c）；好的&#39&#39;:抽签（c）；好的&#39；c&#39；：C꞉＝ c+1；如果（c＝M）c꞉＝ 0 ; 好的&#39；d&#39；：抽签（15）；好的&#39；f&#39；：呼叫填充（y、x、c、Z）；好的&#39；s&#39；：调用save（y，x）；好的&#39；q&#39；：五、꞉＝ 0 ; 好的&#39；v&#39；：C꞉＝ c-1；如果（c＝N）c꞉＝ M-1；呼叫显示（y、x、c）结束;程序主（IC、打包ʌv）;开始呼叫开始；调用getmaxyx（stdscr，w，q）；如果（w&gt；M）w꞉＝ M如果（q&gt；M）q꞉＝ M调用start_color（）；虽然（x&lt；M）确实开始调用init_对（x，x，x）；十、꞉＝ x+1结束;循环调用抽取（15）池;如果（c＝2）调用负载（v[c-1]）；通话显示（0,0,0）；调用m（）；调用endwin（）结束;调用main。</p><p> I hear what you&#39;re saying: &#34;This is literally not C. It has all the markings of a Pascal language, with the semicolon as statement separator rather than statement terminator, the  := for assignment, and maybe some Algol with the  LOOP .. POOL syntax.&#34; It even has the Pascal-style return assignment where you assign the function a value and that&#39;s its return value (see the  fill procedure).</p><p>我听到你说的&#39；你说&#34；这实际上不是C语言。它具有Pascal语言的所有标记，分号作为语句分隔符而不是语句终止符，用于赋值的：=可能还有一些带循环的Algol。。池语法&#34; 它甚至有Pascal风格的返回赋值，在这里，你给函数赋值，然后&#39；s其返回值（请参见填充过程）。</p><p> Caught me. I had recently heard that  Arthur Whitney, author of the  A+,  k, and  q languages (which are array programming languages like  APL and  J), would use the C preprocessor to create his own language and then write the implementation of his language in that self-defined language. I decided to try to do the same.</p><p>抓住我了。我最近听说，A+、k和q语言（APL和J等数组编程语言）的作者Arthur Whitney将使用C预处理器创建自己的语言，然后用自定义语言编写语言的实现。我决定尝试做同样的事情。</p><p> I loosely based my self-defined language off of  PL/0, which we  wrote a compiler for previously (yes, I know I have to finish the self-hosting blog series; I will finish it).</p><p>我松散地将我的自定义语言基于PL/0，我们之前为其编写了一个编译器（是的，我知道我必须完成自托管博客系列；我会完成它）。</p><p> The hero of this exercise was the fact that the C compilers understand UTF-8 characters as valid characters for identifiers. I use lots of characters that look like ASCII but are in fact not ASCII but nonetheless accepted as valid identifier characters. The C preprocessor happily accepts macros that transform these identifiers into whatever you need them to. You can see the hidden away header file  here. Creative use of whitespace helped finish it off.</p><p>本练习的重点是C编译器将UTF-8字符理解为标识符的有效字符。我使用了很多看起来像ASCII的字符，但实际上不是ASCII，但仍然被接受为有效的标识符字符。C预处理器愉快地接受宏，这些宏将这些标识符转换为您需要的任何内容。你可以在这里看到隐藏的头文件。创造性地使用空格有助于完成它。</p><p>   For a short afternoon, it was amusing. I probably won&#39;t try something like this again. But it was fun to discover some interesting ways to abuse the C preprocessor.</p><p>在短短的一个下午里，一切都很有趣。我可能赢了&#39；不要再尝试这样的事情了。但是发现一些滥用C预处理器的有趣方法是很有趣的。</p><p> Oh, and if you actually want to use the program, it&#39;s a simple terminal paint program.</p><p>哦，如果你真的想使用这个程序，它&#39；这是一个简单的终端绘制程序。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/语言/">#语言</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/wrote/">#wrote</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/调用/">#调用</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>