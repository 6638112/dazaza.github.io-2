<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>为什么Godot不基于ECS的游戏引擎？ </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">为什么Godot不基于ECS的游戏引擎？ </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-27 09:06:24</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/aefff4b4b75cc335c7b0601e29100357.png"><img src="http://img2.diglog.com/img/2021/2/aefff4b4b75cc335c7b0601e29100357.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>为什么Godot不使用ECS的话题经常出现，因此本文将解释其背后的设计决策，并阐明Godot的工作原理。</p><p>  ECS是视频游戏中常用的一种设计模式（尽管在软件行业的其余部分中很少使用），它包含一个基础实体（一个容器对象）和可以添加的组件。组件提供了数据以及与整个世界进行交互的方式。最后，系统独立工作，并对每个相似的组件执行操作。</p><p> 这种设计在2010年代初期在游戏引擎和库中变得很普遍。主要的吸引力（除体系结构之外）是可以将组件数据放置在连续的内存中，从而改善缓存访问的事实。这是面向数据的优化的常见形式。</p><p> 从结构上讲，ECS旨在通过支持组合来代替继承，类似于接口或多重继承在OOP中的工作方式。 ECS的主要优势在于组件是动态的（可以在运行时添加或删除）。</p><p>  Godot通过提供既包含数据又包含逻辑的节点来使用更传统的OOP。它还大量使用继承。</p><p> 那么，如果ECS提供更多好处，为什么还要使用这种类型的架构？答案需要分为两个部分：架构原因和优化原因。</p><p>   但是，我认为这个问题应该重新表述为：＆＃34;合成所提供的增加的灵活性是否值得额外付费？ </p><p>这里的问题变得更加主观（因此，取决于每个开发人员的经验）。以我的个人经验，它更符合以下方面：</p><p> 我发现继承要简单得多，尤其是在需要多态的情况下。扩展比组成需要更少的精力和整体代码。因此，Godot还通过继承来编写脚本。</p><p> 继承似乎也更容易理解。这可以在Godot与其他技术的两种常见情况中得到证明：添加新节点：节点列表很整洁，并且通过继承很好地进行了组织，这可能是由于隐含了这种关系。</p><p> 看一看场景树：节点仅做一件事，因此仅查看场景就很容易理解场景的作用。</p><p> 综上所述，这并不意味着Godot由于使用继承而没有那么灵活。通过添加子节点，在Godot中仍然可以完美地进行合成，这与ECS中的合成类似。 Node类是轻量级的，可以扩展以执行所需的任何操作。</p><p>  迁移到Godot的大多数用户推荐都强调，使用它的方式感觉更井井有条，缠着头也更容易。同样，这并不意味着Godot的处事方式比其他技术要好。这仅意味着，由于这个事实，大量尝试Godot的用户只是喜欢它。</p><p>  ECS的另一个重要方面是声称它更易于实现面向数据的设计（由于数据和逻辑之间的分离）。这样做更快吗？绝对地！它要快得多。 </p><p>再一次，应该问的真正问题是＆＃34;值得吗？根据引擎和游戏架构的不同，差异很大。对于Godot的具体情况，答案取决于我们所讨论的领域：</p><p>  Godot在物理，渲染，音频等方面使用了大量面向数据的优化。但是，它们是独立的系统，并且是完全隔离的。</p><p> 利用ECS的大多数（如果不是全部）技术都在核心引擎级别上做到这一点，方法是用作基础架构并在其上构建其他所有内容（物理，渲染，音频等）。</p><p> 相反，Godot，这些子系统都是独立且隔离的（并且适合服务器内部）。我发现这使代码更简单，更易于维护和优化（证明这是微小的Godot的代码库与其他游戏引擎相比，同时提供相似级别的功能）。</p><p> 与传统的ECS系统相比，Godot（节点）中的场景系统通常级别很高。大多数情况都是通过信号回调发生的（例如，对象碰撞，需要重新粉刷某些东西，按下按钮等）。需要从用户端在Godot的每个帧中处理某些事情的情况非常少见，因为引擎将在内部进行管理，从而使用户摆脱了复杂性。</p><p> 换句话说，作为引擎的Godot试图减轻用户的处理负担，而是着重于确定事件发生时的处理方式。这确保了用户不必为了编写大量游戏代码而进行的优化减少，并且成为Godot试图传达的观点的一部分，该观点应构成一种易于使用的游戏引擎。</p><p>  在游戏逻辑方面使用ECS时，某些类型的游戏仍然（虽然到目前为止还不是大多数）在性能上有所提高。 </p><p>这些通常是游戏，需要处理成千上万个对象上的游戏逻辑，因此必须进行面向数据的优化，因为移入CPU缓存的页面数量增加了几个数量级，从而严重影响性能（以及电池消耗）。移动设备）。</p><p> 再次强调一点，虽然这种用例很少（相反，大多数游戏通常最多只有数百个对象，但是对于这些对象，如果不进行缓存优化，则其内存访问频率远远不够用），游戏确实需要缓存优化的事实确实存在。</p><p>  一些策略游戏（虽然不是大多数，但可以同时使用成千上万个游戏单元）。</p><p> 这是否意味着ECS是解决这些性能限制的唯一方法？不总是。同样，它取决于许多因素。</p><p> 很多时候，您仍然可以依靠聪明的优化。有没有想过SimCity如何在Commodore 64上运行？它通过交替处理每帧要处理的图块来实现，因此不需要同时处理数千个图块（在6502 CPU上是不可能的）。</p><p> 从不处理所有帧中的所有内容到为处理可见的（或靠近相机）的所有内容提供更高的优先级，优化的方式可能有所不同。通常，这些优化将需要处理的对象数量减少几个数量级，并且仍然比完全面向数据的性能更好。</p><p> 您实际上是否需要ECS来编写面向数据的游戏逻辑？在许多情况下，将所有内容自己放入结构中并使用for循环进行迭代（或使用诸如OpenMP之类的线程扩展来迭代多个线程）更为简单。沙盒就是一个很好的例子，这种方法通常更好。 </p><p>通常，与使用基于CPU的优化相比，GPU Compute可能是更好的选择。如今，大多数设备都支持它，而且这种支持将很快得到普遍支持。计算很容易编程，并且可以实现比CPU高出数倍的并行性能。</p><p>  有效地开发OOP是困难的，并且需要很多年才能适应，但是其他任何体系结构也是如此。除了游戏之外，当今（如果不是大多数）的大量企业软件是通过利用面向对象的体系结构开发的，该体系结构已经被充分理解并证明能够用于任何规模的项目和团队（因此，请不要盲目相信人们告诉您OOP不好，或者它不能扩展）。</p><p> 传统上，游戏是在非常受限的环境中运行的（与现代台式机相比，控制台是非常有限的硬件），这迫使程序员在资源使用方面非常保守。</p><p> 如今，情况已不再如此，并且出现了一些游戏开发技术，这些技术可以牺牲一些这种效率，以换取更易用和更舒适的开发体验。</p><p> 然而，结果仍然存在着许多关于更传统的游戏软件开发方法的神话或半数真理，随着时间的流逝，它们将逐渐消失。</p><p>  旨在同时解决多个问题的体系结构和设计模式对于程序员来说非常诱人，而Godot的开发则采用了非常务实的方法。</p><p> 尽管ECS确实可以带来很多好处，但是可以客观地证明对Godot目标有好处的案例非常有限，因此（至少对我们而言）很难证明更改架构是合理的，因为它们是例外，而不是通用规则（并且通常可以通过其他更简单的方法来实现优化）。 </p><p>也就是说，如果您喜欢或需要使用ECS，我强烈建议检查Andrea Catania关于Godex的出色工作，该工作旨在为Godot带来高性能的ECS实施。  此外，我们正在讨论游戏能够使用当前的节点/场景系统选择性地分离数据/逻辑以实现更高性能的方法（理论上，这没有必要一定是ECS的唯一优势），因此请继续 敬请期待进一步的工作和更新！ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://godotengine.org/article/why-isnt-godot-ecs-based-game-engine">https://godotengine.org/article/why-isnt-godot-ecs-based-game-engine</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/godot/">#godot</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1049688.html"><img src="http://img2.diglog.com/img/2021/2/thumb_9c8de869284c6abd66eb093f3bddba3e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049688.html">神奇宝贝传奇：Arceus隐身的开放世界将在2022年登陆Switch </a></div><span class="my_story_list_date">2021-2-27 8:44</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049616.html"><img src="http://img2.diglog.com/img/2021/2/thumb_7c3765b0d26a622d9afe52a95f94d759.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049616.html">在2021年更新“ 101种基本计算机游戏” </a></div><span class="my_story_list_date">2021-2-27 0:51</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049601.html"><img src="http://img2.diglog.com/img/2021/2/thumb_31679354aceaffc548b05242e0d54364.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049601.html">索尼结束了Japan Studio的工作，专注于Astro的Playroom团队 </a></div><span class="my_story_list_date">2021-2-26 16:10</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049542.html"><img src="http://img2.diglog.com/img/2021/2/thumb_9628056f9f47faccb19d5e29ac77a2e4.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049542.html">最终幻想VII重制版Intergrade引领最新的PlayStation游戏发布活动 </a></div><span class="my_story_list_date">2021-2-26 8:17</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>