<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>姜戈·异步：有什么新鲜事，下一步是什么？</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">姜戈·异步：有什么新鲜事，下一步是什么？</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-08-15 02:54:53</div><div class="page_narrow text-break page_content"><p>所有你需要知道的关于异步支持的信息都在最新的Django 3.1中增加了。</p><p>从几周前发布的最新版本Django 3.1开始，Django现在完全支持异步请求路径。这对于自从安德鲁·戈德温的DEP 0009于2019年7月获得Django技术委员会批准以来一直在座位边缘等待的每个人来说都是令人兴奋的。如果您有Django应用程序在生产中并希望添加异步支持，请继续阅读以了解此版本意味着什么。在DeepSource，我们正致力于在Python分析器中添加更多Django问题，其中还将包括异步特定的错误风险和反模式。</p><p>在Django 3.1中，现在跨请求-响应周期支持异步功能。这意味着您可以使用Async关键字定义完全异步视图：</p><p>异步定义GET_CAT_FACTS(请求)：&#34；&#34；&#34；&#34；返回随机CAT事实。&#34；&#34；&#34；与aiohttp异步。ClientSession()作为会话：与会话异步。获取(&#39；https://catfact.ninja/fact&#39；)作为响应：DATA=等待响应。Json()返回数据。</p><p>其中最令人兴奋的是异步支持完全向后兼容。这意味着您可以使用异步和同步视图的任意组合，Django将保证始终在正确的执行上下文中执行。因此，如果您不想立即移植所有内容，只需拨动开关，只需添加一个异步视图，而不会对现有的同步代码进行任何速度倒退。</p><p>Def simple_midleware(Get_Response)：异步def中间件(Request)：#做一些有趣的事情响应=等待get_response(请求)返回响应返回中间件。</p><p>由于中间件可以支持同步和异步请求的任意组合，如果只支持一种类型的请求(就像上例中只支持异步请求)，Django将尝试满足中间件的要求-但会以性能为代价。建议使用SYNC_AND_ASYNC_MIDDLEWARE修饰器来定义支持这两种请求的中间件。在文档中可以找到更多的例子。</p><p>Django的所有异步功能在WSGI和ASGI上都完全受支持-尽管如果您使用WSGI运行异步代码会有性能损失，并且长时间运行的请求效率不高。如果您想让您的同步代码在全新的异步视图和ASGI模式下很好地工作，建议使用sync_to_async修饰符。</p><p>如果您从视图执行大量外部HTTP调用，异步视图允许您在本地并行进行这些调用。这可能会带来很大的减速带，特别是如果您以前在同步视图中使用过异步代码的话。如果您的视图涉及作为请求路径的一部分进行的繁重计算或长时间运行的网络调用，这是使用异步视图的一个很好的用例。</p><p>ORM、缓存层和涉及长时间运行的网络调用的代码的其他几个部分还不支持异步。ORM中对异步特性的支持预计很快就会到来，因为它是初始DEP的一部分。像模板和缓存后端这样的功能将需要更多时间，因为这些功能将需要它们自己的独立DEP和研究才能完全异步。</p><p>Django 3.0开始了为Django带来完全异步功能的旅程，首先是增加了对可以运行同步代码的ASGI的支持。在这个版本中，如果您不需要对Django的某些还不支持异步的部分进行繁重的操作，那么您实际上可以将异步代码投入生产。事实上，所有更改都保证100%向后兼容，这本身就是一个令人印象深刻的壮举-而且它很快就保证了Django中完全异步支持的光明未来！</p><p>DeepSource帮助您在代码检查期间自动查找并修复代码中的问题，例如错误风险、反模式、性能问题和安全缺陷。使用您的Bitbucket、GitHub或GitLab帐户设置只需不到5分钟。它适用于Python、Go、Ruby和JavaScript。</p><p>免费开始</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://deepsource.io/blog/django-async-support/">https://deepsource.io/blog/django-async-support/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/django/">#django</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/姜戈/">#姜戈</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>