<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用Python分析卷配置文件 How to Analyze Volume Profiles with Python</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">How to Analyze Volume Profiles with Python<br/>如何使用Python分析卷配置文件 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-16 09:47:04</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/1/5a2ef13fc85ac98787f91f1907d843cb.png"><img src="http://img2.diglog.com/img/2021/1/5a2ef13fc85ac98787f91f1907d843cb.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>When trading in markets such as equities or currencies it is important to identify value areas to inform our trading decisions. One way to do this is by looking at the  volume profile.</p><p>在股票或货币等市场交易时，重要的是要确定价值区域，以为我们的交易决策提供依据。一种方法是查看音量配置文件。</p><p> In this post, we explore quantitative methods for examining the distribution of volume over a period of time.</p><p> 在这篇文章中，我们探索定量方法来检查一段时间内的体积分布。</p><p> More specifically, we’ll be using Python and statistical and signal processing tools in SciPy’s suite of modules. Data plots are rendered with Plotly.</p><p> 更具体地说，我们将在SciPy的模块套件中使用Python以及统计和信号处理工具。数据图使用Plotly渲染。</p><p>   In short,  vol ume conveys the amount of assets transacted during a period of time. Another dimension we can look at is the volume transacted around given price levels. This is known as a  volume profile.</p><p>   简而言之，体积传达了一段时间内交易的资产数量。我们可以查看的另一个维度是在给定价格水平下的交易量。这称为音量配置文件。</p><p>    Areas where significant volume is accumulated form high volume nodes (or clusters). These volume nodes can be helpful in determining important price levels to watch.</p><p>    大量堆积的区域形成大量节点（或群集）。这些交易量节点有助于确定重要的价格水平。</p><p>  It’s easy to visually spot volume nodes in the charts above but the idea here is to do it with code. So let’s see how we can do that.</p><p>  在上面的图表中直观地发现体积节点很容易，但是这里的想法是使用代码来实现。因此，让我们看看我们如何做到这一点。</p><p>  First, we’ll fetch data for the asset and timeframe shown in the charts above. We’ll be fetching minute data to allow us to construct a volume profile with enough granularity.</p><p>  首先，我们将获取上表中显示的资产和时间范围的数据。我们将获取分钟数据，以便我们构建具有足够粒度的音量配置文件。 </p><p> In this example, we’re looking at spot Forex which means we don’t have true volume data. The volume data here is tick volume which serves as a proxy for actual volume transacted.</p><p>在此示例中，我们查看的是现货外汇，这意味着我们没有真实的交易量数据。此处的交易量数据是滴答交易量，它充当实际交易量的代理。</p><p>   Now let’s plot the volume profile which is just a histogram along the price axis.</p><p>   现在，让我们绘制成交量分布图，它只是沿价格轴的直方图。</p><p>   A histogram is a good way of showing the distribution of our data. However, it’s rough and can vary depending on how the bins are defined. Let’s find a more convenient way to model our distribution.</p><p>   直方图是显示数据分布的好方法。但是，这很粗糙，并且可能会根据垃圾箱的定义方式而有所不同。让我们找到一种更方便的方式来对我们的发行进行建模。</p><p>  A  kernel density estimator (KDE) is a non-parametric way to estimate the probability density function (PDF) of a random variable. This allows us to represent our distribution as a smooth and continuous curve.</p><p>  核密度估计器（KDE）是一种非参数方法，用于估计随机变量的概率密度函数（PDF）。这使我们可以将分布表示为平滑连续的曲线。</p><p> We’ll use SciPy’s  gaussian_kde to get our PDF. We can plot a normalized histogram with the curve to see how it fits.</p><p> 我们将使用SciPy的gaussian_kde获取我们的PDF。我们可以用曲线绘制标准化的直方图，以查看其拟合程度。</p><p>    To help us determine the structure of our volume profile, we use  find_peaks from SciPy’s signal processing module.</p><p>    为了帮助我们确定音量配置文件的结构，我们使用了SciPy信号处理模块中的find_peaks。</p><p>   At this point, we already have some useful data to work with. For instance, we have some relatively interesting price points based on our volume profile.</p><p>   至此，我们已经有了一些有用的数据。例如，根据我们的数量资料，我们有一些相对有趣的价格点。 </p><p> But we can do better!  find_peaks provides us the ability to specify constraints to further filter out noise.</p><p>但是我们可以做得更好！ find_peaks使我们能够指定约束以进一步滤除噪声。</p><p>  For starters, we can specify a minimum prominence for our peaks. This can help us identify more pronounced volume nodes. Let’s plot some lines representing each peak’s prominence to see what that looks like.</p><p>  首先，我们可以为峰指定最小突出度。这可以帮助我们识别更明显的体积节点。让我们绘制一些代表每个峰的突出的线，以查看其外观。</p><p>   Prominence is defined as the vertical distance between the peak and its lowest contour line. Let’s filter for peaks where the prominence is at least 30% of the range.</p><p>   突出定义为峰与其最低轮廓线之间的垂直距离。让我们过滤一下突出度至少为范围的30％的峰。</p><p>    Now let’s say we’re looking for areas of high volume and tight consolidation. In other words, we’re interested in areas where a lot of activity happened within a small range. We can find this by specifying constraints on the width of our peaks.</p><p>    现在，假设我们正在寻找大量和紧密整合的领域。换句话说，我们对在小范围内发生大量活动的区域感兴趣。我们可以通过指定对峰宽的约束来发现这一点。</p><p> First let’s plot markers showing the width of the peaks. By default, the width is calculated at half the relative height of the peak.</p><p> 首先，让我们绘制标记以显示峰的宽度。默认情况下，宽度是在峰的相对高度的一半处计算的。</p><p>   On the hourly chart, our  average true range during the week was around 14  pips. Let’s set our max width at 20 pips. To do this, we’ll need to convert our range in prices to number of samples.</p><p>   在小时图上，我们一周的平均真实波动范围约为14个点。让我们将最大宽度设置为20点。为此，我们需要将价格范围转换为样本数量。</p><p>   We’ve now spotted an area of tight consolidation and high volume. In terms of technical analysis, this would be a key value area to watch!</p><p>   现在，我们发现了一个紧密合并和大量交易的区域。就技术分析而言，这将是一个值得关注的关键价值领域！ </p><p>  Maybe we don’t care so much about the width or range of our volume node. What if instead, we were more interested in the total density of the volume node? The PDF is a continuous curve, so we’ll need to take the integral between a range to get the density. We’ll use the base of the peaks to determine the range to integrate over.</p><p>也许我们不太关心体积节点的宽度或范围。如果相反，我们对体积节点的总密度感兴趣吗？ PDF是连续的曲线，因此我们需要对范围进行积分以获取密度。我们将使用峰的底部来确定要积分的范围。</p><p>   Since this is a  probability density function, our density values are normalized. As a reminder, the integral over the entire range is equal to 1.</p><p>   由于这是一个概率密度函数，因此我们的密度值已归一化。提醒一下，整个范围内的积分等于1。</p><p>  So far we were able to download price and volume data over a time period and view the distribution across price as a volume profile. We used a Gaussian KDE to fit a PDF over this data and utilized some signal processing tools to extract useful information.</p><p>  到目前为止，我们已经能够下载一段时间内的价格和数量数据，并且可以将整个价格的分布作为数量概况查看。我们使用高斯KDE将PDF拟合到该数据上，并利用一些信号处理工具来提取有用的信息。</p><p> I hope this was helpful especially for those interested in algorithmic trading. This is only a starting point and we would need to make it more robust before incorporating in a research or trading system.</p><p> 我希望这对那些对算法交易感兴趣的人特别有用。这只是一个起点，我们需要在纳入研究或交易系统之前使其更加强大。</p><p> Thanks for reading and feel free to reach out if you have any comments or suggestions!</p><p> 感谢您的阅读，如果您有任何意见或建议，请随时与我们联系！ </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://metaminh.medium.com/how-to-analyze-volume-profiles-with-python-3166bb10ff24">https://metaminh.medium.com/how-to-analyze-volume-profiles-with-python-3166bb10ff24</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/volume/">#volume</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>