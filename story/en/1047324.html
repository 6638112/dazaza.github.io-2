<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>“扩展随机”的奇怪故事 The strange story of “Extended Random”</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">The strange story of “Extended Random”<br/>“扩展随机”的奇怪故事 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-06 22:58:10</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/3a1e7bf200479f8190c7d627b2637e27.jpg"><img src="http://img2.diglog.com/img/2021/2/3a1e7bf200479f8190c7d627b2637e27.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Yesterday, David Benjamin posted a  pretty esoteric note on the IETF’s TLS mailing list.  At a superficial level, the post describes some seizure-inducingly boring flaws in older Canon printers. To most people that was a complete snooze. To me and  some of my colleagues, however, it was like that scene in X-Files where Mulder and Scully finally learn that aliens are real.</p><p>昨天，大卫·本杰明（David Benjamin）在IETF的TLS邮件列表中发布了一个非常神秘的说明。从表面上看，这篇文章描述了老式佳能打印机中一些引起癫痫发作的缺陷。对大多数人来说，这是一个完全的贪睡。然而，对我和我的一些同事来说，就像X文件中的那个场景一样，Mulder和Scully最终了解到外星人是真实的。</p><p> Those fossilized printers confirmed a theory we’d developed in 2014, but had been unable to prove: namely, the existence of a specific feature in RSA’s BSAFE TLS library called “ Extended Random” — one that we believe to be evidence of a concerted effort by the NSA to backdoor U.S. cryptographic technology.</p><p> 这些僵化的打印机证实了我们在2014年开发的一种理论，但无法证明：即RSA的BSAFE TLS库中存在名为``扩展随机''的特定功能-我们认为这是共同努力的证据由美国国家安全局（NSA）使用后门美国密码技术。</p><p> Before I get to the details, I want to caveat this post in two different ways. First, I’ve written about the topic of cryptographic backdoors way too much. In 2013, the Snowden revelations revealed the existence of a campaign to  sabotage U.S. encryption systems. Since that time, cryptographers have spent  thousands of  hours identifying,  documenting, and trying to convince people to care about these backdoors. We’re tired and we want to do more useful things.</p><p> 在开始详细介绍之前，我想以两种不同的方式对这篇文章加以说明。首先，我对加密后门的话题写得太多了。 2013年，斯诺登（Snowden）的泄密事件揭露了一场破坏美国加密系统的运动。从那时起，密码学家花费了数千个小时来识别，记录和试图说服人们关心这些后门。我们很累，我们想做更多有用的事情。</p><p> The second caveat covers a problem with  any discussion of cryptographic backdoors. Specifically, you never really get  absolute proof. There’s always some innocent or coincidental explanation that could sort of fit the evidence —  maybe it was all a stupid mistake. So you look for patterns of unlikely coincidences, and use Occam’s razor a lot. You don’t get a Snowden every day.</p><p> 第二点警告涉及加密后门的任何讨论问题。具体来说，您永远不会真正获得绝对的证明。总是有一些天真的或偶然的解释可能符合证据，也许这都是愚蠢的错误。因此，您寻找巧合不太可能的模式，并经常使用Occam的剃须刀。您不会每天得到斯诺登。</p><p> With all that said, let’s talk about Extended Random, and what this tells us about the NSA. First some background.</p><p> 综上所述，让我们谈谈扩展随机性，以及这如何告诉我们有关NSA的信息。首先介绍一些背景。</p><p>  To understand the context of this discovery, you need to know about a standard called  Dual EC DRBG. This was a proposed  random number generator that the NSA developed in the early 2000s. It was standardized by NIST in 2007, and later deployed in some important cryptographic products — though we didn’t know it at the time.</p><p>  要了解此发现的上下文，您需要了解一种称为Dual EC DRBG的标准。这是美国国家安全局（NSA）在2000年代初期开发的一种提议的随机数发生器。 NIST在2007年对它进行了标准化，后来将其部署在一些重要的密码产品中，尽管当时我们还不知道。</p><p> Dual EC has a major problem, which is that it likely contains a backdoor. This was pointed out in 2007 by  Shumow and Ferguson, and  effectively confirmed by the Snowden leaks in 2013. Drama ensued. NIST responded by pulling the standard. (For an explainer on the Dual EC backdoor, see  here.)</p><p> Dual EC有一个主要问题，那就是它可能包含一个后门。 Shumow和Ferguson在2007年指出了这一点，并在2013年Snowden泄漏中得到了有效证实。 NIST通过取消该标准做出了回应。 （有关Dual EC后门的说明，请参见此处。） </p><p> Somewhere around this time the world learned that RSA Security had made Dual EC the default random number generator in their popular cryptographic library, which was called  BSAFE. RSA hadn’t exactly kept this a secret, but it was such a bonkers thing to do that nobody (in the cryptographic community) had known. So for years RSA shipped their library with this crazy algorithm, which made its way into all sorts of commercial devices.</p><p>大约在这个时候，全世界都知道RSA Security已将Dual EC设为其流行的密码库（称为BSAFE）中的默认随机数生成器。 RSA并没有完全保密，但是这样做实在是一件令人毛骨悚然的事情，在加密社区中没人知道。因此，多年来RSA都使用这种疯狂的算法向其库提供了支持，该算法已进入各种商业设备。</p><p> The RSA drama didn’t quite end there, however. In late 2013, Reuters reported that  RSA had taken $10 million to backdoor their software. RSA sort of denies this. Or something. It’s not really clear.</p><p> 但是，RSA戏剧还没有结束。 2013年末，路透社报道称RSA已拿出1000万美元用于后门软件。 RSA对此有所否认。或者其他的东西。还不清楚。</p><p> Regardless of the intention, it’s known that RSA BSAFE did incorporate Dual EC. This could have been an innocent decision, of course, since Dual EC was a NIST standard. To shed some light on that question, in 2014  my colleagues and I decided to reverse-engineer the BSAFE library to see if it the alleged backdoor in Dual EC was actually exploitable by an attacker like the NSA. We figured that specific engineering decisions made by the library designers could be informative in tipping the scales one way or the other.</p><p> 无论意图如何，众所周知RSA BSAFE确实包含了Dual EC。当然，这可能是一个无辜的决定，因为Dual EC是NIST标准。为了阐明这个问题，在2014年，我和我的同事决定对BSAFE库进行反向工程，以查看所谓的Dual EC中的后门是否实际上可被NSA等攻击者利用。我们认为，图书馆设计师做出的具体工程决策可能会有益于以一种方式或另一种方式扩展规模。</p><p>   In the course of reverse engineering the Java version of BSAFE, we discovered a funny inclusion. Specifically, we found that BSAFE supports a non-standard extension to the  TLS protocol called “Extended Random”.</p><p>   在对Java版本的BSAFE进行反向工程的过程中，我们发现了一个有趣的内容。具体来说，我们发现BSAFE支持TLS协议的非标准扩展，称为“扩展随机”。</p><p> The  Extended Random extension is an IETF Draft proposed by an NSA employee named Margaret Salter (at some point the head of NSA’s Information Assurance Directorate, which worked on “defensive” crypto for DoD) along with Eric Rescorla as a contractor. (Eric was very clearly hired to develop a decent proposal that wouldn’t hurt TLS, and would primarily be used on government machines. The NSA did not  share their motivations with him.)</p><p> 扩展随机扩展名是由NSA雇员Margaret Salter（有时是NSA信息保证局局长，负责国防部的``防御性''加密货币）提出的IETF草案，Eric Rescorla是承包商。 （很明显，埃里克被雇用来制定一份不会损害TLS的体面的提议，并且主要用于政府机器上。美国国家安全局（NSA）没有与他分享他们的动机。）</p><p> It’s important to note that Extended Random  by itself does not introduce any cryptographic vulnerabilities. All it does is increase the amount of random data (“nonces”) used in a TLS protocol connection. This shouldn’t hurt TLS at all, and besides  it was largely intended for U.S. government machines.</p><p> 请务必注意，扩展随机数本身不会引入任何加密漏洞。它所做的只是增加TLS协议连接中使用的随机数据（“随机数”）的数量。这一点根本不会伤害TLS，此外它主要用于美国政府的计算机。</p><p> The only thing that’s interesting about Extended Random is what happens  when that random data is generated using the Dual EC algorithm. Specifically, this extra data acts as “rocket fuel”, significantly increasing the efficiency of exploiting the Dual EC backdoor to decrypt TLS connections.</p><p> 关于扩展随机的唯一有趣的事情是使用Dual EC算法生成随机数据时发生的情况。具体来说，这些额外的数据充当“火箭燃料”，大大提高了利用Dual EC后门解密TLS连接的效率。 </p><p> In short, if you’re an agency like the NSA that’s trying to use Dual EC as a backdoor to intercept communications, you’re much  better off with a system that uses  both Dual EC DRBG and Extended Random. Since Extended Random was never standardized by the IETF, it shouldn’t be in any systems. In fact, to the best of our knowledge, BSAFE is the only system in the world that implements it.</p><p>简而言之，如果您是像NSA这样的机构，试图使用Dual EC作为后门来拦截通信，那么使用同时使用Dual EC DRBG和Extended Random的系统则要好得多。由于扩展随机数从未由IETF标准化，因此不应在任何系统中使用。实际上，据我们所知，BSAFE是世界上唯一实施该系统的系统。</p><p> In addition to Extended Random, we discovered a variety of features that, combined with the Dual EC backdoor, could make RSA BSAFE fairly easy to exploit. But Extended Random is by far the strangest and hardest to justify.</p><p> 除了扩展随机，我们发现了多种功能，再加上Dual EC后门，可以使RSA BSAFE相当容易利用。但是到目前为止，扩展随机数是最奇怪，最难辩解的。</p><p> So where did this standard come from? For those who like technical mysteries, it turns out that Extended Random isn’t the only funny-smelling proposal the NSA made. It’s actually one of  four failed IETF proposals made by NSA employees, or contractors who work closely with the NSA, all of which try to boost the amount of randomness in TLS. Thomas Ptacek has a mind-numbingly detailed discussion of these proposals and his view of their motivation  in this post.</p><p> 那么这个标准是从哪里来的呢？对于那些喜欢技术奥秘的人来说，事实证明，“扩展随机”并不是国家安全局提出的唯一有趣的建议。实际上，这是NSA员工或与NSA紧密合作的承包商提出的四个失败的IETF提案之一，所有这些提案都试图提高TLS的随机性。托马斯·帕塔塞克（Thomas Ptacek）在这些帖子中对这些建议及其动机提出了令人费解的头脑。</p><p> Oh my god I never thought spies could be so  boring. What’s the new development?</p><p> 噢，天哪，我从没想过间谍会这么无聊。最新发展是什么？</p><p> Despite the fact that we found Extended Random in RSA BSAFE (a free version we downloaded from the Internet), a fly in the ointment was that it didn’t actually seem to be  enabled. That is: the code was there but the switches to enable it were hard-coded to “off”.</p><p> 尽管我们在RSA BSAFE（我们从互联网下载的免费版本）中找到了Extended Random，但美中不足的是它实际上并未启用。那就是：代码在那里，但是启用它的开关被硬编码为“关闭”。</p><p> This kind of put a wrench in our theory that RSA might have included Extended Random to make BSAFE connections more exploitable by the NSA. There might be  some commercial version of BSAFE out there with this code active, but we were never able to find it or prove it existed. And even worse, it might appear only in some special “U.S. government only” version of BSAFE, which would tend to undermine the theory that there was something intentional about including this code — after all, why would the government spy on itself?</p><p> 这种做法在我们的理论上大有裨益，认为RSA可能包含扩展随机数，以使BSAFE连接更易于被NSA利用。可能有一些商业版本的BSAFE可以激活此代码，但我们始终无法找到它或证明它存在。更糟糕的是，它可能只会出现在某些特殊的“美国BSAFE的“仅政府”版本，这往往会破坏有关包含此规范的某些意图的理论-毕竟，政府为什么要自我监视？</p><p> Which finally brings us to  the news that appeared on the TLS mailing list the other day. It turns out that certain Canon printers are failing to respond properly to connections made using the new version of TLS (which is called 1.3), because they seem to have implemented an unauthorized TLS extension using the same number as an extension that TLS 1.3 needs in order to operate correctly. Here’s the relevant section of David’s post:</p><p> 最后，这使我们了解到前几天出现在TLS邮件列表中的新闻。事实证明，某些佳能打印机无法正确响应使用新版TLS（称为1.3）建立的连接，因为它们似乎实现了未经授权的TLS扩展，其扩展名与TLS 1.3所需的扩展名相同。为了正确操作。这是David帖子的相关部分： </p><p>   So in short, this news appears to demonstrate that commercial (non-free) versions of RSA BSAFE did deploy the Extended Random extension, and made it active within third-party commercial products. Moreover, they deployed it specifically to machines — specifically off-the-shelf commercial printers — that don’t seem to be reserved for any kind of special government use.</p><p>简而言之，此消息似乎表明RSA BSAFE的商业（非免费）版本确实部署了Extended Random扩展，并使其在第三方商业产品中有效。此外，他们专门将其部署到了机器上，尤其是现成的商用打印机，这些机器似乎并没有为政府的任何特殊用途保留。</p><p> (If these turn out to be special Department of Defense printers, I will eat my words.)</p><p> （如果这些证明是国防部的特殊打印机，我会吃掉我的话的。）</p><p> Ironically, the printers are now the only thing that still exhibits the features of this (now deprecated) version of BSAFE. This is not because the NSA was targeting printers. Whatever devices they were targeting are probably gone by now. It’s because printer firmware tends to be obsolete and yet highly persistent. It’s like a remote pool buried beneath the arctic circle that preserves software species that would otherwise vanish from the Internet.</p><p> 具有讽刺意味的是，打印机是现在唯一仍然具有此BSAFE版本（现已弃用）功能的东西。这不是因为NSA是针对打印机。他们针对的任何设备可能现在都已经消失了。这是因为打印机固件趋于过时而又持久。这就像是一个埋在北极圈下的远程池，其中保留了本来可以从互联网上消失的软件种类。</p><p> Which brings us to the moral of the story:  not only are cryptographic backdoors a terrible idea, but they totally screw up the assigned numbering system for future versions of your protocol.</p><p> 这带给我们故事的寓意：加密后门不仅是一个可怕的主意，而且还完全破坏了为协议的未来版本分配的编号系统。</p><p> Actually no, that’s a pretty useless moral. Instead, let’s just say that you can deploy a cryptographic backdoor, but it’s awfully hard to control where it will end up.</p><p> 其实不，这是非常无用的道德。相反，我们只能说您可以部署加密后门，但是很难控制它的最终位置。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.cryptographyengineering.com/2017/12/19/the-strange-story-of-extended-random/">https://blog.cryptographyengineering.com/2017/12/19/the-strange-story-of-extended-random/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/奇怪/">#奇怪</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/story/">#story</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tls/">#tls</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>