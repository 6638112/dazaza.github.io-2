<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Godot游戏引擎中复杂的文本布局进度报告</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Godot游戏引擎中复杂的文本布局进度报告</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-10 19:46:43</div><div class="page_narrow text-break page_content"><p>This is the second part of my work on Complex Text Layouts for Godot 4.0, focusing on Fonts and UI mirroring.</p><p>这是我为Godot4.0所做的复杂文本布局工作的第二部分，重点是字体和用户界面镜像。</p><p> See  godot-proposals#1180,  godot-proposals#1181,  godot-proposals#1182, and  godot-proposals#1183 on GitHub for detailed information on  CTL proposals and feedback.</p><p>有关CTL建议和反馈的详细信息，请参见GitHub上的戈多-提案#1180、戈多-提案#1181、戈多-提案#1182和戈多-提案#1183。</p><p>   Since font handling was moved to  TextServer, some substantial changes were made to the Godot  Font and related classes:</p><p>自从字体处理转移到TextServer后，Godot Font和相关类做了一些实质性的更改：</p><p> BitmapFont,  DynamicFont and  DynamicFontData were removed and replaced with universal  Font and  FontData resources which are backed by  TextServer. This provides cleaner font fallback/substitution and possibility for custom text servers to expose different types of fonts without interface changes, for example direct access to the system fonts.</p><p>BitmapFont、DynamicFont和DynamicFontData被移除，取而代之的是由TextServer支持的通用字体和字体数据资源。这为自定义文本服务器提供了更清晰的字体后备/替换，并且可以在不更改界面的情况下公开不同类型的字体，例如直接访问系统字体。</p><p> The new  Font class provides new functions to draw and measure multiline text, and apply alignment.</p><p>新的Font类提供了绘制和测量多行文本以及应用对齐方式的新函数。</p><p> Font and outline size, that were properties of the  Font instance, are moved to the arguments of the draw functions and theme constants. This allows changing font size for individual draw calls, controls, or spans of text in the  RichTextLabel control without creating new  Font instances.</p><p>字体和轮廓大小是Font实例的属性，它们被移到绘图函数和主题常量的参数中。这允许更改RichTextLabel控件中单个绘制调用、控件或文本跨度的字体大小，而无需创建新的Font实例。</p><p> Functions for loading font data from the memory buffer are exposed to GDScript and GDNative.</p><p>从内存缓冲区加载字体数据的函数向GDScript和GDNative公开。</p><p>   Each  FontData has an associated list of supported scripts (writing systems) and languages. For a TrueType/OpenType fonts, a script list is populated automatically from the OS2 table, but it&#39;s not always precise.</p><p>每个FontData都有一个支持的脚本(书写系统)和语言的关联列表。对于TrueType/OpenType字体，脚本列表是从OS2表自动填充的，但它并不总是精确的。</p><p>  For each run of text with a specific script and language,  TextServer will try to use fonts in the following order:</p><p>对于具有特定脚本和语言的每个文本串，TextServer将尝试按以下顺序使用字体：</p><p>  Many Latin fonts have a limited set of Greek characters for use in scientific texts (and such fonts usually have Greek script support flag set in the OS2 table), but it&#39;s not always enough to display Greek text. Adding a separate font with full Greek support, and disabling Greek support in the main font will prevent  TextServer from mixing characters form different fonts.</p><p>许多拉丁字体在科学文本中只有一组有限的希腊字符(这些字体通常在OS2表格中设置了希腊文字支持标志)，但它并不总是足以显示希腊文本。添加完全支持希腊语的单独字体，并在主字体中禁用希腊语支持，将防止TextServer混合不同字体的字符。</p><p> TrueType/OpenType font tables do not have flags for rare/ancient scripts (e.g. Egyptian hieroglyphs), enabling script support manually will speed up font substitution.</p><p>TrueType/OpenType字体表格没有稀有/古老文字(例如埃及象形文字)的标志，手动启用脚本支持将加快字体替换速度。</p><p> Some languages use the same script, but different font styles (e.g. Kufic, Naskh and Nastaʼlīq writing styles preferred for writing different Arabic languages; or the use of traditional Chinese characters in different regions and CJK variants - Traditional Chinese, Simplified Chinese, Japanese, and Korean). Setting language overrides allows to seamlessly use the same font stack for the text in different languages and get the desired style.</p><p>一些语言使用相同的文字，但字体风格不同(例如，Kufic、Naskh和Nastaʼlīq书写风格首选用于书写不同的阿拉伯语；或者在不同地区使用繁体中文和中日韩变体-繁体中文、简体中文、日语和韩语)。通过设置语言覆盖，可以无缝地对不同语言的文本使用相同的字体堆栈，并获得所需的样式。</p><p> Incorrect font used for &#34;μ&#34;:   Correct font used for &#34;μ&#34;:    Labels with  language property set, using the same  Font instance:   CJK variants,  Labels using same font instance:</p><p>用于&#34；μ&#34；的字体不正确：用于&#34；μ&#34；的字体正确：设置了Language属性的标签使用相同的字体实例：cjk变体，使用相同字体实例的标签：</p><p>  Additionally, the new  Font and  TextServer&#39;s  BiDi and shaping features can work with variable fonts (see  godot#43030 for the variable font support PR):</p><p>此外，新的字体和文本服务器的BiDi和Shape功能可以使用可变字体(有关可变字体支持PR，请参阅Godot#43030)：</p><p>  Functions to control the font size were added to the  Theme,  Control, and  Window classes:</p><p>在Theme、Control和Window类中添加了控制字体大小的函数：</p><p> Theme functions:  clear_font_size,  get_font_size,  get_font_size_list,  has_font_size,  set_font_size to control the font size in a similar manner to existing functions for  Font. The special value  -1 can be used as unset/default (have the same effect as  null for the font).</p><p>主题函数：CLEAR_FONT_SIZE、GET_FONT_SIZE、GET_FONT_SIZE_LIST、HAS_FONT_SIZE、SET_FONT_SIZE以与现有字体函数类似的方式控制字体大小。特定值-1可用作取消设置/默认设置(与字体的NULL效果相同)。</p><p>  To ensure that the content is easy to understand, user interfaces for the right-to-left written languages should flow from right-to-left. UI &#34;mirroring&#34; provides a convenient way to achieve this without designing separate interfaces for the  RTL and  LTR languages.</p><p>为了确保内容易于理解，从右到左的书面语言的用户界面应该从右到左排列。UI&34；镜像提供了一种方便的方式来实现这一点，而无需为RTL和LTR语言设计单独的接口。</p><p>  In most cases, UI mirroring should happen automatically, and do not require any actions from the user or knowledge of the RTL writing systems.</p><p>在大多数情况下，用户界面镜像应该自动发生，不需要用户执行任何操作，也不需要了解RTL编写系统。</p><p> Each  Control has a  layout_direction property to control mirroring. It can be set to  inherited (use the same direction as the parent control, same as  auto for the root control),  auto (direction is determined based on the current locale), or forced to RTL or LTR.</p><p>每个控件都有一个Layout_Direction属性来控制镜像。它可以设置为继承(使用与父控件相同的方向，与根控件的自动相同)、自动(方向根据当前区域设置确定)或强制设置为RTL或LTR。</p><p> On the above screenshots, the green and blue &#34;compass&#34; controls are forced to LTR and RTL layout respectively, the red container is set to  auto and the rest of the UI uses  inherited (default setting) direction.</p><p>在上面的屏幕截图上，绿色和蓝色的指南针控件分别被强制为LTR和RTL布局，红色容器被设置为AUTO，而UI的其余部分使用继承的(默认设置)方向。</p><p>  Mirror horizontal order of the child controls in the containers, and items in  Tree/ ItemList controls.</p><p>映射子控件在容器中的水平顺序，以及树/项列表控件中的项。</p><p> Use mirrored order of the internal control elements (e.g.  OptionButton dropdown button, checkbox alignment,  List column order,  Tree item icons and connecting line alignment, etc.), in some cases mirrored controls use separate theme styles.</p><p>使用内部控件元素的镜像顺序(例如，OptionButton下拉按钮、复选框对齐、列表列顺序、树项目图标和连接线对齐等)，在某些情况下，镜像控件使用单独的主题样式。</p><p>  The Unicode  BiDi algorithm is designed to work with natural text and it&#39;s incapable of handling text with a higher level order, like file names, URIs, email addresses, regular expressions or source code.</p><p>Unicode BiDi算法是为处理自然文本而设计的，它不能处理具有更高级别顺序的文本，如文件名、URI、电子邮件地址、正则表达式或源代码。</p><p> The  structured_text_bidi_override property and the  _structured_text_parser callback are added to the all text controls to handle this.</p><p>STRUCTED_TEXT_BIDI_OVERRIDE属性和_STRUCTED_TEXT_PARSER回调被添加到All Text控件以处理此问题。</p><p>  For example, the path for the directory structure in the above screenshot will be displayed incorrectly (top  LineEdit control). The  File type structured text override splits text into segments, then the BiDi algorithm is applied to each of them individually to correctly display directory names in any language and preserve correct order of the folders (bottom  LineEdit control).</p><p>例如，上面屏幕截图中目录结构的路径将显示错误(顶行编辑控件)。文件类型结构化文本覆盖将文本分割成多个片段，然后分别对每个片段应用BiDi算法，以正确显示任何语言的目录名，并保留正确的文件夹顺序(底线编辑控件)。</p><p> Custom callbacks provide a way to override BiDi for the other types of structured text. For example, the following code splits a text using  : as separator, applies BiDi to each part, and displays them in reversed order. The BiDi override can be used with any control, including input fields ( LineEdit,  TextEdit).</p><p>自定义回调提供了覆盖其他类型结构化文本的BiDi的方法。例如，下面的代码使用：作为分隔符拆分文本，对每个部分应用BiDi，并以相反的顺序显示它们。BiDi覆盖可以与任何控件一起使用，包括输入域(LineEdit、TextEdit)。</p><p> func _structured_text_parser(args, text):    var ranges = []    var offset = 0    for t in text.split(&#34;:&#34;):        var text_offset = offset + t.length()        ranges.push_front(Vector2i(offset, text_offset) # Add text        ranges.push_front(Vector2i(text_offset, text_offset + 1)) # Add &#34;:&#34;        offset = text_offset + 1    return ranges</p><p>Func_Structed_text_parser(args，text)：var range=[]；var Offset=0，for t in text。Split(&#34；：&#34；)：var var text_Offset=Offset+t.long()，在文本范围内添加文本。Push_front(Vector2i(Offset，Text_Offset)#Add text for Text range。ush_front(Vector2i(Text_Offset，Text_Offset+1)#。</p><p>   language property (only for controls with text):Overrides the locale for that node: controls language specific line breaking rules, OpenType localized form, shaping, and font substitution.</p><p>Language属性(仅适用于带有文本的控件)：覆盖该节点的区域设置：控制特定于语言的换行规则、OpenType本地化形式、形状和字体替换。</p><p>  opentype_features property (only for controls with text):Controls OpenType font features for the node e.g. ligature types to use, number styles, small caps, etc. ( Full list of standard tags, fonts can have custom features as well).</p><p>OpenType_Feature属性(仅适用于带有文本的控件)：控制节点的OpenType字体功能，例如要使用的连字类型、数字样式、小型大写等。(完整的标准标签列表，字体也可以有自定义功能)。</p><p>   UI mirroring, Font, Theme, and control changes:  godot#41100 (commits 5 to 8, the PR is regularly rebased to keep up with upstream changes, exact commit hashes may vary).</p><p>用户界面镜像、字体、主题和控件更改：Godot#41100(提交5到8个，PR会定期调整基数以跟上上游的更改，确切的提交散列可能会有所不同)。</p><p>    The next part will focus on the changes to the specific controls and  RichTextLabel BBCode.</p><p>下一部分将重点介绍对特定控件和RichTextLabel BBCode的更改。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://godotengine.org/article/complex-text-layouts-progress-report-2">https://godotengine.org/article/complex-text-layouts-progress-report-2</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/text/">#text</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/字体/">#字体</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034230.html"><img src="http://img2.diglog.com/img/2020/11/thumb_93724ab2e02ae14ffb4b1c80a05e7b41.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034230.html">“反法西斯”电子游戏公司的懦弱--《旁观者》</a></div><span class="my_story_list_date">2020-11-10 18:43</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034216.html"><img src="http://img2.diglog.com/img/2020/11/thumb_0fb09a3364f3c3e6c1e3c974e5e6d186.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034216.html">游戏中的皮肤-纳西姆·尼古拉斯·塔勒布(Nassim Nicholas Taleb)-在谷歌(Google)交谈(2018年)</a></div><span class="my_story_list_date">2020-11-10 15:24</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034176.html"><img src="http://img2.diglog.com/img/2020/11/thumb_1b055b0d8f34b2e58bb08ccb080b6c0e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034176.html">
索尼准备与AirPeak一起进军无人机游戏</a></div><span class="my_story_list_date">2020-11-10 8:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034131.html"><img src="http://img2.diglog.com/img/2020/11/thumb_509d806856cdaafae3d2b287a982ed4a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034131.html">
解密：GrayShift筹集4700万美元，苹果漏洞受到攻击，视频游戏制造商遭到黑客攻击</a></div><span class="my_story_list_date">2020-11-10 4:26</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>