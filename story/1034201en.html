<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>AppleCrate II：一种基于Apple II的新型并行计算机</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">AppleCrate II：一种基于Apple II的新型并行计算机</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-10 12:18:39</div><div class="page_narrow text-break page_content"><p>In 2004 I built the first  AppleCrate, an 8-board system, as an inexpensive, easy to programvehicle for experiments in parallel programminga kind of &#34;blade server&#34; for the Apple II, ifyou will! AppleCrate I (at the time I didn&#39;t realize that it was number &#34;I&#34; ;-) was great fun, and itenabled some very interesting experiments, but over time I discovered some of its shortcomings.</p><p>2004年，我建造了第一台AppleCrate，这是一款8板系统，作为一种廉价、易于编程的工具，用于苹果II的并行编程实验，就像是一种刀片服务器，如果你愿意的话！AppleCrate I(当时我并没有意识到它是第几个)非常有趣，它促成了一些非常有趣的实验，但随着时间的推移，我发现了它的一些缺点。</p><p> First and foremost, since the boards were supported by only two edges and not clamped in place, itwas relatively fragile and hard to transport. Second, I had come across situations in which morethan 8 slave processors would have been useful. Third, my arrangement for collecting audio signalssynthesized by the slaves was quite makeshift and delivered sound with lots of digital &#34;hash&#34;as background noise. And finally, the original AppleCrate made no provision for plugging I/O cardsinto any of its boards, so it had to be hosted by a separate Apple II, adding to the problem oftransporting it for demonstrations.</p><p>首先也是最重要的一点是，由于电路板只有两条边支撑，没有固定到位，因此相对易碎，很难运输。其次，我遇到过8个以上的从属处理器可能有用的情况。第三，我收集奴隶们合成的音频信号的安排是相当临时的，用大量数字作为背景噪音来传递声音。最后，最初的AppleCrate没有规定将I/O卡插入任何主板，因此它必须由单独的Apple II托管，这增加了运送演示的问题。</p><p> The AppleCrate II is designed to be significantly improved in all of the areas that wereproblems for the AppleCrate I.</p><p>AppleCrate II的设计目的是在AppleCrate I存在问题的所有领域都有显著改进。</p><p>     The AppleCrate II is made from 17 Enhanced Apple //e main boards. (Fifteen of these boards wereobtained in the same eBay auction that netted the eight unenhanced boards for the original AppleCrate.)Because they are enhanced ROMs, the original NadaNet boot ROM code would not fit and a newboot protocol had to be developed, as described below.</p><p>AppleCrate II由17个增强型Apple//e主板组成。(其中15块是在同一个eBay拍卖中获得的，该拍卖为最初的AppleCrate净赚了8块未增强的主板。)由于它们是增强型ROM，原来的NadaNet引导ROM代码不适合，必须开发新的引导协议，如下所述。</p><p> Instead of mounting the cards vertically in a frame, as in the original, I decided to mount themhorizontally in a stack secured with standoffs3/4&#34; long hexagonal rods, each with a screw protruding fromone end and a tapped hole in the other. The AppleCrate II has nine &#34;columns&#34; of these standoffssixmetal columns at the back and corners of the boards and three nylon columns interior to the boardsto add stiffness, as shown in the photo below at the 2-board construction stage:</p><p>我没有像原来那样把卡片垂直地装在一个框架里，而是决定把它们水平地安装在一叠用立柱固定的六角形杆上，每根杆的一端都有一个螺丝钉，另一端有一个螺纹孔。AppleCrate II在板的背面和角落有9根六金属立柱，在板的内部有3根尼龙柱，以增加硬度，如下图所示的两块板的建造阶段：</p><p>  This &#34;hi-rise&#34; construction makes the &#34;stack&#34; quite rigid and sturdy, while eliminating the needfor a space-consuming exoskeleton. It also has the advantage of leaving the top board unobstructedso that I/O cards can be plugged in, allowing it to serve as the host machine for the AppleCrate. (In fact,I used 17 boards so that the top board can serve as master and leave 16 slave machines for parallelprograms.)</p><p>这种高耸结构使堆叠变得非常坚硬和坚固，同时消除了对消耗空间的外骨骼的需要。它还具有保持顶板通畅的优点，这样就可以插入I/O卡，使其成为AppleCrate的主机。(事实上，我使用了17块板，这样顶板就可以充当主板，并为并行程序留下16台从机。)。</p><p> The Pushbutton 1 input and Annunciator 1 output bus wires and the AN2-to-PB2 GETID daisy chain wires are connected tomachined-pin sockets inserted into the 16-pin game port connector. These connections support  NadaNet,which is the only signal connection between the boards. The network adapter (described below) is shownwith its mounting bracket under what will be the third board. The power bus card is supported by asimilar angle bracket, and the standoffs immediately beneath them are filed down to accomodate thebracket thickness.</p><p>按键1输入和信号器1输出总线导线和AN2到PB2 GETID菊花链导线连接到插入16针游戏端口连接器的机械针脚插座。这些连接支持NadaNet，这是板之间唯一的信号连接。图中显示了网络适配器(如下所述)及其安装支架，安装支架位于第三块板的下方。电源母线卡由类似的角托架支撑，紧邻其下的支架向下倾斜以适应托架厚度。</p><p> The boards are powered by a PC AT power supply. The average power consumed by an Apple //eboard is about 4.2 watts, so the whole 17-board crate consumes only about 70 watts in total,and both the AppleCrate and the power supply run only a few degrees above ambient temperature.</p><p>电路板由PC AT电源供电。Apple//eboard的平均功耗约为4.2瓦，因此整个17板板箱总共只消耗约70瓦，并且AppleCrate和电源都只比环境温度高几度。</p><p> I decided to use #12 copper bus wiresto distribute power to all boards (visible on the right side of the first photo). I would have preferreda connectorized approach, but I could not come up with a connector scheme with areasonable mating/unmating force. As a result, I decided to go with soldered power connections.(It&#39;s a good thing that Apple //e&#39;s are so reliable, since replacing one in the middle of thestack would be relatively difficult!)</p><p>我决定使用#12铜母线将电力分配给所有电路板(在第一张照片的右侧可见)。我本想采用连接化的方法，但我想不出一个具有合理配合/不配合力的连接件方案。因此，我决定采用焊接式电源连接。(苹果的电源如此可靠是一件好事，因为更换电池组中间的一个是相对困难的！)。</p><p> The top board is used as the &#34;master&#34; machine with I/O cards and an external keyboard plugged into it.The Master boots the 16 slave Apples in the AppleCrate II and uses them to run parallel programs.Once they have been booted and started, they can run independently of the masterthough they are clearlyI/O-constrained!</p><p>顶板用作主板，带有I/O卡和外部键盘。主板引导AppleCrate II中的16个从属苹果，并用它们来运行并行程序。一旦它们被引导和启动，它们就可以独立于主板运行，尽管它们明显受到I/O限制！</p><p>     It has proven useful to have some real-time indication of each board&#39;s activity. The stock board contains ared &#34;power&#34; LED (at the right) and a red &#34;speaker&#34; LED at the left. Both are easily visible from the back of theboards (the &#34;front&#34; of the AppleCrate). The function of the power LED is fixed, but the speaker LED is usableas an indicator that software running on the board can operate, just by toggling the speaker. For example,printing a &#34;beep&#34;CHR$(07)causes the speaker LED to flash for 0.1 second, and can be used to indicate somecondition in the software. (The speaker LED will not light when a speaker is installed, but AppleCrateboards have no speakers attached.)</p><p>事实证明，对每个董事会的活动有一些实时指示是有用的。电源板的右边有一个红色的电源LED，左边有一个红色的扬声器LED。从面板的背面(AppleCrate的正面)可以很容易地看到这两款手机。电源LED的功能是固定的，但扬声器LED可以作为主板上运行的软件可以操作的指示器，只需切换扬声器即可。例如，打印蜂鸣音$(07)会导致扬声器LED闪烁0.1秒，并可用于指示软件中的某些情况。(安装扬声器后，扬声器LED不会亮起，但AppleCrateboard没有连接扬声器。)。</p><p> Although the Applecrate network interface described below incorporates an LED to show global network activity,it is very useful to be able to see when any particular board is sending on the network. This need is met byusing the PDL 3 timer to &#34;stretch&#34; each packet send operation into a visible flash of a green rectangular LED.</p><p>尽管下面描述的Applecrate网络接口包含一个LED来显示全球网络活动，但能够看到任何特定板卡在网络上发送的时间是非常有用的。通过使用PDL3定时器将每个数据包发送操作转换为绿色矩形LED的可见闪烁，即可满足这一需求。</p><p>  These photos show the modification made to the 558 timer chip, in which a 267-ohm resistor (just what Ihad handyany value between 220 and 560 ohms is fine) is connectedbetween pins 5 and 8, and the &#34;send&#34; signalling LED is connected between pin 8 and ground, with pin 8 going to theanode. The rectangular LED is carefully pressed between the cassette input and output jacks. On some boards,the jacks were so close together that it was necessary to &#34;shave&#34; the upper plastic swage on the side of the inputjack with an Exacto knife to make room for the LED to press fit between them. (Note that in these photos the redwire connected to the anode of the LED has not yet been soldered.)</p><p>这些照片显示了对558定时器芯片的修改，其中一个267欧姆的电阻器(我手边有220到560欧姆之间的任何值都可以)连接在5号和8号引脚之间，发送信号的LED连接在8号引脚和地之间，8号引脚连接到阳极。矩形LED被小心地按在磁带输入和输出插孔之间。在一些电路板上，插孔靠得太近，以至于有必要用Exacto刀刮掉输入插孔侧面的上部塑料凹槽，以便为LED在它们之间压合留出空间。(请注意，在这些照片中，连接到LED阳极的红线尚未焊接。)。</p><p>     Since AppleCrate machines have no I/O capabilities other thanthe network, they must be booted from the network. This requires that the ROMs on the boards be replaced withEPROMs containing modified RESET code to perform the network boot.</p><p>由于AppleCrate机器除了网络之外没有I/O功能，因此它们必须从网络引导。这需要将主板上的ROM替换为包含修改后的重置代码的EPROM，以执行网络引导。</p><p> As with the AppleCrate I, replacement of the self-test code was the easiest path, since it is self-contained,contiguous, and is executed upon power-on reset if no keyboard is connected. However, the Enhanced //e ROM containsonly $200 bytes of self-test code, just half the size of the unenhanced //e self-test, requiring a newdesign for the network boot.</p><p>与AppleCrate I一样，替换自检代码是最简单的方法，因为它是自包含的、连续的，如果没有连接键盘，则会在上电重置时执行。然而，增强型//e只包含200字节的自检代码，仅为非增强型//e自检的一半大小，需要新的网络引导设计。</p><p> The AppleCrate I used an &#34;active&#34; boot protocol, in which each board enabled by the &#34;GETID daisy chain&#34; (connected fromAN2 of the previous machine to PB2 of the current machine) continuously sent GETID requests to ID 1, until it was assigneda permanent ID and received a NadaNet boot image. The complexity of this protocol, requiring both sending and receivingpackets over the network, resulted in a boot ROM requirement of almost $400 byteswhich fit in an  Unenhanced //e ROM.</p><p>AppleCrate I使用主动引导协议，其中每个由GETID菊花链(从上一台机器的AN2连接到当前机器的PB2)启用的主板不断向ID 1发送GETID请求，直到它被分配一个永久ID并接收到NadaNet引导镜像。该协议非常复杂，需要在网络上发送和接收数据包，因此需要将近400字节的引导只读存储器(Boot ROM)，这几乎可以放入一个未增强的//e只读存储器中。</p><p> Since the  Enhanced //e ROM has only $200 bytes available, a new &#34;passive&#34; boot protocol had to be devised.The  new ROM code continuously monitors the network for a broadcast BOOTREQ control packetcontaining the load address and length of the immediately following boot code data. When the boot image has been correctlyread from the network, control is passed to its starting address. This passive boot code only needs to  read packets from thenet, and so occupies just $190 bytes, which comfortably fits in place of the Enhanced //e ROM self-test code at $C600.</p><p>由于增强型只读存储器只有200美元的可用字节，因此必须设计一种新的被动引导协议。新的只读存储器代码持续监控网络中包含紧随其后的引导代码数据的加载地址和长度的广播BOOTREQ控制包。从网络中正确读取引导镜像后，控制权将传递到其起始地址。这种被动引导代码只需要从网络读取数据包，因此只占用$190字节，这很适合取代$C600的增强的//e ROM自检代码。</p><p> The new boot protocol capitalizes on the fact that boot code is sent as a broadcast transaction, so themachines being booted do not need IDs to receive boot code. A page of &#34;second-stage boot&#34; code is added at thefront of the slave machine boot image. This code is given control immediately after the boot image is received, and,when enabled by the &#34;GETID daisy chain&#34;, it sends a GETID request to the machine that &amp;BOOTed it, making use of thecode in the full NadaNet boot image to do so (see the BOOT2 code in the  NADA.CRATElisting for details).</p><p>新的引导协议利用引导代码作为广播事务发送的事实，因此被引导的机器不需要ID来接收引导代码。在从属机器引导镜像的前面添加了一页第二阶段引导代码。此代码在收到引导镜像后立即获得控制，当被GETID菊花链启用时，它会利用完整NadaNet引导镜像中的代码向引导它的机器发送GETID请求(有关详细信息，请参阅NADA.CRATE列表中的BOOT2代码)。</p><p> The GETID daisy chain functions just as it did in the AppleCrate I. The &#34;first&#34; machine is permanently enabledby connecting its PB2 to ground. AN2 of each machine is connectedto PB2 of the &#34;next&#34; machine. The second-stage boot code running in each machine initially sets its AN2.Then it waits until it sees its PB2 go low, enabling it to send its GETID request. When its GETID is successfulit drops its AN2, enabling the next machine. Then it clears its video display, writes a banner showing themachine ID, and enters its server loop.</p><p>GETID菊花链的功能就像它在AppleCrate I中所做的那样。第一台机器是通过将其PB2连接到地来永久启用的。每台机器的AN2连接到下一台机器的PB2。在每台机器上运行的第二阶段引导代码最初设置其AN2，然后等待，直到它看到它的PB2变低，从而使它能够发送其GETID请求。当它的GETID成功时，它丢弃AN2，启用下一台机器。然后，它清除其视频显示，写下显示机器ID的横幅，并进入其服务器循环。</p><p> This results in permanentIDs being assigned in the fixed order of the physical daisy chain, while allowing all ROMs to be identical.An LED on the AppleCrate II NadaNet adapter board is wired to the last machine&#39;s AN2, so that when the lastmachine drops its AN2, the red LED extinguishes, signalling that all machines have booted successfully.</p><p>这导致永久ID按物理菊花链的固定顺序分配，同时允许所有ROM相同。AppleCrate II NadaNet适配器板上的LED连接到最后一台机器的AN2，因此当最后一台机器放下AN2时，红色LED熄灭，表示所有机器都已成功启动。</p><p> When a network-booting machine is reset, it first checks the network state. If the network is low (ZERO),it performs a cold start. If the network is being held high (ONE), it checks page 3 to see if it is being cold started or warm reset. If it isa warm reset, it re-enters its Server loop. If it is a cold start, it initializes and enters the ROM boot code, again waitingfor a BOOTREQ packet. (This approach has the advantage of reliably forcing a reboot on a power cycle, whilestill permitting boards to be warm reset while holding the network high.)</p><p>当网络引导机器被重置时，它首先检查网络状态。如果网络低(零)，则执行冷启动。如果网络处于高电平状态(一个)，它会检查第3页，查看是否正在冷启动或热重置。如果是热重置，它将重新进入其服务器循环。如果是冷启动，它会初始化并输入ROM引导代码，再次等待BOOTREQ数据包。(这种方法的优点是，可靠地强制重新启动电源循环，同时最大限度地允许在保持网络高电平的同时热重置板。)。</p><p>      NadaNet is a TTL-level serial network in which logic high is represented by a voltage greater than +2 voltsand logic low is represented by a voltage less than +0.7 volts. The fanout capability of a TTL annunciator outputis sufficient to drive a dozen or so TTL pushbutton inputs if they are not otherwise connected, as in the caseof the early Apple II machines. Although NadaNet beganand was named forrequiring no ( nada) extra hardware,some changes Apple made in the Apple //e pushbutton circuits made hardware buffering necessary for these machines.</p><p>NadaNet是TTL级的串行网络，其中逻辑高由大于+2伏的电压表示，逻辑低由小于+0.7伏的电压表示。TTL信号器输出的扇出能力足以驱动十几个左右的TTL按钮输入，如果它们没有以其他方式连接的话，就像早期的Apple II机器那样。尽管NadaNet因不需要额外硬件而得名，但苹果对Apple//e按钮电路做了一些改变，使得这些机器需要硬件缓冲。</p><p> The Open- and Closed-Apple keys on the post-Apple ][plus machines are connected to pushbutton inputs 0 and 1.In order to function in the same manner as game controller buttons, the keyboard contains 470-ohm pulldownresistors for each Apple key, and pressing the key connects the corresponding pushbutton input to +5 volts.In addition, to support board self-test at the factory, the main board contains 11K pullup resistors to pullPB1 and PB2 pushbutton inputs to +5v on a board without a keyboard connected.</p><p>后Apple产品上的Open-Apple键和Close-Apple键[Plus机器连接到按钮输入0和1。为了以与游戏控制器按钮相同的方式工作，键盘上为每个Apple键包含470欧姆的下拉电阻，按下该键可将相应的按钮输入连接到+5伏。此外，为了支持出厂时的电路板自检，主板包含11K上拉电阻，用于在没有连接键盘的电路板上将PB1和PB2按钮输入拉至+5V。</p><p> For the 17-board AppleCrate, since the 16 slave boards do not have keyboards connected, their pushbutton inputsare encumbered only by the 11K pullup resistors, for a total parallel pullup resistance of about 650 ohms.A single emitter follower with a low-value pulldown resistor easily drives all machines in parallel.To collect the annunciator outputs, I use a distributed 17-input OR using 1N914 diodesconnecting from the game connectors of the individual boards to a common bus.As a result, a single adapter interfaces all 17 boards to NadaNet:</p><p>对于17板的AppleCrate，由于16个从机板没有连接键盘，它们的按钮输入只受到11K上拉电阻的阻碍，总的并行上拉电阻约为650欧姆。一个带有低值下拉电阻的单一发射器跟随器很容易并行驱动所有机器。为了收集报警器输出，我使用分布式17输入或使用1N914二极管，从各个板的游戏连接器连接到一条公共总线上。作为一个独立的发射器跟随器，具有低值下拉电阻的单个发射器跟随器可以很容易地并行驱动所有机器。为了收集报警器的输出，我使用了一个分布式的17输入或使用1N914的二极管，这些二极管从各个板的游戏连接器连接到一条公共总线上。如</p><p>   Unlike an individual machine adapter, a 74LS08 has been used to standardize logic levels(which would otherwise suffer three diode drops). One spare &#39;LS08 section is used todrive an LED indicating activity on the net. The final &#39;LS08 section is used to indicatewhen the last machine in the GETID daisy chain (machine #17) has dropped its AN2, meaningthat all machines have booted successfully (the LED extinguishes when the GETIDchain is complete).</p><p>与单个机器适配器不同，74LS08用于标准化逻辑电平(否则会出现三个二极管下降)。LS08的一个备用部分用于驱动指示网络活动的LED。最后的LS08部分用于指示GETID菊花链中的最后一台机器(机器#17)何时丢弃AN2，这意味着所有机器都已成功启动(GETID链完成时LED熄灭)。</p><p> Note that the network is diode-clamped between 0 and +5 volts as a precaution against ESD.</p><p>请注意，网络的二极管钳位范围为0至+5伏，以防ESD。</p><p> The 267-ohm network pulldown resistor in the AppleCrate interface is sufficiently low that nosupplemental pulldown should be required even for long networks if an AppleCrate is connected to the network.(I should point out the the peculiarly specific value of the 267-ohm resistors is just a reflection ofwhat was readily available to meanything from 220 to 270 will work well.)</p><p>AppleCrate接口中的267欧姆网络下拉电阻足够低，如果AppleCrate连接到网络上，即使对于较长的网络，也不需要额外的下拉。(我应该指出的是，267欧姆电阻器的特殊特定值只是反映了我在220到270之间的任何东西都可以很好地工作。)。</p><p>      One interesting and entertaining use of an AppleCrate is as a multi-voice wavetable audio synthesizer.</p><p>AppleCrate的一个有趣和有趣的用途是作为多声音波表音频合成器。</p><p> An Apple //e only has 1-bit sound output built in, but with suitable programming(see  AppleCrate Polyphonic Music Synthesizer), it ispossible to create a 5-bit software digital-to-analog converter (DAC) with a sample rate of 11.025kHz anda pulse repetition rate of 22.05kHz. Performing wavetable sound synthesis with such a software DAC uses100% of the processor cycles of an Apple //e, so each board of an AppleCrate can generate just one note of oneinstrument at any instant. For example, if a guitar is strummed, 6 oscillators must sound, one for each string.With 16 slave boards, the AppleCrate II can create 16-voice polyphony! Here is an example of the AppleCrate IIperforming &#34; When I&#39;m 64&#34;. (This recording is mono, though the AppleCrate ouputis stereo.)</p><p>Apple//e只有1位的内置声音输出，但通过适当的编程(参见AppleCrate Polyphonic Music Synsizer)，可以创建一个采样率为11.025 kHz、脉冲重复率为22.05 kHz的5位软件数模转换器(DAC)。使用这样的软件进行波表声音合成，DAC使用的处理器周期是Apple//e的100%，因此AppleCrate的每个板在任何时刻都只能生成一个乐器的一个音符。例如，如果弹奏一把吉他，必须有6个振荡器发出声音，每根弦一个振荡器。用16个从属电路板，AppleCrate II可以创造16个声音的复调！以下是当我64；m 64；时，AppleCrate II执行的一个例子。(这段录音是单声道的，不过AppleCrate的输出是立体声的。)。</p><p> The AppleCrate I had a very simple sound design: a 10K resistor connected each board&#39;s speaker outputto a common mixing point with a 2.2k resistor to ground, shunted by a 0.1uF capacitor to form a single-polelow-pass filter. This design has several weaknesses. First, the speaker output pulses are derived from the +5vof each board, which is electrically noisy, and this noise finds its way to the mixer output. Second, with onlya single mixing point, output was monaural. Third, the single-pole low-pass filter rolls off at only6dB per octave, so that it is only partly effective at reducing the high-level 22kHz pulse componentwhile also attenuating desired high frequencies in the synthesized sound.Finally, the output at the mixing point was low level, and required an external amplifier.</p><p>AppleCrate I有一个非常简单的音效设计：一个10K的电阻器将每个主板的扬声器输出连接到一个公共的混合点，用一个2.2K的电阻器接地，并由一个0.1uF的电容器分流，形成一个单极低通滤波器。这种设计有几个缺点。首先，扬声器的输出脉冲来自每个电路板的+5V，这是有电噪声的，并且该噪声会到达混音器输出。其次，只有一个混合点，输出是单声道的。第三，单极点低通滤波器仅以每倍频程6dB的速度滚动，因此在抑制高电平22 kHz脉冲分量的同时，也只能部分抑制合成声音中所需的高频。最后，混音点的输出电平较低，需要一个外部放大器。</p><p> The AppleCrate II addresses each of these problems by adding an external sound processor box:</p><p>AppleCrate II通过添加外部声音处理器盒解决了所有这些问题：</p><p>  To reduce spurious noise, the sound output taken from each board is a TTL logic level, and each board&#39;ssignal is separately passed through an inverter stage in the sound processor box. This inverter, like allthe audio circuits in the box, is powered by a &#34;quiet&#34; +5v that is double-regulated down from the +12v supplyof one of the boards. The resulting &#34;clean&#34; pulse-width modulated signals from the boards are then mixed.</p><p>为了减少杂散噪声，每个电路板的声音输出是TTL逻辑电平，每个电路板的信号分别通过声音处理器盒中的逆变级。这款逆变器和盒子里的所有音频电路一样，都是由一个+5V的静音电源供电的，从其中一个电路板的+12V电源可以双倍调节。然后，将得到的来自电路板的脉宽调制信号进行混合。</p><p> The signals are mixed to two mixing points, with boards 1-9 going to the left channel and boards 10-17going to the right channel, providing the capability of generating stereo sound. A Stereo Blend controlis provided to permit blending the stereo channels to mono if desired. In addition, the signal fromboard 1, the master/controller machine, is provided with a separate mixer gain control, so that its output can beincluded or excluded from the outputs of the slave boards.</p><p>信号混合到两个混合点，板子1-9到左声道，板子10-17到右声道，提供产生立体声的能力。提供立体声混合控制以允许在需要时将立体声声道混合为单声道。此外，来自主控板1(主/控制器机器)的信号具有单独的混频增益控制，因此其输出可以包括在从板的输出中或从从板的输出中排除。</p><p> In place of the simple single-pole RC low-pass filter in the AppleCrate I, the sound processor provides5-pole Sallen-Key low-pass filters for both left and right channels. The cutoff frequency of thesefilters is 5.5kHz, which reduces the level of 22kHz in the outputs by 60dB with negligible attenuation ofvalid high frequency signal components.</p><p>在AppleCrate I中，声音处理器取代了简单的单极点RC低通滤波器，为左声道和右声道提供了5极点Sallen-key低通滤波器。该滤波器的截止频率为5.5 kHz，使输出中22 kHz的电平降低了60dB，对有效高频信号分量的衰减可以忽略不计。</p><p> Finally, the output of the filters passes through left and right volume controls to two LM386 power opampsthat drive small speakers or headphones directly. Stereo line-level outputs are connected prior to the volumecontrols.</p><p>最后，滤波器的输出通过左右两个音量控制到两个LM386功率放大器，直接驱动小型扬声器或耳机。立体声线路电平输出在音量控制之前连接。</p><p> The sound processor connects to the AppleCrate II through a ribbon cable and DB-25 connector thatcarries all 17 speaker channels plus +12v and ground (plus a few spare wires for future expansion).</p><p>声音处理器通过带状电缆和DB-25连接器连接到AppleCrate II，DB-25连接器承载所有17个扬声器声道，外加+12V和地(外加一些备用线以备将来扩展)。</p><p> For comparison with the AppleCrate I&#39;s  8-oscillator rendition of In My Life,here is the new AppleCrate II  13-oscillator version of In My Liferequiring 13 oscillators (again, recorded in mono). Notethat 13 oscillators are enough that no oscillators are &#34;stolen&#34; from sounding notes, so there are no missingnotes in the bridge. (Spreading the music across more oscillators also relieved memory pressure sufficientlyto add the final crash cymbal, which sounds for almost a second without repeating, and so requires more than10KB of sample memory.)</p><p>为了与AppleCrate I‘s 8振荡器版本的In My Life进行比较，这里是全新的AppleCrate II 13振荡器版本In My Liferequiring 13振荡器(同样，以单声道录制)。请注意，13个振荡器就足够了，不会有任何振荡器从发声音符中被窃取，所以桥上不会有遗漏的音符。(将音乐分散到更多的振荡器上也充分缓解了记忆压力，可以添加最后的撞击声，这种声音几乎一秒钟都不会重复，因此需要超过10KB的样本内存。)。</p><p>     Programs are usually started on Applecrate from amaster machine (usually ID 1), which is also responsible for booting. BPRUN (Broadcast Parallel RUN), runs a specified Applesoft program onall slave machines. The program that is run is then responsible for any further communication among theslave machines or between the slave machines and the master machine.</p><p>程序通常在Applecrate上从更大的机器(通常是ID1)启动，该机器也负责引导。BPRUN(广播并行运行)，在所有从机上运行指定的Applesoft程序。然后，运行的程序负责从机之间或从机与主机之间的任何进一步通信。</p><p> Some general purpose servers have been written to provide useful services to machines on NadaNet,including AppleCrate machines. The most fundamental is the Message Server, which is conventionallyrun on machine ID 2 to provide &amp;PUTMSG and &amp;GETMSG services as described in A Network Extension for Applesoft BASIC.Another very useful set of services is provided by the  File Server,which offers most ProDOS file operations to all connected machines, whether they are runningProDOS, DOS, or no operating system at all (as with AppleCrate slave machines). Programs communicatewith the File Server through a Message Server queue.</p><p>已经编写了一些通用服务器来为NadaNet上的机器提供有用的服务，包括AppleCrate机器。最基本的是消息服务器，它通常在机器ID 2上运行，以提供Applesoft BASIC的网络扩展中所述的&amp；PUTMSG和&amp；GETMSG服务。另一组非常有用的服务由文件服务器提供，它为所有连接的机器提供大多数ProDOS文件操作，无论它们是运行ProDOS、DOS，还是根本不运行操作系统(与AppleCrate从属机器一样)。程序通过消息服务器队列与文件服务器通信。</p><p> I have written several programs for testing and demonstration purposes.One of the most useful test programs is called  RatRace, which enlists all theslave processors to pass thousands of messages through the Message Server (ID 2).An input message queue is assigned to each slave (IDs 3..17), and one slave &#34;primes&#34; the Message serverwith a message for each slave. Then each of the other slaves further loads the queues by sending threemessages to random slaves. During the main phase of the program, each slave reads a message from its queue,ages it by one time unit, and, if it has not &#34;expired&#34;, passes it on to a random slave&#39;s queue. The resultis slave queue lengths rapidly bouncing around until all messages have timed out, as can be seen byplugging a monitor into the Message Server&#39;s video port.</p><p>我已经编写了几个用于测试和演示的程序。最有用的测试程序之一是RatRace，它征募所有从属处理器通过消息服务器(ID 2)传递数千条消息。为每个从属处理器(ID 3..17)分配一个输入消息队列，并为每个从属服务器分配一个主数消息服务器，为每个从属服务器分配一条消息。然后，其他每个从站通过向随机从站发送三个消息来进一步加载队列。在程序的主要阶段，每个从属设备从其队列中读取一条消息，按一个时间单位对其进行老化，如果消息尚未过期，则将其传递到随机从设备的队列中。结果是从属队列长度迅速反弹，直到所有消息都超时，这可以通过将监视器插入Message Server的视频端口来看到。</p><p>  This loads NadaNet to near maximum rates and serves as both a NadaNet and Message Server stress test.The run time of the test can be easily varied by changing the lifetime of messages and/or the number ofmessages initially queued. The message throughput is over 60 messages per second, even though each20-byte message passes across the network twice, going to and from the Message Server.</p><p>这会将Nadanet加载到接近最大速率，并同时用作Nadanet和消息服务器压力测试。通过更改消息的生存期和/或最初排队的消息数，可以很容易地改变测试的运行时间。消息吞吐量超过每秒60条消息，即使每条20字节的消息在网络上传递两次，往返于Message Server。</p><p> In early 2015, I finally got around to daisy-chaining the AppleCrate I to the AppleCrate II, creatinga 25-machine &#34;AppleCrate&#34;. I made a video of this system running  RatRace, which you can view  here.</p><p>2015年初，我终于抽出时间将AppleCrate I和AppleCrate II以菊花链的方式连接在一起，创造了一台由25台机器组成的AppleCrate。我为这个运行RatRace的系统制作了一段视频，你可以在这里观看。</p><p> A simple little program that makes a nice demonstration and AppleCrate reliability test is CYLON. After it is BPRUN, each slave machine waits for a &amp;POKE of a controlvalue from a neighboring machine that specifies whether to pass the value on by &amp;POKEing it to thenext machine or the previous machine in ID sequence. It then flashes its speaker LED and returnsto its &amp;SERVE loop until the control value changes again.If it is the top slave (ID 2) or the bottom slave (ID 17), it reverses thedirection indicated by the control value and &amp;POKEs it accordingly. Inirtially, the top machinestarts the process by &amp;POKEing the control value &#34;next&#34; into ID 3.</p><p>赛昂是一个简单的小程序，可以很好地演示和测试AppleCrate的可靠性。在BPRUN之后，每个从机都等待来自相邻机器的控制值的触发，该控制值指定是否通过将该值传递给ID序列中的下一台机器或上一台机器来传递该值。然后，它闪烁其扬声器LED并返回到其服务循环，直到控制值再次改变。如果它是顶部从属(ID 2)或底部从属(ID 17)，它会颠倒控制值指示的方向，并相应地戳它。最初，最上面的机器通过将控制值下一步放入ID 3来启动进程。</p><p> The result of this logic is that a trail of about four speaker LEDs appears to oscillate downand up the AppleCrate endlessly, in a manner reminiscent of the eye of a (reclining) Cylon. (FourLEDs are lit because a &#34;beep&#34; flashes the LED for 100ms, and the control value has been &amp;POKEd tofour other machines in that time.)</p><p>这种逻辑的结果是，大约四个扬声器LED的轨迹似乎在AppleCrate上无休止地上下摆动，让人想起(倾斜的)赛昂人的眼睛。(四个LED点亮是因为一声嘟嘟声会使LED闪烁100毫秒，在此期间控制值已被&amp；传给了其他四台机器。)。</p><p> If any &amp;POKE fails while CYLON is running, the LED pattern stops, so running it for a few hourstests the reliability of an AppleCrate.</p><p>如果在赛昂人运行时有任何拨动失败，LED模式就会停止，因此运行几个小时会影响AppleCrate的可靠性。</p><p> CYLON continues to run until the master machine is used to &amp;BPOKE a zero (&#34;stop&#34;) into thecontrol value of all the serving slaves. A second &amp;BPOKE is then required to end the programon the the four machines that were in the process of &#34;beeping&#34; their speaker LEDs instead ofSERVEing when the first &amp;BPOKE request was issued.</p><p>赛昂人继续运行，直到主机被用来将零(停止)设置为所有服务从属的控制值。然后，在发出第一个&amp；BPOKE请求时，需要第二个&amp；BPOKE结束正在发出扬声器LED的四台机器上的程序，而不是关闭它们的扬声器LED。</p><p> The purpose of constructin</p><p>建设的目的。</p><p>......</p><p>.</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://michaeljmahon.com/AppleCrateII.html">http://michaeljmahon.com/AppleCrateII.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/ii/">#ii</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034180.html"><img src="http://img2.diglog.com/img/2020/11/thumb_29bd6bd38d2a9fae3ff7fdb6fd55370b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034180.html">从苹果的“再来一件事”活动中期待什么：首批苹果硅片驱动的Mac，MacOS Big Sur的发布日期，以及可能的AirTags，耳麦耳机</a></div><span class="my_story_list_date">2020-11-10 9:19</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034174.html"><img src="http://img2.diglog.com/img/2020/11/thumb_d523daaa32297c0345a0e9af95c98fda.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034174.html">Apple Silicon Mac将运行iOS应用程序，但包括Facebook、谷歌、Candy Crush和我们在内的一些开发者已经选择退出</a></div><span class="my_story_list_date">2020-11-10 8:1</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034131.html"><img src="http://img2.diglog.com/img/2020/11/thumb_509d806856cdaafae3d2b287a982ed4a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034131.html">
解密：GrayShift筹集4700万美元，苹果漏洞受到攻击，视频游戏制造商遭到黑客攻击</a></div><span class="my_story_list_date">2020-11-10 4:26</span></div><div class="col-sm"><div><a target="_blank" href="/story/1034088.html"><img src="http://img2.diglog.com/img/2020/11/thumb_c0956ee3abe50e2ef952a681651a2ec6.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034088.html">
我们对苹果“再来一件事”Mac发布会的期待</a></div><span class="my_story_list_date">2020-11-10 1:11</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>