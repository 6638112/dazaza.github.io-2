<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Godot的2D引擎在即将到来的4.0中获得了一些改进Godot's 2D engine gets several improvements for upcoming 4.0</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Godot's 2D engine gets several improvements for upcoming 4.0<br/>Godot的2D引擎在即将到来的4.0中获得了一些改进</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-29 06:01:39</div><div class="page_narrow text-break page_content"><p>While the focus of Godot 4.0 Vulkan rewrite has largely been enhancements to the 3D engine, the 2D side will also see several improvements.</p><p>虽然Godot 4.0 Vulkan重写的重点主要是3D引擎的增强，但2D方面也将看到一些改进。</p><p>  Thanks to Vulkan (which has a much lower draw-call cost than OpenGL), 2D itself in Godot 4.0 will see a speedup for free. But that&#39;s not the only reason, many internal improvements and optimizations also contribute to a smoother experience. Changes in memory allocation strategy and internal simplification in draw call logic make it much more efficient to manually call thousands of draw() functions from a node&#39;s _draw() callback. Many of these improvements will also accelerate GLES3 and GLES2 back-ends.</p><p>  由于有了Vulkan（绘图调用成本比OpenGL低得多），Godot 4.0中的2D本身将免费获得加速。但这不是唯一的原因，许多内部改进和优化也有助于获得更流畅的体验。内存分配策略的变化以及绘制调用逻辑的内部简化，使得从节点的_draw（）回调中手动调用数千个draw（）函数更加有效。其中许多改进也将加速GLES3和GLES2后端。</p><p>  Godot 3.x supported 2D lighting, but this did not happen without several constraints. The main one was performance due to every light being rendered in a separate draw pass. This is no longer a problem in 4.0, as all lights are drawn in a single pass.</p><p>  Godot 3.x支持2D照明，但这在没有一些限制的情况下不会发生。主要的性能是由于在单独的绘制过程中渲染了每种灯光。在4.0中，这不再是一个问题，因为所有的光都是一次绘制的。</p><p>  Additionally, all 2D shadows and light textures use a single atlas, resulting in improved performance.</p><p>  此外，所有2D阴影和光纹理均使用单个图集，从而提高了性能。</p><p>  Using normal mapping in 2D was also hit or miss. Some nodes supported the &#34;normal&#34; property, and the look of the lighting was very limited.</p><p>  在2D中使用法线贴图也很容易出错。一些节点支持“正常”属性，并且照明的外观非常有限。</p><p> For Godot 4.0, the new  CanvasTexture texture type has been introduced. This new texture type can be used in any node or resource instead of regular textures, and provides not only normal, but specular and shininess maps, allowing for more complex 2D lighting and shading.</p><p> 对于Godot 4.0，引入了新的CanvasTexture纹理类型。这种新的纹理类型可以在任何节点或资源中代替常规纹理使用，并且不仅提供常规贴图，而且还提供镜面贴图和光泽贴图，从而允许更复杂的2D照明和着色。</p><p>  In the example below, a regular Button uses a CanvasTexture, allowing even UI to receive 2D lighting:</p><p>  在下面的示例中，常规Button使用CanvasTexture，甚至UI也可以接收2D照明：</p><p>   A very requested feature for the 2D engine is the possibility to have 2D directional lights and shadows. This has been added for 4.0 thanks to the new DirectionalLight2D node.</p><p>2D引擎非常需要的功能是可能具有2D定向光和阴影。由于新增了DirectionalLight2D节点，此功能已添加到4.0。</p><p>   Another major annoyance for users in Godot 3.x is that, several times, sprites are separated in many nodes in order to be animated or assembled. If a shader is applied to them, or if transparency is changed, the effect is applied to every node individually, given they each do it in their own draw call. This results in undesired effect overlap (or undesired see-through, like the video below)</p><p>   Godot 3.x中用户的另一个主要烦恼是，为了使动画或组合起来，精灵在许多节点中被分开了好几次。如果将着色器应用于它们，或者更改了透明度，则将效果分别应用于每个节点，前提是它们各自在自己的绘制调用中执行此操作。这会导致不希望的效果重叠（或不希望的透明效果，如下面的视频所示）</p><p>  The new CanvasGroup node merges the draw calls of its children nodes, allowing effects to apply as a whole.</p><p>  新的CanvasGroup节点合并了其子节点的绘制调用，从而使效果可以整体应用。</p><p>  Custom shaders can be used with CanvasGroup to also apply effects like drop shadows or glows to a group of objects as a single one, greatly enhancing the flexibility of the 2D engine.</p><p>  自定义着色器可以与CanvasGroup一起使用，也可以将阴影或光晕等效果作为单个对象应用于一组对象，从而大大增强了2D引擎的灵活性。</p><p>  The ability to easily mask out children 2D nodes using the parent shape has been one of the most demanded fetures in Godot. This was only doable with very complex workarounds like using viewports or 2D lights, which where limited and inefficient.</p><p>  使用父形状轻松遮罩子2D节点的能力一直是Godot中最需要的功能之一。这仅适用于非常复杂的解决方法，例如使用视口或2D灯光，而这些方法又有限且效率低下。</p><p> In the 4.0 branch, this will be doable in a much easier way, thanks to the &#34;clip children&#34; property in the visibility section. This happens at literally no cost and allows for maximum flexibility.</p><p> 在4.0分支中，由于可见性部分中的“ clip children”属性，这将以更简单的方式实现。这实际上是免费的，并允许最大的灵活性。</p><p>   Signed Distance Fields (or SDF), are one of the new trendy algorithms in 3D graphics. They allow to do so many things! Beginning Godot 4.0 they are supported for 2D. The regular CanvasOccluders have a new option to enable them for SDF rendering. This means that, from any point in the screen, you can request the distance to the closest solid.</p><p>   符号距离字段（或SDF）是3D图形中新的流行算法之一。他们允许做很多事情！从Godot 4.0开始，它们支持2D。常规的CanvasOccluders具有新的选项，可以启用它们进行SDF渲染。这意味着您可以从屏幕上的任何点请求到最接近的实体的距离。</p><p> This has several use cases, but the most common one is circle tracing. A new API was added to do this as easy as possible. Here is an example of a long drop shadow (which would be very slow to do with a regular shader), simulating 2D lightshafts.</p><p>这有几种用例，但是最常见的一种是圆跟踪。添加了一个新的API，以使其尽可能地容易。这是模拟2D光轴的长阴影（使用常规着色器将非常慢）的示例。</p><p>   shader_type canvas_item;render_mode unshaded;uniform vec4 color : hint_color;uniform float angle : hint_range(0,360);uniform float len : hint_range(0,1000) = 300;uniform float fade_margin : hint_range(0,100) = 5;void fragment() { float ang_rad = angle * 3.1416 / 360.0; vec2 dir = vec2(sin(ang_rad),cos(ang_rad)); float max_dist = len; vec2 at = screen_uv_to_sdf(SCREEN_UV); float accum = 0.0; while(accum &lt; max_dist) { float d = texture_sdf(at); accum+=d; if (d &lt; 0.01) { break; } at += d * dir; } float alpha = 1.0-min(1.0,accum/max_dist); if (accum &lt; fade_margin) { alpha *= max(0.0,accum / fade_margin); } COLOR = vec4(color.rgb,alpha * color.a);}</p><p>   shader_type canvas_item; render_mode不受阴影;均匀的vec4颜色：hint_color;均匀的浮动角度：hint_range（0,360）;均匀的浮动len：hint_range（0,1000）= 300;均匀的浮动fade_margin：hint_range（0,100）= 5;无效的fragment（）{浮动ang_rad =角度* 3.1416 / 360.0; vec2 dir = vec2（sin（ang_rad），cos（ang_rad））; float max_dist = len; vec2 at = screen_uv_to_sdf（SCREEN_UV）;浮点累加= 0.0; while（accum <max_dist）{float d = texture_sdf（at）;累积+ = d;如果（d <0.01）{ }在+ = d * dir处； } float alpha = 1.0-min（1.0，accum / max_dist）;如果（accum <fade_margin）{alpha * = max（0.0，accum / fade_margin）; } COLOR = vec4（color.rgb，alpha * color.a）;}</p><p> A large amount of other effects can be easily achieved with SDF, such as mist or heat distortion over the floor, 2D global illumination, rain hitting the floor effects, or even procedural shading for the whole screen. The SDF distance is based on scene global coordinates, so measuring distances can be done in a familiar way.</p><p> 使用SDF可以轻松实现大量其他效果，例如地板上的薄雾或热变形，2D全局照明，雨水打到地板效果，甚至整个屏幕的程序阴影。 SDF距离基于场景全局坐标，因此可以以熟悉的方式完成距离测量。</p><p> The 2D GPU particle system will support particle collisions against the whole scene via SDF. Hopefully, users will give many other cool uses to this new feature.</p><p> 2D GPU粒子系统将通过SDF支持整个场景的粒子碰撞。希望用户将对该新功能进行许多其他有趣的使用。</p><p>  More work is also going towards the 2D engine.  Gilles Roudiere is working on a new 2D tilemap system an editor that will hopefully overcome most of the limitations with the current one. You can follow his progress on this  twitter account.</p><p>  2D引擎也正在做更多工作。 Gilles Roudiere正在研究一种新的2D tilemap系统，该编辑器有望克服当前系统的大部分限制。您可以在此Twitter帐户上关注他的进度。</p><p> As always, keep in mind that we make Godot out of love for you and the whole game development community. We want to make the best and easiest to use game engine, and make it so free and open that you can feel that you made it yourself. If you are not, please consider  becoming our patron to help us out!</p><p> 与往常一样，请记住，我们是出于对您和整个游戏开发社区的热爱而使Godot脱颖而出的。我们希望制作最好，最容易使用的游戏引擎，并使其变得如此自由和开放，以至于您能感觉到自己制作的。如果您不是，请考虑成为我们的赞助人来帮助我们！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://godotengine.org/article/godots-2d-engine-gets-several-improvements-upcoming-40">https://godotengine.org/article/godots-2d-engine-gets-several-improvements-upcoming-40</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/获得/">#获得</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/节点/">#节点</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>