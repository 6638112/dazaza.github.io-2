<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Monorepo是个坏主意</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Monorepo是个坏主意</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-24 08:10:38</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/b570c1a623f9809da01938b2f27db3f1.jpeg"><img src="http://img2.diglog.com/img/2020/10/b570c1a623f9809da01938b2f27db3f1.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>业界有这样一个概念，所有成功的公司都使用Monorepos，所以要想像他们一样成功，你的公司也应该如此。</p><p>然而，事实是，没有一家大公司选择使用Monorepo。他们就这样结束了，现在无法摆脱这场纠葛。那么，除了把Monorepo的想法作为一个成功的故事卖给你，让你喝下Kool Aid之外，他们还有什么选择呢？</p><p>不可否认，像Facebook、Google和Twitter这样的公司是成功的。但这并不是因为它们，而是因为它们。事实上，他们都拥有一整套才华横溢、一流的工程师团队，仅仅是为了处理Monorepo遗产带来的复杂问题。而Monorepo只是一件美化的遗产文物。</p><p>在接下来的文章中，我想分析一下拥有单一回购的一些所谓的“优势”。</p><p>“对于多个存储库，您必须定义什么是项目。Monorepo只是持有您公司的整个代码库。“。</p><p>为了清楚起见，您希望强迫自己定义项目是什么，如果它们是相关的，为什么它们是相关的。如果您不确定您的项目在做什么，那么可能出了问题。</p><p>“因为VCS太大或有太多历史记录而不得不拆分项目并不是最佳方案。”</p><p>拆分大型项目是绝对必要的。大项目只意味着大混乱。如果你的项目的历史对于VCS来说太大了，那么你的麻烦就更大了。</p><p>使用Monorepo，您可以用任何逻辑上最一致的方式将项目组织和分组在一起，而不仅仅是因为您的版本控制系统迫使您以特定方式进行组织。</p><p>我的VCS，过去5年的GitHub，从来没有“强迫”我做过什么(尽管有一次它差点说服我收养一只小猫)。</p><p>但是，组织项目最符合逻辑的方式是…。每个项目的存储库。而不是把所有东西都混在一起的储存库。</p><p>只有当你所有的东西都是用单一语言写的时候，这才是真的。你真的认为有一种语言可以满足你所有的需求吗？</p><p>如果您的项目中有一种以上的语言(大多数公司都会这样做)，这种优势是站不住脚的。</p><p>如果您使用的是GitHub/GitLab之类的工具，那么这个论点是无效的。在GitHub/GitLab中，您可以将项目组织到组织中，给项目贴上标签，并能够搜索您的代码。</p><p>如果您使用的是Git或其他…。回到2005年，那里的情况如何？</p><p>不过，说真的，我已经养成了在每个GitHub存储库上至少放两个标签的习惯，告诉他们它属于哪个团队和部门(如果你是一家真正的大公司，就属于哪个部门)。</p><p>如果您的微服务很难设置或测试，这并不是因为您没有使用monorepo。这是因为您没有投资于使其易于运行和测试。</p><p>花几天时间完成一份好的自述文件，一份Dockerfile和一份Docker。将维护它们作为优先事项。</p><p>“对于多个存储库，您必须在它们之间建立版本依赖关系。大多数解决方案都很麻烦，而且涉及大量管理费用。“。</p><p>依赖是很难的。莫诺雷波解决不了这个问题。然而，monorepo所允许的是破解您不拥有的代码，并且不知道它是如何工作的。</p><p>使用语义版本控制。引入更改时，请花几分钟时间考虑它们是否向后兼容。没有什么“灵丹妙药”可以解决这个问题。</p><p>这与前一点有关。这实际上意味着，monorepo允许您同时中断多个项目，而不是中断一个项目。耶！</p><p>构建工具--在某种程度上，传统的构建工具，无论是Maven、NPM、Gradle还是Go Build，要么变得太慢，要么干脆停止工作。您将不得不改用特殊的构建工具，如Bazel或Lerna，与传统工具相比，它们的使用率要低得多，因此文档也少得多。</p><p>风投支持--大多数大公司都在使用自己的风投分叉，仅仅是为了维护大量的文件。我采访过的一家公司甚至非常自豪，他们雇佣Git贡献者就是为了这个目的。</p><p>CI/CD-最常用的CI工具，如CircleCI/TravisCI，围绕每个Repo单个项目的概念构建。一定要和他们说再见，准备好要么回到Jenkins怪兽世界，要么甚至“更好”地建立自己的CI。别忘了把CD放在上面。</p><p>如果你改用monorepo，你不会成为下一个谷歌。但是你肯定会给你的项目带来很多挑战，除非你有一些来自大公司的工程师有如何处理这些挑战的经验(顺便说一句，这就是一些小公司以单一订单告终的方式)。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://medium.com/@alexey.soshin/monorepo-is-a-bad-idea-5e587e848a07">https://medium.com/@alexey.soshin/monorepo-is-a-bad-idea-5e587e848a07</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/monorepo/">#monorepo</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/bad/">#bad</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/项目/">#项目</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>