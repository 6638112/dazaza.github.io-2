<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>一种新的掠夺器使用WebSockets和一张伪造的信用卡表格</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">一种新的掠夺器使用WebSockets和一张伪造的信用卡表格</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-12 03:48:49</div><div class="page_narrow text-break page_content"><p>A new skimmer attack was discovered this week, targeting various online e-commerce sites built with different frameworks. As of the writing of this blog post, the attack is still active and exfiltrating data.</p><p>本周发现了一种新的掠夺者攻击，目标是使用不同框架构建的各种在线电子商务网站。在撰写这篇博文时，攻击仍然很活跃，正在渗漏数据。</p><p>  Attackers are exploiting an expanding in-browser attack surface and continually evolving web skimming techniques.  This attack implements many sophisticated capabilities, which we don&#39;t usually see among skimmers attacks.</p><p>攻击者正在利用不断扩大的浏览器内攻击面和不断发展的网页浏览技术。这种攻击实现了许多复杂的功能，这在掠夺者攻击中是不常见的。</p><p> Online stores are increasingly outsourcing their payment processes to third-party vendors,  which means that they don&#39;t handle credit card data inside their store. To overcome this, the attacker creates a fake credit card form and injects it into the application&#39;s checkout page. The exfiltration itself is done by WebSockets, which provide the attacker a more silent exfiltration path.</p><p>网店越来越多地将支付流程外包给第三方供应商，这意味着它们不会在店内处理信用卡数据。为了克服这一缺陷，攻击者创建了一张假信用卡表格，并将其插入到应用程序的结账页面中。渗出本身是由WebSockets完成的，它为攻击者提供了一条更安静的渗出路径。</p><p>  [!] The following information is publicly available and hence spreading.  By providing high-level detail of this new attack method, Akamai encourages website owners and security teams to be aware of the problem characteristics and has provided insights on how to defeat this specific attack.</p><p>[！]。以下信息是公开的，因此正在传播。*通过提供这种新攻击方法的高级细节，Akamai鼓励网站所有者和安全团队了解问题特征，并就如何击败这种特定攻击提供了见解。</p><p> The skimmer injects a loader into the page source as an inline script. Once executed, a malicious JavaScript file is requested from the skimmer&#39;s command and control  (C2) server at  https[:]//tags-manager[.]com/gtags/script2</p><p>掠夺器将加载器作为内联脚本注入页面源代码。一旦执行，就会从Skimmer的命令和控制程序(C2)服务器请求恶意的JavaScript文件，地址是：HTTPS[：]//TAG-MANAGER[.]com/gtag/script2。</p><p>   When the external script is loaded, the skimmer stores in the browser&#39;s LocalStorage its generated session-id and the client IP address. Those parameters are sent as part of the data exfiltration later in the session.</p><p>加载外部脚本时，掠夺器会在浏览器的LocalStorage中存储其生成的会话ID和客户端IP地址。这些参数将作为稍后会话中数据外泄的一部分发送。</p><p>   The skimmer saves the session ID and the user IP in the browser local storage</p><p>掠取器将会话ID和用户IP保存在浏览器本地存储中。</p><p> The actual malicious behavior of the skimmer occurs, of course, in the application sensitive pages, such as the checkout, login, or new account registration pages. The skimmer checks the page URL in order to decide whether it runs on a sensitive page.</p><p>当然，掠夺器的实际恶意行为发生在应用程序敏感页面中，例如结账、登录或新帐户注册页面。掠夺器检查页面URL，以确定它是否在敏感页面上运行。</p><p> Once loaded in a sensitive page, the skimmer initiates a WebSocket connection with its C2 server.</p><p>一旦加载到敏感页面中，掠夺器就会启动与其C2服务器的WebSocket连接。</p><p>   After that, the skimmer registers new event listeners on all the input, form, and button elements in the page. Once fired, the skimmer maps the input field values and exfiltrates them using its opened WebSocket connection to the C2 server.</p><p>之后，Skimmer在页面中的所有输入、表单和按钮元素上注册新的事件侦听器。一旦触发，掠夺器就会映射输入字段值，并使用其打开的到C2服务器的WebSocket连接来提取它们。</p><p>    The attacker implemented some sophisticated mechanisms, which we don&#39;t usually see among web skimmers, which are noted here as attack insight.</p><p>攻击者实施了一些复杂的机制，这在网络掠夺器中是不常见的，这里将其称为攻击洞察力。</p><p> Data exfiltration using WebSockets. Unlike other skimmers attacks, which mostly exfiltrate the data using XHR requests or HTML tags, this skimmer exfiltrates the users&#39; sensitive information via WebSockets. Once the skimmer is loaded in the target page, it initializes a WebSocket communication with its C2 server and keeps it open by sending ping sockets in intervals.  The skimmer tracks the sensitive input fields in the targeted page and sends their values for every change occurring in their content.  The usage of WebSockets provides the attacker a better hiding mechanism as the requests that are being sent will be more &#34;silent.&#34; Also, a lot of CSP policies don&#39;t limit WebSockets usage.</p><p>使用WebSockets进行数据外泄。与其他掠夺者攻击不同的是，这种掠夺者主要使用XHR请求或HTML标签来窃取数据，而这种掠夺者则通过WebSockets来窃取用户的敏感信息。一旦Skimmer被加载到目标页面中，它就会初始化与其C2服务器的WebSocket通信，并通过间隔发送ping套接字使其保持打开状态。掠夺器跟踪目标页面中的敏感输入字段，并为其内容中发生的每一次更改发送它们的值。WebSockets的使用为攻击者提供了更好的隐藏机制，因为发送的请求将更加静默。此外，许多CSP策略并不限制WebSockets的使用。</p><p>   Fake credit card form. Some of the targeted stores don&#39;t handle the payment process by themselves, but use a third-party provider to handle the payment process. In that case, once the user completes filling in his personal information, he is redirected to the third-party vendor in order to provide credit card information and complete the transaction. The skimmer will not be able to inject itself into the third-party vendor to get the end-user credit card information.  For this case, the skimmer creates a fake credit card form in the page before it is redirected to the third-party vendor. The form even validates the user input and the credit card information and shows the user relevant error messages. Once the user clicks on the fake &#34;Pay&#34; button, the skimmer shows a message that the payment cannot be processed and lets the user continue with the real flow of the application.</p><p>伪造的信用卡表格。一些目标商店并不自己处理支付过程，而是使用第三方提供商来处理支付过程。在这种情况下，一旦用户填写完他的个人信息，他就会被重定向到第三方供应商，以便提供信用卡信息并完成交易。撇油器将无法将其自身注入第三方供应商以获取最终用户信用卡信息。在本例中，撇卡器在页面重定向到第三方供应商之前在页面中创建一个假信用卡表单。该表单甚至验证用户输入和信用卡信息，并向用户显示相关的错误消息。一旦用户点击了假的支付按钮，掠夺器就会显示一条消息，提示支付无法处理，并让用户继续进行真实的应用程序流程。</p><p>   In summary, the evasion and obfuscation attempts by the skimmer present a level of sophistication and evolution of such malware strains, we see that escalation as a growing trend among adversaries that are always willing to advance their tactics to gain as much as they can from their campaigns and to sustain it as long as they can before detection.</p><p>总而言之，掠夺者的规避和模糊尝试代表了这类恶意软件菌株的复杂程度和进化程度，我们认为这种升级在敌手中是一种日益增长的趋势，这些对手总是愿意推进他们的战术，以尽可能多地从他们的行动中获益，并在发现之前尽可能长时间地保持这种状态。</p><p>  Akamai sees new and subtly modified web application client-side attacks, such as this example, on nearly a weekly basis. Given the obfuscated nature and supply chain origination of in-browser attacks, traditional CSP-reliant approaches miss most of these types of attacks.</p><p>Akamai几乎每周都会看到新的、经过微妙修改的Web应用客户端攻击，比如这个例子。考虑到浏览器内攻击的模糊性和供应链来源，传统的依赖CSP的方法会漏掉大部分此类攻击。</p><p> Our security portfolio has embraced and invested in bringing to market a web skimming protection product called Page Integrity Manager, which focuses on the script execution behavior with unprecedented visibility into the runtime environment. It collects information about the different scripts that run in the web page, each action they take, and their relation to other scripts in the page. Pairing this data with our multilayered detection approach -- leveraging heuristics, risk scoring, AI, and other factors -- allows Page Integrity Manager to detect different types of client-side attacks, with a high focus on data exfiltration and web skimming attacks.</p><p>我们的安全产品组合接受并投资于将名为Page Integrity Manager的Web浏览保护产品推向市场，该产品专注于脚本执行行为，对运行时环境具有前所未有的可见性。它收集有关网页中运行的不同脚本、它们执行的每个操作以及它们与页面中其他脚本的关系的信息。将这些数据与我们的多层检测方法相结合--利用启发式方法、风险评分、人工智能和其他因素--使Page Integrity Manager能够检测不同类型的客户端攻击，重点关注数据外泄和网络浏览攻击。</p><p> This particular attack using WebSockets and fake credit card pages has been tested against Page Integrity Manager; it was immediately recognized, and detailed information for troubleshooting was provided for effective mitigation.</p><p>已针对Page Integrity Manager测试了使用WebSockets和伪造信用卡页面的这一特定攻击；该攻击立即被识别出来，并提供了故障排除的详细信息，以便有效地进行缓解。</p><p> To learn more about Akamai Page Integrity Manager and to get a free script risk-assessment report, go to   www.akamai.com/PIM .</p><p>要了解有关Akamai Page Integrity Manager的更多信息并获得免费脚本风险评估报告，请访问www.akamai.com/pim。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blogs.akamai.com/2020/11/a-new-skimmer-uses-websockets-and-a-fake-credit-card-form-to-steal-sensitive-data.html">https://blogs.akamai.com/2020/11/a-new-skimmer-uses-websockets-and-a-fake-credit-card-form-to-steal-sensitive-data.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/信用卡/">#信用卡</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/攻击/">#攻击</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>