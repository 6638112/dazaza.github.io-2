<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>网络游戏：玩过去还是玩未来</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">网络游戏：玩过去还是玩未来</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-16 09:08:54</div><div class="page_narrow text-break page_content"><p>几年前，我读了一系列关于网络物理的文章，其中包括一些很棒的演示电影，之后我对网络游戏的工作原理着迷了。我并不是真的理解它。当客户端和服务器之间有大约100毫秒的网络延迟时，游戏怎么可能是可玩的呢？我决定制作一个网络游戏的小演示，试着找出答案。然而，就像我开始的大多数项目一样，我在上面花了几个小时就放弃了。几个月前，我重新发现了它，并把它弄到了一个合理的完成状态。该演示展示了一款游戏的客户端和服务器状态，并允许您调整模拟的延迟。这让我非常欣赏用来制作快节奏游戏的聪明技巧，这些游戏可以在互联网上玩。特别是，我发现客户无论是在过去还是在未来都在玩这款游戏，这很令人惊讶，但它仍然能创造出一种互动的体验。</p><p>一个重要的教训是，即使是本地游戏也有延迟。让我们忽略键盘延迟或显示延迟之类的事情，它们中的每一个都可以很容易地增加约50毫秒的延迟。让我们考虑一下游戏循环，它包括读取输入，模拟世界，然后绘制世界。这意味着在按钮按下后，游戏直到下一帧才会响应。许多显示器最多可以显示每秒60帧(FPS)，这相当于平均8毫秒的延迟(均匀分布在0-16毫秒之间)。最初的一帧也可能只是记录玩家正在向前移动，但实际上直到下一帧才会将玩家向前移动，所以这意味着在您按下按钮和看到变化之间最多33毫秒。许多游戏的运行速度都比这慢，这就扩大了延迟。结论是，即使是你在本地游戏中得到的那种快速反应也不是瞬间的，在输入和看到更新之间实际上可能有大约100毫秒的延迟。</p><p>最简单的网络游戏模型，也是我的演示中实现的模型，是让客户端向服务器发送命令，并让服务器将状态发送回客户端，客户端显示这些命令。在此实施中，当您按下按钮进行操作(如向前移动)时，需要整个网络往返一次才能看到移动。“末日”和“地震”的最初版本使用了这种方法，因为它们是为本地网络而不是互联网设计的。地震是在家庭互联网普及的时候发布的，不管怎样，人们确实在互联网上玩游戏，只有在网络往返时间低的情况下才能奏效。在我的演示中，感觉可以播放高达50ms的单向延迟。</p><p>对我来说，最有趣的部分是，与服务器状态相比，这意味着玩家正在玩过去的游戏。我画了下面的图表，试图说明我的意思。客户端和服务器同时开始游戏，t=0。此时，播放器按下“向前移动”按钮，因此客户端将此消息发送到服务器。到达服务器需要一个时间单位/帧，因此在t=1时，服务器接收并处理按钮按下。在t=2处，服务器模拟玩家向前移动一个单元，并将状态发送给客户端。最后，在t=3，客户端接收更新的位置显示它。这意味着客户端的显示更新时间为t=3，而不是本地版本中的t=1。这会延迟一个网络往返时间(本例中为2个单位)。在任何时刻，客户端都比服务器晚一个时间单位，这就是我过去玩游戏的意思。</p><p>当我在模拟中尝试移动和射击时，我想我可以注意到哪怕是很小的延迟。然而，我觉得我可以适应它，这个游戏可以玩到大约50毫秒。超过这一点，它开始感觉到不可能的缓慢和真正令人不快。这意味着这个简单的模拟只对物理近距离玩家有效。根据gcpping.com的衡量，从我在纽约市的家中连接到Google Cloud的数据中心，我只能玩北美东半部(弗吉尼亚州、南卡罗来纳州和蒙特利尔)托管的游戏。</p><p>为了隐藏潜伏期的影响，现代游戏预测他们行动的效果。因此，客户现在是未来的，而不是过去的。让我们重新考虑一下我们的例子，在这个例子中，游戏开始，玩家立即开始向前移动，如下所示。在第一个时刻，客户端处理前移命令，因此将其发送到服务器。在下一个时刻，客户端预测前进一步，服务器收到消息。在第二个时刻(t=2)，客户端预测将前进另一步。服务器模拟移动并发送官方状态。在下一个时刻(t=3)，客户端接收到用户确实向前移动的确认。棘手的部分是</p><p>网络物理：让我感兴趣的原创系列文章。有关更多详细信息，请参阅系列索引。</p><p>Quake 3网络：通过审阅源代码来描述Quake 3是如何工作的。将它与最初的Quakeworld的工作方式进行比较很有启发意义，因为它在地震中增加了客户端预测。</p><p>客户端/服务器游戏中的延迟补偿方法：值得注意的是，这篇文章描述了Half Life如何使即时命中武器与客户端预测一起工作，以及这如何成为游戏设计的选择，因为有一些基本的必要的权衡。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.evanjones.ca/network-game-simulation.html">https://www.evanjones.ca/network-game-simulation.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/玩过去/">#玩过去</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/games/">#games</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1012128.html"><img src="http://img.diglog.com/img/2020/7/thumb_af699feb1ee1451670a8d6c7e7cd52c0.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012128.html">
Ttilting Point收购FTX游戏资产和Plamee Studios</a></div><span class="my_story_list_date">2020-7-16 3:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/1012039.html"><img src="http://img.diglog.com/img/2020/7/thumb_d22f277245c97f0dc4022dfea97cb8cd.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012039.html">生成艺术中的生命涌现游戏</a></div><span class="my_story_list_date">2020-7-15 23:10</span></div><div class="col-sm"><div><a target="_blank" href="/story/1012020.html"><img src="http://img.diglog.com/img/2020/7/thumb_cc5f7e7b42a057adff553060fbcf6c86.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1012020.html">指挥与征服游戏的代码：来自90年代的虫子。第二卷</a></div><span class="my_story_list_date">2020-7-15 21:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1011957.html"><img src="http://img.diglog.com/img/2020/7/thumb_8afed90b2c56ff0ac62be080a8c028cc.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1011957.html">直升机突击队再次亮相</a></div><span class="my_story_list_date">2020-7-15 13:1</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>