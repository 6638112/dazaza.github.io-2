<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>成为Shell Lite Become Shell Literate</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Become Shell Literate<br/>成为Shell Lite </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-13 02:20:30</div><div class="page_narrow text-break page_content"><p>Shell literacy is one of the most important skills you ought to possess as aprogrammer. The Unix shell is one of the most powerful ideas ever put to code,and should be second nature to you as a programmer. No other tool is nearly aseffective at commanding your computer to perform complex tasks quickly —or at storing them as scripts you can use later.</p><p>Shell读写能力是程序员应具备的最重要技能之一。 Unix shell是有史以来编写代码最强大的想法之一，对于您来说，它应该是您的第二本性。没有其他工具可以有效地命令您的计算机快速执行复杂的任务，或者将它们存储为以后可以使用的脚本。</p><p> In my workflow, I use Vim as my editor, and Unix as my “IDE”. I don’t trick out my vimrc to add abunch of IDE-like features — the most substantial plugin I use on a dailybasis is  Ctrl+P, and that just makes iteasier to open files. Being Vim literate is a valuable skill, but an importantdetail is knowing when to drop it. My daily workflow involves several openterminals, generally one with Vim, another to run builds or daemons, and a thirdwhich just keeps a shell handy for anything I might ask of it.</p><p> 在工作流程中，我使用Vim作为编辑器，并使用Unix作为“ IDE”。我不会骗我vimrc来添加许多类似IDE的功能-我每天使用的最重要的插件是Ctrl + P，这使得打开文件更加容易。具备Vim知识是一项宝贵的技能，但重要的细节是知道何时删除它。我的日常工作流程涉及多个openterminal，一个通常与Vim一起使用，另一个用于运行内部版本或守护程序，另一个则可以使Shell方便地处理我可能要问的任何事情。</p><p>  The shell I keep open allows me to perform complex tasks and answer complexquestions as I work. I find interesting things with  git grep,perform bulk find-and-replace with  sed, answer questions with awk, and perform more intricate tasks on-demand with ad-hoc shellcommands and pipelines. I have the freedom to creatively solve problems withoutbeing constrained to the rails laid by IDE designers.</p><p>  我保持打开状态的外壳使我能够执行复杂的任务并在工作时回答复杂的问题。我用git grep找到有趣的东西，用sed执行批量查找和替换，用awk回答问题，并使用临时的shell命令和管道按需执行更复杂的任务。我可以自由地创造性地解决问题，而不必受限于IDE设计人员的要求。</p><p> Here’s an example of a problem I encountered recently: I had a bunch of changesin a git repository. I wanted to restore deleted files without dropping the restof my changes, but there were hundreds of these. How can I efficiently addressthis problem?</p><p> 这是我最近遇到的一个问题示例：我在git存储库中做了很多更改。我想还原已删除的文件而不删除其余的更改，但是其中有数百个。我如何有效解决这个问题？</p><p> Well, I start by getting a grasp of the scale of the issue with git status,which shows hundreds of deleted files that need to be restored. This scale isbeyond the practical limit of manual intervention, so I switch to git status-s to get a more pipeline-friendly output.</p><p> 好吧，我首先使用git status来了解问题的严重性，它显示了数百个需要还原的已删除文件。这个比例超出了手动干预的实际限制，因此我切换到git status -s以获得更友好的管道输出。</p><p> $ git status -s D main/a52dec/APKBUILD D main/a52dec/a52dec-0.7.4-build.patch D main/a52dec/automake.patch D main/a52dec/fix-globals-test-x86-pie.patch D main/aaudit/APKBUILD D main/aaudit/aaudit D main/aaudit/aaudit-common.lua D main/aaudit/aaudit-repo D main/aaudit/aaudit-server.json D main/aaudit/aaudit-server.lua ...</p><p> $ git status -s D main / a52dec / APKBUILD D main / a52dec / a52dec-0.7.4-build.patch D main / a52dec / automake.patch D main / a52dec / fix-globals-test-x86-pie.patch D main / aaudit / APKBUILD D main / aaudit / aaudit D main / aaudit / aaudit-common.lua D main / aaudit / aaudit-repo D main / aaudit / aaudit-server.json D main / aaudit / aaudit-server.lua ..</p><p> I can work with this. I add grep &#39;^ D&#39; to filter out any entries which werenot deleted, and pipe it through awk &#39;{ print $2 }&#39; to extract just thefilenames. I’ll often run the incomplete pipeline just to check my work andcatch my bearings:</p><p> 我可以解决这个问题。我添加grep＆＃39; ^ D＆＃39;过滤掉所有未被删除的条目，并通过awk＆＃39; {print $ 2}＆＃39;仅提取文件名。我经常会运行不完整的管道，只是为了检查工作并抓住方向： </p><p>  Very good — we have produced a list of files which we need to address.Note that, in retrospect, I could have dropped the grep and just used awk to thesame effect:</p><p>很好-我们已经生成了需要处理的文件列表。请注意，回想起来，我可以删除grep并使用awk达到相同的效果：</p><p>  However, we’re just writing an ad-hoc command here to solve a specific,temporary problem — finesse is not important. This command isn’t going tobe subjected to a code review. Often my thinking in these situations is to solveone problem at a time: “filter the list” and “reword the list”. Anyway, thelast step is to actually use this list of files to address the issue, with thehelp of  xargs.</p><p>  但是，我们只是在此处编写一个临时命令来解决特定的临时问题-技巧并不重要。该命令不会进行代码审查。在这些情况下，我通常的想法是一次解决一个问题：“过滤列表”和“重写列表”。无论如何，最后一步是在xargs的帮助下实际使用此文件列表来解决此问题。</p><p> $ git status -s | awk &#39;/^ D/ { print $2 }&#39; | xargs git checkout --</p><p> $ git status -s | awk＆＃39; / ^ D / {print $ 2}＆＃39; | xargs git checkout-</p><p> Let’s look at some more examples of interesting ad-hoc shell pipelines.Naturally, I wrote a shell pipeline to find some:</p><p> 让我们看一些有趣的临时外壳管道的例子。自然地，我写了一个外壳管道来寻找一些：</p><p> $ history | cut -d&#39; &#39; -f2- | awk -F&#39;|&#39; &#39;{ print NF-1 &#34; &#34; $0 }&#39; | sort -n | tail</p><p> $历史记录|切-d＆＃39; ＆＃39; -f2- | awk -F＆＃39; |＆＃39; ＆＃39; {打印NF-1＆＃34; ＆＃34; $ 0}＆＃39; |排序-n |尾巴</p><p>  cut -d&#39; &#39; -f2- removes the first field from each line, using space as adelimiter.  history numbers every command, and this removes the number.</p><p>  切-d＆＃39; ＆＃39; -f2-使用空格作为adelimiter从每行中删除第一个字段。历史记录为每个命令编号，这将删除该编号。</p><p> awk -F&#39;|&#39; &#39;{ print NF-1 &#34; &#34; $0 } tells awk to use | as the field delimiterfor each line, and print each line prefixed with the number of fields. Thisprints every line of my history, prefixed with the number of times the pipeoperator appears in that line.</p><p> awk -F＆＃39; |＆＃39; ＆＃39; {打印NF-1＆＃34; ＆＃34; $ 0}告诉awk使用|作为每行的字段定界符，并打印以字段数为前缀的每行。这会打印我历史记录的每一行，并以管道操作员在该行中出现的次数为前缀。 </p><p> This command, written in the moment, finds, characterizes, filters, and sorts myshell history by command complexity. Here are a couple of the cool shellcommands I found:</p><p>此刻编写的命令可以根据命令的复杂性查找，表征，过滤和排序myshell历史记录。这是我发现的几个很酷的shell命令：</p><p>   I use this command all the time. If I want to watch a video later, I will touch the file so it appears at the top of this list. Another commandtransmits a tarball of a patched version of  Celeste to a friend usingnetcat, minus the (large) game assets, with a progress display via  pv:</p><p>   我一直在使用此命令。如果以后要观看视频，请触摸该文件，使其显示在此列表的顶部。另一个命令使用netcat将修补版本的Celeste压缩包发送给朋友，减去（大型）游戏资源，并通过pv显示进度：</p><p> find . ! -path &#39;./Content/*&#39; | xargs tar -cv | pv | zstd | nc 204:fbf5:... 12345</p><p> 找 。 ！ -path＆＃39; ./ Content / *＆＃39; | xargs tar -cv | pv | zstd | nc 204：fbf5：... 12345</p><p>   tar, by the way, is an under-rated tool for moving multiple files through apipeline. It can read and write tarballs to stdin and stdout!</p><p>   顺便说一下，tar是用于通过管道移动多个文件的被低估的工具。它可以读取和写入tarball到stdin和stdout！</p><p> I hope that this has given you a tantalizing taste of the power of the Unixshell. If you want to learn more about the shell, I can recommend shellhaters.org as a great jumping-off point intovarious shell-related parts of the POSIX specification. Don’t be afraid of thespec — it’s concise, comprehensive, comprehensible, and full of examples.I would also  definitely recommend taking some time to learn awk in particular: here’s a brief tutorial.</p><p> 我希望这能使您对Unixshell的功能具有诱人的品味。如果您想了解有关shell的更多信息，我可以推荐shellhaters.org作为POSIX规范中与shell相关的各个部分的重要起点。不要担心规格-简洁，全面，易懂且包含很多示例。我也绝对建议您花些时间特别学习awk：这是一个简短的教程。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://drewdevault.com/2020/12/12/Shell-literacy.html">https://drewdevault.com/2020/12/12/Shell-literacy.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/shell/">#shell</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>