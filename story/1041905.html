<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>与NNCP的异步通信：Tor，SSH和UUCP之间的交叉 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">与NNCP的异步通信：Tor，SSH和UUCP之间的交叉 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-26 19:29:42</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/7cf484ceeae6bc7fc2161eddc603cd15.jpg"><img src="http://img2.diglog.com/img/2020/12/7cf484ceeae6bc7fc2161eddc603cd15.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>您是否曾经旅行，拍摄过大量照片和视频，但很生气地发现它使您可以访问的可怕wifi变得饱和了？也许您希望暂停上传，直到您到达其他位置为止，但是随后在Nextcloud / Syncthing / Dropbox上暂停同步也会暂停您不想暂停的其他同步。或者您在不在家时无法备份笔记本电脑时遇到麻烦，不会意外吞噬手机数据。</p><p>  这里有很多背景。如果您想查看加密的洋葱路由式UUCP的外观，请跳到“ NNCP”部分！</p><p> 有句老话：“当你只有一把锤子时，每个问题都像钉子。”我们有一个称为ssh的出色工具，它无处不在且易于理解，因此我们倾向于使用它。但是我们错过了异步处理的一些好处，而这些好处实际上是我们以前经常使用的。</p><p> 当然，我们都习惯了生活中的一些异步服务。电子邮件是一个流行的示例：大多数邮件客户端都脱机工作，并且在邮件服务器可访问时将传输存储的邮件。邮件服务器本身也是如此。许多即时消息平台也是如此。</p><p> 甚至某些备份系统也可以。例如，Bacula / Bareos将所有备份数据后台处理到连接到磁带机的系统上的磁盘上，然后再从那里备份到磁带本身上。他们这样做有几个原因，但主要是这样的事实：如果未以设计速度为磁带驱动器提供数据，则可能对磁带甚至驱动器造成物理损坏。它导致驱动器必须暂停，并向后搜索以重新定位以进行下一次写入。这会导致磁带在写头上过度移动，从而导致磁带过早损坏的情况，即所谓的“磁带擦”。</p><p> 人们在通过网络（或Internet）同步发送数据时经常遇到以下问题：</p><p> Internet缓慢导致流程花费比计划更长的时间，从而导致意外结果或锁定问题 </p><p>当然，在很多情况下必须进行同步通信。例如：</p><p>  我怀疑，尽管它在Unix传统中很强大，但我们今天不进行更多异步处理的原因是缺乏执行此操作的现代工具。让我们探索更多。</p><p>  我在所有支持ZFS的系统上运行ZFS：文件服务器，便携式计算机，工作站等。使用ZFS发送/接收进行备份是很自然的事，我也这样做。但是，当我旅行时，我的笔记本电脑永远都不会备份，因为备份是从备份系统中提取的。当然，有很多解决方法。例如VPN。但是然后我们遇到的情况是，即使我有可用的Internet连接，有时我也不想发送备份：也许我被拴在移动连接上，这样做会很昂贵，或者我正在使用Wifi酒店那是片状且缓慢的，我不想放弃任何微薄的带宽。</p><p> 我还有另一个与备份有关的问题。我有一台远程服务器，直到最近它一直在使用极慢的磁盘。如果进行了重大更改，则备份将花费一天的大部分时间。当我尝试每小时备份一次时，这很烦人。因此，我当然必须实现锁定，但是那意味着那天其他机器也不会备份。</p><p> 一次，我需要传输大约2TB的数据。我的家庭互联网连接速度非常慢，我计算可能需要几个月的时间。因此，我开始手动将部分数据复制到笔记本电脑上，每当我发现机场或咖啡厅的上网速度比家里快时，我便会从中删除这些数据。但是，这需要大量的工作。</p><p>  而“大量的工作”也许就是为什么我们不做更多的事情。尚无出色的标准解决方案，因此在需要时全都是“自己动手”。因此，我们仅使用ssh，因为它更简单，通常“足够好”。但是，正如我在最近有关气隙备份的文章中所写的那样，有理由进行异步。</p><p>  能够为机器排队数据并以任何可能的方式让它到达那里不是很好吗？也许找到了快速的Internet连接，或者通过Tor，或者通过复制到USB记忆棒，或者通过无线电广播？这将使其中许多情况变得容易得多。现在，有了现代安全性，有多种方法可以实现！ </p><p>为此，我们在Linux上有一些工具：git-annex用于存储和迁移，syrep用于同步，NNCP用于文件传输和远程执行（可以与其他一些工具结合使用）。让我们深入了解NNCP。</p><p>  如果您已经了解UUCP，可以将NNCP视为具有现代安全性和工具的UUCP进入了现代时代。</p><p> 基本上，NNCP允许您将文件发送到远程系统，从远程系统请求文件，以及将数据通过管道传输到NNCP命令，以请求远程执行。因此，您可以说，将zfs发送到NNCP的管道传输到NNCP，NNCP将其发送到远程，再到zfs接收到它的管道。</p><p> NNCP具有可延迟的，可恢复的协议，该协议几乎可以在任何可靠的连接上运行：TCP，串行，Tor，各种无线电，您都可以命名。但这还不是全部；它也可以将其队列转储到USB记忆棒之类的东西上进行传输，甚至可以制作出可随意混合的tar样式的流。如果您想花哨的话，可以为数据包分配优先级，例如，出站电子邮件将始终在您还必须发送的1TB文件之前发送。您还可以对其进行配置，以使某些运营商可以处理某些数据优先级。您的手机只能处理最紧急的情况，但是USB记忆棒可以处理任何事情。</p><p> NNCP是源路由的；您可以说鲍勃到达爱丽丝的方式是通过卡尔，然后是贝蒂。 Bob可以生成一条将沿着该路由发送的消息，并在此过程的每一步都进行了完全加密和认证。 Carl除了下一跳以外，看不到邮件的内容或什至有关邮件的任何内容。</p><p>   对于正在备份的笔记本电脑，在旅行时可以将其备份，照片，视频或其他内容排队。连接良好时，它们可以由命令触发，也可以自动触发。数据可以复制到USB并提供给朋友进行传输；由于加密，因此非常安全。或者也可以等到回到家后，安全地移出其他同步目录。 NNCP文档中有一个示例。</p><p> 对于缓慢备份的服务器，这很容易解决；慢速备份只需排好队，并在准备就绪后进行传输和处理。这不会中断其他备份。 </p><p>2TB传输问题如何？ 这也使事情变得容易得多。 可以运行一条命令以将部分队列填充到USB记忆棒，然后将该USB记忆棒插入并在快速位置传输。 在慢速系统继续上传其余位时，根据需要重复操作。  如果您已经熟悉SSH中公钥的工作方式，那么NNCP也应该立即熟悉。 这是一个类似的概念（尽管可以说设置起来比较容易）。  我正在建立NNCP网络，一旦完成，将会有更多关于如何执行此操作的信息。 同时，该项目的文档也很好。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://changelog.complete.org/archives/10163-rehabilitating-asynchronous-communication-with-nncp-a-cross-between-tor-ssh-and-uucp">https://changelog.complete.org/archives/10163-rehabilitating-asynchronous-communication-with-nncp-a-cross-between-tor-ssh-and-uucp</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/tor/">#tor</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/备份/">#备份</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1021589.html"><img src="http://img2.diglog.com/img/2020/9/thumb_05f899e2f6bc77b0da8e64490e090092.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1021589.html">向政府出售Zero-day的初创公司出价100万美元收购Tor黑客</a></div><span class="my_story_list_date">2020-9-1 20:51</span></div><div class="col-sm"><div><a target="_blank" href="/story/1018869.html"><img src="http://img.diglog.com/img/2020/8/thumb_4ba2ed76adede93b4afcf9e1794411b1.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1018869.html">切勿将ToR与VPN一起使用</a></div><span class="my_story_list_date">2020-8-18 19:13</span></div><div class="col-sm"><div><a target="_blank" href="/story/1017486.html"><img src="http://img.diglog.com/img/2020/8/thumb_84b2e4e91f885934a31b669667c20ac5.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1017486.html">报告：从1月份开始，就有一群人劫持Tor出口中继节点进行SSL剥离攻击，在5月份达到顶峰，当时该群人运行了23.95%的所有节点</a></div><span class="my_story_list_date">2020-8-11 16:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1015256.html"><img src="http://img.diglog.com/img/2020/7/thumb_e65c8fa0bbce0a592002efab2cc3814e.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1015256.html">披露了两个ToR零日，未来还会有更多</a></div><span class="my_story_list_date">2020-7-31 3:1</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>