<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>ARM组件中的代码：条件循环 Code in ARM Assembly: Conditional Loops</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Code in ARM Assembly: Conditional Loops<br/>ARM组件中的代码：条件循环 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-30 00:39:45</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/6/07e1a87f1755f9a72a064ac67cb5d592.jpg"><img src="http://img2.diglog.com/img/2021/6/07e1a87f1755f9a72a064ac67cb5d592.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>In  the previous episode in this series, I started to look at how to control flow using an instruction which sets the NZCV flags, followed by a conditional branch to a label. The example given there is among the simplest, a series of  if … else if … statements or a small  switch statement. That can be summarised in the diagram:</p><p>在本系列中的前一集中，我开始使用设置NZCV标志的指令来控制如何控制流，然后是标签的条件分支。给出的示例是最简单的，如果是......否则，如果...语句或小型交换机语句。可以在图中概括：</p><p>  This article moves on to look at the other main type of control, conditional loops.</p><p>  本文介绍了查看其他主要的控制类型，条件循环。</p><p> Although conditional loops can be written in several different ways using high-level languages like Swift, there are two basic patterns, depending on whether the test is made in the head or tail of the loop.</p><p> 虽然条件循环可以使用像SWIFT这样的高级语言以几种不同的方式编写，但是有两个基本模式，具体取决于测试是否在循环的头部或尾部进行。</p><p>  In Swift, the most widely used form of loop which tests whether the condition is met in the tail is the  for statement:  for index in 1...100 { }</p><p>  在SWIFT中，最广泛使用的循环形式，测试是否在尾部满足条件是for语句：用于索引在1 ... 100 {}中</p><p> A typical implementation in ARM64 assembly language might start by setting up registers containing the start index value and the end index, then perform the code in the loop, incrementing the index value, and testing whether it remains less than or equal to the end index. If it does, then branch back to the loop to perform it again; if it doesn’t, then continue with the following operations.</p><p> ARM64汇编语言中的典型实现可能首先设置包含开始索引值和结束索引的寄存器，然后在循环中执行代码，递增索引值，并测试它是否仍然小于或等于最终索引。如果它确实，然后分支回循环再次执行它;如果没有，则继续使用以下操作。</p><p> Here’s an example in which the index is stored in register X5, and the maximum index in X4:  	MOV	X5, #1 // start index = 1 MOV X4, #100 // end index = 100 for_loop:	// do what you need in the loop // … ADD	X5, X5, #1 // increment the index by 1 CMP	X5, X4 // check whether end index has been reached B.LE for_loop // if index &lt;= end index, loop back // next code after loop</p><p> 以下是索引存储在寄存器x5中的示例，以及x4：mov x5，＃1 // start index = 1 mov x4，＃100 // endex = 100 for_loop：//执行所需的索引在循环// ...添加x5，x5，＃1 //递增1 cmp x5，x4 //检查是否已达到终端索引B.Le for_loop //，如果index＆lt; = end index，循环回/ /下一个循环后的代码</p><p>  It’s simple to modify that for variants which count down, for example, by decrementing the index from an upper limit until it reaches the lower limit.</p><p>  修改为计算下降的变体，这很简单，例如，通过将索引从上限递减直到达到下限。 </p><p>  In Swift, a common form of loop which performs testing at the head uses  while:  while x &lt; 100 { }</p><p>在Swift中，一种常见的循环形式，其在头部使用的是：而x＆lt; 100 {}</p><p> A typical implementation in ARM64 assembly language might start by setting up registers containing the initial value of x and the end limit, then check whether x has reached that end value. If it has, then branch to the next code after the loop. Otherwise perform the loop code and increment the x value before performing an unconditional loop back to the starting test and passing through the loop again.</p><p> ARM64汇编语言中的典型实现可能首先设置包含X和最终限制的初始值的寄存器，然后检查x是否已达到该终端值。如果它有，则在循环后分支到下一个代码。否则执行循环代码并在执行无条件循环回到起始测试并再次通过循环之前递增X值。</p><p> Here’s an example in which the x value is stored in register X5, and the end value in X4:  	MOV	X5, #1 // start value = 1 MOV X4, #100 // end value = 100 while_loop:	CMP	X5, X4 // check whether end value has been reached B.GE		while_done // if value &gt; end value, end loop // do what you need to in the loop // … ADD X5, X5, #1 // increment value (or whatever needed to progress towards termination) B	while_loop // unconditional loop back while_done: // next code after loop</p><p> 这是一个例子，其中x值存储在寄存器x5中，x4：mov x5，＃1 // start值= 1 mov x4，＃100 // end值= 100 wher_loop：cmp x5，x4 / /检查是否已达到终端值B.gehing and_done //如果值＆gt;终端值，结束循环//执行循环中所需的内容// ...添加x5，x5，＃1 //增量值（或在终止中所需的任何东西）b with_loop //无条件循环返回white_done：// next循环后的代码</p><p>  A classic example of that is iterating through each of the single-byte characters in a null-terminated ASCII string.</p><p>  经典示例的迭代通过返回空终止的ASCII字符串中的每个字节字符迭代。</p><p> In Swift, this might be called as:  var output: [CChar] = Array(repeating: 0, count: 255) let s: String = &#34;Sample string&#34; ascii_copy(s, &amp;output) which calls the C header of:  extern int ascii_copy(const char *, char *);</p><p> 在SWIFT中，这可能被称为：VAR输出：[CCHAR] =阵列（重复：0，count：255）让S：String =＆＃34;样本字符串＆＃34; ascii_copy（s，＆amp;输出）调用：extern int ascii_copy的c头（const char *，char *）;</p><p> Register usage follows:  // X1 - address of output string // X0 - address of input string // X4 - original output string for length calc. // W5 - current character being processed and the assembly code is:  _ascii_copy:	MOV 	X4, X1 // loop until the byte pointed to by X1 is non-zero loop:	LDRB		W5, [X0], #1 // load ASCII character and increment pointer // do whatever you need to the character in W5 STRB		W5, [X1], #1 // store character to output str CMP		W5, #0 // stop on hitting a null character B.NE		loop // loop if character isn&#39;t null SUB		X0, X1, X4 // get the length by subtracting the pointers RET		// Return to caller</p><p> 注册用法遵循：// x1  - 输出字符串的地址// x0  - 输入字符串的地址/// x4  - 长度计算的原始输出字符串。 // W5  - 正在处理的当前字符和汇编代码是：_ascii_copy：mov x4，x1 //循环，直到x1指向的字节是非零环：ldrb w5，[x0]，＃1 //加载ASCII字符和递增指针//使用W5 STRB W5，[x1]，＃1 //存储字符到输出str cmp w5，＃0 //停止击中空字符B.NE循环//循环如果字符ISN＆＃39; t null sub x0，x1，x4 //通过减去read //返回呼叫者来获得长度</p><p>  Control transfer statements such as  continue, break, return and  throw can be implemented using an instruction which sets the NZCV flags, then a conditional branch, such as  loop: // do things CMP	X5, X4 // compare the two registers B.GT break_loop // break out of loop // do other things B	loop // repeat loop break_loop:	// break out of loop and continue with next code</p><p>  可以使用设置NZCV标志的指令来实现控制传输语句，如继续，中断，返回和抛出，然后是一个条件分支，例如循环：// do cmp x5，x4 //比较两个寄存器b.gt break_loop //突破循环// do其他内容b循环//重复循环break_loop：//断开循环并继续下一个代码 </p><p>  All four of these idioms are collected together in today’s tear-out PDF:  ARMcontrolflow1</p><p>这些成语中的所有四个都在当今的撕裂PDF中收集：ARMControlflow1</p><p> In the next article, I’ll start looking at some common general-purpose register instructions.</p><p> 在下一篇文章中，我将开始查看一些常见的通用注册说明。</p><p> The example ASCII string code above is based on Alexander von Below’s modified code to accompany Stephen Smith’s book.</p><p> 上面的示例ASCII字符串代码是基于以下修改代码的Alexander VON，以伴随斯蒂芬史密斯的书。</p><p>  1: Building an app to develop assembly routines, including an explanation of calling assembly language from Swift, with a complete Xcode project  2: Registers explained  3: Working with pointers  4: Controlling flow</p><p>  1：构建一个应用程序以开发装配例程，包括解释从SWIFT调用汇编语言，完整的Xcode项目2：寄存器解释3：使用指针4：控制流程</p><p>    Procedure Call Standard for the Arm 64-bit Architecture (ARM) from  Github  Writing ARM64 Code for Apple Platforms (Apple) Stephen Smith (2020)  Programming with 64-Bit ARM Assembly Language, Apress, ISBN 978 1 4842 5880 4. Daniel Kusswurm (2020)  Modern Arm Assembly Language Programming, Apress, ISBN 978 1 4842 6266 5.  ARM64 Instruction Set Reference (ARM).</p><p>    手术呼叫标准用于ARM 64位架构（ARM）从GitHub写作ARM64代码用于Apple平台（Apple）Stephen Smith（2020）用64位ARM汇编语言编程，APRess，ISBN 978 1 4842 5880 4. Daniel Kusswurm（ 2020）现代ARM汇编语言编程，APRess，ISBN 978 1 4842 6266 5. ARM64指令集参考（ARM）。</p><p>  Posted in  Macs,  Technology and tagged  Apple silicon,  ARM,  assembler,  assembly language,  M1,  Xcode. Bookmark the  permalink.</p><p>  发布在Mac，技术和标记的Apple硅，臂，汇编器，汇编语言，M1，Xcode。书签永久链接。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://eclecticlight.co/2021/06/29/code-in-arm-assembly-conditional-loops/">https://eclecticlight.co/2021/06/29/code-in-arm-assembly-conditional-loops/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/代码/">#代码</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/条件/">#条件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/arm/">#arm</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/循环/">#循环</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1068555.html"><img src="http://img2.diglog.com/img/2021/6/thumb_ee4fd8e6efced593998b77cf35ec3f5d.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1068555.html">Microsoft和Open AI构建GitHub Copilot，基于AI的工具，以在几乎任何编程语言中推荐给软件开发人员的代码 </a></div><span class="my_story_list_date">2021-6-29 23:16</span></div><div class="col-sm"><div><a target="_blank" href="/story/1068531.html"><img src="http://img2.diglog.com/img/2021/6/thumb_f912c4a920a763ac89ddb5733d2d10f8.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1068531.html">github copilot：您的AI对程序员 </a></div><span class="my_story_list_date">2021-6-29 23:9</span></div><div class="col-sm"><div><a target="_blank" href="/story/1068476.html"><img src="http://img2.diglog.com/img/2021/6/thumb_ab44f4c3edc604980a93c0aa5664efbb.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1068476.html">让我们代码TCP / IP堆栈（2016） </a></div><span class="my_story_list_date">2021-6-29 22:45</span></div><div class="col-sm"><div><a target="_blank" href="/story/1068270.html"><img src="http://img2.diglog.com/img/2021/6/thumb_55709c8e84b2625e24a30d2a04e8fb7a.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1068270.html">LinkedIn正式加入欧盟代码讨论讲话 </a></div><span class="my_story_list_date">2021-6-26 0:36</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>