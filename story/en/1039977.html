<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>黑暗光环利用SolarWinds破坏了突破组织 Dark Halo Leverages SolarWinds Compromise to Breach Organizations</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Dark Halo Leverages SolarWinds Compromise to Breach Organizations<br/>黑暗光环利用SolarWinds破坏了突破组织 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-16 14:00:28</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/c16d0f69c567628f15600c104d6622ca.png"><img src="http://img2.diglog.com/img/2020/12/c16d0f69c567628f15600c104d6622ca.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Volexity is releasing additional research and indicators associated with compromises impacting customers of the SolarWinds Orion software platform.</p><p>Volexity将发布与折衷相关的其他研究和指标，这些折衷会影响SolarWinds Orion软件平台的客户。</p><p> On Sunday, December 13, 2020, FireEye   detailing an alleged compromise to the company SolarWinds. This compromise involved a backdoor being distributed through an update to SolarWind’s Orion software product. FireEye attributed this activity to an unknown threat actor it tracks as UNC2452. Volexity has subsequently been able to tie these attacks to multiple incidents it worked in late 2019 and 2020 at a US-based think tank. Volexity tracks this threat actor under the name  Dark Halo.</p><p> 2020年12月13日星期日，FireEye详细说明了据称对SolarWinds公司的妥协。这种妥协涉及通过更新SolarWind的Orion软件产品来分发后门。 FireEye将此活动归因于其追踪为UNC2452的未知威胁参与者。随后，Volexity能够将这些攻击与它在2019年末和2020年在美国智囊团工作的多个事件联系在一起。 Volexity以Dark Halo的名字追踪这位威胁演员。</p><p> At one particular think tank, Volexity worked three separate incidents involving Dark Halo. In the initial incident, Volexity found multiple tools, backdoors, and malware implants that had allowed the attacker to remain undetected for several years. After being extricated from the network, Dark Halo then returned a second time, exploiting a vulnerability in the organization’s  . Near the end of this incident, Volexity observed the threat actor using a novel technique to bypass Duo multi-factor authentication (MFA) to access the mailbox of a user via the organization’s Outlook Web App (OWA) service. Finally, in a third incident, Dark Halo breached the organization by way of its SolarWinds Orion software in June and July 2020.</p><p> 在一个特定的智囊团中，Volexity进行了三起涉及Dark Halo的单独事件。在最初的事件中，Volexity发现了多种工具，后门和恶意软件植入物，这些漏洞使攻击者多年来一直未被发现。从网络中解脱出来后，Dark Halo随后又利用组织的一个漏洞再次返回。在事件即将结束时，Volexity观察到威胁参与者使用一种新颖的技术绕过Duo多因素身份验证（MFA）通过组织的Outlook Web App（OWA）服务访问用户的邮箱。最终，在第三起事件中，Dark Halo于2020年6月和2020年7月通过其SolarWinds Orion软件破坏了该组织。</p><p> The primary goal of the Dark Halo threat actor was to obtain the e-mails of specific individuals at the think tank. This included a handful of select executives, policy experts, and the IT staff at the organization. Volexity notes its investigations are directly related to the FireEye report based on overlap between command-and-control (C2) domains and other related indicators such as a backdoored server running SolarWinds Orion.</p><p> Dark Halo威胁演员的主要目标是在智囊团中获取特定个人的电子邮件。其中包括一些精选的执行官，策略专家和组织中的IT人员。 Volexity指出，其调查与FireEye报告直接相关，该报告基于命令和控制（C2）域之间的重叠以及其他相关指标，例如运行SolarWinds Orion的后门服务器。</p><p>  Volexity has worked three major incidents involving the Dark Halo threat actor. In most cases, the actor aimed to live off the land, primarily focusing on weekly operations to extract e-mail messages from the organization. Dark Halo did use malware and red-teaming tools but largely only for specific one-time tasks as a fallback mechanism when other avenues of access were cut off. For the purposes of this write-up, Volexity will share novel and useful information from the second and third incidents. The second incident involved a sophisticated way to obtain unauthorized access to an account via OWA that had MFA protection in place. The third incident involved a breach by way of the SolarWinds Orion platform.</p><p>  Volexity已处理了涉及Dark Halo威胁演员的三起重大事件。在大多数情况下，行动者的目标是在这片土地上生活，主要集中在每周的活动中，以从组织中提取电子邮件。 Dark Halo确实使用了恶意软件和红队工具，但在很大程度上只能用于特定的一次性任务，以作为其他访问途径被切断时的后备机制。为了撰写本文，Volexity将分享第二次和第三次事故的新颖有用的信息。第二起事件涉及一种复杂的方法，该方法通过具有MFA保护的OWA来未经授权访问帐户。第三起事件涉及通过SolarWinds Orion平台的破坏。</p><p>  Toward the end of the second incident that Volexity worked involving Dark Halo, the actor was observed accessing the e-mail account of a user via OWA. This was unexpected for a few reasons, not least of which was the targeted mailbox was protected by MFA. Logs from the Exchange server showed that the attacker provided username and password authentication like normal but were not challenged for a second factor through Duo. The logs from the Duo authentication server further showed that no attempts had been made to log into the account in question. Volexity was able to confirm that session hijacking was not involved and, through a memory dump of the OWA server, could also confirm that the attacker had presented cookie tied to a Duo MFA session named  duo-sid.</p><p>  在第二次Volexity涉及Dark Halo的事件即将结束时，观察到该演员通过OWA访问了用户的电子邮件帐户。出于某些原因，这是意外的，其中最重要的原因是目标邮箱受MFA保护。来自Exchange服务器的日志显示，攻击者提供的用户名和密码身份验证正常，但没有通过Duo受到第二方面的挑战。来自Duo身份验证服务器的日志进一步表明，未尝试登录到相关帐户。 Volexity能够确认不涉及会话劫持，并且通过OWA服务器的内存转储，还可以确认攻击者提供了与名为duo-sid的Duo MFA会话绑定的cookie。</p><p> Volexity’s investigation into this incident determined the attacker had accessed the Duo integration secret key ( akey) from the OWA server. This key then allowed the attacker to derive a pre-computed value to be set in the duo-sid cookie. After successful password authentication, the server evaluated the duo-sid cookie and determined it to be valid. This allowed the attacker with knowledge of a user account and password to then completely bypass the MFA set on the account. It should be noted this is  not a vulnerability with the MFA provider and underscores the need to ensure that all secrets associated with key integrations, such as those with an MFA provider, should be changed following a breach. Further, it is important that not only are passwords changed after a breach, but that passwords are not set to something similar to the previous password (e.g.,  Summer2020! versus  Spring2020! or  SillyGoo$e3 versus  SillyGoo$e2).</p><p> Volexity对这一事件的调查确定，攻击者已从OWA服务器访问了Duo集成秘密密钥（akey）。然后，该密钥使攻击者可以得出在duo-sid cookie中设置的预先计算的值。成功进行密码身份验证后，服务器评估了duo-sid cookie并确定其有效。这使攻击者知道用户帐户和密码，然后完全绕过帐户上设置的MFA。应该注意的是，这不是MFA提供程序的漏洞，并且强调了确保与密钥集成相关的所有机密（例如与MFA提供程序的密钥集成相关的机密）在发生违规后应被更改的必要性。此外，重要的是，不仅要在违规后更改密码，而且不要将密码设置为与以前的密码类似的内容（例如，Summer2020！vs Spring2020！或SillyGoo $ e3 vs SillyGoo $ e2）。 </p><p>  In the third incident, which took place in July 2020, Volexity identified suspicious administrative commands and ActiveSync anomalies in the organization’s Exchange environment. Further review of the organization’s endpoint software and network traffic confirmed a breach. The attacker had executed commands to export e-mail for specific users in the organization, and then exfiltrated the data via the organization’s Outlook Web Anywhere (OWA) server.</p><p>在2020年7月发生的第三起事件中，Volexity在组织的Exchange环境中发现了可疑的管理命令和ActiveSync异常。对组织的端点软件和网络流量的进一步检查确认存在违规行为。攻击者执行了命令以为组织中的特定用户导出电子邮件，然后通过组织的Outlook Web Anywhere（OWA）服务器窃取了数据。</p><p> Many of the technical details regarding the malware used are covered in the FireEye notification. However, in this blog, Volexity can share examples of command-line actions the attacker took after gaining access to the target network and provide insight into additional tools, infrastructure, and attacker objectives.</p><p> FireEye通知涵盖了有关所使用恶意软件的许多技术细节。但是，在此博客中，Volexity可以共享攻击者在访问目标网络后采取的命令行操作的示例，并提供对其他工具，基础结构和攻击者目标的了解。</p><p>  The attacker was quite adept with Exchange and immediately listed various organization configuration settings via PowerShell. Below are a few of the operations that the attacker executed.</p><p>  攻击者非常熟悉Exchange，并立即通过PowerShell列出了各种组织配置设置。以下是攻击者执行的一些操作。</p><p> Get a list of users on the Exchange server and their current role using  :</p><p> 使用以下命令获取Exchange服务器上的用户及其当前角色的列表：</p><p> C:\Windows\system32\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command “Get-ManagementRoleAssignment -GetEffectiveUsers | select Name,Role,EffectiveUserName,AssignmentMethod,IsValid | ConvertTo-Csv -NoTypeInformation | % {$_ -replace ‘`n’,’_’} | Out-File C:\temp\1.xml”</p><p> C：\ Windows \ system32 \ cmd.exe / C powershell.exe -PSConsoleFile exshell.psc1-命令“ Get-ManagementRoleAssignment -GetEffectiveUsers |选择名称，角色，有效用户名，AssignmentMethod，IsValid | ConvertTo-Csv -NoTypeInformation | ％{$ _-替换'`n'，'_’} |输出文件C：\ temp \ 1.xml”</p><p>   The attacker also made use of a file called sqlceip.exe, which upon first glance might appear as the legitimate version of SQL Server Telemetry Client provided by Microsoft. However, Volexity determined this tool was actually a version of AdFind from joeware.net. AdFind is a command-line tool used for querying and extracting data from Active Directory. During the course of its investigations, Volexity discovered the attacker using AdFind with the following command line:</p><p>   攻击者还利用了一个名为sqlceip.exe的文件，乍一看它可能是Microsoft提供的SQL Server Telemetry Client的合法版本。但是，Volexity确定此工具实际上是joeware.net的AdFind的版本。 AdFind是用于从Active Directory查询和提取数据的命令行工具。在调查过程中，Volexity使用AdFind和以下命令行来发现攻击者：</p><p> C:\Windows\system32\cmd.exe /C sqlceip.exe -default -f (name=”Organization Management”) member -list | sqlceip.exe -f objectcategory=* &gt; .\SettingSync\log2.txt</p><p> C：\ Windows \ system32 \ cmd.exe / C sqlceip.exe -default -f（名称=“组织管理”）成员-列表| sqlceip.exe -f objectcategory = *＆gt; 。\ SettingSync \ log2.txt </p><p>   $scheduler = New-Object -ComObject (“Schedule.Service”);$scheduler.Connect($env:COMPUTERNAME);$folder = $scheduler.GetFolder(“\Microsoft\Windows\SoftwareProtectionPlatform”);$task = $folder.GetTask(“EventCacheManager”);$definition = $task.Definition;$definition.Settings.ExecutionTimeLimit = “PT0S”;$folder.RegisterTaskDefinition($task.Name,$definition,6,”System”,$null,5);echo “Done”</p><p>$ scheduler =新对象-ComObject（“ Schedule.Service”）; $ scheduler.Connect（$ env：COMPUTERNAME）; $ folder = $ scheduler.GetFolder（“ \ Microsoft \ Windows \ SoftwareProtectionPlatform”）; $ task = $ folder .GetTask（“ EventCacheManager”）; $ definition = $ task.Definition; $ definition.Settings.ExecutionTimeLimit =“ PT0S”; $ folder.RegisterTaskDefinition（$ task.Name，$ definition，6，“ System”，$ null，5 ）;回显“完成”</p><p>  C:\Windows\system32\cmd.exe /C schtasks /create /F /tn “\Microsoft\Windows\SoftwareProtectionPlatform\EventCacheManager” /tr “C:\Windows\SoftwareDistribution\EventCacheManager.exe” /sc ONSTART /ru system /S [machine_name]</p><p>  C：\ Windows \ system32 \ cmd.exe / C schtasks / create / F / tn“ \ Microsoft \ Windows \ SoftwareProtectionPlatform \ EventCacheManager” / tr“ C：\ Windows \ SoftwareDistribution \ EventCacheManager.exe” / sc ONSTART / ru system / S [机器名称]</p><p>  The attacker exfiltrated e-mail data from targeted accounts using the  New-MailboxExportRequest command followed by Get-MailboxExport-Request command. In this case, the attacker was only interested in mail received this year.</p><p>  攻击者使用New-MailboxExportRequest命令和Get-MailboxExport-Request命令从目标帐户中窃取了电子邮件数据。在这种情况下，攻击者仅对今年收到的邮件感兴趣。</p><p> C:\Windows\system32\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command “New-MailboxExportRequest -Mailbox foobar@organization.here -ContentFilter {(Received -ge ’03/01/2020′)} -FilePath ‘\\&lt;MAILSERVER&gt;\c$\temp\b.pst&#39;”</p><p> C：\ Windows \ system32 \ cmd.exe / C powershell.exe -PSConsoleFile exshell.psc1-命令“ New-MailboxExportRequest -Mailbox \ foobar@organization.here -ContentFilter {（Received -ge '03 / 01/2020'）}- FilePath'\\＆lt; MAILSERVER＆gt; \ c $ \ temp \ b.pst＆＃39;”</p><p> The attacker created password-protected archives on the victims’ OWA server so that they could be exfiltrated via a simple HTTP request.</p><p> 攻击者在受害人的OWA服务器上创建了受密码保护的档案，以便可以通过简单的HTTP请求将其窃取。</p><p> C:\Windows\system32\cmd.exe /C .\7z.exe a -mx9 -r0 -p[33_char_password]  “C:\Program Files\Microsoft\Exchange Server\V15\FrontEnd\HttpProxy\owa\auth\Redir.png” C:\Temp\b.pst‍‍‍</p><p> C：\ Windows \ system32 \ cmd.exe / C。\ 7z.exe a -mx9 -r0 -p [33_char_password]“ C：\ Program Files \ Microsoft \ Exchange Server \ V15 \ FrontEnd \ HttpProxy \ owa \ auth \ Redir .png” C：\ Temp \ b.pst‍‍‍</p><p>     Volexity also saw the attacker stage other exfiltration in another folder on the server located here:</p><p>     Volexity还看到攻击者在位于此服务器上的另一个文件夹中进行其他渗透： </p><p>  Finally, the attacker added their own devices as allowed IDs for active sync for a number of mailboxes using  Set-CASMailbox:</p><p>最后，攻击者使用Set-CASMailbox将自己的设备作为允许的ID进行活动同步，以对多个邮箱进行主动同步：</p><p> C:\Windows\system32\cmd.exe /C powershell.exe -PSConsoleFile exshell.psc1 -Command “Set-CASMailbox -Identity &lt;UserID&gt; -ActiveSyncAllowedDeviceIDs @{add=’XXXXXXXXXXXXX’}”</p><p> C：\ Windows \ system32 \ cmd.exe / C powershell.exe -PSConsoleFile exshell.psc1-命令“ Set-CASMailbox -Identity＆lt; UserID＆gt; -ActiveSyncAllowedDeviceIDs @ {add =’XXXXXXXXXXXXX’}”</p><p>  After successfully exporting mail they wished to steal, the attacker would remove the evidence of the export request using  Remove-MailboxExportRequest:</p><p>  在成功导出他们希望窃取的邮件之后，攻击者将使用Remove-MailboxExportRequest删除导出请求的证据：</p><p>   During the July 2020 incident, Volexity observed at least two indicators that overlapped with indicators of compromise posted by FireEye. The organization’s SolarWinds server conducted DGA-style DNS queries under the following subdomain:</p><p>   在2020年7月的事件中，Volexity观察到至少两个指标与FireEye发布的危害指标重叠。该组织的SolarWinds服务器在以下子域下进行了DGA风格的DNS查询：</p><p>  The vast majority of queries were met with SERVFAIL responses. In most other cases, the hostnames resolved to IPs that fell in the ranges 184.72.0.0/16, 20.141.48.0/24, 8.18.144.0/24, and 8.18.145.0/24. However, the critical responses to the organization came by way of CNAME responses that occurred between June 30, 2020, and July 16, 2020. These DNS resolutions returned a CNAME for the domain  freescanonline[.]com. In late July, the attacker took advantage of their access and started moving laterally throughout the organization, which will be described a bit later. Most notably the attacker pushed malware to other systems that beaconed back to the following additional infrastructure:</p><p>  SERVFAIL响应满足了绝大多数查询。在大多数其他情况下，主机名解析为IP范围为184.72.0.0/16、20.141.48.0/24、8.18.144.0/24和8.18.145.0/24的IP。但是，对组织的重要响应来自2020年6月30日至2020年7月16日之间发生的CNAME响应。这些DNS决议返回了freescanonline [。] com域的CNAME。在7月下旬，攻击者利用了他们的访问权限，并开始在整个组织中横向移动，稍后将对此进行描述。最明显的是，攻击者将恶意软件推送到了其他系统，这些系统可追溯到以下其他基础结构：</p><p>  At the time of the incident (July 2020), the attacker had accidentally configured their servers to be open to the Internet, accepting arbitrary requests on port 80. Since then, the attacker has fixed this issue; however, at the time, Volexity was able to identify a number of C2 addresses based on server profiling.</p><p>  在事件发生时（2020年7月），攻击者意外地将其服务器配置为可向Internet开放，并在端口80上接受任意请求。此后，攻击者已修复此问题;但是，当时，Volexity能够根据服务器配置文件识别多个C2地址。</p><p> Specifically, at the time there were only a handful of servers that responded with the following HTTP headers in the following order:</p><p> 具体来说，当时只有少数服务器按照以下顺序响应以下HTTP标头： </p><p>  The “Server” value also specified IIS10.0, but this header order does not match the order used by IIS 10.0.</p><p>“服务器”值也指定了IIS10.0，但是此标头顺序与IIS 10.0使用的顺序不匹配。</p><p> Based on this pattern Volexity was able to identify the following IP addresses in July 2020:</p><p> 基于这种模式，Volexity能够在2020年7月识别出以下IP地址：</p><p> 13.57.184.217 13.59.205.66 18.217.225.111 18.220.219.143 3.16.81.254 3.87.182.149‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍ 34.219.234.134 54.193.127.66 54.215.192.52</p><p> 13.57.1​​84.217 13.59.205.66 18.217.225.111 18.220.219.143 3.16.81.254 3.87.182.149</p><p>   Notably, some of these domains were set up prior to the earlier known compromise date published by FireEye, such as solartrackingsystem[.]net, which was assigned its current nameserver in January 2020. Several of the domains also have very long registration histories going back several years. Volexity believes that attacker obtained these domains through auctions or from registrants after they expired but before they were deleted. This allowed the attacker to use domains with a long history and avoid being detected based on detections tied to a domain being newly registered.</p><p>   值得注意的是，其中一些域是在FireEye公布的较早的已知折衷日期之前建立的，例如solartrackingsystem [。] net，该网络在2020年1月被分配为其当前的名称服务器。其中一些域的注册历史可追溯至很长的历史。几年。 Volexity认为，攻击者会在域名过期后但被删除之前通过拍卖或从注册人那里获取这些域名。这使攻击者可以使用历史悠久的域，并且避免基于与新注册的域有关的检测而被检测到。</p><p>  At the time of the investigation, Volexity deduced that the likely infection was the result of the SolarWinds box on the target network; however, it was not fully understood exactly how the breach occurred (i.e., whether there was some unknown exploit in play, or other means of access), therefore Volexity was not in a position to report the circumstances surrounding the breach to SolarWinds. The machines involved in this incident had been rebooted several times prior to Volexity’s involvement in incident response efforts, meaning that a great deal of evidence that would have been in volatile memory had been lost.</p><p>  在调查时，Volexity推断出可能的感染是目标网络上SolarWinds盒的结果;但是，尚不能完全完全了解违规行为是如何发生的（即，游戏中是否存在一些未知的漏洞利用或其他访问手段），因此Volexity无法向SolarWinds报告违规情况。在Volexity参与事件响应工作之前，涉及该事件的计算机已重新启动了几次，这意味着丢失了许多本来应该存储在易失性存储器中的证据。</p><p> Volexity believes that Dark Halo is a sophisticated threat actor based on the following characteristics of their attacks:</p><p> Volexity认为Dark Halo是基于攻击的以下特征的复杂威胁演员：</p><p> Generally, the attacker displayed a reasonable level of operational security throughout the attack, taking steps to wipe logs for various services used and to remove evidence of their commands from infected systems.</p><p> 通常，攻击者在整个攻击过程中都显示出合理水平的操作安全性，采取措施清除所用各种服务的日志，并从受感染的系统中删除其命令的证据。 </p><p> The server profile used to identify the C2 domains was only visible for a snapshot in time, where the attacker likely became aware that their C2 addresses could be identified in this way, they went on to secure their C2 servers further.</p><p>用于识别C2域的服务器配置文件仅在时间快照中可见，攻击者可能会意识到可以以这种方式识别其C2地址，因此他们继续保护其C2服务器。</p><p> Despite an ongoing campaign lasting one year, very few files related to this attacker have made their way to VirusTotal.</p><p> 尽管正在进行的活动持续了一年，但与此攻击者相关的文件很少进入VirusTotal。</p><p> During the investigation Volexity discovered no hints as to the attacker’s origin or any links to any publicly known threat actor.</p><p> 在调查过程中，Volexity没有发现有关攻击者来源的任何暗示，也没有发现与任何已知威胁者的任何链接。</p><p>  Ensure that all secret keys associated with MFA or other sensitive integrations are reset following a breach.</p><p>  确保与MFA或其他敏感集成相关联的所有秘密密钥在违规后均被重置。</p><p> Make sure all credentials in an organization, including service accounts, are reset following a breach and that default passwords or those similar to previous passwords are not used.</p><p> 确保违规后重置组织中的所有凭据（包括服务帐户），并且不使用默认密码或与以前的密码相似的密码。</p><p> If you run an on-premise Exchange environment, consider adding alerting mechanisms to any EDR solutions for processes using the Exchange Management Shell PowerShell cmdlets listed in Appendix B. This may or may not be a valid detection approach depending on how frequently this is used within your organization.</p><p> 如果您运行本地Exchange环境，请考虑使用附录B中列出的Exchange命令行管理程序PowerShell cmdlet将警报机制添加到任何EDR解决方案流程中。这可能是有效的检测方法，具体取决于它在内部使用的频率。您的组织。</p><p> More generally, if the Exchange Management Shell is rarely used in a legitimate Administrative context, it may be worth investigating any historical use of this shell.</p><p> 更一般而言，如果很少在合法的管理环境中使用Exchange命令行管理程序，则有必要调查一下此管理程序的任何历史用途。 </p><p>  13.57.184.217 13.59.205.66 18.217.225.111 18.220.219.143 196.203.11.89 3.16.81.254 3.87.182.149 3.87.182.149‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍‍ 34.219.234.134 54.193.127.66 54.215.192.52 avsvmcloud[.]com deftsecurity[.]com digitalcollege[.]org freescanonline[.]com globalnetworkissues[.]com kubecloud[.]com lcomputers[.]com seobundlekit[.]com solartrackingsystem[.]net thedoccloud[.]com virtualwebdata[.]com webcodez[.]com</p><p>13.57.1​​84.217 13.59.205.66 18,217,225,111 18,220,219,143 196.203.11.89 3.16.81.254 3.87.182.149 3.87.182.149 34,219,234,134 54.193.127.66 54.215.192.52 avsvmcloud [。]具有机密性[。]与digitalcollegeon [。] Org freescanline [。]具有globalnetworkissues [。]具有kubecloud [。]具有lcomputers [。]具有seobundlekit [。]具有solartrackingsystem [。]净thedoccloud [。]具有virtualwebdata [。]具有webcodez [。] com </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/">https://www.volexity.com/blog/2020/12/14/dark-halo-leverages-solarwinds-compromise-to-breach-organizations/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/利用/">#利用</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/halo/">#halo</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/攻击者/">#攻击者</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>