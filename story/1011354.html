<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>面向JavaScript开发人员的Rust-模式匹配和枚举</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">面向JavaScript开发人员的Rust-模式匹配和枚举</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-12 23:33:34</div><div class="page_narrow text-break page_content"><p>这是向JavaScript开发人员介绍Rust语言系列文章的第四部分。以下是过去的章节：</p><p>为了理解模式匹配，让我们从JavaScript-switch大小写中熟悉的内容开始。</p><p>函数PRINT_COLOR(COLOR){Switch(COLOR){CASE&#34；ROSE&#34；：CONSOLE。原木(#34；玫瑰是红色的，#34；)；折断；表壳&#34；紫色&#34；：控制台。日志(&#34；紫罗兰是蓝色的，&#34；)；中断；默认：控制台。LOG(&#34；糖是甜的，你也是。&#34；)；}}PRINT_COLOR(&#34；ROSE&34；)；//玫瑰是红色的，PRINT_COLOR(&#34；紫色&34；)；//紫罗兰是蓝色的，PRINT_COLOR(&#34；You&#34；)；//糖是甜的，你也是。</p><p>fn print_color(color：&amp；str){Match color{&#34；Rose&#34；=&gt；println！(&#34；玫瑰是红色的，&#34；)，&#34；紫罗兰&#34；=&gt；println！(&#34；紫罗兰是蓝色的，&#34；)，_=&gt；println！(&#34；糖是甜的，你也是甜的。&#34；糖是甜的，你也是甜的。&#34；糖是甜的，你也是甜的。&#34；糖是甜的，你也是。&#34；糖是甜的，你也是甜的。)，}}fn main(){print_color(&#34；Rose&#34；)；//玫瑰是红色的，print_color(&#34；紫罗兰&#34；)；//紫罗兰是蓝色的，print_color(&#34；you&#34；)；//糖是甜的，你也是。}。</p><p>大部分代码应该可以立即理解。匹配表达式具有以下签名：</p><p>胖箭头=&gt；语法可能会绊倒我们，因为它与JavaScript箭头函数相似，但它们是无关的。最后一个使用下划线_的模式称为CatchAll模式，类似于切换情况下的默认情况。每个模式=&gt；表达式组合称为匹配臂。</p><p>上面的示例并没有真正传达出模式匹配有多有用-它看起来就像是具有不同语法和花哨名称的switch case。让我们讨论一下解构和枚举，以了解模式匹配为什么有用。</p><p>析构是将数组或结构的内部字段提取到单独变量中的过程。如果您在JavaScript中使用过解构，那么它在Rust中非常相似。</p><p>设RGB=[96,172，57]；设[红，绿，蓝]=RGB；控制台。log(红色)；//96console。log(绿色)；//172控制台。log(蓝色)；//57设Person={name：&#34；shesh&#34；，City：&#34；Singapore&#34；}；设{name，City}=Person；Console。log(Name)；//nameconsole。log(城市)；//城市。</p><p>struct Person{name：string，City：String，}fn main(){let rgb=[96,172，57]；let[red，green，Blue]=rgb；println！(&#34；{}&#34；，red)；//96 println！(&#34；{}&#34；，green)；//172 println！(&#34；{}&#34；，Blue)；//57设Person=Person{name：&#34；shesh&#34；。to_string()，城市：&#34；新加坡&#34；。to_string()，}；let Person{name，City}=Person；println！(&#34；{}&#34；，name)；//name println！(&#34；{}&#34；，City)；//City}。</p><p>编写“如果这个那么那个”类型的代码是非常常见的。通过将解构和模式匹配相结合，我们可以非常简洁地编写这些类型的逻辑。</p><p>让我们以下面的JavaScript示例为例。它是人为的，但你可能在你的职业生涯中的某个时候写过这样的东西：</p><p>常量point={x：0，y：30}；const{x，y}=point；if(x=0&amp；&amp；y=0){控制台。log(&#34；两者都是零&#34；)；}Else if(x=0){控制台。log(`x为零，y为${y}`)；}Else if(y=0){控制台。log(`x为${x}，y为零`)；}否则{控制台。log(`x为${x}，y为${y}`)；}。</p><p>结构点{x：I32，y：I32，}fn main(){let point=Point{x：10，y：0}；匹配点{Point{x：0，y：0}=&gt；println！(&#34；两者都是零&#34；)，点{x：0，y}=&gt；println！(&#34；x是零，y是{}&#34；，y)，点{x，y：0}=&gt；println！(&#34；x是{}，y是零&#34；，x)，点{x，y}=&gt；println！(&#34；x是{}，y是{}&#34；，x，y)，}}。</p><p>与if Else逻辑相比，它有点简洁，但也可能会令人困惑，因为我们同时执行比较、析构和变量绑定。</p><p>我们开始明白为什么它被命名为“模式匹配”-我们接受输入，看看火柴臂中的哪个模式“更适合”-它就像孩子们玩的形状分类玩具。除了比较，我们还在第2，3，4场比赛中做可变装订。我们将变量x和/或y传递给它们各自的表达式。</p><p>模式匹配也是详尽的-也就是说，它迫使您处理所有可能的情况。尝试删除最后一个匹配的ARM，Rust不会让您编译代码。</p><p>JavaScript没有枚举，但是如果您使用过tyescript，您可以认为Rust的枚举是typecript的枚举和typecript的区别联合的组合。</p><p>例如，即使JavaScript没有枚举，您也可以使用以下模式：</p><p>常量方向={前进：&#34；前进&#34；，向后：&#34；向后&#34；，左：&#34；左&#34；，右：&#34；右&#34；，}；函数MOVE_DRONE(方向){开关(方向){案例方向.FORWARD：控制台。记录(&#34；向前移动&#34；)；中断；案例方向.BACKWARD：控制台。记录(&#34；向后移动)；中断；案例方向。左：控制台。记录(&#34；向左移动)；中断；案例方向。右：控制台。日志(&#34；向右移动&#34；)；中断；}}MOVE_DRONE(方向.FORWARD)；//&#34；向前移动&#34；</p><p>在这里，我们可以将向前、向后、向左和向右定义为单独的常量，但是将其分组到Direction对象中有以下好处：</p><p>名称向前、向后、向左和向右在方向下进行命名空间，因此可以避免命名冲突。</p><p>它是自我文档化的，因为我们可以快速查看代码库中所有可用的有效说明。</p><p>如果有人将NORTH或UP作为参数传递给MOVE_DRONE怎么办？要解决此问题，我们可以添加一个验证，以确保在Move函数中只允许Direction对象中存在的值。</p><p>如果我们决定在将来支持向上和向下，或者将左/右更名为左舷/右舷，该怎么办？我们需要找出所有使用类似开关盒或IF-ELSE的地方。我们有可能会错过一些会在生产中引起问题的地方。</p><p>强类型语言(如Rust)中的枚举功能更强大，因为它们无需我们编写额外代码即可解决这些问题。</p><p>如果函数只能接受一小部分有效输入，则可以使用枚举来强制执行此约束。</p><p>使用模式匹配枚举会强制您覆盖所有情况。在将来更新枚举时非常有用。</p><p>枚举方向{向前、向后、左、右}fn MOVE_DRONE(方向：方向){匹配方向{方向：：向前=&gt；println！(&#34；向前移动&#34；)，方向：：向后=&gt；println！(&#34；向后移动)，方向：：Left=&gt；println！(&#34；向左移动&#34；)，方向：：右=&gt；println！(&#34；右移&#34；)，}}fn main(){Move_Done(Direction：：Forward)；}。</p><p>我们使用：：表示法访问Enum内的变量。尝试通过调用“Move_Droone(Direction：：Up)”或将“Down”作为新项添加到Direction枚举中来编辑此代码。在第一种情况下，编译器会抛出一个错误，指出在“Direction”中找不到“Up”，在第二种情况下，编译器会抱怨我们没有在Match块中覆盖“Down”。</p><p>Rust Enums可以做的不仅仅是充当一组常量-我们还可以将数据与Enum变量相关联。</p><p>枚举方向{向前，向后，左，右，}枚举操作{PowerOn，PowerOff，Move(Direction)，Rotate，TakePhoto{IS_SCOWARE：BOOL，ZOOM_LEVEL：I32}，}FN OPERATE_DRONE(OPERATION：OPERATION){匹配操作{Operation：：PowerOn=&gt；println！(&#34；打开&#34；)，操作：：PowerOff=&gt；println！(&#34；Power。)，操作：：MOVE(方向)=&gt；MOVE_DRONE(方向)，操作：：Rotate=&gt；println！(&#34；Rotate&#34；)，操作：：TakePhoto{IS_LANCES，ZOOM_LEVEL，}=&gT；println！(&#34；TakePhoto{}，{}&#34；，IS_LOCATIONAL，ZOOM_LEVEL)，}}FN MOVE_DRONE(方向：方向){匹配方向{方向：：向前=&gt；println！(&#34；向前移动&34；)，方向：：向后=&gt；println！(&#34；向后移动&34；)，方向：：Left=&gt；println！(&#34；向左移动&#34；)，方向：：右=&gt；println！(&#34；Move Right&#34；)，}}fn main(){Operate_Droone(Operation：：Move(Direction：：Forward))；Operate_Droone(Operation：：TakePhoto{IS_LAWAGE：TRUE，ZOOM_LEVEL：10，})}</p><p>这里，我们又添加了一个名为Operation的Enum，它包含“unit like”变量(PowerOn、PowerOff、Rotate)和“struct like”变量(Move、TakePhoto)。请注意我们如何将模式匹配与析构和变量绑定一起使用。</p><p>如果您使用过TypeScript或Flow，这类似于区分的联合或SUM类型：</p><p>接口{Kind：&#34；PowerOff&#34；；}接口{Kind：&#34；PowerOff&#34；；}type Direction=&#34；Forward&#34；|&#34；|&#34；Left&#34；|&#34；Right&#34；；interface{Kind：&#34；Move&#34；；Direction：Direction；}接口{Kind：&#34；Rotate&#34；；}interface{Kind：&#34；TakePhoto&#34；；IS_LOCATIONAL：Boolean；ZOOM_LEVEL：NUMBER；}type Operation=PowerOn|PowerOff|Move|Rotate|TakePhoto；Function Operate_Done(operation：Operation){Switch(operation.Kind){case&#34；PowerOn&#34；：Console。日志(&#34；开机&#34；)；中断；案例&#34；电源关闭&#34；：控制台。LOG(&#34；Power Off&#34；)；Break；Case&#34；Move&#34；：MOVE_DRONE(操作.Direction)；Break；Case&#34；Rotate&#34；：Console。Log(&#34；Rotate&#34；)；Break；Case&#34；TakePhoto&#34；：控制台。log(`TakePhoto${operation.is_scape}，${operation.zoom_level}`)；Break；}}函数MOVE_DRONE(方向：方向){Switch(方向){case&#34；Forward&#34；：控制台。日志(&#34；向前&#34；)；中断；案例&#34；向后&#34；：控制台。Log(&#34；向后移动&#34；)；Break；Case&#34；Left&#34；：控制台。LOG(&#34；Move Left&#34；)；Break；Case&#34；Right&#34；：控制台。log(&#34；Move Right&#34；)；Break；}}OPERATE_DRONE({KIND：&#34；MOVE&#34；，方向：&#34；FORWARD&#34；，})；OPERATE_DRONE({KIND：&#34；TakePhoto&#34；，IS_LANCEL：TRUE，ZOOM_LEVEL：10，})；</p><p>我们在第2章中了解了选项类型。选项实际上是一个具有两个变体的枚举-一些和没有：</p><p>fn read_file(path：&amp；str)-&gt；option&lt；&amp；str&gt；{let content=&#34；hello&#34；if path！=&#34；&#34；{Return Some(Contents)；}return None；}fn main(){let file=read_file(&#34；path/to/file&#34；)；if file。is_ome(){让Contents=file.。展开()；println！(&#34；{}&34；，Contents)；}否则{println！(&#34；Empty！&#34；)；}}。</p><p>fn main(){let file=read_file(&#34；path/to/file&#34；)；匹配文件{Some(Contents)=&gt；println！(&#34；{}&#34；，Contents)，None=&gt；println！(&#34；Empty！&#34；)，}}。</p><p>在Github、Twitter或LinkedIn上找到我。请随时通过sheshbabu[at]gmail.com与我联系</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="http://www.sheshbabu.com/posts/rust-for-javascript-developers-pattern-matching-and-enums">http://www.sheshbabu.com/posts/rust-for-javascript-developers-pattern-matching-and-enums</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/java/">#java</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/开发/">#开发</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/rust/">#rust</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/枚举/">#枚举</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1011263.html"><img src="http://img.diglog.com/img/2020/7/thumb_ddd802e3034da766b357abb3fd1e241e.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1011263.html">Deno JavaScript的包管理器</a></div><span class="my_story_list_date">2020-7-12 5:8</span></div><div class="col-sm"><div><a target="_blank" href="/story/1010724.html"><img src="http://img.diglog.com/img/2020/7/thumb_f6a515d8a82aff74430468a5cd03fd9f.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1010724.html">新的JavaScript代码生成器已在Idris 2中落地</a></div><span class="my_story_list_date">2020-7-9 14:57</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009991.html"><img src="http://img.diglog.com/img/2020/7/thumb_80fecb39faabd710594d24737c2fa2ac.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009991.html">Chrome实验功能将限制后台选项卡上的Javascript计时器唤醒</a></div><span class="my_story_list_date">2020-7-6 4:10</span></div><div class="col-sm"><div><a target="_blank" href="/story/1009835.html"><img src="http://img.diglog.com/img/2020/7/thumb_6e77901b46b15d3276b752e30d7661b5.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1009835.html">巴克莱银行(Barclays Bank)可能会将Wayback Machine用作一些JavaScript的“CDN”</a></div><span class="my_story_list_date">2020-7-5 0:50</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>