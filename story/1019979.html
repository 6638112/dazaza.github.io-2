<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PHP内置Web服务器</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">PHP内置Web服务器</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-08-24 07:34:02</div><div class="page_narrow text-break page_content"><p>警告此Web服务器旨在帮助开发应用程序。它还可用于测试目的或在受控环境中运行的应用程序演示。它不打算成为功能齐全的Web服务器。不应在公共网络上使用它。</p><p>Web服务器只运行一个单线程进程，因此如果请求被阻塞，PHP应用程序将会停止。</p><p>URI请求从启动PHP的当前工作目录提供服务，除非使用-t选项指定显式文档根目录。如果URI请求没有指定文件，则返回给定目录中的index.php或index.html。如果这两个文件都不存在，则在父目录中继续查找index.php和index.html，依此类推，直到找到一个或到达文档根目录。如果找到index.php或index.html，则返回它，并将$_SERVER[&#39；PATH_INFO&#39；]设置为URI的尾部。否则返回404响应代码。</p><p>如果在启动Web服务器时命令行上提供了PHP文件，则该文件将被视为路由器脚本。该脚本在每个HTTP请求开始时运行。如果此脚本返回False，则请求的资源将按原样返回。否则，脚本的输出将返回给浏览器。</p><p>将为扩展名为.3gp、.apk、.avi、.bmp、.css、.csv、.doc、.docx、.flac、.gif、.gz、.gzip、.htm、.html、.ics、.jpe、.jpeg、.jg、.js、.kml、.kmz、.m4a、.mov、.mp3、.mp4、.mpeg的文件返回标准MIME类型。.oga、.ogg、.ogv、.pdf、.pdf、.png、.pps、.pptx、.qt、.svg、.swf、.tar、.text、.tif、.txt、.wav、.webm、.wmv、.xls、.xlsx、.xml、.xsl、.xsd和.zip。</p><p>.3gp、.apk、.avi、.bmp、.csv、.doc、.docx、.flac、.gz、.gzip、.ics、.kml、.kmz、.m4a、.mp3、.mp4、.mpg、.mpeg、.mov、.odp、.ods、.odt、.oga、.pdf、.pptx、.pps、.qt、.swf、.。.xls、.xlsx和.zip。</p><p>您可以将内置Web服务器配置为派生多个工作器，以便测试需要向内置Web服务器发出多个并发请求的代码。在启动服务器之前，将PHP_CLI_SERVER_WORKS环境变量设置为所需的工作进程数。这在Windows上不受支持。</p><p>PHP 5.4.0 Development Server在清华7月21日10：43：28 2011启动收听localhost：8000文档根目录为/home/me/public_html按Ctrl-C组合键退出</p><p>PHP 5.4.0开发服务器于2011年清华7月21 10：43：28启动本地主机监听：8000Document root为/HOME/me/public_html按Ctrl-C退出。[清华7月21 10：48：48 2011]：：1：39144 GET/Favicon.ico-Request Read[清华JUL 21 2011 10：48：50]：：1：39146 GET/-Request Read[清华JUL 21 2011 10：48：50。52 2011年]：：1：39148 GET/myscript.html-请求读取[清华7月21 10：48：52 2011]：：1：39149 GET/Favicon.ico-请求读取。</p><p>请注意，在PHP 7.4.0之前，Windows上不能访问符号链接的静态资源，除非路由器脚本可以处理这些资源。</p><p>PHP 5.4.0开发服务器于清华7月21日10：50：26启动收听localhost：8000Document root为/home/me/public_html/foo按Ctrl-C退出。</p><p>在此示例中，图像请求将显示它们，但HTML文件请求将显示&#34；欢迎使用PHP&#34；：</p><p>&lt；？php//rerouter.php if(preg_match(&#39；/\.(？：png|jpg|jpeg|gif)$/&#39；，n$_server[&#34；request_URI&#34；]))n{0将返回False；继续//按原样为您请求的资源提供服务。}还有没有其他的，{}将回应&#34；&lt；p&gt；欢迎您加入我们的PHP&lt；/p&gt；；}？&gt；##34；/p&&gt;；}？&gt；欢迎使用PHP&lt；/p&&gt;；}？&gt；</p><p>要在CLI Web服务器和以后的生产Web服务器的开发过程中重复使用框架路由器脚本，请执行以下操作：</p><p>&lt；？php//.router.php if(php_sani_name()==0&#39；cli-server&#39；){/*静态资产的路由，返回错误的路径*/}/*继续正常的index.php操作*/？&gt；</p><p>如果您需要提供其MIME类型未由CLI Web服务器处理的静态资源，请使用：</p><p>Ó要设置特定于项目的配置选项，只需将php.ini文件添加到项目中，然后使用此标志运行内置服务器：PHP-S localhost：8000-c php.ini这对于无法在运行时设置的设置(ini_set())特别有用。</p><p>？它没有直接提到，也可能不明显，但你也可以用它来创建一个虚拟主机。当然，这需要主机文件的帮助。步骤如下：1、/etc/hosts：127.0.0.1；www.example.com2、cd[根文件夹]：php-S www.example.com：80003、浏览器：*http://www.example.com:8000/index.php结合简单的SQLite数据库，拥有非常便捷的测试环境。</p><p>ä我痛苦地经历了一些行为，但我在这里似乎找不到记录在案的，所以我想给大家提个醒，以免重蹈覆辙：在Mac(在我的例子中是MacOS Sierra)上启动php-S以托管本地服务器时，我在从传统Java连接时遇到了问题。结果是，如果您使用&#34；php-S localhost：80&#34；启动php服务器，那么服务器将只支持IPv6！要通过IPv4访问它，您需要更改启动命令，如下所示：&#34；php-S 127.0.0.1：80&#34；该命令仅在IPv4模式下启动服务器。</p><p>？侦听IPv4的所有地址：PHP-S 0.0.0.0：80侦听IPv6的所有地址：PHP-S[：：0]：80。</p><p>Ó要发送与PHP内置Web服务器相同的环境变量，请键入如下内容。~$MYENV=dev php-d变量_ORDER=EGPCS-S 0.0.0.0：8000在PHP脚本上，我们可以使用此代码进行检查。&lt；？php和echo getenv(&#39；MYENV&#39；)；//打印开发。</p><p>如果您的URI包含点，则在使用内置Web服务器时，您将丢失$_SERVER[&#39；PATH_INFO&#39；]变量。我想编写一个API，并使用.json以URI-s结尾，但是后来框架的路由机制崩溃了，花了很长时间才发现它背后的原因是它的路由器依赖$_server[&#39；path_info&#39；]。参考文献：https://bugs.php.net/bug.php?id=61286。</p><p>Ó在WindowsShell：sendto中有一个phpserver.bat文件可能会很有用，下面是：Explorer http://localhost:8888 rem检查arg是文件还是目录&#34；%~1\&#34；(php-S localhost：8888-t&#34；%~1&#34；)否则(php-S localhost：8888-t&#34；%~dp1&#34；)那么要快速进行网络测试，您只需。</p><p>Ó要在命令行上输出调试信息，可以将输出写入到php：//stdout：&lt；？php$path=$_server[&#34；script_filename&#34；]；file_put_content(&#34；php：//stdout&#34；，&#34；\n请求的：$path&#34；)；echo&#34；&lt；p&gt；Hello World&lt；/p&gt；&#</p><p>？仅向也使用Windows 8.1的用户或在使用PHP服务器CLI运行时遇到此问题的任何人发出提示。`PHP-S localhost：8000-t/public`&lt；--不工作。`PHP-S localhost：8000-t public`&lt；--works！此外，笔记中还提到了一些关于您不能为项目文件夹和路由器文件提供服务的内容。嗯，事实上你可以的！至少对我来说是这样。`PHP-S localhost：8000 router.php-t public`&lt；--可能有人尝试了一下，但它不起作用。`PHP-S localhost：8000-t public router.php`&lt；--works！</p><p>ä我摆弄着内部网络服务器，在处理静态文件时遇到了问题，这些静态文件不包含点和文件扩展名。Web服务器返回200，但没有任何URI文件(如&#34；/testfile&#34；)的内容。我不确定这是否是bug，但是我创建了一个router.php，它现在不使用&#34；return false；&#34；操作，以便通过内部Web服务器传递静态文件。相反，我使用fpassthu()来实现这一点。除此之外，我的router.php可以配置为...。-.。具有某些索引文件，在请求目录时...。配置正则表达式路由，以便如果REQUEST_URI与正则表达式匹配，则改为请求某个文件或目录。(您可以使用nginx config或.htaccess ModRewrite来做一些事情)也许有人会觉得这很有帮助。=&lt；？PHP$indexFiles=[&#39；index.html&#39；，&#39；index.php&#39；]；$routes=[&#39；^/api(/.*)？$&#39；=&&gt;；&#39；/index.php&#39；]；$request。$_SERVER[&#39；REQUEST_URI&#39；]；//检查请求是否匹配其中一个定义的路由foreach($routes as$regex=&gt；$fn){*if(preg_Match(&#39；%&#39；。$regex。&#39；%&#39；，$_SERVER[&#39；REQUEST_URI&#39；])，{$requstedAbsoluteFile=dirname(__File__)。$fn；$Break；$}}//如果请求是目录调用，请检查索引文件是否存在，条件是(is_dir($requstedAbsoluteFile)){5foreach($indexFiles as$filename)和{requstedAboluteFile=$requstedAboluteFile。&#39；/&#39；。$filename；如果(IS_FILE($FN))，则$filename；如果请求的文件不存在或is directory=&gt；404 if(！)，则返回{_file($fn)/{requstedAbsoluteFile=$fn；$Break；${}//如果请求的文件不存在或is directory=&gt；404 if(！Is_file($requstedAbsoluteFile)){标头($_server[&#39；server_protocol&#39；]。&#39；404未找到&#39；)；$printf(&#39；&#34；%s&#34；不存在&#39；，$_server[&#39；Request_URI&#39；])；如果请求的文件是&#39；NT php文件，则返回true；}//如果(！Preg_Match(&#39；/\.php$/&#39；，$requstedAbsoluteFile){标题(&#39；Content-Type：&#39；。MIME_CONTENT_TYPE($requstedAbsoluteFile))；*$fh=fopen($requstedAbsoluteFile，&#39；r&#39；)；*fpassthu($fh)；*fclose($fh)；将返回true；}//如果请求的文件是php，则将其包括在内_once$requtedAboluteFile；</p><p>？我的路由文件如下所示：if(file_exists($_SERVER[&#34；DOCUMENT_ROOT&#34；]。$_SERVER[&#34；REQUEST_URI&#34；])){返回FALSE；}否则{需要&#34；index.php&#34；；}原因是要支持所有静态文件。</p><p>？将php用作内置命令行Web服务器时，未定义$$_SERVER[&#39；SERVER_ADDR&#39；]，因此不能使用$_SERVER[&#39；SERVER_ADDR&#39；]检测服务器的IP地址。附注：这是在2016-12-22年12月7日在Windows PHP 7.1上测试的。下面是打印的$_SERVER变量。数组([文档根]=&gt；E：\Programs\PHPServer\www\srv)[远程地址]=&gt；118.117.61.32)[远程端口]=&gt；10865：[服务器软件]=&gt；PHP 7.1.0开发服务器地址[服务器协议]=&gt；HTTP/1.1.[服务器名称]=&gt；0.0.0.0%[服务器端口]=&gt。8080GET[请求URI]=&gt；/；[请求方法]=&gt；获取[脚本名称]=&gt；/index.php文件名[脚本文件名]=&gt；E：\Programs\PHPServer\www\srv\index.php=[PHP_Self]=&gt；/index.php；[HTTP_HOST]=&gt；www.wuxiancheng.ct；[HTTP_HOST]=&gt；www.wuxiancheng.cn。保持活动状态[HTTP_CACHE_CONTROL]=&gT；MAX-AGE=0；[HTTP_UPDATE_INSECURE_REQUESTS]=&&gt;1个[HTTP_USER_AGENT]=&gT；MOZILLA/5.0(Windows NT6.1；Win64；x64)AppleWebKit/537.36(KHTML，如壁虎)Chrome/55.0.2883.87 Safari/537.36*[HTTP_Accept]=&gt；Text/HTML，application/xhtml+。Q=0.8%[HTTP_DNT]=&gt；1%[HTTP_ACCEPT_ENCODING]=&gt；gzip，DEFLATE，SDCH=[HTTP_ACCEPT_LANGUAGE]=&gT；zh-CN，zh；q=0.8，en-US；q=0.6，en；q=0.4%[HTTP_cookie]=&gt；qbbs_2132_saltkey=fZ7509n5；qbbs_2132_lastkey。Hm_lvt_6a65b0f2004e441e86ecea9c3562d997=1482232509,1482241896,1482242293,1482296586：[请求时间浮点]=&gt；1482390410.65625；[请求时间]=&gt；1482390410)。</p><p>Ó当我需要启动服务器以使用重写进行开发时，我使用它：//php-S 0.0</p><p>您还可以通过ERROR_LOG()将消息打印到服务器的STDOUT。此外，文档没有明确说明，当您使用路由器脚本时，如果请求PHP文件，并且您返回False，则将提供PHP文件(即，您不需要手动加载和评估它)。</p><p>Ó我改进了伊万·费雷尔的phpserver.bat，以便直接在浏览器中打开发送到文件：-rem检查arg是文件还是目录&#34；%~1\&#34；(资源管理器http://localhost:8888：php-S localhost：8888-t&#34；%~1&#34；)否则(资源管理器http://localhost:8888/%~nx1：php-S localhost：8888-t&#34；%~dp1&#34；%~dp-S localhost：8888-t&#34；%~dp-S localhost：8888-t&#34；%~dp1&#34；)。</p><p>？在我的Mac(High Sierra)PHP 7.2服务器和Laravel Valet上执行shell脚本时，我发现了一个奇怪的问题。路径=/usr/bin：/bin：/usr/sbin：/sbin是默认的Mac路径，但没有考虑.bash_profile中的shell路径，这意味着找不到MySQL和其他实用程序。是否有在执行时注入路径变量的解决方法。</p><p>？如果您遇到此错误：未知：php_network_getaddress：getaddrinfo失败，请尝试此操作：1.确保您的主机文件中有`localhost`条目2.或使用`php-S 127.0.0.1：8888`。</p><p>Ó注意：内置Web服务器有文件大小限制。对于大于5 GB的文件，它将始终显示找不到文件错误页。</p><p>Ó要设置特定于项目的配置选项，只需将php.ini文件添加到项目中，然后使用此标志运行内置服务器：PHP-S localhost：8000-c php.ini这对于无法在运行时设置的设置(ini_set())特别有用。</p><p>ÓSubmit_btn.addEventListener(MouseEvent.CLICK，sendMessage)；函数sendMessage(e：MouseEvent)：void{var my_vars：URLVariables=new URLVariables()；my_vars.senderName=name_txt.text；my_vars.senderEmail=email_txt.text；my_vars.senderMsg=message_txt.text；var my_ur。My_loader.dataFormat=URLLoaderDataFormat.VARIABLES；my_loader.load(My_Url)；name_txt.text=&#34；&#34；；email_txt.text=&#34；&#34；；message_txt.text=&#34；；}</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.php.net/manual/en/features.commandline.webserver.php">https://www.php.net/manual/en/features.commandline.webserver.php</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/内置/">#内置</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/built/">#built</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/php/">#php</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>