<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>BLINK：打算删除：HTTP/2和gQUIC服务器推送</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">BLINK：打算删除：HTTP/2和gQUIC服务器推送</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-12 09:11:53</div><div class="page_narrow text-break page_content"><p>unread, 6:00 AM (3 hours ago)  6:00 AM    Either email addresses are anonymous for this group or you need the view member email addresses permission to view the original message</p><p>未读时间：上午6：00(3小时前)和上午6：00要么电子邮件地址对此组是匿名的，要么您需要查看成员电子邮件地址权限才能查看原始邮件。</p><p> Remove the ability to receive, keep in memory, and use HTTP/2 and gQUIC push streams sent by the server.  Send SETTINGS_ENABLE_PUSH = 0 at the beginning of every HTTP/2 and gQUIC connection to request that servers not send them.</p><p>删除接收、保存在内存中以及使用服务器发送的HTTP/2和gQUIC推送流的功能。请在每个HTTP/2和gQUIC连接开始时发送SETTINGS_ENABLE_PUSH=0，以请求服务器不发送它们。</p><p>   HTTP/2 allows servers to “push” a resource that the client will likely need before the client actually requests it, see   https://httpwg.org/specs/rfc7540.html#PushResources .  The specification allows the client to reject the pushed resource at its discretion.</p><p>Https://httpwg.org/specs/rfc7540.html#PushResources/2允许服务器在客户端实际请求之前“推送”客户端可能需要的资源，参见HTTP。该规范允许客户端自行拒绝推送的资源。</p><p>  gQUIC is a non-standard protocol supported by Google servers, Akamai, and Litespeed.  It also allows servers to push resources in a fashion very similar to HTTP/2.  gQUIC is being obsoleted by HTTP/3 and support will eventually be removed entirely.</p><p>GQUIC是Google服务器、Akamai和Litespeed支持的非标准协议。它还允许服务器以非常类似于HTTP/2的方式推送资源。gQUIC正在被HTTP/3淘汰，最终将完全取消对它的支持。</p><p>    Chrome currently supports handling push streams over HTTP/2 and gQUIC, and this intent is about removing support over both protocols.  Chrome does not support push over HTTP/3 and adding support is not on the roadmap.</p><p>Chrome目前支持通过HTTP/2和gQUIC处理推流，这一意图是为了移除对这两种协议的支持。*Chrome不支持通过HTTP/3推送，添加支持不在路线图中。</p><p>   Almost five and a half years after the publication of the HTTP/2 RFC, server push is still extremely rarely used.  Over the past 28 days, 99.95% of HTTP/2 connections created by Chrome never received a pushed stream ( Net.SpdyStreamsPushedPerSession) , and 99.97% of connections never received a pushed stream that got matched with a request ( Net.SpdyStreamsPushedAndClaimedPerSession) .  These numbers are exactly the same as in June 2019.  In June 2018, 99.96% of HTTP/2 connections never received a pushed stream.  These numbers  indicate the lack of active efforts by server operators to increase push usage.  On top of this, less than 40% of received pushes are used, down from 63.51% two years ago.  The rest are invalid, never get matched to a request, or already in cache.</p><p>在HTTP/2 RFC发布近五年半后，服务器推流仍然极少使用。在过去的28天里，Chrome创建的99.95%的HTTP/2连接从未收到过推流(Net.SpdyStreamsPushedPerSession)，99.97%的连接从未收到过与请求匹配的推流(Net.SpdyStreamsPushedAndClaimedPerSession)。这些数字与2019年6月的数据完全相同。99.96%的HTTP/2连接从未收到过推流。这些数字表明服务器运营商没有采取积极措施来增加推送使用率。*最重要的是，收到的推送的使用率从两年前的63.51%下降到了不到40%。其余的都是无效的，永远不会与请求匹配，或者已经在缓存中。</p><p>  Server push is very difficult to use well.  Akamai publicly shared two studies showing that push over HTTP/2 either does not change performance or improves performance marginally when used with certain restrictions, see   https://lists.w3.org/Archives/Public/ietf-http-wg/2019JulSep/0078.html .  However, these studies had been done more than a year ago and push usage data still does not indicate wide deployment even within Akamai’s network.  In light of this it is doubtful that smaller server operators have the resources to successfully deploy server push.</p><p>服务器推送很难很好地使用。Akamai公开分享了两项研究，表明通过http/2推送不会改变性能，或者在使用某些限制时略微提高性能，参见https://lists.w3.org/Archives/Public/ietf-http-wg/2019JulSep/0078.html。然而，这些研究已经进行了一年多，推送使用数据仍然不表明广泛部署，即使在Akamai的网络中也是如此。鉴于此，规模较小的服务器运营商是否有资源成功部署服务器推送是值得怀疑的。</p><p>  A contrasting result has been presented to the same IETF in 2018: a large experiment done by Chrome to measure the effect of server push on page load latency when using HTTP/2 showed that push increases latency at the long tail, see   https://github.com/httpwg/wg-materials/blob/gh-pages/ietf102/chrome_push.pdf .</p><p>2018年，同一个ietf呈现了一个截然不同的结果：Chrome做了一个大型实验，测量使用http/2时服务器推流对页面加载延迟的影响，结果显示，推流会增加长尾延迟，参见https://github.com/httpwg/wg-materials/blob/gh-pages/ietf102/chrome_push.pdf。</p><p>  As far as gQUIC goes, over the past 28 days, less than 1 out of 1,200,000 connections have seen any pushed streams.  We are not aware of any studies done on the effect of latency.</p><p>就gQUIC而言，在过去的28天里，每120万个连接中只有不到1个看到过推流。我们不知道有任何关于延迟影响的研究。</p><p>  There is significant code complexity associated with Chromium supporting push: pushed requests have to be stored in an in-memory cache, looked up by URL across connections but only if the connection is authoritative for the request, matched by other parameters (method and other headers), and evicted after a timeout.  Running associated tests burden developers and infrastructure when developing unrelated features, and users bear the burden of increased binary size.  We believe that these outweigh the theoretical performance benefits.</p><p>Chromium支持推送有很大的代码复杂性：推送的请求必须存储在内存缓存中，通过连接的URL查找，但前提是连接对请求是权威的，与其他参数(方法和其他头部)匹配，并在超时后被逐出。在开发无关功能时，运行相关测试会给开发人员和基础设施带来负担，而用户承担增加的二进制大小的负担。*我们认为这些好处超过了理论上的性能好处。</p><p>   There is no compatibility risk.  Server push is meant as a performance optimization, a client is allowed to choose to reject any pushed streams.  In order to minimize wasted downlink capacity, Chromium would cancel pushed streams that a buggy server might open despite Chromium disabling server push by sending SETTINGS_ENABLE_PUSH = 0 in the initial SETTINGS frame.  Note however that in the experiment conducted two years ago no server was observed to send pushes when this setting was sent.</p><p>没有兼容性风险。服务器推送是一种性能优化，允许客户端选择拒绝任何推送的流。*为了最大限度地减少浪费的下行链路容量，Chromium会通过在初始设置框中发送SETTINGS_ENABLE_PUSH=0来取消有漏洞的服务器可能打开的推送流，方法是在初始设置框中发送SETTINGS_ENABLE_PUSH=0。但是请注意，在两年前进行的实验中，没有观察到服务器在发送此设置时发送推送。</p><p>  Firefox and Safari both support HTTP/2 push and we are not aware of any plans for removal.</p><p>Firefox和Safari都支持HTTP/2推送，我们不知道有任何移除的计划。</p><p>   It is recommended that servers use the  &lt;link rel=&#34;preload&#34;&gt;  element to notify the client about subresources that it is expected to need.  Admittedly these resources will then need to be requested by the client, making them arrive 1 RTT later than a pushed resource would.  On the other hand,  &lt;link rel=&#34;preload&#34;&gt;  allows the client to avoid fetching resources which are already cached.  Repeated efforts to analyze the latency gains of push found little or no benefit.</p><p>建议服务器使用&lt；link rel=#34；preload；&gt；元素通知客户端预期需要的子资源。诚然，客户端随后将需要请求这些资源，使它们比推送的资源延迟1 RTT到达。另一方面，&lt；link rel=#34；preload&34；&gt；允许客户端避免提取已缓存的资源。重复尝试分析延迟。</p><p>  Because of limitations of HTTP/2 stream multiplexing, a server may normally only send  &lt;link rel=&#34;preload&#34;&gt;  elements when the rest of the final headers are available, otherwise it would block other responses on the connection.  The 103 Early Hints status code (  https://tools.ietf.org/html/rfc8297 ) is expected to provide better performance under certain circumstances by allowing information about resources that the client should request to be sent as soon as available and then making the connection available for carrying data on other streams until the final response is sent.  There is active effort to measure the potential latency gain of 103 Early Hints (compared to not using it, without using server push in either case), with the understanding that resources will be allocated to implementing it in Chromium in case data look promising.  See   https://chromium.googlesource.com/chromium/src/+/master/docs/early-hints.md  for more details.</p><p>由于HTTP/2流多路复用的限制，服务器通常可能只发送&lt；link rel=&#34；preload&gt；元素，否则它将阻塞连接上的其他响应。在某些情况下，103个早期提示状态代码(https://tools.ietf.org/html/rfc8297)有望提供更好的性能，因为它允许有关客户端应请求的资源的信息尽快发送，然后使连接可用于在其他流上承载数据，直到最终响应被发送。如果正在积极努力测量103个早期提示的潜在延迟增益(与在这两种情况下都不使用它，而不使用服务器推送相比)，如果数据看起来前景看好，我们将分配资源用于在Chromium中实现它。更多细节请参见https://chromium.googlesource.com/chromium/src/+/master/docs/early-hints.md。</p><p>  It is interesting to note that server push has been used in ways other than originally intended.  One prominent example is to stream data from the server to the client, which will be better served by the upcoming WebTransport protocol.</p><p>有趣的是，服务器推送的使用方式超出了最初的预期。一个突出的例子是将数据从服务器传输到客户端，这将被即将发布的WebTransport协议更好地服务。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://groups.google.com/a/chromium.org/g/blink-dev/c/K3rYLvmQUBY/m/vOWBKZGoAQAJ">https://groups.google.com/a/chromium.org/g/blink-dev/c/K3rYLvmQUBY/m/vOWBKZGoAQAJ</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/服务器/">#服务器</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/intent/">#intent</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/推送/">#推送</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034061.html"><img src="http://img2.diglog.com/img/2020/11/thumb_ba9a5ffbec05326b99ff326f7a5c40a0.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034061.html">四个强大的HTTP标头，您以前不知道</a></div><span class="my_story_list_date">2020-11-10 0:11</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032963.html"><img src="http://img2.diglog.com/img/2020/11/thumb_1b8d43f0863065c4f954f4168059ebc7.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032963.html">CTO可怕的停电故事</a></div><span class="my_story_list_date">2020-11-3 22:14</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031464.html"><img src="http://img2.diglog.com/img/2020/10/thumb_194015af871dc0eae66ec9140ee18b52.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031464.html">无服务器搜索和分析初创公司Rockset在红杉资本(Sequoia Capital)牵头的B系列融资4000万美元</a></div><span class="my_story_list_date">2020-10-27 20:40</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030953.html"><img src="http://img2.diglog.com/img/2020/10/thumb_703ff4b74c33072dcd8ca8a2a94efdfc.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030953.html">Faasd-轻量级无服务器，适用于您的树莓PI(2020年更新)</a></div><span class="my_story_list_date">2020-10-24 18:57</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>