<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何使用加密双引导Ubuntu 20.04和Windows 10</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">如何使用加密双引导Ubuntu 20.04和Windows 10</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-28 11:36:05</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/a022a87498307e340e9ad1edc2b08f6d.jpg"><img src="http://img2.diglog.com/img/2020/10/a022a87498307e340e9ad1edc2b08f6d.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>When you run the Ubuntu installer, there’s an option to dual-boot Ubuntu with anexisting Windows installation. There’s also an option to encrypt your Ubuntuinstallation, but  only if you erase everything and install ubuntu. There’s noautomatic way to install Ubuntu alongside Windows 10 with encryption. And whilethere are plenty of tutorials for dual-booting Ubuntu and Windows, many of themare outdated – often referencing an MBR partition table – and almost none ofthem seem to address encrypting your Ubuntu partition.</p><p>当你运行Ubuntu安装程序时，有一个选项可以用现有的Windows安装来双引导Ubuntu。还有一个选项可以加密你的Ubuntuinstall，但前提是你必须清除所有内容并安装Ubuntu。没有自动方式将Ubuntu与加密的Windows10一起安装。虽然有很多关于双引导Ubuntu和Windows的教程，但其中很多都已经过时了--通常引用的是MBR分区表--而且几乎没有一个教程涉及加密您的Ubuntu分区。</p><p>  In reality, once you figure it out, it’s not that hard. The tricky thing is thatthis isn’t well-documented  anywhere! So I’m hoping to fix that with thistutorial blog post. Honestly, if you know enough about Ubuntu to set up adual-boot with Windows, it’s only a little bit harder to do it with encryption.I prepared this tutorial on a Dell Latitude e7450, and I fine-tuned it when Itested it on my Dell Precision 5510. So it should work with almost nomodification on most Dell systems, and with only minor modifications(particularly around BIOS setup) on most other types of computers.</p><p>实际上，一旦你弄清楚了，就没那么难了。棘手的是，这在任何地方都没有很好的记录！所以我希望用这篇文章来解决这个问题。老实说，如果您对Ubuntu有足够的了解，可以在Windows上设置双引导，那么使用加密只会稍微困难一点。我在Dell Latitude E7450上准备了本教程，在我的Dell Precision 5510上测试时对其进行了微调。因此，它在大多数戴尔系统上几乎都可以正常运行，而在大多数其他类型的计算机上只需稍作修改(特别是在BIOS设置方面)即可。</p><p>  To write this guide, I compiled information from several sources. Here are someof the most useful references I found:</p><p>为了撰写本指南，我从几个来源收集了信息。以下是我找到的一些最有用的参考资料：</p><p> XPS 15 9560 Dual-Boot with Encryption Notes,by  luispabon. I followed these notes prettyclosely, but modified some partition sizes and names based on other guides.</p><p>XPS 15 9560 Dual-Boot with Encryption Notes，作者：Luispabon。我非常仔细地遵循了这些说明，但根据其他指南修改了一些分区大小和名称。</p><p>    Full Disk Encryption HowTo 2019,from the Ubuntu Community Wiki. This is a great resource, but deals withencryption without dual-booting.</p><p>全磁盘加密方法2019，来自Ubuntu社区维基。这是一个很好的资源，但是在不使用双引导的情况下处理加密。</p><p>  Manual Full System Encryption,from the Ubuntu Community Wiki. This is longer, and isn’t focused ondual-booting, but provides great details on the way certain things work.</p><p>手动全系统加密，来自Ubuntu社区维基。本文篇幅较长，并且不关注双引导，但提供了有关某些事情工作方式的详细信息。</p><p> It is worth noting that this method doesn’t encrypt  /boot. While there arevalid reasons for encrypting /boot, the graphical installer does not encrypt itwhen you do a graphical install with LUKS. As such, I’m matching that precedent,and keeping the simplicity of an unencrypted /boot partition. Thus, the guideI’ve compiled below is just about the  simplest way to have a LUKS encryptionwith dual-boot.</p><p>值得注意的是，此方法不加密/引导。虽然加密/引导是有正当理由的，但是当您使用Luk进行图形安装时，图形安装程序不会对其进行加密。因此，我将遵循这一先例，并保持未加密/引导分区的简单性。因此，我在下面编写的指南是使用双引导进行Luks加密的最简单的方法。</p><p>  I began using encrypted storage on all my personal computers 5 or 6 years agoafter noticing that all the companies I’d worked for required it, and had goodreason to. Laptops get lost and stolen all the time. They’re high-value itemsthat are small and easy to carry. And when a thief gets your laptop, there’stons of valuable information on it that they can use or sell. Even if you use apassword to log in, it’s easy for an attacker to gain access to your data ifyour disk isn’t encrypted – for example, by using a live USB stick. And oncethey have that data, they might get access to online accounts, bank statements,emails, and tons of other data. For me, an encrypted hard disk isn’t optionalanymore – its a necessity.</p><p>五六年前，在注意到我工作过的所有公司都需要加密存储后，我开始在我所有的个人电脑上使用加密存储，并有很好的效果。笔记本电脑经常丢失和被盗。它们是价值很高的物品，体积小，携带方便。当小偷拿到你的笔记本电脑时，上面有成堆的有价值的信息，他们可以使用或出售。即使您使用密码登录，如果您的磁盘未加密(例如，使用活动的U盘)，攻击者也很容易获得访问您的数据的权限。一旦他们有了这些数据，他们就可以访问在线账户、银行对账单、电子邮件和大量其他数据。对我来说，加密硬盘不再是可选的--它是一种必需品。</p><p>  So what are we going to do? This tutorial will help you set up a system to dual-boot Ubuntu 20.04 and Windows 10. (I haven’t tested it, but it shouldwork with most other modern versions (~16.04+) of Ubuntu or Windows.) The systemwill use a GPT hard disk with UEFI (your BIOS must support UEFI). The Ubuntupartition will be encrypted with LUKS.  1 The Windows partition can optionallybe encrypted with BitLocker. I’m going to keep the Ubuntu installation as closeto a “default” installation as possible – no fancy tricks like a separate /home partition, but it should be somewhat easy to add that yourself if youreally want to.</p><p>那么我们要做什么呢？本教程将帮助您设置一个双引导Ubuntu20.04和Windows10的系统。(我还没有测试过，但它应该可以与大多数其他现代版本(~16.04+)的Ubuntu或Windows兼容。)。系统将使用带有UEFI的GPT硬盘(您的BIOS必须支持UEFI)。Ubuntu分区将使用Luk进行加密。1 Windows分区可以选择使用BitLocker加密。我将使Ubuntu安装尽可能接近“默认”安装--没有像单独的/home分区那样的花哨把戏，但是如果你真的想要自己添加，应该会比较容易。</p><p> I’m going to start with a blank hard disk, installing both Windows 10 and Ubuntufrom scratch. If you already have Windows installed and you want to keep it, youshould be able to shrink your windows partition and join us in phase 3 (thoughyou might want to skim phases 1 and 2 to understand what we did).</p><p>我将从一个空白硬盘开始，从头开始安装Windows10和Ubuntu。如果您已经安装了Windows并且想要保留它，您应该能够收缩您的Windows分区并加入我们的第三阶段(尽管您可能想要浏览第一阶段和第二阶段以了解我们所做的工作)。</p><p> To give you a broad overview of where we’re headed, here’s what we’re going todo:</p><p>为了让您大致了解我们的发展方向，以下是我们要做的事情：</p><p>  Of course, as with any new OS installation, you should back up any importantdata before proceeding.  The instructions below will erase all the data on yourhard disk. Proceed at your own risk; I’m not responsible for any damage ordata loss.</p><p>当然，与任何新的操作系统安装一样，您应该在继续安装之前备份所有重要数据。下面的说明将擦除硬盘上的所有数据。操作风险自负；我不对任何损坏或数据丢失负责。</p><p>  Since we’re installing both Windows 10 and Ubuntu from scratch, we’ll need a USBstick for each. If you don’t already have a computer running Ubuntu or Windows,making the installation media will be a little harder – but there are tutorialsfor that and I’ll let you figure it out on your own.</p><p>因为我们都是从头开始安装Windows10和Ubuntu，所以每个都需要一个USB棒。如果你还没有一台运行Ubuntu或Windows的电脑，制作安装介质会有点困难--不过有一些教程可以教你，我会让你自己弄明白的。</p><p> Create a Windows Installer USB stick. The easiest way is to use the  Windows10 Media Creation Tool from acomputer that’s already running Windows.</p><p>创建Windows Installer U盘。最简单的方法是在已经运行Windows的计算机上使用Windows10媒体创建工具。</p><p>  Create an Ubuntu 20.04 USB stick. The easiest way is to  download theISO and use the Startup Disk Creator on acomputer that’s already running Ubuntu.</p><p>创建一个Ubuntu 20.04 U盘。最简单的方法是下载ISO，然后在已经运行Ubuntu的计算机上使用Startup Disk Creator。</p><p> Great! We’ve got our USB sticks ready to go! One final thing before we getstarted – we need to make sure our BIOS is set up correctly. In particular, wewant to make sure we’re using UEFI to boot our OS.  2</p><p>太棒了！我们的U盘已经准备好了！在我们开始之前还有最后一件事-我们需要确保我们的BIOS设置正确。特别是，我们需要确保我们使用UEFI来引导我们的操作系统。2个</p><p>  Ensure your computer is running the latest BIOS available. This is importantbecause an out-of-date BIOS can have bugs, and those bugs sometimes affectthings like UEFI, non-Windows operating systems, or other components we’ll betouching.</p><p>确保您的计算机正在运行可用的最新BIOS。这一点很重要，因为过期的BIOS可能会有错误，而这些错误有时会影响UEFI、非Windows操作系统或我们打赌的其他组件。</p><p>  Edit your BIOS settings. The following names are probably specific to DellBIOS, but other manufacturers will have similar settings.  Under  General and  Advanced Boot Options, I disabled Legacy Option ROMs. It’s important that both OSes install in UEFI mode.(You can probably enable this when installation is complete if you care).</p><p>编辑您的BIOS设置。以下名称可能特定于DellBIOS，但其它制造商也会有类似的设置。在“常规”和“高级启动选项”下，我禁用了传统选件ROM。两个操作系统都必须以UEFI模式安装，这一点很重要(如果您愿意，可以在安装完成时启用该模式)。</p><p>  Under  Security,  TPM Security must be enabled if youwant to easily set up BitLocker in Windows.</p><p>在“安全性”下，如果您希望在Windows中轻松设置BitLocker，则必须启用“TPM安全性”。</p><p>  I disabled  Secure Boot. I’m not sure if this is absolutely required, andyou can try leaving it on or re-enabling it when you’re done if you want.</p><p>我禁用了安全引导。我不确定这是否是绝对必需的，如果您愿意，可以尝试将其保留或在完成后重新启用。</p><p> Now that our BIOS is configured for UEFI, we’re going to set up our hard disk.</p><p>既然已经为UEFI配置了BIOS，我们就可以设置硬盘了。</p><p> Most modern computers support this, but if yours doesn&#39;t this tutorial won&#39;twork for you. You should consider:</p><p>大多数现代计算机都支持这一点，但如果您的计算机不支持此功能，本教程将不适用于您。您应该考虑：</p><p> OR Finding another tutorial or figuring out how to do this with an MBR disk.</p><p>或者找到另一个教程，或者找出如何使用MBR磁盘来做到这一点。</p><p> Completely erase your hard disk and set it up for UEFI by doing thefollowing.  3  Figure out what your primary hard disk is called. It will probably beeither  /dev/sda or  /dev/nvme0n1. Importantly, it’s  not  /dev/sda1 or /dev/nvme0n1p1 – those are partitions of the disk. One way to figure out whatyours is called is to run  lsblk and look at the disk size. Throughout the restof this guide, I’m going to refer to  /dev/sda.  If yours is not /dev/sda, replace  /dev/sda with your own (perhaps  /dev/sdb or /dev/nvme0n1) for the rest of this guide.</p><p>通过执行以下操作，完全擦除硬盘并将其设置为UEFI。3找出您的主硬盘的名称。它可能是/dev/sda或/dev/nvme0n1。重要的是，它不是/dev/sda1或/dev/nvme0n1p1-它们是磁盘的分区。确定您的名称的一种方法是运行lsblk并查看磁盘大小。在本指南的其余部分，我将引用/dev/sda。如果您的目录不是/dev/sda，请在本指南的其余部分中将/dev/sda替换为您自己的目录(可能是/dev/sdb或/dev/nvme0n1)。</p><p>  Run the following commands. This will initialize the drive as a GPT driveand create a 550M EFI system partition formatted as FAT32.</p><p>运行以下命令。这会将驱动器初始化为GPT驱动器，并创建格式化为FAT32的550M EFI系统分区。</p><p>  $ sudo su# sgdisk --zap-all /dev/sda# sgdisk --new=1:0:+550M /dev/sda# sgdisk --change-name=1:EFI /dev/sda# sgdisk --typecode=1:ef00 /dev/sda# mkfs.fat -F 32 /dev/sda1</p><p>$sudo su#sgdisk--zap-all/dev/sda#sgdisk--new=1：0：+550M/dev/sda#sgdisk--change-name=1：efi/dev/sda#sgdisk--typecode=1：ef00/dev/sda#mkfs.fa-F 32/dev/sda1。</p><p> OK, phase 1’s complete. We have our installation media ready to go and thecomputer’s BIOS and hard drive is set up correctly. Next, we’ll install Windows.</p><p>好的，第一阶段完成了。我们已准备好安装介质，并且计算机的BIOS和硬盘设置正确。接下来，我们将安装Windows。</p><p>  In this phase, we’re going to install Windows. Note that when we do this, we’regoing to leave some unallocated space to install Linux later. This is a goodapproach because the Windows installer will mess with our partitions a littlebit, and its easier to let it do so before finalizing our Linux partitions.</p><p>在此阶段，我们将安装Windows。请注意，当我们这样做时，我们将留下一些未分配的空间，以便稍后安装Linux。这是一个很好的方法，因为Windows安装程序会稍微修改一下我们的分区，而且在最终完成Linux分区之前让它这样做更容易。</p><p>  Create a new partition. The size of this partition should be the amount ofdisk space you want to use for Windows. In this example, I did 80G since the SSDon my computer is relatively small. If unsure, do about half of your harddisk.</p><p>创建新分区。此分区的大小应该是要用于Windows的磁盘空间量。在本例中，我使用了80G，因为我计算机上的SSD相对较小。如果不确定，可以做大约一半的硬盘。</p><p>  Windows will warn you that it is going to create an extra system partition.This is good.  4</p><p>Windows将警告您它将创建一个额外的系统分区。这很好。4.。</p><p>  Install Windows onto the partition you just made. There’s no need to formatany partitions – the Windows installer will take care of that for you.</p><p>将Windows安装到您刚刚创建的分区上。不需要格式化任何分区-Windows安装程序将为您处理。</p><p>  When the Windows installation is finished, log in and enable BitLocker ondrive  C:. This will automatically create yet another partition on your disk(a Windows recovery partition) - which is why we’re doing it beforepartitioning for Ubuntu.</p><p>Windows安装完成后，登录并在驱动器C：上启用BitLocker。这将自动在您的磁盘上创建另一个分区(Windows恢复分区)-这就是为什么我们在为Ubuntu分区之前这样做的原因。</p><p> At this point, you can start using Windows. But I’d avoid doing too much setupor personalization yet so you don’t have to do it again if something goes wrongbelow. If you want to double check your partitions, this is what you’ll be leftwith after installing Windows and enabling BitLocker:</p><p>此时，您可以开始使用Windows。但我会避免做太多的设置或个性化设置，这样如果下面出了什么问题，你就不必再做了。如果您想要仔细检查分区，在安装Windows并启用BitLocker后，您将得到以下结果：</p><p> ubuntu@ubuntu:~$ sudo sgdisk --print /dev/sdaDisk /dev/sda: 500118192 sectors, 238.5 GiBNumber Start (sector) End (sector) Size Code Name 1 2048 1128447 550.0 MiB EF00 EFI 2 1128448 1161215 16.0 MiB 0C01 Microsoft reserved ... 3 1161216 167825076 79.5 GiB 0700 Basic data partition 4 167825408 168900607 525.0 MiB 2700</p><p>Ubuntu@ubuntu：~$sudo sgdisk--print/dev/sdadisk/dev/sda：500118192个扇区，238.5 GiBNumber开始(扇区)大小代码名称12048 1128447 550.0 MiB EF00 EFI 2 1128448 1161215 16.0 MiB 0C01 Microsoft保留...3 1161216 167825076 79.5 GiB0700基本数据分区4 167825408 168900607 525.0 MiB2700。</p><p>  This is the trickiest phase since this is where we need to manually set up ourencrypted disks for Ubuntu. We’re going to make it work very similar to the waythe Ubuntu installer would set things up if you encrypted your whole disk.</p><p>这是最棘手的阶段，因为这是我们需要手动为Ubuntu设置加密磁盘的阶段。我们将使它的工作方式非常类似于Ubuntu安装程序在加密整个磁盘时的设置方式。</p><p>  Throughout this section, I’m going to be referencing  sgdisk commands. Youcould use  gdisk if you’re comfortable with it and want an interactiveinterface, or you could use GParted if you prefer.  sgdisk commands are justeasier to reference in a tutorial. And again, I’ll be referring to  /dev/sda,but there’s a chance yours could be named something like  /dev/nvme0n1 – justcontinue substituting whatever you’ve been using.</p><p>在本节中，我将引用sgdisk命令。如果您对gdisk感到满意并想要一个交互界面，您可以使用它，或者如果您愿意，也可以使用GParted。Sgdisk命令在教程中更易于参考。同样，我指的是/dev/sda，但是您的名称可能类似于/dev/nvme0n1-只需继续替换您一直使用的内容即可。</p><p> If you want, you can run  sudo sgdisk --print /dev/sda to examine the partitiontable before moving on. You’ll see multiple partitions created by the Windowsinstaller, and should see some empty space where we’re about to install Ubuntu.</p><p>如果需要，可以在继续之前运行sudo sgdisk--print/dev/sda来检查分区表。您将看到由Windowsinstaller创建的多个分区，并且应该会看到我们将要安装Ubuntu的一些空白空间。</p><p> Make a partition for  /boot and a partition for our Linux system &amp; data (tobe encrypted with LUKS).</p><p>为/boot创建一个分区，为我们的Linux系统&amp；data创建一个分区(使用Luk加密)。</p><p>  $ sudo su# sgdisk --new=5:0:+768M /dev/sda# sgdisk --new=6:0:0 /dev/sda# sgdisk --change-name=5:/boot --change-name=6:rootfs /dev/sda# sgdisk --typecode=5:8300 --typecode=6:8300 /dev/sda# mkfs.ext4 -L boot /dev/sda5</p><p>$sudo su#sgdisk--new=5：0：+768m/dev/sda#sgdisk--new=6：0：0/dev/sda#sgdisk--change-name=5：/boot--change-name=6：rootfs/dev/sda#sgdisk--typecode=5：8300--tyecode=6：8300/dev/sda#mkfs.ext4-L boot/dev/sda5。</p><p>  # cryptsetup luksFormat --type=luks1 /dev/sda6WARNING!========This will overwrite data on /dev/sda6 irrevocably. Are you sure? (Type uppercase yes): YESEnter passphrase for /dev/sda6: Verify passphrase: # cryptsetup open /dev/sda6 sda6_cryptEnter passphrase for /dev/sda6: # ls /dev/mapper/control sda6_crypt</p><p>#cryptsetup luksFormat--type=luks1/dev/sda6WARNING！=这将不可撤销地覆盖/dev/sda6上的数据。真的吗？(键入大写yes)：YES输入/dev/sda6的密码：验证密码：#cryptsetup open/dev/sda6 sda6_crypt输入/dev/sda6的密码：#ls/dev/mapper/control sda6_crypt</p><p>  Setup LVM inside our encrypted partition for a data volume and swap space.It’s good that our swap space is inside the encrypted partition because of datathat could be there when the system suspends. Also, for suspend/hibernate towork, you should have at least as much swap space as memory. My laptop has 8Gmemory, so I’ll create 8G swap space.  5</p><p>在我们的加密分区中设置LVM用于数据卷和交换空间。我们的交换空间在加密分区中是件好事，因为当系统挂起时，数据可能会在那里。此外，对于挂起/休眠工作，您至少应该有与内存一样多的交换空间。我的笔记本电脑有8G内存，所以我将创建8G交换空间。5个。</p><p>  # pvcreate /dev/mapper/sda6_cryptPhysical volume &#34;/dev/mapper/sda6_crypt&#34; successfully created.# vgcreate ubuntu-vg /dev/mapper/sda6_cryptVolume group &#34;ubuntu-vg&#34; successfully created# lvcreate -L 8G -n swap_1 ubuntu-vgLogical volume &#34;swap_1&#34; created.# lvcreate -l 100%FREE -n root ubuntu-vgLogical volume &#34;root&#34; created.</p><p>#pvcreate/dev/mapper/sda6_cryptPhysical Volume&#34；/dev/mapper/sda6_crypt&#34；已成功创建。#vgcreate ubuntu-vg/dev/mapper/sda6_cryptVolume group&#34；ubuntu-vg&#34；已成功创建#lvcreate-L 8G-n swap_1 ubuntu-vg逻辑卷&#34；swap_1&#34；已创建。#lvcreate-l 100%free-n root ubuntu-vgLogical volume&#34；已创建。</p><p> Now, all our partitions are prepared. Don’t stop here! Continue to the nextphase without exiting the Ubuntu live environment.</p><p>现在，我们所有的分区都准备好了。别停在这里！在不退出Ubuntu实时环境的情况下继续进入下一阶段。</p><p>  Run the Ubuntu installer from the Desktop, and choose  Something else toconfigure partitions yourself.  The bootloader device should be  /dev/sda (though it appears that thissetting might not actually be used in UEFI mode)</p><p>从桌面运行Ubuntu安装程序，然后选择其他选项来自己配置分区。引导加载器设备应该是/dev/sda(尽管似乎在UEFI模式下可能并未实际使用此设置)。</p><p>  When the installer is finished, hit  Continue Testing. We have to do acouple more things before we restart.</p><p>安装程序完成后，单击继续测试。在我们重新开始之前，我们必须做更多的事情。</p><p>  Set up  etc/crypttab. This is what will allow you to unlock your encrypteddrive by typing in your passphrase when booting.  # mount /dev/mapper/ubuntu--vg-root /target# mount /dev/sda5 /target/boot# for n in proc sys dev etc/resolv.conf; do mount --rbind /$n /target/$n; done # chroot /target # mount -a</p><p>设置etc/crypttab。这将允许您在引导时通过键入密码来解锁加密的驱动器。#mount/dev/mapper/ubuntu--vg-root/target#mount/dev/sda5/target/boot#for n in proc sys dev etc/Resolution v.conf；do mount--rbind/$n/target/$n；do#chroot/target#mount-a。</p><p>  Inside your chroot (that is, in the same terminal), set up  /etc/crypttab.Use your favorite editor to edit this file. I’ll use vi.  sudo vi /etc/crypttabSave the following file contents, replacing the UUID with the actual UUID youfound above.</p><p>在chroot内部(即在同一终端中)，设置/etc/crypttab。使用您喜欢的编辑器编辑该文件。我将使用vi。Sudo vi/etc/crypttab保存以下文件内容，用上面找到的实际UUID替换UUID。</p><p>  # &lt;target name&gt; &lt;source device&gt; &lt;key file&gt; &lt;options&gt;# options used:# luks - specifies that this is a LUKS encrypted device# tries=0 - allows to re-enter password unlimited number of times# discard - allows SSD TRIM command, WARNING: potential security risk (more: &#34;man crypttab&#34;)# loud - display all warningssda6_crypt UUID=abcdefgh-1234-5678-9012-abcdefghijklm none luks,discard</p><p>#&lt；目标名称&gt；&lt；源设备&gt；&lt；密钥文件&gt；&lt；选项&gt；#使用的选项：#luks-指定这是Luks加密设备#TRIES=0-允许重新输入密码不限次数#discard-允许SSD trim命令，警告：潜在安全风险(更多：&#34；man crypttab&#34；)#out-显示所有警告ssda6_crypt UID=abcdefgh-1234-5678-9012-abcdefghijm NONE Luks，disard</p><p> Done! Congratulations, you’ve created a dual-boot system with Ubuntu 20.04 andWindows 10 with all your data encrypted! Now that both installations arefinished, you can reboot your computer.</p><p>搞定了！恭喜您，您已经使用Ubuntu20.04和Windows10创建了一个双引导系统，所有数据都已加密！现在两个安装都已完成，您可以重新启动计算机了。</p><p> By default, your computer will boot into grub, which can boot Ubuntu. AlthoughWindows is listed in grub, booting Windows from grub with BitLocker enabledwon’t work because the system’s TPM will detect a change in the boot sequence.To avoid this problem, you should boot Windows directly from your computer’sBIOS boot menu - usually accessible by pressing  F12 on startup.</p><p>默认情况下，您的计算机将引导至GRUB，GRUB可以引导Ubuntu。尽管GRUB中列出了Windows，但在启用BitLocker的情况下从GRUB启动Windows将不起作用，因为系统的TPM将检测到启动顺序中的更改。若要避免此问题，您应该直接从计算机的BIOS启动菜单启动Windows-通常在启动时按F12键即可访问。</p><p> As a reference, here’s the final state of my hard drive (with 2 logical volumeson the rootfs partition for  / and  swap):</p><p>作为参考，下面是我的硬盘驱动器的最终状态(在rootfs分区上有2个逻辑卷，用于/和交换)：</p><p> $ sudo sgdisk --print /dev/sdaDisk /dev/sda: 500118192 sectors, 238.5 GiB Number Start (sector) End (sector) Size Code Name 1 2048 1128447 550.0 MiB EF00 EFI 2 1128448 1161215 16.0 MiB 0C01 Microsoft reserved ... 3 1161216 167825076 79.5 GiB 0700 Basic data partition 4 167825408 168900607 525.0 MiB 2700 5 168900608 170473471 768.0 MiB 8301 /boot 6 170473472 500118158 157.2 GiB 8301 rootfs</p><p>$sudo sgdisk--Print/dev/sdaDisk/dev/sda：500118192个扇区，238.5 GiB编号开始(扇区)结束(扇区)大小代码名称1 2048 1128447 550.0 MiB EF00 EFI 2 1128448 1161215 16.0 MiB 0C01 Microsoft保留...3 1161216 167825076 79.5 GiB0700基本数据分区4 167825408 168900607 525.0 MiB 2700 5 168900608 170473471 768.0 MiB 8301/Boot 6 170473472 500118158 157.2 GiB8301根文件系统。</p><p> I hope you found this guide useful, and I hope full-disk encryption with Ubuntubecomes more popular and better-supported as a result!</p><p>我希望你会发现这本指南很有用，我希望Ubuntu的全磁盘加密会因此变得更受欢迎和更好的支持！</p><p>  Ubuntu supports other types of encryption. But home folder encryption can cause lots of problems and incompatibilities. And the  cryptsetup manpages recommend LUKS over dm-crypt.  ↩</p><p>Ubuntu支持其他类型的加密。但是主文件夹加密可能会导致很多问题和不兼容。Cryptsetup手册页推荐Luks而不是dm-crypt。-↩。</p><p>  Booting in UEFI is important for this process to work. There’s an  in-depth discussion of boot modes on the Ubuntu community wiki.  ↩</p><p>在UEFI中引导对于此过程的工作非常重要。在Ubuntu社区维基上有一个关于引导模式的深入讨论。--↩。</p><p>    According to the  sgdisk man pages, “If Windows is to boot from a GPT disk, a partition of type Microsoft Reserved (sgdisk internal code 0x0C01) is recommended. This partition should be about 128 MiB in size. It ordinarily follows the EFI System Partition and immediately precedes the Windows data partitions.”  ↩</p><p>根据sgdisk手册页，“如果Windows要从GPT磁盘引导，建议使用Microsoft保留类型的分区(sgdisk内部代码0x0C01)。此分区的大小应约为128 MiB。它通常紧跟在EFI系统分区之后，紧跟在视窗数据分区之前。“”↩</p><p>  There’s a good  discussion of suspend modes on the Ubuntu community wiki, highlighting the need for swap space.  ↩</p><p>在Ubuntu社区维基上有关于暂停模式的很好的讨论，强调了交换空间的必要性。(↩</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.mikekasberg.com/blog/2020/04/08/dual-boot-ubuntu-and-windows-with-encryption.html">https://www.mikekasberg.com/blog/2020/04/08/dual-boot-ubuntu-and-windows-with-encryption.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/ubuntu/">#ubuntu</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/加密/">#加密</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/boot/">#boot</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1031582.html"><img src="http://img2.diglog.com/img/2020/10/thumb_21ededac314d85399d5606f786c2d456.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031582.html">Pro1 X智能手机配有硬件键盘，专为运行LineageOS或Ubuntu而设计</a></div><span class="my_story_list_date">2020-10-28 3:8</span></div><div class="col-sm"><div><a target="_blank" href="/story/1031577.html"><img src="http://img2.diglog.com/img/2020/10/thumb_75e60354f9d7216fe8ff99728318d528.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1031577.html">Ubuntu Groovy Gorilla将Raspberry Pi添加为“一等公民”</a></div><span class="my_story_list_date">2020-10-28 2:52</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030666.html"><img src="http://img2.diglog.com/img/2020/10/thumb_56256739a7bd8da78cfb7c8fddd15c4d.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030666.html">Ubuntu 20.10现已提供下载</a></div><span class="my_story_list_date">2020-10-23 4:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030656.html"><img src="http://img2.diglog.com/img/2020/10/thumb_c05557145d77fc08247aa89365c2ca59.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030656.html">Ubuntu Linux20.10‘Groovy Gorilla’带来了新的Raspberry PI焦点</a></div><span class="my_story_list_date">2020-10-23 4:11</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>