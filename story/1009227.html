<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>名片神经网络</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">名片神经网络</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-01 13:44:37</div><div class="page_narrow text-break page_content"><p>我最近偶然看到安德鲁·肯斯勒(Andrew Kensler)迷人的名片光线追踪器(Raytracer)。他的代码，只有1337字节，生成了一个完整的光线跟踪图像，包括景深、反射、天空渐变和纹理地板。同样，我开始创建一个可以放在名片背面的完整神经网络。下面的代码就是结果，创建了一个带有泄漏-重新激活的3层完全连接的神经网络，并对其进行训练以生成我的名字的小图像。</p><p>#include&lt；bits/stdc++.h&gt；tyfinf Float f；tydeff std：：Vector&lt；f&gt；v；f K=0.01，R=0.01；struct L{int w，h，i；v W，x，z；L(int i，int o){W。Resize(i*o)；for(f&amp；a：w)a=(rand()/(1.1-(1&lt；&lt；31)-0.5)/sqrt(i+o+0.。)；w=i；h=o；}v F(V X){x=X；v a(H)；i=h*w；而(i--)a[i/w]+=W[i]*x[i%w]；z=a；对于(f&amp；i：a)i=K&gt；i？k：i；return a；}v B(V Y){v X(W)；i=w*h；而(i--){f Z=Y[i/w]*(z[i/w]&gt；0？1：k)；X[i%w]+=Z*W[i]；W[i]-=R*Z*x[i%w]；}return X；}}；int main(){Ln[]{L(40，50)，L(50，50)，L(50，1)}；int l，z，k，i=500337；而(i-){z=242%243；k=40；vx(K)，y；而(k--)x[k]=sin((k%2？z/27/3.：z%27/5)+6.14*k/20)；y=x；对于(l=0；l&lt；3；l++)y=n[l]。F(Y)；v Y{2*(y[0]-(&#34；\x1e\0\0\b\x01\0@H\374\377 B\x12@\x18\x12 G\302\\x10@\x12\372\377\221\x10\0\0\200\0\0\\x02&#34；[z/8]&gt；&gt；z%8&amp；1)。B(Y)；putchar(&#34；.，-*Oo##&#34；[(Int)(y[0]*8)%9])；如果(i%27&lt；1)放入(i？i%243？&#34；&#34；：&#34；\033[9A&#34；：&#34；：\r\-Oisin Carroll-\n\gh：Oisincar web：imois.in&#34；)；}}。</p><p>您可以通过单击播放按钮在此处查看输出。(我不愿承认这一点，因为它实际上并没有在浏览器中运行代码：p，但是如果您自己运行代码，您将看到相同或相似的输出)。</p><p>代码只有878个字符，并且(如前所述)创建和训练一个小型神经网络。我确信有可能让它变得更短，但我很高兴能走到这一步！我想把它再短一点就不可能推理了，现在至少可以很容易地添加或删除新的层，并且向前/向后传播相当整齐！(我发誓我没有偏见)。</p><p>定义简单的导入和typedefs。这两个浮点定义用于泄漏REU的泄漏的常数(即\(K\)in\(f(X)=max(Kx，x)\))和学习速率。</p><p>层结构L的开始。构造函数接受输入和输出大小，并以Xavier初始化的近似值初始化权重矩阵。理想情况下，随机变量应该是正态分布的，但是线性似乎也可以很好地工作！</p><p>Layer结构的两个函数。F执行前向传播，获取输入向量并返回输出。有些值被缓存以备以后使用。B执行反向传播，取输出的导数，更新权重矩阵，并返回输入的导数。两家公司都在使用漏水的RELU。</p><p>从Main开始，创建一个3层网络。该网络接受40个值作为输入，具有两个隐含层，每个隐含层有50个节点，最后返回单个值。输入基于当前预测的x，y坐标，输出是该像素应该是空格还是&#39；#&#39；的单个值。在最后，我们打开训练循环，它运行500336次迭代，这是输出大小的倍数；243.</p><p>生成输入向量x。x的每个元素都基于当前预测的像素的x或y坐标的sin。</p><p>根据网络的输出y，计算\(\frac{de}{dy}\)。我们使用均方误差，所以导数正好是\(2(y-\hat{y})\)，其中\(\hat{y}\)是目标值，并编码在字符串中。当用非ASCII字符书写时，这要短得多。</p><p>输出：根据预测值的高低选择不同的字符。如果我们位于行尾(I%27==0)，或者我们已经完成了一个完整的纪元(I%243==0)，则打印特殊字符。最后，当我们完成时，i==0并打印结束文本。</p><p>谢谢你的阅读！我想听听关于如何缩短篇幅的建议，或者任何其他的想法。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://imois.in/posts/card-network/">https://imois.in/posts/card-network/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/神经网络/">#神经网络</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/名片/">#名片</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/card/">#card</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/输出/">#输出</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1007378.html"><img src="http://img.diglog.com/img/2020/6/thumb_69e37c1f65f9fa6c3c3c823c14bccfc0.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1007378.html">教授神经网络物理消除“混沌失明”</a></div><span class="my_story_list_date">2020-6-20 12:14</span></div><div class="col-sm"><div><a target="_blank" href="/story/1003777.html"><img src="http://img.diglog.com/img/2020/5/thumb_73cb20ff9fff6a5b8ff5254500f753ff.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1003777.html">符号数学最终屈服于神经网络</a></div><span class="my_story_list_date">2020-5-26 14:37</span></div><div class="col-sm"><div><a target="_blank" href="/story/1002744.html"><img src="http://img.diglog.com/img/2020/5/thumb_e7f1cf77d53dae841b88deafe93d15a1.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1002744.html">尖峰神经网络：研究项目还是商业产品</a></div><span class="my_story_list_date">2020-5-19 14:22</span></div><div class="col-sm"><div><a target="_blank" href="/story/1000594.html"><img src="http://img.diglog.com/img/2020/5/thumb_52b03383f830f67c707d01d620371549.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1000594.html">利用神经网络在表格中查找答案</a></div><span class="my_story_list_date">2020-5-4 21:25</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>