<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Faasd-轻量级无服务器，适用于您的树莓PI(2020年更新)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Faasd-轻量级无服务器，适用于您的树莓PI(2020年更新)</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-24 18:57:54</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/703ff4b74c33072dcd8ca8a2a94efdfc.jpg"><img src="http://img2.diglog.com/img/2020/10/703ff4b74c33072dcd8ca8a2a94efdfc.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>今天就用FASID踢轮胎，享受不需要Kubernetes的轻量级无服务器体验。相反，它使用的是tainerd和现有的OpenFaaS生态系统。</p><p>上次更新时间：2020年10月18日-升级了faasd&amp；tainerd版本。新增网关等核心组件日志说明。</p><p>您可以在任何地方运行faasd，甚至可以在树莓PI上运行，但是您为什么要这样做呢？Faasd提供了容器和OpenFaaS的许多优点，但没有Kubernetes的复杂性和操作成本。Tainerd是一个自动化容器的低级工具，也是一个CNCF项目。</p><p>无服务器/FAAS的用例是相当知名的，但是您可以在边缘使用faasd，在智能汽车中，作为物联网设备的一部分，在将示例上传到云之前处理数据，用于WebHook接收器/警报、机器人、WebServices、API集成，甚至提供您自己的API。COMPUTE就是COMPUTE，而带有容器的OpenFaaS使消费和提供都变得容易。</p><p>新消息：faasd已成为OpenFaaS GitHub组织的一部分！您甚至可以在几分钟内将faasd部署到您最喜欢的云中。</p><p>本教程使用Raspbian或Raspbian Lite(现在称为RaspiOS)。请勿在同一个Raspberry PI上安装Docker，因为这可能会导致与网络和我们正在使用的Containerd版本发生冲突。</p><p>您应该使用RPI 2、3或4。如果您只有一个Raspberry PI，那么您将能够从OpenFaaS Function Store部署预先构建的映像，但是如果您有第二个Raspberry PI，那么您也可以使用它来构建新函数。</p><p>安装只需要几分钟的时间，如果我们能从上游项目获得容器d的二进制文件，将来应该会更快。</p><p>Faas-cli可用于构建、部署、管理和调用OpenFaaS的功能。OpenFaaS提供REST API、异步调用、身份验证、指标和开箱即用的UI。</p><p>不幸的是，tainerd维护者只提供x86_64(普通PC)的二进制文件，所以我们必须安装GO并从源代码构建tainerd。</p><p>Sudo apt update\&amp；&amp；sudo apt install-qy\runc\bridge-utils\tmux\git。</p><p>Sudo apt update\&amp；&amp；sudo apt install-qy\build-Essential\libbtrfs-dev\libseccomp-dev。</p><p>这在RPi2或RPi3上可能需要一些时间，在RPi4上会更快一些。</p><p>检查tainerd是否以sudo systemctl status tainerd启动，如果不是，则可能需要取消它的掩码，然后再次运行命令。请参阅取消屏蔽服务。</p><p>#one-offsudo modbe br_netfilter&amp；&amp；\sudo sysctl net.bridge ge.bridge-nf-call-iptables=1#使其永久回显&#34；br_netfilter&#34；|sudo tee-a/etc/module-load.d/modes.confecho&#34；net.bridge.bridge-nf-call-iptables=1&#34；|sudo tee-a/etc/sysctl.conf。</p><p>可选步骤-如果您的系统上正在运行Docker，则将其禁用并在此时重新启动。</p><p>Sudo systemctl禁用dockersudo systemctl禁用docker.sock#或docker.socket-您可能还需要此步骤。</p><p>Docker的IP地址范围与NetNS选择的IP地址范围冲突，此问题将在迁移到CNI时解决。</p><p>Faasd是一个在您的系统上运行的Go二进制文件，可以打包所有的OpenFaaS，它是一个类似于docker-compose的工具。</p><p>Faasd的命令之一faasd Provider运行OpenFaaS提供程序，该提供程序实现函数的OpenFaaS CRUD；API。</p><p>#停止systemd服务，如果您有sudo systemctl stop faasdsudo systemctl stop faasd-Provider#如果您有sudo rm-rf/usr/local/bin/faasd，请删除旧的二进制文件。</p><p>Faasd install命令创建两个systemd单元文件，可用于启动/停止faasd和faasd-Provider。</p><p>您将在/var/lib/faasd/secrets中找到网关的登录详细信息，用户是admin，密码在/var/lib/faasd/secrets/basic-auth-password中。</p><p>您可以从使用faasd部署的任何核心服务访问日志，如下所示：</p><p>Sudo Jouralctl-t默认值：Gateway--行40sudo Jouralctl-t默认值：NAT--行40sudo Jouralctl-t默认值：Queue-Worker--行40sudo Jouralctl-t默认值：普罗米修斯--行40。</p><p>Faasd部署OpenFaaS及其核心逻辑faasd-Provider，后者使用tainerd而不是Kubernetes来启动、停止和管理功能。</p><p>Faasd进程会将HTTP端口8080上的任何传入请求代理到OpenFaaS网关容器，您还可以在faasd目录下的hosts文件中找到容器的IP。</p><p>您还可以通过编辑docker-compose.yaml来访问内置的Prometheus容器，以向127.0.0.1或您的所有网络适配器公开其端口。</p><p>#如果连接远程导出IP=192.168.0.101导出OPENFAAS_URL=http://$IP:8080echo$PASSWORD|FAAS-CLI登录#或在设备上：SUDO cat/var/lib/faasd/secrets/basic-auth-password|faas-cli登录--password-stdin。</p><p>查看用于armhf平台的函数存储区中提供的内容，然后部署以下内容：</p><p>Faas-cli存储列表--platform armhf#部署figletfaas-cli store Deploy--platform armhf figlet#查找函数的URL faas-cli store check figlet#创建一些ASCIIecho&#34；faasd&34；|faas-cli调用figlet。</p><p>尝试一个可以生成身份的函数，就像你在GitHub.com上看到的默认头像徽标一样</p><p>您将需要第二个树莓圆周率这一步。您也可以使用我预构建的函数之一，比如ascii-2020，但是您应该只运行Faas-cli部署步骤。</p><p>您可以将OpenFaaS网关设置为指向运行faasd的RPI。</p><p>您的新函数将在第一个Raspberry PI上拉下并开始执行。查找用于调用函数的IP地址/URL，同步和异步调用都在工作：</p><p>现在，试着在hello-world/handler.go中编辑函数的源代码，让它打印一条不同的消息。我们选择的模板使用gofmt运行验证，因此如果您已经在RPI上进行了编辑，您可能需要在进行构建之前格式化文本。</p><p>您的工作流只是Faas-cli up，或者是Faas-cli构建、Faas-cli推送和Faas-cli部署的单独步骤。</p><p>支持私有注册表，如Docker Hub、AWS ECR、GitLab或您自己的私有托管注册表。</p><p>注意：如果您想设置您自己的注册表，请使用k3sup遵循我的5分钟教程。</p><p>要使用私有容器映像注册表，只需在您的PC或笔记本电脑上运行docker login，然后将$HOME/.docker/config.json文件复制到运行faasd的位置。确保文件中的值是用Base64编码的，而不是使用Docker for Mac/Windows凭据助手，这样您就可以使用了。</p><p>入口可以帮助我们获得公共IP并进入我们的功能，这是通过到云IaaS或VPS提供商(如DigitalOcean)上的主机的隧道来完成的。</p><p>您需要云的访问令牌才能访问受支持的提供商之一，请参阅上的列表：inletsctl create--help。</p><p>我选择了DigitalOcean并运行create命令来配置退出服务器，这是一个具有公共IP的面向公众的主机。</p><p>注意：我们创建的主机将花费大约5美元/月，因为只要您保持运行，您就可以随时运行inletsctl delete，或者从您的仪表板中删除VM。您可以向一些提供免费级别或积分的云提供商免费运行退出节点。</p><p>几秒钟后，主机将开始运行Inlets服务器，现在您可以继续在RPI上运行Inlets客户端。我喜欢使用tmux或Screen运行命令，这样我就可以注销，而它们仍在运行。您还可以使用systemd单元文件或@reboot等Cron条目使inlets客户机成为永久性的。</p><p>这是inletsctl create打印出的命令，只需编辑上游命令，使其指向127.0.0.1：8080上的faasd，然后按Enter。</p><p>您的功能现在可以通过公共互联网访问，您可以随意与您的朋友共享URL。</p><p>基本身份验证是指OpenFaaS的UI和API是受保护的，但默认情况下可以访问功能。</p><p>您甚至可以通过SSH登录到您的出口节点并安装Nginx或Caddy，从而将TLS添加到您的出口节点。</p><p>我为Caddy编写了一个教程，名为HTTPS，适用于带有入口和Caddy的本地端点，以下是从我的域faasd.myfaas.Club的出口节点提供TLS证书时的实际效果。</p><p>现在我更喜欢使用inlets-pro，这意味着我可以直接在RPI上运行Caddy，并在设备本身上获得一个LetsEncrypt证书。</p><p>Inlets-PRO还配备了通过线路进行链路级加密的功能，并且能够代理来自NAT后面的任何L4 TCP流量。</p><p>购买Inlets Pro或注册一个免费的14天试用来踢轮胎：Inlets Pro。</p><p>现在尝试重新启动您的RPI，您应该会看到网关随后再次打开。您部署的函数仍将存在，但已缩放为零，因此第一次调用将再次预热它们，此过程可能需要大约0.38秒。在PC上，这甚至更快。</p><p>如果需要手动删除函数，可以这样做：</p><p>导出fn=&#34；figlet&#34；sudo ctr--命名空间openfaas-fn任务删除-f$FNsudo ctr--命名空间openfaas-fn容器删除$FNsudo ctr--命名空间openfaas-fn快照删除$fn-SNAPSHOT</p><p>Fasd为您的Raspberry PI、云基础架构和裸机带来了轻量级体验，所有这些都不需要Kubernetes。该解决方案仍在积极开发中，因此您可能还不想将其投入生产，但是我们进展很快，并且已经拥有异步调用、身份验证和函数存储支持。</p><p>如果您觉得安装过程有点繁琐，那么请不要担心：我们还有一个安装脚本，欢迎您尝试。</p><p>通过社区内部人员订阅，及时了解有关faasd和我的其他工作的最新信息。</p><p>这款RPi3有1 GB内存和4个内核。目前，它正在运行@openfaas@Nats_io@PrometheusIO@inletsdev@tainerd，但没有看到Kubernetes。这意味着我们还有空间用于https://t.co/WW5TZVdAeU🤓pic.twitter.com/JYeV1nSToK的一些函数。</p><p>-亚历克斯·埃利斯(@alexellisuk)2020年1月8日。</p><p>您可能想知道用faasd在新的RPI上运行什么。任何OpenFaaS代码都应该能够运行，无论是API、函数、微服务还是简单的网页。下面是我脑海中浮现的几个想法：</p><p>家庭服务器和物联网设备的自动化-使用功能向您的智能家居发送呼叫？</p><p>您可以将faasd用于客户端项目和工作。我已经为您提供了一种使用单个复制/粘贴和您的云提供商的仪表板自动执行整个过程的方法。</p><p>Faasd不需要复杂的服务器管理或集群配置，您甚至可以使用GitLab或GitHub操作集成CI/CD管道，在几分钟内，您就可以通过将代码推送到Git存储库来更新TLS端点。</p><p>在GitHub上为openfaas/faasd投稿-您需要对Golang和Containers有基本的了解</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.alexellis.io/faasd-for-lightweight-serverless/">https://blog.alexellis.io/faasd-for-lightweight-serverless/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/2020/">#2020</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/服务器/">#服务器</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/faasd/">#faasd</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1030873.html"><img src="http://img2.diglog.com/img/2020/10/thumb_3c039aa2326c56d4766bba35777c9890.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030873.html">
以下是几十家初创公司在2020年第三季度的增长速度</a></div><span class="my_story_list_date">2020-10-24 7:47</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030744.html"><img src="http://img2.diglog.com/img/2020/10/thumb_a28e8f70d1439f2b98a53bd29ee5fc83.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030744.html">2020年PLONE大会-2020年12月5日至13日-早鸟登记开放</a></div><span class="my_story_list_date">2020-10-23 14:53</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030706.html"><img src="http://img2.diglog.com/img/2020/10/thumb_d7e28534c904b04352a2153d484bcbe6.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030706.html">Amazon Prime Day 2020-由AWS提供支持</a></div><span class="my_story_list_date">2020-10-23 11:59</span></div><div class="col-sm"><div><a target="_blank" href="/story/1030651.html"><img src="http://img2.diglog.com/img/2020/10/thumb_686ffeb23c432d1aec644a54eddfa580.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1030651.html">IPad 12.9“2020年回顾(个人电脑用户视角)</a></div><span class="my_story_list_date">2020-10-23 3:46</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>