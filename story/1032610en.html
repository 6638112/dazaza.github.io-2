<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>在命令行上查看漂亮的CSV</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">在命令行上查看漂亮的CSV</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-01 20:26:55</div><div class="page_narrow text-break page_content"><p>CSV (comma separated values) files are to data formats what FAT32 is tofile systems: everybody loves to hate them, but you can&#39;t find a morewidely supported alternative.</p><p>CSV(逗号分隔值)文件之于数据格式就像FAT32之于文件系统：每个人都讨厌它们，但是你找不到更广泛支持的替代方案。</p><p> For example, viewing CSV files in a command line environment is typically prettyannoying. You can&#39;t make much from this, right?</p><p>例如，在命令行环境中查看CSV文件通常非常烦人。你不可能从中赚到很多钱，对吗？</p><p>  However, if you weld a couple of common command line tools together,you can create a handy viewer that make the data look like this:</p><p>但是，如果您将两个常用命令行工具焊接在一起，则可以创建一个方便的查看器，使数据看起来如下所示：</p><p>   There is this well hidden command line tool called &#34; column&#34; that allows youto align the data nicely in properly sized columns.Combine this with a pager like  less and we have a nice prototype already</p><p>有一个隐藏得很好的命令行工具，叫做&#34；column&34；，它允许您在适当大小的列中很好地对齐数据。将它与Less之类的分页程序结合使用，我们已经有了一个很好的原型。</p><p>  One problem with this is that  column ignores/merges empty cells in your data,which ruins the whole point of aligning all together.On Debian/Ubuntu,  column provides an option  -n to disable this behavior, butfor other platforms (like with the BSD flavor of  column on the Mac), weneed some additional trickery.A simple solution is just adding a space before each comma:</p><p>这样做的一个问题是，Column忽略/合并数据中的空单元格，这破坏了将所有数据对齐的全部意义。在Debian/Ubuntu上，Column提供了一个选项-n来禁用此行为，但对于其他平台(如Mac上的BSD风格的Column)，我们需要一些额外的技巧。一个简单的解决方案是在每个逗号之前添加一个空格：</p><p>  Or, if you want to avoid wasting too much horizontal space, you can adda space only to the empty cells as follows:</p><p>或者，如果您希望避免浪费太多的水平空间，可以只向空单元格添加空间，如下所示：</p><p>   Time to create some shortcuts and put this in, for example, your  .bashrc, .bash_aliases or whatever other customization options your favorite shell provides.I&#39;ll just cover bash here, because that&#39;s the shell I currently use most.</p><p>现在可以创建一些快捷方式并将其放入您的.bashrc、.bash_aliases或您最喜欢的shell提供的任何其他自定义选项中。这里我只介绍bash，因为那是我目前最常用的shell。</p><p> In the end we&#39;ll have a tool  pretty_csv which can be used in different ways:</p><p>最后，我们将拥有一个工具Pretty_csv，它可以以不同的方式使用：</p><p> sort data.csv | pretty_csv (to illustrate that the input doesn&#39;t necessary have to be a file, you can also pipe the output of another process to it)</p><p>对data.csv|Pretty_CSV进行排序(为了说明输入不一定必须是文件，您还可以通过管道将另一个进程的输出传递给它)。</p><p>  On Debian/Ubuntu systems I just put this in my  .bashrc(note some additional  less options, roughly based on how  git log works):</p><p>在Debian/Ubuntu系统上，我只是将其放在我的.bashrc中(注意一些额外的较少选项，大致基于git日志的工作方式)：</p><p>    function pretty_csv  { perl -pe  &#39;s/((?&lt;=,)|(?&lt;=^)),/ ,/g;&#39;  &#34; $@ &#34;  | column -t -s,  | less -F -S -X -K }</p><p>函数Pretty_CSV{perl-pe&#39；s/((？&lt；=，)|(？&lt；=^))，/，/g；&#39；&#34；$@&#34；|column-t-s，|less-F-S-X-K}。</p><p>  On my Mac I use  iTerm2 and I noticed that its shell integrationconflicts in some weird ways with  less in the above bash function ifI apply it through a pipe ( cat data.csv | pretty_csv).</p><p>在我的Mac上，我使用iTerm2，我注意到它的shell集成以某种奇怪的方式与上面的bash函数冲突，如果我通过管道(cat data.csv|Pretty_CSV)应用它的话。</p><p> As workaround I use a bash script instead of a bash function.For example, create a file  ~/.bash.d/pretty_csv.sh, containing:</p><p>作为解决办法，我使用bash脚本而不是bash函数。例如，创建文件~/.bash.d/Pretty_csv.sh，其中包含：</p><p> #!/bin/bashperl -pe  &#39;s/((?&lt;=,)|(?&lt;=^)),/ ,/g;&#39;  &#34; $@ &#34;  | column -t -s,  |  exec less -F -S -X -K</p><p>#！/bin/bashperl-pe&#39；s/((？&lt；=，)|(？&lt；=^))，/，/g；&#39；&#34；$@&#34；|column-t-s，|exec less-F-S-X-K。</p><p> make it executable ( chmod u+x ~/.bash.d/pretty_csv.sh)and create a bash alias for it (e.g in  .bashrc or  .bash_aliases)</p><p>将其设置为可执行文件(chmod u+x~/.bash.d/Pretty_csv.sh)并为其创建bash别名(例如，在.bashrc或.bash_aliases中)。</p><p>   I regularly also have to work with TSV files, where the columns are separatedby the  tab character. The tricky part here is passing this special charactercorrectly to the parts of the pipeline.</p><p>我还经常使用TSV文件，其中的列由制表符分隔。这里的棘手之处在于将这个特殊字符正确地传递给管道的各个部分。</p><p>  function pretty_tsv  { column -t -s  $&#39;\t&#39; -n  &#34; $@ &#34;  | less -F -S -X -K }</p><p>函数Pretty_TSV{column-t-s$&#39；\t&#39；-n&#34；$@&#34；|less-F-S-X-K}。</p><p>  function pretty_tsv  { perl -pe  &#39;s/((?&lt;=\t)|(?&lt;=^))\t/ \t/g;&#39;  &#34; $@ &#34;  | column -t -s  $&#39;\t&#39;  | less -F -S -X -K }</p><p>函数Pretty_TSV{perl-pe&#39；s/((？&lt；=\t)|(？&lt；=^))\t/\t/g；&#39；&#34；$@&#34；|column-t-s$&#39；\t&#39；|less-F-S-X-K}。</p><p>  #!/bin/bashperl -pe  &#39;s/((?&lt;=\t)|(?&lt;=^))\t/ \t/g;&#39;  &#34; $@ &#34;  | column -t -s  $&#39;\t&#39;  |  exec less -F -S -X -K</p><p>#！/bin/bashperl-pe&#39；s/((？&lt；=\t)|(？&lt；=^))\t/\t/g；&#39；&#34；$@&#34；|column-t-s$&39；\t&39；|exec less-F-S-X-K。</p><p>  Now you can enjoy the warm cosy feeling of browsing pretty, shiny CSV and TSVfiles in your terminal.</p><p>现在，您可以在您的终端中享受浏览漂亮、闪亮的CSV和TSV文件的温暖舒适的感觉。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.stefaanlippens.net/pretty-csv.html">https://www.stefaanlippens.net/pretty-csv.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/命令行/">#命令行</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/csv/">#csv</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>