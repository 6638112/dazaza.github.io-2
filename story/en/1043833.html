<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Firefox 86中默认启用了AVIF支持 AVIF support enabled by default in Firefox 86</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">AVIF support enabled by default in Firefox 86<br/>Firefox 86中默认启用了AVIF支持 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-10 13:11:18</div><div class="page_narrow text-break page_content"><p>What it says on the tin, basically. This amounts to setting  image.avif.enabled to true and letting it ride the trains to release.</p><p>它在锡罐上说的基本上是什么。这相当于将image.avif.enabled设置为true，并使其乘坐火车释放。</p><p>   [task 2020-12-17T19:53:15.275Z] 19:53:15 INFO - TEST-START | netwerk/test/mochitests/test_accept_header.html[task 2020-12-17T19:53:15.452Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?iframe[task 2020-12-17T19:53:15.529Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19:53:15.550Z] 19:53:15 INFO - TEST-PASS | netwerk/test/mochitests/test_accept_header.html | Expected: iframe [task 2020-12-17T19:53:15.552Z] 19:53:15 INFO - TEST-INFO | started process screentopng[task 2020-12-17T19:53:15.568Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?image[task 2020-12-17T19:53:15.596Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19:53:15.624Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?style[task 2020-12-17T19:53:15.640Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19:53:15.680Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?worker[task 2020-12-17T19:53:15.696Z] 19:53:15 INFO - test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - TEST-INFO | screentopng: exit 0[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - TEST-UNEXPECTED-FAIL | netwerk/test/mochitests/test_accept_header.html | Accept header: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8 - got &#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8&#34;, expected &#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8&#34;[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - SimpleTest.is@SimpleTest/SimpleTest.js:500:14[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - test_last_request_and_continue/&lt;@netwerk/test/mochitests/test_accept_header.html:20:7[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - TEST-PASS | netwerk/test/mochitests/test_accept_header.html | Expected: image [task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - Not taking screenshot here: see the one that was previously logged[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - TEST-UNEXPECTED-FAIL | netwerk/test/mochitests/test_accept_header.html | Accept header: image/webp,*/* - got &#34;image/avif,image/webp,*/*&#34;, expected &#34;image/webp,*/*&#34;[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - SimpleTest.is@SimpleTest/SimpleTest.js:500:14[task 2020-12-17T19:53:15.813Z] 19:53:15 INFO - test_last_request_and_continue/&lt;@netwerk/test/mochitests/test_accept_header.html:20:7[task 2020-12-17T19:53:15.814Z] 19:53:15 INFO - TEST-PASS | netwerk/test/mochitests/test_accept_header.html | Expected: style [task 2020-12-17T19:53:15.814Z] 19:53:15 INFO - TEST-PASS | netwerk/test/mochitests/test_accept_header.html | Accept header: text/css,*/*;q=0.1 [task 2020-12-17T19:53:15.815Z] 19:53:15 INFO - TEST-PASS | netwerk/test/mochitests/test_accept_header.html | Expected: worker [task 2020-12-17T19:53:15.815Z] 19:53:15 INFO - TEST-PASS | netwerk/test/mochitests/test_accept_header.html | Accept header: */* [task 2020-12-17T19:53:15.815Z] 19:53:15 INFO - GECKO(3092) | MEMORY STAT | vsize 2564MB | residentFast 155MB | heapAllocated 10MB[task 2020-12-17T19:53:15.816Z] 19:53:15 INFO - TEST-OK | netwerk/test/mochitests/test_accept_header.html | took 462ms</p><p>   [任务2020-12-17T19：53：15.275Z] 19:53:15信息-测试开始| netwerk / test / mochitests / test_accept_header.html [任务2020-12-17T19：53：15.452Z] 19:53:15信息-test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?iframe [任务2020-12- 17T19：53：15.529Z] 19:53:15 INFO-test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19：53：15.550Z] 19:53:15 INFO-TEST -通行证| netwerk / test / mochitests / test_accept_header.html |预期：iframe [任务2020-12-17T19：53：15.552Z] 19:53:15信息-测试信息|已启动进程screentopng [任务2020-12-17T19：53：15.568Z] 19:53:15信息-test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?image [任务2020-12-17T19：53：15.596Z ] 19:53:15 INFO-test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19：53：15.624Z] 19:53:15 INFO-test_accept_header / tests / netwerk / test /mochitests/test_accept_header.sjs?style[task 2020-12-17T19：53：15.640Z] 19:53:15 INFO-test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?get[task 2020-12-17T19 ：53：15.680Z] 19:53:15信息-test_accept_header /tests/netwerk/test/mochitests/test_accept_header.sjs?worker[task 2020-12-17T19：53：15.696Z] 19:53:15 INFO-test_accept_header / tests / netwerk / test / mochitests / test_accept_header.sjs？get [task 2020-12-17T19：53：15.813Z] 19:53:15 INFO-TEST-INFO | screentopng：退出0 [任务2020-12-17T19：53：15.813Z] 19:53:15信息-TEST-UNEXPECTED-FAIL | netwerk / test / mochitests / test_accept_header.html |接受标头：text / html，application / xhtml + xml，application / xml; q = 0.9，image / webp，* / *; q = 0.8-得到＆＃34; text / html，application / xhtml + xml，application / xml; q = 0.9，image / avif，image / webp，* / *; q = 0.8＆＃34 ;,预期＆＃34; text / html，application / xhtml + xml，application / xml; q = 0.9，image / webp，* / *; q = 0.8＆＃34; [任务2020-12-17T19：53：15.813Z] 19:53:15信息-SimpleTest.is@SimpleTest/SimpleTest.js：500：14 [任务2020 -12-17T19：53：15.813Z] 19:53:15信息-test_last_request_and_continue /＆lt; @ netwerk / test / mochitests / test_accept_header.html：20：7 [任务2020-12-17T19：53：15.813Z] 19： 53:15信息-通过测试| netwerk / test / mochitests / test_accept_header.html |预期：图像[任务2020-12-17T19：53：15.813Z] 19:53:15信息-此处未截屏：请参阅先前记录的屏幕[任务2020-12-17T19：53：15.813Z] 19： 53:15信息-意外测试失败| netwerk / test / mochitests / test_accept_header.html |接受标头：image / webp，* / *-得到了＆＃34; image / avif，image / webp，* / *＆＃34 ;,预期的＆＃34; image / webp，* / *＆＃34; [任务2020-12-17T19：53：15.813Z] 19:53:15 INFO-SimpleTest.is@SimpleTest/SimpleTest.js：500：14 [任务2020-12-17T19：53：15.813Z] 19:53:15 INFO -test_last_request_and_continue /＆lt; @ netwerk / test / mochitests / test_accept_header.html：20：7 [任务2020-12-17T19：53：15.814Z] 19:53:15信息-测试通过| netwerk / test / mochitests / test_accept_header.html |预期：样式[任务2020-12-17T19：53：15.814Z] 19:53:15信息-测试通过| netwerk / test / mochitests / test_accept_header.html |接受标头：text / css，* / *; q = 0.1 [task 2020-12-17T19：53：15.815Z] 19:53:15 INFO-TEST-PASS | netwerk / test / mochitests / test_accept_header.html |预期：工作人员[任务2020-12-17T19：53：15.815Z] 19:53:15信息-测试通过| netwerk / test / mochitests / test_accept_header.html |接受标头：* / * [task 2020-12-17T19：53：15.815Z] 19:53:15 INFO-GECKO（3092）|内存统计| vsize 2564MB |居民快速155MB | heapAllocated 10MB [task 2020-12-17T19：53：15.816Z] 19:53:15 INFO-TEST-OK | netwerk / test / mochitests / test_accept_header.html |用了462ms</p><p>   I&#39;m currently looking at this. The fix to  test_accept_header.html is straightforward, but it led me to run  a full mochitest suite and that showed some less-obvious errors. In particular  image/test/mochitest/test_bug496292.html is  failing, but it took me awhile (I got sidetracked by  bug 1682709) to track down  why.</p><p>   我目前正在研究这个。对test_accept_header.html的修复很简单，但是它导致我运行了完整的mochitest套件，并且显示了一些不太明显的错误。特别是image / test / mochitest / test_bug496292.html失败了，但是花了我一段时间（我被bug 1682709所困扰）来追查原因。</p><p> To hopefully avoid another backout, I&#39;ve just replaced all the instances of  &#34;image/webp,*/*&#34; (our previous Accept header) in our test code with  &#34;image/avif,image/webp,*/*&#34;. I&#39;ll run another try and hopefully that one will be green.</p><p> 为了希望避免再次退出，我刚刚替换了所有image_webp，* / *＆＃34;实例。 （我们以前的Accept标头）在我们的测试代码中为＆＃34; image / avif，image / webp，* / *＆＃34;。我将进行另一次尝试，希望它会变成绿色。</p><p> Sadly there still seem to be some test failures that, while it&#39;s not immediately clear why they&#39;d be affected by this, are locally reproducible  only with this change. For example:  devtools/client/netmonitor/test/browser_net_copy_headers.js.</p><p> 令人遗憾的是，似乎仍然存在一些测试失败，尽管目前尚不清楚为什么它们会受此影响，但只有通过此更改才能在本地重现。例如：devtools / client / netmonitor / test / browser_net_copy_headers.js。</p><p> So, I&#39;m looking into those and won&#39;t try to re-land until I&#39;ve got them sorted.</p><p> 因此，我正在调查这些情况，直到我将它们归类后再尝试降落。</p><p> Sadly there still seem to be some test failures that, while it&#39;s not immediately clear why they&#39;d be affected by this, are locally reproducible  only with this change. For example:  devtools/client/netmonitor/test/browser_net_copy_headers.js.</p><p> 令人遗憾的是，似乎仍然存在一些测试失败，尽管目前尚不清楚为什么它们会受此影响，但只有通过此更改才能在本地重现。例如：devtools / client / netmonitor / test / browser_net_copy_headers.js。 </p><p> That test will poll the clipboard until it finds an expected strings. When it can&#39;t find the expected string it will time out.  https://searchfox.org/mozilla-central/source/devtools/client/netmonitor/test/browser_net_copy_headers.js#45</p><p>该测试将轮询剪贴板，直到找到期望的字符串为止。如果找不到所需的字符串，它将超时。 https://searchfox.org/mozilla-central/source/devtools/client/netmonitor/test/browser_net_copy_headers.js#45</p><p> So, I&#39;m looking into those and won&#39;t try to re-land until I&#39;ve got them sorted.</p><p> 因此，我正在调查这些情况，直到我将它们归类后再尝试降落。</p><p> Thanks Tom, I found that as well (unfortunately before I saw your comment). Not sure how I missed it the first time around, but I&#39;m pretty sure I&#39;ve addressed all the locations in test code where  image/webp appears and if this  next try run looks good, I&#39;ll try to land this again.</p><p> 谢谢汤姆，我也发现了这一点（很遗憾，在我看到您的评论之前）。不确定我是如何第一次错过它，但是我很确定我已经解决了测试代码中出现image / webp的所有位置，如果下次尝试运行看起来不错，我会尝试再次降落。</p><p> I don&#39;t think any of the remaining failures are due to the changes for this issue. However, I don&#39;t want to land a change directly before being unavailable during the holiday time, so wait on this until I&#39;m back.</p><p> 我认为剩下的任何故障都不是由于此问题的更改引起的。但是，我不想在假期期间无法使用之前直接进行更改，因此请等到我回来。</p><p> Hi! Excited to see this, but maybe  bug 1654461 should be fixed first? Both libavif and  squoosh.app produce full range AVIF images by default, and it&#39;s better to use full range in image encoding to prevent banding artifact.</p><p> 嗨！很高兴看到这个，但是也许应该首先修复错误1654461？默认情况下，libavif和squoosh.app都生成全范围的AVIF图像，最好在图像编码中使用全范围的图像以防止出现带状伪像。</p><p>       You need to  log in before you can comment on or make changes to this bug.</p><p>       您需要先登录，然后才能对此错误进行评论或进行更改。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://bugzilla.mozilla.org/show_bug.cgi?id=1682995">https://bugzilla.mozilla.org/show_bug.cgi?id=1682995</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/默认/">#默认</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/support/">#support</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/test/">#test</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>