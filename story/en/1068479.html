<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>默认情况下，Intel默认禁用TSX，并使用新的微码更多的CPU Intel to disable TSX by default on more CPUs with new microcode</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Intel to disable TSX by default on more CPUs with new microcode<br/>默认情况下，Intel默认禁用TSX，并使用新的微码更多的CPU </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-06-29 22:50:56</div><div class="page_narrow text-break page_content"><p>Intel is going to be disabling Transactional Synchronization Extensions (TSX) by default for various Skylake through Coffee Lake processors with forthcoming microcode updates. Yes, this does mean performance implications for workloads benefiting from TSX. This change has seemingly not been talked about much at all publicly and I just happened to become aware of it when looking through new kernel patches.   Transactional Synchronization Extensions (TSX) have been around since Haswell for hardware transactional memory support and going off Intel&#39;s own past numbers can be around 40% faster in specific workloads or as much 4~5 times faster in database transaction benchmarks. TSX issues have been found in the past such as a possible side channel timing attack that could lead to KASLR being defeated and CVE-2019-11135 (TSX Async Abort) for an MDS-style flaw. Now in 2021 Intel is disabling TSX by default across multiple families of Intel CPUs from Skylake through Coffee Lake.   No widespread announcement on the change seems to have been made as this is the first time I have heard of this deprecation/disabling and not mentioned on other news sites, but noticed it with the fresh round of patches going into the new  Linux 5.14 cycle. The Linux kernel is preparing for this microcode change as seen in the flow of new patches this morning for the 5.14 merge window.    A memory ordering issue is what is reportedly leading Intel to now deprecate TSX on various processors. There is  this Intel whitepaper updated this month that outlines the problem at length. As noted in the revision history, the memory ordering issue has been known to Intel since at least before October 2018 but only now in June 2021 are they pushing out microcode updates to disable TSX by default.   When going through the new Linux patches, there was reference to this  guidance from 12 June that outlines the intended change. That update was published a few days after  Intel&#39;s latest CPU microcode update earlier this month that did not note any TSX changes but noted other security updates. (Trying this latest microcode update on one of the affected CPUs still shows TSX as active with TAA mitigations still active.) With forthcoming microcode updates will effectively deprecate TSX for all Skylake Xeon CPUs prior to Stepping 5 (including Xeon D and 1st Gen Xeon Scalable), all 6th Gen Xeon E3-1500m v5 / E3-1200 v5 Skylake processors, all 7th/8th Gen Core and Pentium Kaby/Coffee/Whiskey CPUs prior to 0x8 stepping, and all 8th/9th Gen Core/Pentium Coffee Lake CPUs prior to 0xC stepping will be affected. That ultimately spans from various Skylake steppings through Coffee Lake; it was with 10th Gen Comet Lake and Ice Lake where TSX/TSX-NI was subsequently removed.    In addition to disabling TSX by default and force-aborting all RTM transactions by default, a new CPUID bit is being enumerated with the new microcode to indicate that the force aborting of RTM transactions. It&#39;s due to that new CPUID bit that the Linux kernel is seeing patches. Previously Linux and other operating systems applied a workaround for the TSX memory ordering issue but now when this feature is disabled, the kernel can drop said workaround. These patches are coming with the Linux 5.14 cycle and will likely be back-ported to stable too.    Intel disabling TSX via microcode updates isn&#39;t entirely new as back when the feature first appeared with Haswell they ended up selectively disabling the feature due to early bugs in that original implementation but now this effectively killing it off spans multiple product generations and years after software has been adapted to allow making use of Transactional Synchronization Extensions. TSX performance on Linux has already been degraded for newer processors as well stemming from  the TAA mitigations enacted back in late 2019.    Intel&#39;s guidance this month around the forthcoming microcode change does acknowledge &#34; Workloads that were benefited from Intel TSX might experience a change in performance.&#34; Thus time to fire up some new benchmarks.</p><p>默认情况下，英特尔将禁用事务性同步扩展（TSX）通过咖啡湖处理器，即即将结交的微码更新。是的，这表明对受益于TSX的工作负载的性能影响。这一变化似乎没有公开谈论大量谈论，我刚刚在通过新的内核补丁时刚刚意识到它。   自动同步扩展（TSX）自哈斯韦尔为硬件事务内存支持并进行Intel＆＃39;在特定工作负载中的速度速度速度约为40％，或者在数据库事务基准中更快的4〜5倍。过去发现了TSX问题，如可能的侧通道定时攻击，可能导致KASLR被击败和CVE-2019-11135（TSX Async中止）进行MDS式漏洞。现在，在2021年，英特尔横跨咖啡湖的Skylake的多个Intel CPU的默认情况下禁用TSX。   没有对变革的广泛公告似乎已经取得了这一变化，因为这是我第一次听到这个弃用/禁用，而不是在其他新闻网站上提到，但注意到它与新的Linux 5.14周期进入新的补丁。 Linux内核正在为本早晨为5.14合并窗口的新补丁流程进行准备。    记忆订单问题是据报道，据报道，英特尔现在贬低了各种处理器的TSX。本月有这个英特​​尔白皮书更新了这个问题的时间。如在修订历史记录中所指出的，自从2018年10月之前的至少在2018年10月之前的内容中已知内存排序问题，但现在只在2021年6月2021年默认推出Microcode更新以禁用Microcode更新以默认禁用TSX。   在进行新的Linux补丁时，从6月12日参考这一指导概述了预期的变化。该更新在英特尔＆＃39的最新CPU微码更新后几天发布了本月早些时候没有注意到任何TSX的更改，但注意到其他安全更新。 （尝试在其中一个受影响的CPU上的最新的微码更新仍然显示TSX与TAA缓解仍然有效。）即将到来的Microcode更新将在踩踏5之前有效地贬低所有Skylake Xeon CPU的TSX（包括Xeon D和第1 Gen Xeon可扩展），所有第6型Xeon E3-1500M V5 / E3-1200 V5 Skylake加工器，所有7日/第8次核心和磷脂/咖啡/威士忌/威士忌CPU在0x8阶梯之前，以及所有8日/第9段核心/奔腾咖啡湖CPU之前到0xC踩踏将受到影响。最终通过咖啡湖从各种天窗的平台跨越;它是第10族彗星湖和冰湖，随后取下了TSX / TSX-Ni。    除了默认情况下禁用TSx并默认强制下降所有RTM事务，将枚举新的微码，以指示RTM事务的力中止。它＆＃39; s由于Linux内核看到修补程序的新CPUID位。以前Linux和其他操作系统应用了TSX内存排序问题的解决方法，但现在禁用此功能时，内核可以丢弃所述解决方法。这些补丁随着Linux 5.14循环而来，也可能会恢复稳定。    英特尔通过微码更新禁用TSX ISN＆＃39; T完全是重新的，当特征首次出现哈斯韦尔时，他们最终选择性地禁止由于早期错误而在该原始实施中的早期错误，但现在这会有效地杀死它跨越多个产品代数和岁月软件适用于允许使用事务同步扩展。 Linux上的TSX性能已经为较新的处理器劣化，因为2019年底颁布的Taa缓解源。   英特尔＆＃39;在即将举行的微码变化周围本月的指导确实确认＆＃34;受益于英特尔TSX的工作负载可能会遇到性能变化。＆＃34;因此，有时间射击一些新的基准。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://www.phoronix.com/scan.php?page=news_item&px=Intel-TSX-Off-New-Microcode">https://www.phoronix.com/scan.php?page=news_item&px=Intel-TSX-Off-New-Microcode</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/默认/">#默认</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/disable/">#disable</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tsx/">#tsx</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>