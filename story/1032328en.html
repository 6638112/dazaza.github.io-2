<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Kde.org已迁移到Hugo</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Kde.org已迁移到Hugo</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-31 02:02:38</div><div class="page_narrow text-break page_content"><p>KDE.org now uses the  Hugo. Hugo is a fast and modern static sitegenerator written in Go. It provides a few improvements over the old system that wasusing plain PHP. A large part of the work was done by Anuj during GSoC 2020. Thiswas a massive work, converting the repository storing more than 20 years of KDEhistory.</p><p>KDE.org现在使用Hugo。Hugo是一个用围棋编写的快速而现代的静态站点生成器。与使用纯PHP的旧系统相比，它提供了一些改进。很大一部分工作是由Anuj在GSOC 2020期间完成的。这是一项巨大的工作，要转换存储了20多年KDE历史的存储库。</p><p> The website is now generated once and no longer use PHP to generate itself at runtime.This improves the loading speed of the website, but the speed boost is not significant,since the PHP code used before was quite small and KDE’s servers are powerful.</p><p>网站现在只生成一次，不再使用PHP在运行时自动生成，这提高了网站的加载速度，但速度提升并不明显，因为以前使用的PHP代码非常小，而且KDE的服务器功能强大。</p><p> But the biggest improvement is in terms of features. We are now working with markdownfiles instead of raw HTML files, this makes the life of the promo team much easier.</p><p>但最大的改进是在功能方面。我们现在使用的是markdownfile而不是原始的HTML文件，这使得宣传团队的生活变得容易得多。</p><p> The internalization of the website now creates a unique URL per language, thisshould allow Google to link to the version of the website using the correct language.A  french,  ukrainian, catalan,  Dutch, and a few more languagesare already available. There is also a proper language selector! We also don’t needto manually tag each string for translations.</p><p>网站的内部化现在为每种语言创建了一个唯一的URL，这应该允许Google使用正确的语言链接到网站的版本。法语、乌克兰语、加泰罗尼亚语、荷兰语和其他几种语言已经可用。还有一个合适的语言选择器！我们也不需要手动标记每个字符串以进行翻译。</p><p> There is also now an  RSS feed with all thelatest announcements. Another big improvement is that the announcements list isautogenerated and no longer modified by hand and with the help of the release scripts.</p><p>现在还有一个RSS订阅源，上面有所有最新的公告。另一个重大改进是公告列表是自动生成的，不再需要手动修改，也不再需要在发布脚本的帮助下修改。</p><p> Another nice change for website developers is that now the SCSS code for the individualpages is located in the kde-org repository itself instead of another repository.Overall the developer experience is much better, there is no need to set up an apacheserver and to the PHP configs to include the capacity framework, just to get thewebsite running locally. Now you only need to download the Hugo binary from theirrelease page and run it on the repo.</p><p>对于网站开发人员来说，另一个很好的改变是，现在单个页面的SCSS代码位于kde-org存储库本身，而不是其他存储库。总体来说，开发人员的体验要好得多，不需要设置一个缓存服务器和PHP配置来包括容量框架，只需让网站在本地运行即可。现在您只需要从他们的发布页面下载Hugo二进制文件，并在repo上运行它。</p><p>  The internalization of KDE.org was quite a challenge. When working on a multilingualwebsite with Hugo, Hugo expects a markdown document per language for each translatedpage.</p><p>KDE.org的内部化是一个相当大的挑战。当与Hugo一起处理多语言网站时，Hugo希望每个翻译页面都有一个每种语言的标记文档。</p><p>  The problem is that traditional translations workflow expect a string-based approach,where a document is split in paragraphs and translated individually. So I couldn’tjust put each file markdown file as big blobs in the po files. To solve this problem,I created a python script splitting the markdown files in paragraphs, simplifyingthe markdown syntax (removing leading  # and  + for heading and list item). Thisscript also handles Hugo shortcodes transforming:</p><p>问题是，传统翻译工作流希望使用基于字符串的方法，即将文档拆分成段落并单独翻译。因此，我不能将每个文件标记为po文件中的大BLOB。为了解决这个问题，我创建了一个Python脚本，将标记文件拆分成段落，简化了标记语法(去掉了标题和列表项的前导#和+)。此脚本还处理Hugo短码转换：</p><p>    The script can obliviously put the individual strings back in place. The scripts alsohandle the menu translation, and the translations of the strings in the footers.For now, the script is just a file in the kde-org repository, but I would like totransform it as a standalone library so that other gettext and Hugo users cantranslate their website.</p><p>脚本可以不知不觉地将各个字符串放回原位。目前，脚本只是kde-org存储库中的一个文件，但我想将其转换为独立库，以便其他gettext和Hugo用户可以翻译他们的网站。</p><p>  &lt;ul class=&#34;navbar-nav ml-auto&#34;&gt; {{ if .IsTranslated }} &lt;li class=&#34;nav-item dropdown&#34; aria-describedby=&#34;language-picker-description&#34;&gt; &lt;p class=&#34;sr-only&#34; id=&#34;language-picker-description&#34;&gt;{{ i18n &#34;Select-your-language&#34; }}&lt;/p&gt; &lt;a class=&#34;nav-link dropdown-toggle&#34; href=&#34;#&#34; data-toggle=&#34;dropdown&#34; role=&#34;button&#34; aria-haspopup=&#34;true&#34; aria-expanded=&#34;false&#34;&gt; &lt;img src=&#34;/Language-Icons/icon20x24px-exported-transparent.png&#34; alt=&#34;&#34; /&gt; &lt;span&gt;{{ i18n &#34;translations&#34; }}&lt;/span&gt; &lt;/a&gt; &lt;div class=&#34;dropdown-menu dropdonw-trans&#34; role=&#34;listbox&#34;&gt; &lt;a class=&#34;dropdown-item&#34; aria-selected=&#34;true&#34; hreflang=&#34;{{ .Site.Language.Lang }}&#34; role=&#34;option&#34; lang=&#34;{{ .Site.Language.Lang }}&#34; href=&#34;{{ .Permalink }}&#34;&gt;{{ .Site.Language.LanguageName }}&lt;/a&gt; {{ range .Translations }} &lt;a class=&#34;dropdown-item&#34; hreflang=&#34;{{ .Language.Lang }}&#34; role=&#34;option&#34; lang=&#34;{{ .Language.Lang }}&#34; href=&#34;{{ .Permalink }}&#34;&gt;{{ .Language.LanguageName }}&lt;/a&gt; {{ end }} &lt;/div&gt; &lt;/li&gt; {{ end }}&lt;/ul&gt;</p><p>&lt；ul class=&#34；navbar-nav ml-AUTO&#34；&gt；{{if.IsTranslated}}&lt；li class=&#34；nav-item下拉菜单&#34；aria-describedby=&#34；language-picker-description&#34；&gt；&lt；p class=&#34；sr-only&#34；id=&#34；language-picker-description&#34；&gt；{{i18n&#34；选择您的语言&#34；}}&lt；/p&gt；&lt；A class=&#34；nav-link下拉切换=&#34；href=&#34；#&#34；数据切换=&#34；下拉&#34；角色=&#34；按钮&#34；aria-haspopup=&#34；true&#34；aria-Expanded=&#34；false&#34；&gt；&lt；img src=&#34；/Language-Icons/icon20x24px-exported-transparent.png&#34；alt=&#34；&#34；/&gt；&lt；span&gt；{{i18n&#34；翻译&#34；}}&lt；/span&gt；&lt；/a&gt；&lt；div class=&#34；Dropdown-Menu Dropdonw-trans&34；Role=&#34；listbox&#34；&gt；&lt；a class=&#34；aria-Selected=&#34；true&#34；hrefang=&#34；{{.Site.Language.lang}}&#34；Role=&#34；Option&#34；lang=&#34；{{.Site.Language.Lang}}&#34；href=&#34；{{.Permalink}}&#34；&gt；{{.Site.Language.LanguageName}}&lt；/a&gt；{{range.Translations}}&lt；a class=&#34；DropDown-Item&#34；hrefang=&#34；{{.Language.Lang}}&#34；Role=&#34；Option&#34；lang=&#34；{{.Language.Lang}}&#34；href=&#34；{{.Permalink}}&#34；&gt；{{.Language.LanguageName}}&lt；/a&gt；{{end}}&lt；/div&gt；&lt；/li&gt；{{end}}&lt；/ul&gt；</p><p> This is a bit verbose because this selector is also fully accessible for screen readers.</p><p>这有点冗长，因为屏幕阅读器也可以完全访问此选择器。</p><p> There are a few more tricks employed in kde.org to improve the internalization, forexample when a page doesn’t exist in a language, there is an Apache rule redirecting itto the English version. Another nice trick is that there is a special Hugo shortcodecalled  i18n_var and used to parametrize the strings. For example:</p><p>在kde.org中使用了更多的技巧来提高内部化，例如，当页面不存在于语言中时，有一条Apache规则将其重定向到英文版本。另一个好把戏是有一个特殊的Hugo短编码i18n_var，用于参数化字符串。例如：</p><p> {{&lt; i18n_var &#34;Today KDE releases a bugfix update to KDE Plasma 5, versioned %[1]s&#34; &#34;5.20.2&#34; &gt;}}</p><p>{{&lt；i18n_var&#34；今天KDE发布了对KDE等离子体5版本%[1]s&#34；&#34；5.20.2&#34；&gt；}的错误修复更新}。</p><p> And the extractor is clever and only extract the part that needs to be translated.</p><p>而且提取器很聪明，只提取需要翻译的部分。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://carlschwan.eu/2020/10/30/kde-org-hugo.html">https://carlschwan.eu/2020/10/30/kde-org-hugo.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/迁移/">#迁移</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/migrated/">#migrated</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/网站/">#网站</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>