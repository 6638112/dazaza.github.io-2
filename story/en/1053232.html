<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>实际上，DMARC与邮件列表合作（2018） Actually, DMARC works fine with mailing lists (2018)</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Actually, DMARC works fine with mailing lists (2018)<br/>实际上，DMARC与邮件列表合作（2018） </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-18 20:38:49</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/3/86d53cafa5901534cb9553a4df08cb83.png"><img src="http://img2.diglog.com/img/2021/3/86d53cafa5901534cb9553a4df08cb83.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>There’s a common belief online that DMARC, an anti-phishing technology, prevents the proper operation of electronic mailing lists. To get around the perceived problem, many articles advise reconfiguring listserv software in ways that break the norms of SMTP.</p><p>在网上有一个常见的信念，DMARC是一种防守网络钓鱼技术，防止了电子邮件列表的适当运行。要绕过感知的问题，许多文章以打破SMTP规范的方式建议重新配置ListServ软件。</p><p> However there is a configuration that allows mailing lists to work perfectly and still be able to relay messages in the presence of DMARC. Before describing it, let’s get some terminology straight.</p><p> 然而，存在一种配置，允许邮件列表完全工作，并且仍然能够在DMARC的存在下中继消息。在描述之前，让我们直接得到一些术语。</p><p>  (A.k.a. return-path.) A record in an SMTP message’s “envelope,” saying whom to contact in the event of delivery failure. Emails can travel in multiple hops, being relayed from server to server, before reaching their destination. During transit, the RFC5321.MailFrom header contains an email address for the server that sent the message along the current hop.</p><p>  （A.K.A.返回路径。）SMTP消息的“信封”中的记录，称在交付失败时要联系。在到达目的地之前，电子邮件可以在多个跳中传输到服务器，从服务器转发到服务器。在运输过程中，RFC5321.MailFrom报头包含发送沿当前跃点的消息的服务器的电子邮件地址。</p><p>  A header inside the message itself, hopefully preserved across hops. This is the “From” field that email clients display, and it is supposed to be the email address of the person responsible for the email.</p><p>  消息本身内部的标题，希望跨越啤酒花。这是电子邮件客户端显示的“来自”字段，它应该是负责电子邮件的人的电子邮件地址。</p><p>  A less commonly known email header which indicates an intermediary who writes or sends a message on behalf of someone else. RFC 5322 gives the example of a secretary (Sender) who writes and sends a message on behalf of the boss (From).</p><p>  一个不太常见的电子邮件标题，它表示代表其他人写入或发送消息的中介。 RFC 5322给出了秘书（发件人）的例子，他代表BOSS（来自）发出并发送消息。</p><p>  Sender Policy Framework. A TXT DNS record which publishes the addresses of mail servers who are allowed to send or relay messages for a (sub)domain. Receiving mail servers can inspect RFC5321.MailFrom and bounce the message if it doesn’t match the servers listed in the SPF record.</p><p>  发件人策略框架。一个TXT DNS记录，它发布允许为（子）域发送或中继消息的邮件服务器的地址。接收邮件服务器可以检查RFC5321.Mailfrom并反弹消息如果它与SPF记录中列出的服务器不匹配。</p><p>  DomainKeys Identified Mail. DKIM are TXT DNS records which each contain a public key that is permitted to cryptographically sign the body, and a list of which email headers should be covered in the signature. Sending servers must know the private key in order to sign outgoing mail, and receiving mail servers can check the email against the public key to make sure it passes. This ensures that only authorized servers can originate mail for a domain, and also that relay servers cannot modify the message.</p><p>  DomainKeys已识别邮件。 DKIM是TXT DNS记录，每个记录都包含允许加上密钥的公钥签署正文，以及应在签名中涵盖哪些电子邮件标题的列表。发送服务器必须知道私钥才能登录邮件，并且接收邮件服务器可以检查对公钥的电子邮件以确保它通过。这可确保只有授权服务器可以为域发起邮件，并且还原中继服务器无法修改消息。 </p><p>  Domain-based Message Authentication, Reporting and Conformance. A TXT DNS record which publishes a domain’s policy for how receiving mail servers should act on SPF or DKIM failure. Actions include ignoring the problem, sending the message to the spam folder, or outright bouncing the message. The DMARC record contains some other settings such as an email address for mail servers to report any non-conforming mail they receive.</p><p>基于域的消息身份验证，报告和一致性。一个TXT DNS记录，它发布了域的策略，了解接收邮件服务器应该如何对SPF或DKIM失败作用。操作包括忽略问题，将消息发送到垃圾邮件文件夹，或者彻底弹跳消息。 DMARC Record包含其他一些设置，例如邮件服务器的电子邮件地址，以报告他们收到的任何不合格邮件。</p><p>  A relay mail server which hosts a special address called a  reflector. The mailing list relays any message sent to its reflector to the addresses of list subscribers. Mailing lists are used for group discussions, including collaborative software development.</p><p>  托管一个名为反射器的特殊地址的继电器邮件服务器。邮件列表将发送到其反射器发送到列表订阅者的地址的任何消息。邮件列表用于组讨论，包括协作软件开发。</p><p> While earlier methods such as PGP have existed to unmask mail forgery, DMARC has become the popular choice and is honored today on all major mail servers. However people whose domains employ DMARC are unable to send messages through traditionally-configured mailing lists. During DMARC adoption on major domains such as gmail and yahoo, mailing lists started having widespread problems.</p><p> 虽然PGP等早期方法已经存在于揭示邮件伪造，但DMARC已成为最受欢迎的选择，并在所有主要邮件服务器上获得荣誉。但是，域名雇用DMARC的人无法通过传统配置的邮件列表发送消息。在DMARC在Gmail和雅虎等主要领域采用期间，邮件列表开始具有广泛的问题。</p><p> Some people called DMARC a broken standard. They failed to implement elegant adjustments to mailing list behavior, and used hacky workarounds to fix the problem instead.</p><p> 有些人称为DMARC的破碎标准。他们未能为邮寄列表行为实施优雅的调整，并使用贺卡变通方法来解决问题。</p><p> Let’s examine how a message passes or fails DMARC, and then learn how to fix lists. A message passes if  either SPF or DKIM passes, and only fails if both SPF and DKIM fail. This way SPF-only and DKIM-only messages can pass DMARC, but messages without either SPF/DKIM will always fail.</p><p> 让我们来看看消息如何通过或失败DMARC，然后了解如何修复列表。如果SPF或DKIM通过，则传递消息，并且仅在SPF和DKIM失败时才会失败。这样，仅限SPF和DKIM的消息都可以通过DMARC，但没有SPF / DKIM的消息将始终失败。</p><p>  For DKIM, it means that the message has one valid DKIM signature with “d=RFC5322.From”.</p><p>  对于DKIM，这意味着该消息具有一个有效的DKIM签名，“d = rfc5322.from”。</p><p>    A mailing list is going to have a hard time relaying messages for any domain that uses DMARC and SPF but not DKIM. Consider this message:</p><p>    邮件列表将为使用DMARC和SPF但不是DKIM的任何域都有一个艰难的时间中继消息。考虑此消息： </p><p>    However  destination.com will reject this message if  mailinglist.org is not in the SPF record for  dmarcdomain.com. Furthermore a good SPF record is not enough, since the Return-Path and From are out of alignment (they specify different domains).</p><p>但是，如果mailinglist.org不在dmarcomain.com的SPF记录中，则Destination.com将拒绝此消息。此外，良好的SPF记录是不够的，因为返回路径和来自对齐（它们指定不同的域）。</p><p> Dealing with this situation is what causes the hacky workarounds. Lists have to use techniques like From-munging or MIME message wrapping to get the mail through.</p><p> 处理这种情况是导致贺卡变通方法的原因。列表必须使用从营地或MIME消息包装等技术来获取邮件。</p><p>  Return-Path: &lt;fun-bounce@mailinglist.org&gt;From: &#34;Sally Sender via Fun List&#34; &lt;fun@mailinglist.org&gt;Reply-To: &#34;Sally Sender&#34; &lt;sender@demarcdomain.com&gt;To: &#34;Roger Reader&#34; &lt;reader@destination.com&gt;Subject: HiHi everyone</p><p>  返回路径：＆lt; fun-bounce@mailinglist.org& gt;来自：＆＃34;莎莉发件人通过有趣的列表＆＃34; ＆lt; fun@mailinglist.org& gt;回复 - 至：＆＃34;莎莉发件人＆＃34; ＆lt; sender@demarcomomain.com& gt; to：＆＃34; roger读者＆＃34; ＆lt; reader @ destination.com& gt;主题：每个人都有hihi</p><p> The recipient would only have to check DMARC for  mailinglist.org which would pass. However this is a poor use of email, since it’s misrepresenting who originated the message. Also email clients often have a degraded interface with respect to the  Reply-To header. It’s usually not visible in the message list, not used for sorting, and not added to the address book.</p><p> 收件人只需检查将通过的MailingList.org的DMARC。然而，这是电子邮件的使用差，因为它是歪曲谁发起了消息。此外，电子邮件客户端通常具有与回复标头的劣化接口。它通常在消息列表中不可见，不用于排序，而不是添加到地址簿中。</p><p>  If the sending domain uses DKIM, it avoids the need for From-munging or other hacks. It works under the condition that the list does not modify the message.</p><p>  如果发送域使用DKIM，它会避免从营地或其他黑客攻击。它在列表不修改消息的情况下工作。</p><p>   SPF will fail, as we saw earlier, so DMARC will try a DKIM check. The From, Subject and body were not modified so they will be properly signed. DKIM checks alignment between RFC5322.From and the signature’s domain, which will also match. DKIM passes, and message gets delivered.</p><p>   正如我们之前看到的那样，SPF将失败，因此DMARC将尝试DKIM检查。没有修改，受试者和身体，所以它们将被正确签署。 DKIM检查RFC5322之间的对齐。来自和签名的域，也将匹配。 DKIM通过，消息交付。</p><p> Should be perfect, right? Well it could be, except lists traditionally add extra information in the subject and body of relayed messages, and the modified fields don’t pass a DKIM check. Messages from traditional mailing lists typically look more like this:</p><p> 应该是完美的，对吗？嗯，除了列表中，除了传统上添加了中继消息的主题和主体中的额外信息，并且修改的字段不会通过DKIM检查。来自传统邮件列表的消息通常如此如此： </p><p> Return-Path: &lt;fun-bounce@mailinglist.org&gt;From: &#34;Sally Sender&#34; &lt;sender@dmarcdomain.com&gt;Sender: &#34;Fun List&#34; &lt;fun@mailinglist.org&gt;To: &#34;Roger Reader&#34; &lt;reader@destination.com&gt;Subject: [fun] HiHi everyone--You are subscribed to the fun list, to unsubscribevisit https://mailinglist.org/unsub/123</p><p>返回路径：＆lt; fun-bounce@mailinglist.org& gt;来自：＆＃34;莎莉发件人＆＃34; ＆lt; sender@dmarcomain.com& gt;发件人：＆＃34;有趣的名单＆＃34; ＆lt; fun@mailinglist.org& gt; to：＆＃34;罗杰读者＆＃34; ＆lt; reader @ destination.com& gt;主题：[有趣] Hihi Everys  - 您订阅了Fun列表，到Unsubscribevisit https://mailinglist.org/unsub/123</p><p> The subject line tag is typically used to sort the messages into a separate mailbox following user-defined rules in the email client. The unsubscribe link in the body is a convenience (and avoids government fines from violating the CAN-SPAM act.)</p><p> 主题行标记通常用于将消息对在电子邮件客户端中的用户定义规则之后的单独邮箱中。身体中的取消订阅链接是便利（并避免政府罚款违反CAN-SPAM法案。）</p><p> We need to give the client a way to sort mail, unsubscribe, etc without modifying the parts of the message signed by DKIM. Fortunately, there are RFCs for this.  RFC2369 from 1998 and  RFC2919 from 2001 both predate the DMARC machinery. The first introduces header fields for list information and control.</p><p> 我们需要为客户提供一种方法来排序邮件，取消订阅等，而无需修改DKIM签名的消息的部分。幸运的是，有rfcs。 RFC2369于1998年和RFC2919从2001年开始，两者都是预测DMARC机械。首先介绍列表信息和控件的标题字段。</p><p> For our example RFC2369 allows us to add  List-Unsubscribe: &lt;https://mailinglist.org/unsub/123&gt;. It also introduces headers like List-Help, List-Subscribe, List-Post, List-Owner, and List-Archive. What’s more, many mail clients understand these headers. Gmail adds an unsubscribe button to the web interface when it detects List-Unsubscribe.</p><p> 对于我们的示例，RFC2369允许我们添加列表 - 取消订阅：＆lt; https：//mailinglist.org/unsub/123&gt;它还介绍了List-help，list-subscribe，list-post，list-owner和list-arprive的标题。更重要的是，许多邮件客户理解这些标题。在检测到列表 - 取消订阅时，Gmail将取消订阅按钮添加到Web界面。</p><p> The second RFC offers a way to identify a list with another header, like  List-Id: The Fun List &lt;fun.mailinglist.org&gt;. Mail client rules can query this header rather than checking whether the subject field contains  [fun].</p><p> 第二个RFC提供了一种方法来识别包含另一个标题的列表，如列表ID：有趣列表＆lt; fun.mailinglist.org＆gt ;.邮件客户端规则可以查询此标题，而不是检查主题字段是否包含[有趣]。</p><p>  It is reasonable nowadays to require that mailing list users whose domains use DMARC also enable DKIM. In fact the list software could check the sender’s domain at subscription time and raise an error if their domain uses DMARC but not DKIM.</p><p>  现在是合理的，要求域使用DMARC的邮件列表用户也启用DKIM。事实上，列表软件可以在订阅时间检查发件人的域，如果域域使用DMARC，则会引发错误，但不是DKIM。</p><p> Lists should keep the From address, the Subject, and the Message totally unchanged. They should add a Sender header to indicate their relay role, and set at least the List-Id and List-Unsubscribe headers for mailbox rules and subscription management.</p><p> 列表应保持来自地址，主题和消息完全不变。它们应该添加一个发件人标题来指示其继电器角色，并至少设置邮箱规则和订阅管理的列表ID和列表 - 取消订单。 </p><p> This configuration will allow mailing lists to function as proper SMTP citizens in the age of DMARC.</p><p>此配置将允许邮件列表在DMARC时代的函数中作为正确的SMTP公民。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://begriffs.com/posts/2018-09-18-dmarc-mailing-list.html">https://begriffs.com/posts/2018-09-18-dmarc-mailing-list.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/邮件/">#邮件</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/works/">#works</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/消息/">#消息</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>