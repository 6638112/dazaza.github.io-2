<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Vftool在macOS Big Sur中运行Linux虚拟机 Vftool runs Linux virtual machines in macOS Big Sur</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Vftool runs Linux virtual machines in macOS Big Sur<br/>Vftool在macOS Big Sur中运行Linux虚拟机 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-11 14:01:14</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/5877709dbee07abb65362f46399c8e74.jpeg"><img src="http://img2.diglog.com/img/2020/12/5877709dbee07abb65362f46399c8e74.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Here lies a  really minimalist and very noddy command-line wrapper to run VMs in the macOS Big Sur Virtualization.framework.</p><p>这是一个非常简约且非常简洁的命令行包装程序，用于在macOS Big Sur Virtualization.framework中运行VM。</p><p> Vftool runs Linux virtual machines with virtio block, network, entropy and console devices. All of the hard work and actual virtualisation is performed by Virtualization.framework -- this wrapper simply sets up configuration objects, describing the VM.</p><p> Vftool运行带有virtio块，网络，熵和控制台设备的Linux虚拟机。所有艰苦的工作和实际的虚拟化工作都是由Virtualization.framework执行的-这个包装器只是简单地设置配置对象，以描述VM。</p><p> It&#39;s intended to be the simplest possible invocation of this framework, whilst allowing configuration for:</p><p> 它旨在是对该框架的最简单的调用，同时允许配置：</p><p>  Tested on an M1-based Mac (running arm64/AArch64 VMs), but should work on Intel Macs too (to run x86 VMs). Requires macOS &gt;= 11.</p><p>  在基于M1的Mac（运行arm64 / AArch64 VM）上进行了测试，但也应在Intel Mac（运行x86 VM）上运行。需要macOS＆gt; = 11。</p><p> This is  not a GUI-based app, and this configuration is provided on the command-line. Note also that Virtualization.framework does not currently provide public interfaces for framebuffers/video consoles/GUI, so the resulting VM will have a (text) console and networking only. Consider using VNC into your VM, which is quite usable.</p><p> 这不是基于GUI的应用程序，并且在命令行上提供了此配置。另请注意，Virtualization.framework当前不为帧缓冲区/视频控制台/ GUI提供公共接口，因此生成的VM仅具有（文本）控制台和联网。考虑在虚拟机中使用VNC，这非常有用。</p><p>   It should be one click, though you may have to set up your (free) developer ID/AppleID developer Team in the &#34;Signing &amp; Capabilities&#34; tab of the project configuration.</p><p>   尽管您可能必须在＆＃34; Signing＆amp; amp;中设置（免费的）开发人员ID / AppleID开发人员团队，但应该单击一下。能力＆＃34;项目配置的选项卡。</p><p>   This results in  build/vftool. The Makefile applies a code signature and required entitlements without an identity, which should be enough to run on your own machine. I haven&#39;t tested whether this binary will then work on other people&#39;s machines.</p><p>   这将生成build / vftool。 Makefile应用代码签名和必需的权利而没有身份，这足以在您自己的计算机上运行。我尚未测试过此二进制文件是否可以在其他人的计算机上工作。 </p><p>   -k &lt;kernel path&gt; -a &lt;kernel cmdline arguments&gt; -i &lt;initrd path&gt; -d &lt;disc image path&gt; -c &lt;CDROM image path&gt; -b &lt;bridged ethernet interface&gt; -p &lt;number of processors&gt; -m &lt;memory size in MB&gt; -t &lt;tty type&gt;</p><p>-k＆lt;内核路径＆gt; -a＆lt; kernel cmdline arguments＆gt; -i＆lt; initrd path＆gt; -d＆lt;光盘图像路径＆gt; -c＆lt; CDROM图像路径＆gt; -b＆lt;桥接以太网接口＆gt; -p＆lt;处理器数＆gt; -m＆lt;以MB为单位的内存大小＆gt; -t＆lt; tty type＆gt;</p><p> Only the  -k argument is required (for a path to the kernel image), and all other arguments are optional. The (current) default is 1 CPU, 512MB RAM, &#34;console=hvc0&#34;, NAT-based networking, no discs or initrd and creates a pty for the console.</p><p> 仅-k参数是必需的（用于内核映像的路径），所有其他参数都是可选的。 （当前）默认值为1 CPU，512MB RAM，＆console = hvc0＆＃34 ;、基于NAT的网络，没有光盘或initrd，并为控制台创建了一个pty。</p><p> The  -t option permits the console to either use stdin/stdout (option  0), or to create a pseudo terminal (option  1, the default) and wait for you to attach something to it, as in the example below. The pseudo terminal (pty) approach gives a useful interactive console (particularly handy for setting up your VM), but stdin/stdout and immediate startup are more useful for launching VMs in a script.</p><p> -t选项允许控制台使用stdin / stdout（选项0），或创建伪终端（选项1，默认值），然后等待您将某些东西附加到它，如下面的示例所示。伪终端（pty）方法提供了一个有用的交互式控制台（尤其是在设置VM时非常方便），但是stdin / stdout和立即启动对于在脚本中启动VM更为有用。</p><p> Multiple disc images can be attached by using several  -d or  -c options. The discs are attached in the order they are given on the command line, which should then influence which device they appear as. For example,  -d foo -d bar -c blah will create three virtio-blk devices,  /dev/vda,  /dev/vdb,  /dev/vdc attached to  foo,  bar and  blah respectively. Up to 8 discs can be attached.</p><p> 使用多个-d或-c选项可以附加多个光盘映像。光盘按照在命令行上给出的顺序进行连接，这将影响光盘的外观。例如，-d foo -d bar -c blah将创建三个virtio-blk设备，分别连接到foo，bar和blah的/ dev / vda，/ dev / vdb，/ dev / vdc。最多可以安装8张光盘。</p><p> The kernel should be uncompressed. The initrd may be a gz. Disc images are raw/flat files (nothing fancy like qcow2).</p><p> 内核应未压缩。 initrd可能是gz。光盘映像是原始文件/平面文件（没有像qcow2这样的花哨的文件）。</p><p>  2020-11-25 02:14:33.883 vftool[86864:707935] vftool (v0.1 25/11/2020) starting2020-11-25 02:14:33.884 vftool[86864:707935] +++ kernel at file:///Users/matt/vm/debian/Image-5.9, initrd at (null), cmdline &#39;console=hvc0 root=/dev/vda1&#39;, 2 cpus, 4096MB memory2020-11-25 02:14:33.884 vftool[86864:707935] +++ fd 3 connected to /dev/ttys0162020-11-25 02:14:33.884 vftool[86864:707935] +++ Waiting for connection to: /dev/ttys016</p><p>  2020-11-25 02：14：33.883 vftool [86864：707935] vftool（v0.1 25/11/2020）starting2020-11-25 02：14：33.884 vftool [86864：707935] +++内核位于文件： ///Users/matt/vm/debian/Image-5.9，initrd at（null），cmdline＆＃39; console = hvc0 root = / dev / vda1＆＃39 ;, 2 cpus，4096MB memory2020-11-25 02： 14：33.884 vftool [86864：707935] +++ fd 3已连接至/ dev / ttys0162020-11-25 02：14：33.884 vftool [86864：707935] +++等待连接至：/ dev / ttys016</p><p> vftool is now waiting for a connection to the VM&#39;s console -- in this example, it&#39;s created  /dev/ttys016 for this. Continue by attaching to this in another terminal:</p><p> vftool现在正在等待与VM控制台的连接-在此示例中，它为此创建了/ dev / ttys016。通过在另一个终端上附加此内容来继续： </p><p>   At this point, vftool starts the VM. (Well, vftool validates some items after this point, so if your disc images don&#39;t exist then you&#39;ll find out now.)</p><p>此时，vftool将启动VM。 （好吧，vftool在此之后会验证一些项目，因此，如果您的光盘映像不存在，那么您现在就可以找到。）</p><p>      Note that Virtualization.framework provides all IO as virtio-pci, including the console (i.e. not a UART). The debian install kernel does not have virtio drivers, unfortunately. I ended up using debootstrap ( --foreign) to install to a disc image on a Linux box... but I hear good things about Fedora etc.</p><p>      请注意，Virtualization.framework将所有IO提供为virtio-pci，包括控制台（即非UART）。不幸的是，debian安装内核没有virtio驱动程序。我最终使用debootstrap（--foreign）将其安装到Linux机器上的光盘映像中...但是我听到了有关Fedora等的好消息。</p><p>  The  -b option uses a  VZBridgedNetworkDeviceAttachment to configure a bridged network interface instead of the default &#39;NAT&#39; interface.  This does not currently work.</p><p>  -b选项使用VZBridgedNetworkDeviceAttachment配置桥接的网络接口，而不是默认的＆＃39; NAT＆＃39;。接口。目前无法使用。</p><p> The bridging requires the binary to have the  com.apple.vm.networking entitlement, and Apple docs helpfully give this note:</p><p> 桥接要求二进制文件具有com.apple.vm.networking权利，Apple文档有帮助地给出此注释：</p><p> NoteThis entitlement is restricted to developers of virtualization software. To request this entitlement, contact your Apple representative.</p><p> 注意此权利仅限于虚拟化软件开发人员。要请求此权利，请联系您的Apple代表。</p><p> This seems to be saying that one requires a paid developer account  and to ask nicely to be able to use this OS feature. (Rolls eyes)</p><p> 这似乎是在说，您需要一个付费的开发人员帐户，并要求能够使用此OS功能。 （转动眼球）</p><p> Fortunately, the &#34;NAT&#34; default works fine for the outgoing direction, and even permits  incoming connections -- it appears to be kernel-level NAT from a bridged interface instead of the user-level TCP/IP stuff as used in QEMU. I end up with a host-side  bridge100 network interface with IP  192.168.64.1 and my guests get  192.168.64.x addresses which are reachable from the host. So, at least one can SSH/VNC into guests!</p><p> 幸运的是，＆＃34; NAT＆＃34; default对于传出方向很好，甚至允许传入连接-它似乎是桥接接口的内核级NAT，而不是QEMU中使用的用户级TCP / IP。我最终得到了一个主机端bridge100网络接口，其IP为192.168.64.1，我的来宾获得了192.168.64.x地址，该地址可以从主机访问。因此，至少有一个可以通过SSH / VNC进入访客！ </p><p>    KhaosT&#39;s SimpleVM is a Swift wrapper for Virtualization.framework:  https://github.com/KhaosT/SimpleVM This does roughly the same thing as vftool, but has a friendlier GUI. vftool has a little more flexibility in configuration (without hacking sources) and I personally prefer the text-based terminal approach.</p><p>KhaosT的SimpleVM是Virtualization的Swift包装器。框架：https://github.com/KhaosT/SimpleVM这与vftool大致相同，但是具有友好的GUI。 vftool在配置方面有更多的灵活性（没有黑客来源），我个人更喜欢基于文本的终端方法。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/evansm7/vftool">https://github.com/evansm7/vftool</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/虚拟机/">#虚拟机</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/macos/">#macos</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/runs/">#runs</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/控制台/">#控制台</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1038971.html"><img src="http://img2.diglog.com/img/2020/12/thumb_0b2e36735cc3a2d9ff5c8b3adc0dd926.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1038971.html">CentOS 8与Amazon Linux 2 </a></div><span class="my_story_list_date">2020-12-11 7:46</span></div><div class="col-sm"><div><a target="_blank" href="/story/1038872.html"><img src="http://img2.diglog.com/img/2020/12/thumb_1b94f5947c5b3fc668dd8f1c164447f5.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1038872.html">CentOS Linux已经死了，而Red Hat表示Stream“不是替代品” </a></div><span class="my_story_list_date">2020-12-10 21:40</span></div><div class="col-sm"><div><a target="_blank" href="/story/1038800.html"><img src="http://img2.diglog.com/img/2020/12/thumb_6c1c2aa6bc0c861ef45483bfafc7c8bc.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1038800.html">Rocky Linux：原始CentOS创建者的新RHEL Fork </a></div><span class="my_story_list_date">2020-12-10 9:16</span></div><div class="col-sm"><div><a target="_blank" href="/story/1038681.html"><img src="http://img2.diglog.com/img/2020/12/thumb_c13477f6896e3f061f40791358604777.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1038681.html">Rocky Linux：与RHEL兼容的社区企业OS </a></div><span class="my_story_list_date">2020-12-10 2:10</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>