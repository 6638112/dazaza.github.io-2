<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>用实例说明类型系统</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">用实例说明类型系统</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-09-29 10:37:23</div><div class="page_narrow text-break page_content"><p>“我的语言更好，因为它有很强的类型系统！”你的同事开发人员戴夫(Dave)尖叫着，试图将编程语言Cobol推向你们公司的下一项微服务。</p><p>在开发人员中，关于编程语言及其类型系统的讨论可能很快就会变得情绪化。在这些讨论中，我们经常抛出“类型系统”、“数据类型”、“类型推断”、“静态类型”、“弱类型”、“强制”等词。但是，我们真的理解所有这些术语的含义吗？</p><p>然而，理解我们正在使用的语言的类型系统是最原始的。这就是本文的目标；我们将看到：</p><p>我将使用两种语言来说明不同的概念，Golang和PHP。如果你不认识他们，别担心！这些例子简单明了，易于理解。</p><p>我鼓励你在阅读的时候使用一些在线的PHP解释器和围棋操场，自己玩和试验。这将帮助你理解并帮助你把所有这些好的知识放入你的长期记忆中。</p><p>我不会在这里详述血淋淋的细节。正如您将看到的，很难概括特定于编程语言的东西。不过，本文将很好地概述大多数类型系统的常见属性。我们会从清澈的水逐步走到沼泽，所以带上你的橡皮靴，我们走吧！</p><p>类型系统由类型组成。我知道，这太让人兴奋了。这些类型也称为数据类型。他们是什么?。</p><p>首先，让我们澄清编程语言的语法和语义之间的区别。</p><p>例如。你母语的句法是一套规定句子结构的规则。对于许多口语来说，你需要一个主语和一个动词才能使你的句子正确。相反，编程语言具有不同的结构，如表达式、控制结构或语句。</p><p>例如，要使PHP中的if语句语法正确，您需要：</p><p>另一方面，语义是构式背后的意义。例如，IF语句的语义可以解释如下：</p><p>为什么我们需要语法和语义？它旨在与两种不同类型的实体进行通信：</p><p>回到我们的主题，类型可以将语义附加到数据。例如，在PHP中：</p><p>在数学中，65是整数集的一部分，因此PHP将值65视为整数类型。您的变量$INTEGER也具有值65，因此它也是一个整数。</p><p>当您将65赋给变量$INTEGER时，就为它赋予了我们在第二行声明它时没有的语义。此语义将让您知道可以对该变量执行哪些操作。</p><p>类型是一组值。对于整型，它将是一个小数范围。对于类型字符串，它将是一系列可能的字符串。</p><p>当您声明一个变量并为其赋值时，内存将以二进制形式保存它的值。我们的计数系统是十进制的，这意味着我们每天知道和使用的数字在二进制中有很大的不同：</p><p>&lt；？php$INTEGER=65；//十进制表示法printf(&#34；%d的二进制表示法：%b\n&#34；，$INTEGER，$INTEGER)；//=65：1000001的二进制表示法。</p><p>您的同事开发人员Dave在阅读这些行时充满了疑问。“像‘A’这样的角色是如何保存在记忆中的呢？”他想知道。“这不是一个数字！它不能用二进制表示！“。</p><p>戴夫是对的。按照ASCII标准，必须首先将字符转换为十进制数。然后，该ASCII码被保存在存储器中。</p><p>&lt；？php$INTEGER=65；printf(&#34；二进制表示形式：%b\n&#34；，$INTEGER)；//=&gt；二进制表示形式：1000001$CHARACTER=&#39；A&#39；；$ASCII=ORDER(&#39；A&#39；)；//&#39；A&#39；的ASCII代码。Printf(&#34；ASCII代码：%d\n&#34；，$ASCII)；//=&gt；ASCII代码：65打印f(&#34；二进制表示：%b\n&#34；，$ASCII)；//=&&gt;；二进制表示：1000001。</p><p>整数65和字符串‘A’在内存中具有相同的二进制表示！</p><p>戴夫很困惑。他绝望地问天空：“见鬼，我们的程序怎么知道$INTEGER等于65，$CHARACTER等于&#39；A‘？怎样做？“。实际上，在内存中，$CHARACTER和$INTEGER这两个值完全相同：1000001。当您在代码中使用这两个变量时，语言的类型系统将解释内存中的这两个值，它将决定什么是字符，什么是整数。</p><p>理解这一点很重要，因为这种解释对于某些类型(如浮点数)并不总是准确的。</p><p>类型还将决定如何在内存中存储值。对于字符和整数，我们看到它们的存储方式相同。例如，存储浮点数的方式就非常不同。</p><p>对于开发人员来说，类型系统很好地抽象了内存存储，不需要考虑这些混淆的0和1，这样您就可以专注于更重要的问题。至少在抽象不泄露的情况下是这样。如果您不确定什么是抽象，我写了一篇关于它的文章。</p><p>类型系统也是一组规则，或多或少都很严格。你不能对某些类型做任何你想做的事。</p><p>&lt；？PHP printf((3+&#34；Hello World！&#34；)。&#34；\n&#34；)；//=&gt；PHP警告：在/home/myusername/phpgooies/test.php第3行//=&gt；3printf(&#34；执行继续！&#34；)；//=&gt；继续执行！</p><p>这段代码没有什么意义。我试图通过将整数3加到字符串上来重新发明数学。PHP将抛出警告，但仍会给出结果3.当您违反类型系统的规则时，结果可能介于这两个极端之间：</p><p>在我们的示例中，PHP将抛出警告，但执行仍将继续。您甚至可以消除臭名昭著的php.ini中的警告。</p><p>为了与另一种语言进行比较，让我们以Golang中完全相同的内容为例：</p><p>包主要导入(&#34；fmt&#34；)func main(){fmt.。Println(3+&#34；Hello World&#34；)//=&gt；无效操作：3+&#34；Hello World&#34；(不匹配的类型非类型化int和非类型化字符串)fmt。Println(&#34；继续执行！&#34；)}</p><p>编译器会给你一个错误，你的程序甚至不会被编译。</p><p>编程语言通常有一整套开箱即用的类型。这些类型称为基元类型。例如：整型、布尔型、浮点型等等。</p><p>通常，您还可以使用复合类型，即包含多个值的类型，可能还可以使用多个基元类型。这也是我们所说的数据结构。数组是复合类型：</p><p>附加到这些数据类型的规则由您选择的语言的编译器(或解释器)强制执行。</p><p>自从抽象数据类型(ADT)出现以来，您就有能力在高级编程语言中创建自己的类型。例如，在PHP中：</p><p>当您编写$Shipping=new Shipping()时，您将创建类Shipping的一个实例。对象$SHIPTING也可以被视为类型为SHIPTING。</p><p>我们还可以说，$Shipping是它的类的抽象，它的接口(您与抽象交互的方式)是方法send()。</p><p>在Golang中，您没有类，但也可以创建自定义类型：</p><p>程序包主导入(&#34；fmt&#34；)类型分钟int func(m分钟)秒()int{return int(M)*60}func main(){var min=2 fmt。Printf(&#34；%d分钟是%d秒&#34；，分钟，分钟。Second())//2分钟等于120秒}。</p><p>在这种情况下，新类型Minint将获得与类型int相同的规则集。然后，您可以将方法附加到这个新类型Minint，就像方法Second()一样。</p><p>如果类型迫使我们遵守某些规则，编程语言需要一个算法来检查我们是否遵守它们。这称为类型检查。</p><p>即使类型系统可能非常相似，也可能非常不同，这取决于编程语言，但我们是人，所以我们需要将这些完全不同的东西分类以理解它们。</p><p>类型检查有两个重要类别：静态类型检查和动态类型检查。它们主要是关于类型检查算法何时验证您的代码。仅此而已。</p><p>对于动态类型系统，类型检查将在运行时(当计算机执行您的代码时)进行。</p><p>如果您的编程语言没有任何静态类型检查，通常会说它是一种“动态类型语言”。</p><p>如果您不尊重数据类型的规则，则需要执行代码，以便类型检查器检测错误并采取相应行动(抛出警告、停止执行等)。</p><p>对于静态类型系统，类型检查在运行时之前、编译期间进行。在这一点上，如果编译器强加给您的类型的规则得不到遵守，您很可能永远也不会编译您的程序。</p><p>这意味着编译器需要知道程序中使用的每个数据的确切数据类型，然后才能运行它。当数据类型只能在运行时确定时，这可能是一个问题。这就是为什么静态类型语言通常也有一些动态类型检查的原因！</p><p>尽管如此，如果类型主要是在编译时检查的，我们可以说编程语言是“静态类型的”。</p><p>由于大多数类型不需要在运行时进行检查，因此程序的性能通常会更好。编译器可以优化您的代码，因为它知道类型系统的规则是受尊重的。</p><p>就目前而言，在打字之地，一切看起来都很好，而且井井有条。然而，世界并不是一成不变的，我们的代码库也不是一成不变的。情况会发生变化，我们的类型通常也需要在运行时进行更改。</p><p>让我们举另一个微不足道的例子。您想在您梦幻般的电子商务上展示一些价格，如下所示：</p><p>&lt；？PHP ECHO&#34；&lt；p&gt；嘿！买我的鱼吧！现在!。这是价格：34；。65岁。&#34；欧元&lt；/p&gt；&#34；；</p><p>您会注意到这里混合了两种类型：整数(65)和字符串(所有内容都用双引号引起来)。PHP解释器的类型检查器理解您希望将整数65更改为字符串，因此它会自动执行此操作，而不会询问您。</p><p>这就是所谓的胁迫。解释器(或编译器)不会显式地告诉您发生了类型更改，但无论如何都会发生。</p><p>包主要导入(&#34；fmt&#34；)func main(){fmt.。Println(&#34；&lt；p&gt；嘿！买我的鱼吧！现在!。这里是价格：&#34；+65+&34；欧元/p&&gt;；&34；)//=&&gt;；无效操作：&#34；&lt；p&&gt;；嘿！买我的鱼吧！现在!。这里是价格：+65(不匹配的类型非类型化字符串和非类型化整型)}。</p><p>这一次，类型检查器将在编译时抛出一个错误。你的程序永远不会编译，你的电商不会卖鱼，告别财富和荣耀吧。</p><p>编程语言并不总是隐式地为您更改类型，当它们这样做时，您需要意识到后果。当然，我们的示例很琐碎(否则您不会再阅读本文)，但是真正的代码库要复杂得多。</p><p>另一方面，您可以显式更改类型，这意味着类型更改将在代码中明确指示。这通常称为类型转换。</p><p>&lt；？PHP ECHO&#34；&lt；p&gt；嘿！买我的鱼吧！现在!。这是价格：34；。(字符串)65。&#34；欧元&lt；/p&gt；&#34；；</p><p>包主要导入(&#34；fmt&#34；)func main(){fmt.。Println(&#34；&lt；p&gt；嘿！买我的鱼吧！现在!。这里是价格：&#34；+string(65)+&#34；欧元/p&gt；&34；)}。</p><p>这一次，它成功了！Golang对类型转换很满意，但不支持类型强制。</p><p>在某些语言(如PHP)中，您可以通过赋值直接定义变量的类型：</p><p>&lt；？PHP$BeautufulInt=65；$myString=&#34；Hello&#34；；$isItReallyTrue=true；$aCompositeType=[]；echo gettype($BeautifulInt)。&#34；\n&#34；；//=&gt；整数回显gettype($myString)。&#34；\n&#34；；//=&gt；String echo gettype($isItReallyTrue)。&#34；\n&#34；；//=&gt；布尔回显gettype($aCompositeType)。&#34；\n&#34；；//=&gt；数组。</p><p>在声明每个变量时，您不需要精确地指定它们的类型。PHP解释器将在运行时为您执行此操作，具体取决于变量的值。这称为类型推断。</p><p>软件包main import(&#34；fmt&#34；&#34；)func main(){BeauufulInt：=65 myString：=&#34；hello&#34；isItReallyTrue：=true fmt。Println(反射。Typeof(Beauty Int))//=&gt；int fmt。Println(反射。Typeof(MyString))//=&gt；String fmt。Println(反射。Typeof(IsItReallyTrue)//=&gt；bool}。</p><p>在某些语言中，声明变量时需要显式键入变量。在其他语言(如PHP)中，您不能这样做。某些编程语言(如Golang)可以让您同时做到这两点：</p><p>程序包主导入(&#34；fmt&#34；&#34；reflect&#34；)func main(){BeautifulInt：=65 var explitBeautifulInt int=65 fmt。Println(反射。Typeof(Beauty Int))//=&gt；int fmt。Println(反射。Typeof(ExplitBeautifulInt)//=&gt；int}。</p><p>对于变量EXPLICIT BeautifulInt，显式声明了一个类型int。该类型成为编程语言本身的语法的一部分。</p><p>您可以在某些语言中声明函数参数的类型，也可以声明函数输出的类型。</p><p>&lt；？PHP函数CoolFunction($CoolThing){return&#34；我认为是&#34；。$CoolThing。&#34；是一个很酷的东西！&#34；；}ECHO COOL Function(&#34；Daffodil&#34；)；</p><p>同样，函数的输入和输出没有显式类型声明。但是，这一次，如果需要，您可以添加它：</p><p>&lt；？PHP函数CoolFunction(String$CoolThing)：String{return&#34；我认为是&#34；。$CoolThing。&#34；是一个很酷的东西！&#34；；}ECHO COOL Function(&#34；Daffodil&#34；)；</p><p>在这里，我们显式声明$CoolThing并将返回值声明为字符串。当声明函数参数的类型是可选的时，我们通常称之为类型提示。</p><p>&lt；？PHP函数CoolFunction(String$CoolThing)：String{return&#34；我认为是&#34；。$CoolThing。&#34；是很酷的东西！&#34；；}ECHO CoolFunction(65)；//=&gt；我认为65是很酷的东西！</p><p>PHP解释器将强制将您的值从整数转换为字符串。如果您返回65而不是字符串，它也会被强制。</p><p>您必须声明输入和输出的类型，否则将抛出错误。</p><p>Package main import(&#34；fmt&#34；)func CoolFunction(CoolThing String)String{return&#34；我认为a&#34；+CoolThing+&#34；是很酷的东西！&#34；}func main(){fmt。Println(CoolFunction(&#34；Daffodil&34；))//=&gt；我认为水仙花是很酷的东西！}</p><p>如果您不给CoolFunction一个字符串，您会得到一个错误。如果CoolFunction返回字符串以外的任何内容，您也会得到一个错误。</p><p>一些开发人员会根据类型系统的不同属性将语言分类为“强”或“弱”；例如，如果类型系统强制您的值。但似乎没有人对什么应该是“强”或“弱”有相同的定义，这使得辩论变得困难。</p><p>我对工具龙也是这么想的。但是正如我们所看到的，Golang是一种静态类型语言，但是您可以隐式类型声明。Python是动态类型的，但不做太多强制。简而言之，上面的映射是错误的。</p><p>我认为围绕编程语言的健康辩论是有益的。决定什么是解决手头问题的最好工具是至关重要的，我们经常从这些讨论中进行教学和学习。开发人员通常对他们的工艺充满热情，这绝对是一个好观点！</p><p>然而，谈论“弱”或“强”语言是令人困惑的，因为它们的定义是模糊的。取而代之的是，我们应该使用上面看到的词汇，具体说明我们喜欢打字系统中的什么，以及为什么它比另一个打字系统更好。这会增加谈话的精确性和清晰的含义。</p><p>当人们谈到“弱类型”和“强类型”语言时，通常指的是语言的类型安全。一般来说，它是您的编译器或解释器检查类型错误的“次数”，以及将它们扔到您的脸上的频率。</p><p>这个“多少”也没有很好的定义。另外，和往常一样，这取决于编程语言，甚至取决于您使用的编程语言的版本。例如，使用最新版本的PHP，您可以这样做：</p><p>&lt；？PHP DECLARE(STRICT_TYES=1)；ECHO&#34；我的名字是&#34；。65岁。&#34；\n&#34；；//这不会引发错误//=&gt；我的名字是65 Function CoolFunction(String$CoolThing)：string{return&#34；我认为是&#34；。$CoolThing。&#34；是一个很酷的东西！&#34；；}ECHO CoolFunction(65)；//=&gt；PHP致命错误：未捕获TypeError：传递给CoolFunction()的参数1必须是字符串类型，int给定</p><p>另一方面，严格的类型系统可能会在您的设计中造成一些僵化，这将使代码在混乱的现实世界(上下文)演变时更难更改。尽管如此，它们仍将有助于避免整个类别的错误。</p><p>这就是为什么您应该学习您选择的语言如何处理类型。在官方文件中可以看到这一点。用它做实验。试着找出最终的不一致之处和陷阱。如果您感兴趣，我为PHP7写了一篇关于这方面的文章。</p><p>即使您使用相同的编程语言多年，这个建议仍然有效。语言就像软件一样，是要进化的。保持为。</p><p>.</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://thevaluable.dev/type-system-explained/">https://thevaluable.dev/type-system-explained/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/说明/">#说明</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/systems/">#systems</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/类型/">#类型</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>