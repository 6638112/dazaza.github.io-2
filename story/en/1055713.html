<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>此博客现在托管在GPS / LTE调制解调器上 This Blog is now hosted on a GPS/LTE modem</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">This Blog is now hosted on a GPS/LTE modem<br/>此博客现在托管在GPS / LTE调制解调器上 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-04-02 16:36:09</div><div class="page_narrow text-break page_content"><p>No, really. Despite the timing of this article, this is not an April Fool’s joke.</p><p>不完全是。尽管这篇文章的时间，但这不是愚人节的笑话。</p><p>   [ 25.476857] modem-power serial1-0: ADB KEY is &#39;41618099&#39; (you can use it to unlock ADB access to the modem)</p><p>   [25.476857]调制解调器电源Serial1-0：adb键是＆＃39; 41618099＆＃39; （您可以使用它来解锁对调制解调器的ADB访问）</p><p> For context, the PinePhone has a  Quectel EG25-G modem, which handles GPS and wireless connectivity for the PinePhone. This piece of hardware is one of the few components on the phone  which is closed-source.</p><p> 对于上下文，PinePhone具有REGECEL EG25-G调制解调器，其处理PINEPHONE的GPS和无线连接。这块硬件是手机上的少数组件之一，闭合源。</p><p> When I saw that message and the mention of ADB, I immediately thought of Android Debug Bridge, the software commonly used to communicate with Android devices. “Surely,” I thought, “it can’t be talking about  that ADB”. Well, turns out it is.</p><p> 当我看到该消息和提及亚行时，我立即想到了Android调试桥，该软件常用于与Android设备进行通信。 “当然，”我想，“它不能谈论亚洲人”。好吧，结果是。</p><p> The message links to  an article which details the modem in question. It also links to an  unlocker utility which, when used, prints out AT commands to enable  adbd on the modem.</p><p> 消息链接到文章，详细介绍了有问题的调制解调器。它还链接到解锁器实用程序，当使用时，在命令中打印出在调制解调器上启用adbd。</p><p>    For whatever reason, my input wasn’t being echoed back, but the screen session printed out “OK” twice, indicating it had executed the commands fine.</p><p>    无论何种原因，我的输入都没有回声，但屏幕会话打印出“确定”两次，表示它已执行命令精细。</p><p> After setting up proper  udev rules and  adb on my “host machine”, which is the PinePhone, the modem popped up in the output for  adb devices, and I could drop into a shell:</p><p> 在“主机”上设置正确的UDEV规则和adb后，该规则是Pinephone的，调制解调器在adb设备的输出中弹出，我可以丢弃shell： </p><p>   It turns out the modem runs its own OS totally separate from the rest of the PinePhone OS. With the latest updates, it runs Linux 3.18.44.</p><p>事实证明，调制解调器运行其自己的操作系统完全分开了与PinePhone OS的其余部分分开。使用最新更新，运行Linux 3.18.44。</p><p>  For whatever reason, I thought it’d be fun to run my blog on this thing. Since we were working with limited resources (around 48M of space and the same amount of memory), and the fact that my blog is just a bunch of static files, I decided that something like nginx (as lightweight as it is) would be a bit overkill for my purposes.</p><p>  无论出于什么原因，我都认为在这件事上运行我的博客很有趣。由于我们正在使用有限的资源（大约4800万个空间和​​相同数量的内存），并且我的博客只是一堆静态文件，我决定像Nginx（像它一样轻量级）这样的东西是一个为我的目的有点矫枉过正。</p><p> darkhttpd seemed to fit the bill well. Single binary, no external dependencies, does GET and HEAD requests only. Perfect.</p><p> Darkhttpd似乎适合账单。单个二进制，没有外部依赖项，只得到和头部请求。完美的。</p><p> I used the  armv7l-linux-musleabihf-cross toolchain to cross compile it for ARMv7 and statically link it against musl.  adb push let me easily push the binary and my site assets to the modem’s  /usrdata directory, which seems to have a writable partition about 50M big mounted on it.</p><p> 我使用了ARMV7L-Linux-Musleabihf-Crosschain，将其交叉编译为ARMv7并静态将其与Musl联系起来。 adb推送让我轻松推动二进制和我的网站资产到调制解调器/ usrdata目录，这似乎有一个约50米大安装在它的可写分区。</p><p> The HTTP server works great. I decided to use ADB to expose the HTTP port to my PinePhone:</p><p> HTTP服务器很棒。我决定使用adb将HTTP端口公开到我的Pinephone：</p><p>  As ADB-forwarded ports are only bound to the loopback interface, I also manually exposed it to external connections:</p><p>  由于adb转发端口仅绑定到环回接口，我还手动将其暴露于外部连接：</p><p> #  sysctl  -w net.ipv4.conf.all.route_localnet =1 #  iptables  -t nat  -I PREROUTING  -p tcp  --dport 8080  -j DNAT  --to-destination 127.0.0.1:8080</p><p> #sysctl -w net.ipv4.conf.all.route_localnet = 1＃iptables -t nat -i prerouting -p tcp --dport 8080 -j dnat --to-destination 127.0.0.1：8080 </p><p>   I ran  iperf over ADB port forwarding just to see what kind of throughput I get.</p><p>我在adb端口转发时ran iperf over to看我得到什么样的吞吐量。</p><p> $  iperf  -c localhost ------------------------------------------------------------Client connecting to localhost, TCP port 5001TCP window size: 2.50 MByte (default)------------------------------------------------------------[ 3] local 127.0.0.1 port 44230 connected with 127.0.0.1 port 5001[ ID] Interval Transfer Bandwidth[ 3] 0.0-10.6 sec 14.4 MBytes 11.4 Mbits/sec</p><p> $ iperf -c localhost --------------------------------------- ---------------连接到LocalHost，TCP端口5001TCP窗口大小：2.50 MBYTE（默认）----------------- ------------------------------------ [3]本地127.0.0.1端口44230连接127.0.0.1端口5001 [ID]间隔传输带宽[3] 0.0-10.6秒14.4 MBYTES 11.4 MBITS / SEC</p><p>  The PinePhone itself is connected to the network over USB (side note: I had to  remove two components from the board to get USB networking to work). Out of interest, I ran  iperf over that connection as well:</p><p>  PINEPHONE本身通过USB连接到网络（侧面注意：我必须从板上删除两个组件以获得USB网络工作）。出于兴趣，我也在那个连接中运行IPerf：</p><p> $ iperf -c 10.15.19.82------------------------------------------------------------Client connecting to 10.15.19.82, TCP port 5001TCP window size: 136 KByte (default)------------------------------------------------------------[ 3] local 10.15.19.100 port 58672 connected with 10.15.19.82 port 5001[ ID] Interval Transfer Bandwidth[ 3] 0.0-10.4 sec 25.8 MBytes 20.7 Mbits/sec</p><p> $ iperf -c 10.15.19.82 ------------------------------------ ----------------客户端连接到10.15.19.82，TCP端口5001TCP窗口大小：136千字节（默认）-------------- ------------------------------------- [3]本地10.15 .19.100端口58672连接10.15.19.82端口5001 [ID]间隔传输带宽[3] 0.0-10.4秒25.8 MBYTES 20.7 MBITS / SEC</p><p> Although I was expecting more, it doesn’t really matter, as I was bottlenecking at the ADB-forwarded connection.</p><p> 虽然我期待更多，但它并不重要，因为我在亚行转发的联系时是瓶颈。</p><p>  I wonder how secure the modem is. It turns out a lot of AT commands  use  system() on the modem. I suspect some of those AT commands may be vulnerable to command injection, but I haven’t looked into this further. It also doesn’t really matter when dropping into a root shell using ADB is this easy.</p><p>  我想知道调制解调器是如何安全。它在调制解调器上拒绝了很多AT命令使用System（）。我怀疑某些人的命令可能很容易受到命令注射，但我还没有进一步调查这一点。当使用adb丢弃到根外壳时，它也并不重要这就是这种简单。</p><p> At first glance, this seems like a perfect method to obtain persistence for malware. With root access on the host system, malware could implant itself into the modem, which would enable it to survive reinstalls of the host OS, and snoop on communications or track the device’s location. Some of the impact is alleviated by the fact that all interaction with the host OS happens over USB and I2S and only if the host OS initiates it, so malware in the modem couldn’t directly interact with the host OS.</p><p> 乍一看，这似乎是一个完美的方法来获得恶意软件的坚持。通过主机系统的root访问权限，恶意软件可以将自己植入到调制解调器中，这将使它能够存活重新安装主机操作系统，并侦听通信或跟踪设备的位置。通过与主机OS的所有交互在USB和I2S发生的情况下，且仅当主机操作系统启动时，因此才能使Morwware无法与主机操作系统直接交互。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://nns.ee/blog/2021/04/01/modem-blog.html">https://nns.ee/blog/2021/04/01/modem-blog.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/现在/">#现在</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/hosted/">#hosted</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/调制解调器/">#调制解调器</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>