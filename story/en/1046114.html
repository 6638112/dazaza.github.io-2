<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>使Win32 API更易于访问更多语言 Making Win32 APIs More Accessible to More Languages</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Making Win32 APIs More Accessible to More Languages<br/>使Win32 API更易于访问更多语言 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-01-24 12:24:25</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/1/7a53792b19d63d2ee4aeb74637d0edae.jpg"><img src="http://img2.diglog.com/img/2021/1/7a53792b19d63d2ee4aeb74637d0edae.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Win32 APIs provide powerful functionality that let you get the most out of Windows in your applications. While these APIs are readily accessible to C and C++ developers, other languages like C# and Rust require wrappers or bindings in order to access these APIs. In C#, this is commonly known as platform invoking or P/Invoke.</p><p>Win32 API提供了强大的功能，可让您在应用程序中充分利用Windows。虽然C和C ++开发人员可以轻松访问这些API，但其他语言（如C＃和Rust）则需要包装或绑定才能访问这些API。在C＃中，这通常称为平台调用或P /调用。</p><p> Historically this has required developers to handcraft the wrappers or bindings, which is error prone and doesn’t scale to broad API coverage. In recent years, given the strong demand for calling Win32 APIs from various languages, several community projects have spawned to provide more strongly typed and idiomatic representations of these wrappers and bindings to provide an improved developer experience and spare developers the overhead of creating them themselves. Some notable projects include   PInvoke for .NET and   winapi-rs  for Rust.</p><p> 从历史上看，这要求开发人员手工包装或绑定，这很容易出错，并且无法扩展到广泛的API覆盖范围。近年来，由于强烈要求从各种语言调用Win32 API，因此催生了几个社区项目，以提供这些包装和绑定的更强类型和惯用的表示形式，以提供改进的开发人员体验，并节省开发人员自己创建它们的开销。一些值得注意的项目包括用于.NET的PInvoke和用于Rust的winapi-rs。</p><p> The main challenge with these projects is they are manually maintained, which makes broad and sustained API coverage difficult and costly, and their work doesn’t really benefit other languages.</p><p> 这些项目的主要挑战在于它们是手动维护的，这使得覆盖范围广且持续的API变得困难且成本高昂，而且它们的工作并没有真正使其他语言受益。</p><p> As owners of the Windows SDK, we wanted to see where we could provide unique value here, take some of the burden off of the community, and make achieving broad and sustainable API coverage across languages a reality.</p><p> 作为Windows SDK的所有者，我们希望看到可以在此处提供独特价值的地方，减轻社区的负担，并使跨语言的广泛且可持续的API覆盖成为现实。</p><p> The result of this is our   win32metadata  project and corresponding Win32 language projections now in preview on GitHub!</p><p> 结果是我们的win32metadata项目和相应的Win32语言投影现在可以在GitHub上预览了！</p><p>  The goal of the   win32metadata  project is to provide a complete description of the Win32 API surface in metadata so that it can be projected to any language in an automated way, improving correctness and minimizing maintenance overhead. The output of this project is effectively an ECMA-335 compliant Windows metadata file (winmd) published to Nuget.org containing metadata describing the entire Win32 API surface.</p><p>  win32metadata项目的目标是在元数据中提供Win32 API表面的完整描述，以便可以自动方式将其投影到任何语言，从而提高准确性并最大程度地减少维护开销。该项目的输出实际上是发布到Nuget.org的，兼容ECMA-335的Windows元数据文件（winmd），其中包含描述整个Win32 API表面的元数据。</p><p> Win32 APIs have existed for a long time, so accurately describing all of them will take some iteration. We will be developing this tooling in the open and welcome community contributions to ensure an accurate representation of the Win32 API surface that will benefit all languages.</p><p> Win32 API已经存在很长时间了，因此准确描述所有这些API将需要一些迭代。我们将在开放的欢迎社区中开发此工具，以确保Win32 API表面的准确表示，这将使所有语言受益。 </p><p> For this metadata to enable developers to call Win32 APIs idiomatically from the language of their choice, we need language projections built on top of it. The first such language projection is   C#/Win32 .</p><p>为了使元数据能够使开发人员从他们选择的语言中惯用地调用Win32 API，我们需要在其之上构建语言投影。第一个这样的语言投影是C＃/ Win32。</p><p>    The   Rust language projection  follows in the tradition established by   C++/WinRT  of building language projections for Windows using standard languages and compilers, providing a natural and idiomatic way for Rust developers to call Windows APIs. The   windows  crate lets you call any Windows API using code generated on the fly directly from the metadata, enabling you to call the APIs as if they were just another Rust module. It does not attempt to partition Windows APIs by technology, instead providing a single way to call any Windows API regardless of the underlying technology. You can seamlessly make use of APIs based on C-style exports, COM interfaces, or WinRT types.</p><p>    Rust语言投影遵循C ++ / WinRT建立的传统，即使用标准语言和编译器为Windows构建语言投影，从而为Rust开发人员调用Windows API提供了自然而惯用的方式。 Windows crate可让您使用直接从元数据中即时生成的代码来调用任何Windows API，从而使您可以像调用其他API一样调用这些API。它不会尝试按技术对Windows API进行分区，而是提供一种调用任何Windows API的单一方法，而与底层技术无关。您可以无缝使用基于C样式导出，COM接口或WinRT类型的API。</p><p>  In addition to   C#  and   Rust , we are also working on a   Modern C++  projection in the open on GitHub and welcome community contributions there. These projects are early previews and under active development so are subject to change significantly as we absorb feedback and make progress. We will work with the community to support other languages based on   demand , partnering with existing community projects where appropriate.</p><p>  除C＃和Rust外，我们还在GitHub上公开进行Modern C ++投影，并欢迎社区的贡献。这些项目是早期预览，并且正在积极开发中，因此随着我们吸收反馈并取得进展，它们可能会发生重大变化。我们将与社区合作，根据需求支持其他语言，并在适当情况下与现有社区项目合作。</p><p> Under the umbrella of the   win32metadata  project, we hope to advocate a set of   principles  that all language projections should follow for the best developer experience while providing flexibility for each projection to do what’s best for their community.</p><p> 在win32metadata项目的保护下，我们希望倡导一套原则，所有语言投射都应遵循，以获取最佳开发人员体验，同时为每种投射提供灵活性，以尽其所能为社区带来最大利益。</p><p>  Making Win32 APIs more accessible to more languages will allow developers to make the most out of Windows regardless of their preferred language. We are excited to engage with the community to expand API coverage and language support and minimize the maintenance overhead of existing projects.</p><p>  使Win32 API更易于使用更多语言，这将使开发人员可以充分利用Windows，而无需考虑其首选语言。我们很高兴与社区合作，以扩展API覆盖范围和语言支持，并最大程度地减少现有项目的维护开销。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blogs.windows.com/windowsdeveloper/2021/01/21/making-win32-apis-more-accessible-to-more-languages/">https://blogs.windows.com/windowsdeveloper/2021/01/21/making-win32-apis-more-accessible-to-more-languages/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/win32/">#win32</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/语言/">#语言</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>