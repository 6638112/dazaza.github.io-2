<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>“扩展随机”的奇怪故事 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">“扩展随机”的奇怪故事 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-06 22:58:10</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/3a1e7bf200479f8190c7d627b2637e27.jpg"><img src="http://img2.diglog.com/img/2021/2/3a1e7bf200479f8190c7d627b2637e27.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>昨天，大卫·本杰明（David Benjamin）在IETF的TLS邮件列表中发布了一个非常神秘的说明。从表面上看，这篇文章描述了老式佳能打印机中一些引起癫痫发作的缺陷。对大多数人来说，这是一个完全的贪睡。然而，对我和我的一些同事来说，就像X文件中的那个场景一样，Mulder和Scully最终了解到外星人是真实的。</p><p> 这些僵化的打印机证实了我们在2014年开发的一种理论，但无法证明：即RSA的BSAFE TLS库中存在名为``扩展随机''的特定功能-我们认为这是共同努力的证据由美国国家安全局（NSA）使用后门美国密码技术。</p><p> 在开始详细介绍之前，我想以两种不同的方式对这篇文章加以说明。首先，我对加密后门的话题写得太多了。 2013年，斯诺登（Snowden）的泄密事件揭露了一场破坏美国加密系统的运动。从那时起，密码学家花费了数千个小时来识别，记录和试图说服人们关心这些后门。我们很累，我们想做更多有用的事情。</p><p> 第二点警告涉及加密后门的任何讨论问题。具体来说，您永远不会真正获得绝对的证明。总是有一些天真的或偶然的解释可能符合证据，也许这都是愚蠢的错误。因此，您寻找巧合不太可能的模式，并经常使用Occam的剃须刀。您不会每天得到斯诺登。</p><p> 综上所述，让我们谈谈扩展随机性，以及这如何告诉我们有关NSA的信息。首先介绍一些背景。</p><p>  要了解此发现的上下文，您需要了解一种称为Dual EC DRBG的标准。这是美国国家安全局（NSA）在2000年代初期开发的一种提议的随机数发生器。 NIST在2007年对它进行了标准化，后来将其部署在一些重要的密码产品中，尽管当时我们还不知道。</p><p> Dual EC有一个主要问题，那就是它可能包含一个后门。 Shumow和Ferguson在2007年指出了这一点，并在2013年Snowden泄漏中得到了有效证实。 NIST通过取消该标准做出了回应。 （有关Dual EC后门的说明，请参见此处。） </p><p>大约在这个时候，全世界都知道RSA Security已将Dual EC设为其流行的密码库（称为BSAFE）中的默认随机数生成器。 RSA并没有完全保密，但是这样做实在是一件令人毛骨悚然的事情，在加密社区中没人知道。因此，多年来RSA都使用这种疯狂的算法向其库提供了支持，该算法已进入各种商业设备。</p><p> 但是，RSA戏剧还没有结束。 2013年末，路透社报道称RSA已拿出1000万美元用于后门软件。 RSA对此有所否认。或者其他的东西。还不清楚。</p><p> 无论意图如何，众所周知RSA BSAFE确实包含了Dual EC。当然，这可能是一个无辜的决定，因为Dual EC是NIST标准。为了阐明这个问题，在2014年，我和我的同事决定对BSAFE库进行反向工程，以查看所谓的Dual EC中的后门是否实际上可被NSA等攻击者利用。我们认为，图书馆设计师做出的具体工程决策可能会有益于以一种方式或另一种方式扩展规模。</p><p>   在对Java版本的BSAFE进行反向工程的过程中，我们发现了一个有趣的内容。具体来说，我们发现BSAFE支持TLS协议的非标准扩展，称为“扩展随机”。</p><p> 扩展随机扩展名是由NSA雇员Margaret Salter（有时是NSA信息保证局局长，负责国防部的``防御性''加密货币）提出的IETF草案，Eric Rescorla是承包商。 （很明显，埃里克被雇用来制定一份不会损害TLS的体面的提议，并且主要用于政府机器上。美国国家安全局（NSA）没有与他分享他们的动机。）</p><p> 请务必注意，扩展随机数本身不会引入任何加密漏洞。它所做的只是增加TLS协议连接中使用的随机数据（“随机数”）的数量。这一点根本不会伤害TLS，此外它主要用于美国政府的计算机。</p><p> 关于扩展随机的唯一有趣的事情是使用Dual EC算法生成随机数据时发生的情况。具体来说，这些额外的数据充当“火箭燃料”，大大提高了利用Dual EC后门解密TLS连接的效率。 </p><p>简而言之，如果您是像NSA这样的机构，试图使用Dual EC作为后门来拦截通信，那么使用同时使用Dual EC DRBG和Extended Random的系统则要好得多。由于扩展随机数从未由IETF标准化，因此不应在任何系统中使用。实际上，据我们所知，BSAFE是世界上唯一实施该系统的系统。</p><p> 除了扩展随机，我们发现了多种功能，再加上Dual EC后门，可以使RSA BSAFE相当容易利用。但是到目前为止，扩展随机数是最奇怪，最难辩解的。</p><p> 那么这个标准是从哪里来的呢？对于那些喜欢技术奥秘的人来说，事实证明，“扩展随机”并不是国家安全局提出的唯一有趣的建议。实际上，这是NSA员工或与NSA紧密合作的承包商提出的四个失败的IETF提案之一，所有这些提案都试图提高TLS的随机性。托马斯·帕塔塞克（Thomas Ptacek）在这些帖子中对这些建议及其动机提出了令人费解的头脑。</p><p> 噢，天哪，我从没想过间谍会这么无聊。最新发展是什么？</p><p> 尽管我们在RSA BSAFE（我们从互联网下载的免费版本）中找到了Extended Random，但美中不足的是它实际上并未启用。那就是：代码在那里，但是启用它的开关被硬编码为“关闭”。</p><p> 这种做法在我们的理论上大有裨益，认为RSA可能包含扩展随机数，以使BSAFE连接更易于被NSA利用。可能有一些商业版本的BSAFE可以激活此代码，但我们始终无法找到它或证明它存在。更糟糕的是，它可能只会出现在某些特殊的“美国BSAFE的“仅政府”版本，这往往会破坏有关包含此规范的某些意图的理论-毕竟，政府为什么要自我监视？</p><p> 最后，这使我们了解到前几天出现在TLS邮件列表中的新闻。事实证明，某些佳能打印机无法正确响应使用新版TLS（称为1.3）建立的连接，因为它们似乎实现了未经授权的TLS扩展，其扩展名与TLS 1.3所需的扩展名相同。为了正确操作。这是David帖子的相关部分： </p><p>简而言之，此消息似乎表明RSA BSAFE的商业（非免费）版本确实部署了Extended Random扩展，并使其在第三方商业产品中有效。此外，他们专门将其部署到了机器上，尤其是现成的商用打印机，这些机器似乎并没有为政府的任何特殊用途保留。</p><p> （如果这些证明是国防部的特殊打印机，我会吃掉我的话的。）</p><p> 具有讽刺意味的是，打印机是现在唯一仍然具有此BSAFE版本（现已弃用）功能的东西。这不是因为NSA是针对打印机。他们针对的任何设备可能现在都已经消失了。这是因为打印机固件趋于过时而又持久。这就像是一个埋在北极圈下的远程池，其中保留了本来可以从互联网上消失的软件种类。</p><p> 这带给我们故事的寓意：加密后门不仅是一个可怕的主意，而且还完全破坏了为协议的未来版本分配的编号系统。</p><p> 其实不，这是非常无用的道德。相反，我们只能说您可以部署加密后门，但是很难控制它的最终位置。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.cryptographyengineering.com/2017/12/19/the-strange-story-of-extended-random/">https://blog.cryptographyengineering.com/2017/12/19/the-strange-story-of-extended-random/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/奇怪/">#奇怪</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/story/">#story</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/tls/">#tls</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1046781.html"><img src="http://img2.diglog.com/img/2021/1/thumb_b4028eb79611c64f7158bd005f25f06b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1046781.html">产生立方便便的是袋熊的奇怪肠子，而不是肛门 </a></div><span class="my_story_list_date">2021-1-30 4:41</span></div><div class="col-sm"><div><a target="_blank" href="/story/1042269.html"><img src="http://img2.diglog.com/img/2020/12/thumb_a46eef9f2253251b47b557c43e59f18e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1042269.html">2020年真正的，奇怪的布卡蒂尼短缺 </a></div><span class="my_story_list_date">2020-12-29 4:44</span></div><div class="col-sm"><div><a target="_blank" href="/story/1042107.html"><img src="http://img2.diglog.com/img/2020/12/thumb_43d00b3d1d028b90ca81ee6d2f7c01d4.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1042107.html">太阳系外的奇怪空间 </a></div><span class="my_story_list_date">2020-12-28 7:5</span></div><div class="col-sm"><div><a target="_blank" href="/story/1038484.html"><img src="http://img2.diglog.com/img/2020/12/thumb_93570e7d691dc83c90d948dc9d7aa94b.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1038484.html">被地球重新捕获的奇怪物体是来自Surveyor 2的1966年助推火箭 </a></div><span class="my_story_list_date">2020-12-9 5:5</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>