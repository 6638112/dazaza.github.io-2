<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Raspberry Pi上的鞭炮入门</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Raspberry Pi上的鞭炮入门</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-24 00:14:37</div><div class="page_narrow text-break page_content"><p>传统上，服务是在裸机上部署的，在过去的几十年中，我们看到了虚拟化（在操作系统进程中运行其他操作系统）和最近的容器化（在与其他进程分开的安全上下文中运行操作系统进程）的兴起。同一主机）。虚拟化和容器化通过将某些操作系统功能移至客户系统来提供不同级别的隔离。</p><p>    在本文中，我将深入研究Firecracker，以及如何将其用于在Raspberry Pi（4B）上部署服务。</p><p>  这里没有几条路。首先，我将使用Ubuntu尝试简单的方法。稍后，我们将研究Alpine Linux的使用，它比Ubuntu轻巧得多，非常适合RPI之类的设备。</p><p>  我们需要一个64位的Ubuntu映像和一个microSD卡。对于成像，我使用Balena Etcher，它使成像过程变得异常简单。</p><p>   预安装意味着我们将拥有一个可以正常运行的操作系统，并且在启动后无需执行其他安装步骤。使用Balena Etcher，将压缩的图像文件写入sd卡并在准备好后启动系统非常容易。 SSHD在安装后启动，如果我们知道DHCP服务器发布给设备的IP地址（假设我们的LAN中存在DHCP服务器），则可以通过ssh登录。</p><p> 我通常删除的Ubuntu几乎没有什么烦人的东西（快照，无人值守的升级）。我也更喜欢在系统等效项上使用Chrony。这些的Ansible回购可在这里找到：https://github.com/l1x/rpi/blob/main/ubuntu.20/ansible/roles/os/tasks/main.yml</p><p>  Firecracker：主要组件，它是一个虚拟机监视器（VMM），它使用Linux内核虚拟机（KVM）创建和运行microVM。</p><p>Jailer：要在生产模式下启动Firecracker，请应用cgroup / namespace隔离屏障，然后放弃特权。那里</p><p>     Firectl的安装有点麻烦，因为没有发行二进制文件，并且需要Golang 1.14进行编译。我们可以分两个步骤完成这些操作。</p><p>      我们拥有运行第一个microVM所需的所有工具，唯一缺少的是：需要运行的东西。</p><p>    稍后，我们将研究如何创建自己的版本，但现在，我们将使用来自</p><p>   为了使microVM正常运行，我们需要一个网络设备。对于这种情况，我们将使用tap并创建一个设备：</p><p> sudo ip tuntap添加dev tap0模式tapsudo ip addr添加172.16.0.1/24 dev tap0 sudo ip链接集tap0 upip addr显示dev tap0</p><p> 如果要授予对虚拟机的访问权限，则必须启用IP转发：</p><p>DEVICE_NAME = eth0sudo sh -c“ echo 1> / proc / sys / net / ipv4 / ip_forward” sudo iptables -t nat -A POSTROUTING -o $ DEVICE_NAME -j MASQUERADEsudo iptables -A FORWARD -m conntrack --ctstate相关，成立- j接受sudo iptables -A FORWARD -i tap0 -o $ DEVICE_NAME -j接受</p><p>  这就是我们启动第一个microVM的方式。我通常在屏幕上启动它，因此我可以轻松地打开一个新会话，因为它将使用新启动的控制台的标准输入和输出（除非您将其重定向）。</p><p>         在启动通常的方式并登录后，我们需要修复一些问题：</p><p>    root @ fadfdd4af58a：〜＃apt update得到：1 http://ports.ubuntu.com/ubuntu-ports仿生InRelease [242 kB]得到：2 http://ports.ubuntu.com/ubuntu-ports仿生更新InRelease [ 88.7 kB]命中：3 http://ports.ubuntu.com/ubuntu-ports bionic-backports InReleaseHit：4 http://ports.ubuntu.com/ubuntu-ports bionic-security InReleaseGet：5 http：// ports。 ubuntu.com/ubuntu-ports仿生/宇宙arm64软件包[11.0 MB]获得：6 http://ports.ubuntu.com/ubuntu-ports仿生/多宇宙arm64软件包[153 kB]得到：7 http：// ports。 ubuntu.com/ubuntu-ports bionic / main arm64软件包[1285 kB]获取：8 http://ports.ubuntu.com/ubuntu-ports bionic / restricted arm64软件包[572 B] Get：9 http：// ports。 ubuntu.com/ubuntu-ports bionic-updates / universe arm64软件包[1865 kB] Get：10 http://ports.ubuntu.com/ubuntu-ports bionic-updates / restricted arm64软件包[2262 B] Get：11 http： //ports.ubuntu.com/ubuntu-ports bionic-updates / main arm64软件包[1431 kB]获取：12 http://ports.ubuntu.com/ubuntu-ports bionic-updates / mu ltiverse arm64软件包[5758 B]在6s（2543 kB / s）中获取16.1 MB正在读取软件包列表...错误！E：/ var / lib / dpkg / status上的flAbsPath失败-realpath（2：无此类文件或目录） E：无法打开文件-打开（2：无此类文件或目录）E：打开问题E：无法解析或打开包列表或状态文件。</p><p>    下次，我们将讨论如何编译新内核并使用不同的rootfs（可能使用Alpine）。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://dev.l1x.be/posts/2020/11/22/getting-started-with-firecracker-on-raspberry-pi/">https://dev.l1x.be/posts/2020/11/22/getting-started-with-firecracker-on-raspberry-pi/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/raspberry/">#raspberry</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1034992.html"><img src="http://img2.diglog.com/img/2020/11/thumb_cab52fc71ff9a4cc1b47f023f7733936.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1034992.html">一些树莓PI 4现在可以超锁到2.3 GHz。这就是如何做到这一点的</a></div><span class="my_story_list_date">2020-11-14 8:56</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033963.html"><img src="http://img2.diglog.com/img/2020/11/thumb_1162f33a467b6428f47d5e059547cf75.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033963.html">如何利用树莓派挖掘加密货币</a></div><span class="my_story_list_date">2020-11-9 9:46</span></div><div class="col-sm"><div><a target="_blank" href="/story/1033066.html"><img src="http://img2.diglog.com/img/2020/11/thumb_7b874496b8110227f7bd777cbb4a55f2.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1033066.html">设计覆盆子PI 400</a></div><span class="my_story_list_date">2020-11-4 6:56</span></div><div class="col-sm"><div><a target="_blank" href="/story/1032782.html"><img src="http://img2.diglog.com/img/2020/11/thumb_0d589b0131d5b63dba8d22600118cc5e.jpg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1032782.html">Raspberry Pi 400是一款内置计算机的紧凑型键盘</a></div><span class="my_story_list_date">2020-11-2 22:48</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>