<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Python模式匹配 Python Pattern Matching</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Python Pattern Matching<br/>Python模式匹配 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-17 18:07:50</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/e35239bcbf2199ee7fc7cced2fafd597.jpeg"><img src="http://img2.diglog.com/img/2021/2/e35239bcbf2199ee7fc7cced2fafd597.jpeg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>This repo contains an issue tracker, examples, and early work related to PEP 622: Structural Pattern Matching. The current version of the proposal is PEP 634,which was  accepted by the Steering Council on February 8, 2021.The motivation and rationale are written up in PEP 635,and a tutorial is in  PEP 636.The tutorial below is also included in PEP 636 as Appendix A.</p><p>此回购包含问题跟踪器，示例和与PEP 622：结构模式匹配有关的早期工作。该提案的当前版本为PEP 634，该指导委员会于2021年2月8日接受了该提案。动机和理由已在PEP 635中进行了编写，而指南则在PEP 636中进行了编写。 636作为附录A.</p><p>      A full reference implementation written by Brandt Bucher is availableas a  fork ofthe CPython repo. This is readily converted to a  pullrequest.</p><p>      Brandt Bucher编写的完整参考实现可作为CPython存储库的分支获得。这很容易转换为请求请求。</p><p> For those who prefer not to build a CPython binary from source there&#39;sa Binder playground -- click the button at the top of this readme.</p><p> 对于那些不想从源代码构建CPython二进制文件的人，这里有一个Binder游乐场-单击此自述文件顶部的按钮。</p><p>    A  match statement takes an expression and compares it to successivepatterns given as one or more  case blocks. This is superficiallysimilar to a  switch statement in C, Java or JavaScript (and manyother languages), but much more powerful.</p><p>    match语句采用一个表达式并将其与作为一个或多个case块给出的连续模式进行比较。这在表面上类似于C，Java或JavaScript（以及许多其他语言）中的switch语句，但功能更强大。</p><p>  def  http_error( status):  match  status:  case  400:  return  &#34;Bad request&#34;  case  401:  return  &#34;Unauthorized&#34;  case  403:  return  &#34;Forbidden&#34;  case  404:  return  &#34;Not found&#34;  case  418:  return  &#34;I&#39;m a teapot&#34;  case  _:  return  &#34;Something else&#34;</p><p>  def http_error（status）：匹配状态：case 400：返回＆＃34; Bad request＆＃34;情况401：返回＆＃34;未经授权＆＃34;情况403：返回“禁止”情况404：返回＆＃34;找不到＆＃34;情况418：将茶壶归还给我情况_：返回“其他”</p><p> Note the last block: the &#34;variable name&#34;  _ acts as a  wildcard andnever fails to match.</p><p> 请注意最后一块：变量名称＆＃34; _用作通配符，并且永远不会匹配。</p><p>    # The subject is an (x, y) tuple match  point:  case ( 0,  0):  print( &#34;Origin&#34;)  case ( 0,  y):  print( f&#34;Y=  { y }&#34;)  case ( x,  0):  print( f&#34;X=  { x }&#34;)  case ( x,  y):  print( f&#34;X=  { x }, Y=  { y }&#34;)  case  _:  raise  ValueError( &#34;Not a point&#34;)</p><p>    ＃主题是（x，y）元组匹配点：case（0，0）：print（＆＃34; Origin＆＃34;）case（0，y）：print（f＆＃34; Y = {y} ＆＃34;）case（x，0）：print（f＆＃34; X = {x}＆＃34;）case（x，y）：print（f＆＃34; X = {x}，Y = { y}＆＃34;）情况_：引发ValueError（＆＃34; Not a point＆＃34;） </p><p> Study that one carefully! The first pattern has two literals, and canbe thought of as an extension of the literal pattern shown above. Butthe next two patterns combine a literal and a variable, and thevariable  captures a value from the subject ( point). The fourthpattern captures two values, which makes it conceptually similar tothe unpacking assignment  (x, y) = point.</p><p>仔细研究那个！第一个模式有两个文字，可以认为是上面显示的文字模式的扩展。但是接下来的两种模式将文字和变量组合在一起，变量从主题（点）捕获值。第四个模式捕获两个值，这使其在概念上与拆箱分配（x，y）= point相似。</p><p> If you are using classes to structure your data (e.g. data classes)you can use the class name followed by an argument list resembling aconstructor, but with the ability to capture variables:</p><p> 如果您使用类来构造数据（例如，数据类），则可以使用类名，后跟类似构造函数的参数列表，但可以捕获变量：</p><p> from  dataclasses  import  dataclass @ dataclass class  Point:  x:  int  y:  int def  whereis( point):  match  point:  case  Point( 0,  0):  print( &#34;Origin&#34;)  case  Point( 0,  y):  print( f&#34;Y=  { y }&#34;)  case  Point( x,  0):  print( f&#34;X=  { x }&#34;)  case  Point():  print( &#34;Somewhere else&#34;)  case  _:  print( &#34;Not a point&#34;)</p><p> 从数据类导入数据类@数据类类Point：x：int y：int def whereis（point）：匹配点：case Point（0，0）：print（＆＃34; Origin＆＃34;）case Point（0，y） ：print（f＆＃34; Y = {y}＆＃34;）case Point（x，0）：print（f＆＃34; X = {x}＆＃34;）case Point（）：print（＆＃ 34; Somewhere else＆＃34;）case _：print（＆＃34; Not a point＆＃34;）</p><p> We can use keyword parameters too. The following patterns are allequivalent (and all bind the  y attribute to the  var variable):</p><p> 我们也可以使用关键字参数。以下模式是等效的（并将y属性都绑定到var变量）：</p><p>  Patterns can be arbitrarily nested. For example, if we have a shortlist of points, we could match it like this:</p><p>  模式可以任意嵌套。例如，如果我们有一个点的简短列表，我们可以像这样匹配它：</p><p> match  points:  case []:  print( &#34;No points&#34;)  case [ Point( 0,  0)]:  print( &#34;The origin&#34;)  case [ Point( x,  y)]:  print( f&#34;Single point   { x },   { y }&#34;)  case [ Point( 0,  y1),  Point( 0,  y2)]:  print( f&#34;Two on the Y axis at   { y1 },   { y2 }&#34;)  case  _:  print( &#34;Something else&#34;)</p><p> 匹配点：case []：print（＆＃34; No points＆＃34;）case [Point（0，0）]：print（＆＃34; The origin＆＃34;）case [Point（x，y）] ：print（f＆＃34;单点{x}，{y}＆＃34;）case [Point（0，y1），Point（0，y2）]：print（f＆＃34; Y轴上的两个{y1}，{y2}＆＃34;）情况_：print（＆＃34;其他内容＆＃34;）</p><p> We can add an  if clause to a pattern, known as a &#34;guard&#34;. If theguard is false,  match goes on to try the next  case block. Notethat value capture happens before the guard is evaluated:</p><p> 我们可以将if子句添加到称为＆＃34; guard＆＃34;的模式中。如果后卫为假，则比赛继续进行下一个案件阻止。请注意，值捕获发生在评估防护之前： </p><p> match  point:  case  Point( x,  y)  if  x  ==  y:  print( f&#34;Y=X at   { x }&#34;)  case  Point( x,  y):  print( f&#34;Not on the diagonal&#34;)</p><p>匹配点：如果x == y：case Point（x，y）：print（f＆＃34; Y = X at {x}＆＃34;）case Point（x，y）：print（f＆＃34; Not on对角线＆＃34;）</p><p>  Like unpacking assignments, tuple and list patterns have exactly thesame meaning and actually match arbitrary sequences. An importantexception is that they don&#39;t match iterators or strings.(Technically, the subject must be an instance of collections.abc.Sequence.)</p><p>  像拆包任务一样，元组和列表模式的含义完全相同，实际上匹配任意序列。一个重要的例外是它们与迭代器或字符串不匹配（从技术上讲，主题必须是collections.abc.Sequence的实例）。</p><p> Sequence patterns support wildcards:  [x, y, *rest] and  (x, y, *rest) work similar to wildcards in unpacking assignments. Thename after  * may also be  _, so  (x, y, *_) matches a sequenceof at least two items without binding the remaining items.</p><p> 序列模式支持通配符：[x，y，* rest]和（x，y，* rest）的工作方式与解包分配中的通配符相似。 *之后的名称也可能是_，因此（x，y，* _）匹配至少两个项目的序列，而没有绑定其余项目。</p><p> Mapping patterns:  {&#34;bandwidth&#34;: b, &#34;latency&#34;: l} captures the &#34;bandwidth&#34; and  &#34;latency&#34; values from a dict. Unlike sequencepatterns, extra keys are ignored. A wildcard  **rest is alsosupported. (But  **_ would be redundant, so it is not allowed.)</p><p> 映射模式：{＆＃34;带宽＆＃34;：b，＆＃34;等待时间＆＃34;：l}捕获＆＃34;带宽＆＃34;和＆＃34;延迟＆＃34;字典中的值。与sequ​​encepatterns不同，多余的键将被忽略。还支持通配符** rest。 （但是** _将是多余的，因此是不允许的。）</p><p>  Patterns may use named constants. These must be dotted namesto prevent them from being interpreted as capture variable:</p><p>  模式可以使用命名常量。这些必须为点分名称，以防止将其解释为捕获变量：</p><p> from  enum  import  Enum class  Color( Enum):  RED  =  0  GREEN  =  1  BLUE  =  2 match  color:  case  Color. RED:  print( &#34;I see red!&#34;)  case  Color. GREEN:  print( &#34;Grass is green&#34;)  case  Color. BLUE:  print( &#34;I&#39;m feeling the blues :(&#34;)</p><p> 从枚举中导入Enum类Color（Enum）：RED = 0 GREEN = 1 BLUE = 2匹配颜色：case颜色。红色：打印（“我看见红色！”）情况颜色。绿色：打印（＆＃34;草为绿色）颜色。蓝色：印刷品（＆＃34;我感觉忧郁：（＆＃34;）</p><p> The literals  None,  False and  True are treated specially:comparisons to the subject are done using  is. This:</p><p> 字面值None，False和True受到特殊对待：与主题的比较使用is进行。这： </p><p> Classes may override the mapping from positional arguments toattributes by setting a class variable  __match_args__.Read about it in the PEP.</p><p>通过设置类变量__match_args__，类可以覆盖从位置参数到属性的映射。请在PEP中进行了解。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/gvanrossum/patma/blob/master/README.md">https://github.com/gvanrossum/patma/blob/master/README.md</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/python/">#python</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/pattern/">#pattern</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/模式/">#模式</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>