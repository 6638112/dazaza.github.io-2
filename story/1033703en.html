<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>以太化-将以太带回以太网</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">以太化-将以太带回以太网</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-11-07 18:15:44</div><div class="page_narrow text-break page_content"><p>Leaking data via out of unconnected devices (both connected and unconnected) is a very interesting topic, often called “soft tempest”. Often this is the realm of absurdly costly lab equipment, source code isn’t published etc.  Here i would like to demonstrate this using the simplest equipment and means, and make it very easy to reproduce.</p><p>通过未连接设备(包括已连接设备和未连接设备)泄露数据是一个非常有趣的话题，通常被称为“软风暴”。这通常是昂贵得离谱的实验室设备的领域，源代码没有公布等等。在这里，我想用最简单的设备和方法来演示这一点，并使其非常容易复制。</p><p> To transmit an elecromagnetic wave one needs to have a conductor driven by a high frequency source. Various busses are used: monitor cables, pci buses etc. Here i propose the use of ethernet.</p><p>要传输电磁波，需要有一个由高频电源驱动的导体。使用各种总线：监视器电缆、PCI总线等。这里我建议使用以太网。</p><p> An ethernet cable consists of 4 twisted pair lines with 100ohm impedance., which carries RF signals in the tens to hundredths MHz range. Any imperfections in the cable (asymetry etc) or in the interface will cause radio signals to be radiated.</p><p>以太网电缆由4条阻抗为100欧姆的双绞线组成，传输的射频信号范围在百分之几十到百分之一兆赫之间。电缆(不对称等)或接口中的任何缺陷都会导致无线电信号被辐射。</p><p> Signals can be modulated using different methods. Here i will use morse code for simplicity. This also allows one to judge the signal to noise ratio by just listening. It is also possible to decode it by ear without additional devices if one knows morse code, if not there is a lot of software that can do it (although usually with much worse performance than an experienced human operator).</p><p>可以使用不同的方法来调制信号。为了简单起见，这里我将使用摩尔斯电码。这也使得人们只需听一听就可以判断信噪比。如果一个人知道摩尔斯电码，也可以在不需要额外设备的情况下用耳朵破译它，如果不知道，也有很多软件可以做到这一点(尽管通常比有经验的人工操作员的性能差得多)。</p><p> Transmission is implemented via very simple shell scripts. Only bash, ethtool and ping is needed. This enables the script to be used easily on embedded devices and other platforms where shipping binaries, installing a python environment etc might be a problem.</p><p>传输是通过非常简单的Shell脚本实现的。只需要bash、ethtool和ping。这使得该脚本可以很容易地在嵌入式设备和其他平台上使用，在这些平台上，传输二进制文件、安装Python环境等可能会遇到问题。</p><p>   Various ethernet speeds have different modulation speeds, types and encoding. By switching between we can modulate the RF signal leaking from the wires.</p><p>各种以太网速度具有不同的调制速度、类型和编码。通过切换，我们可以调制从电线泄漏的射频信号。</p><p> 10base-T uses manchester encoding with 10MHz symbol rate. This is used as the space signal (logical 0).</p><p>10BASE-T采用曼彻斯特编码，码率为10 MHz。这用作空间信号(逻辑0)。</p><p> 100base-T uses 4B5B encoding with NRZI at 125MHz symbol rate . This results in an easy to receive signal around 125MHz, this is used as the mark signal (logical 1).</p><p>100BASE-T使用4b5b编码和NRZI，符号速率为125 MHz。这导致容易接收125 MHz左右的信号，这被用作标记信号(逻辑1)。</p><p> Ethernet transmits an idle sequence when no packets are carried, so the signal is constant. No packets have to be transmitted for the signal to be present, on the speed of the interface has to be changed.</p><p>以太网在没有数据包的情况下发送空闲序列，因此信号是恒定的。必须改变接口的速度才能显示信号，而不必发送数据包。</p><p> The transmission is implemented by a simple bash script, which sends the content of a short text file given as the argument, or “etherify demo” if none is given. The signal can be received as morse code around 125MHz, please use USB or CW mode in the receiver and use a narrow filter.</p><p>传输是通过一个简单的bash脚本实现的，该脚本发送作为参数提供的短文本文件的内容，如果没有提供，则发送“etherify demo”。该信号可在125 MHz左右以莫尔斯电码的形式接收，请在接收器中使用USB或CW模式，并使用窄带滤波器。</p><p>  Ensure that the two raspberry PIs are connected and that there is an ethernet link between them (signalled via the LEDs).</p><p>确保两个覆盆子PI已连接，并且它们之间有以太网链路(通过LED发出信号)。</p><p>       The is decodable by ear with a simple Moxon directional antenna and a ham radio receiver (SDR could be used too).</p><p>它可以通过一个简单的莫克森定向天线和一个业余无线电接收器(也可以使用SDR)通过耳朵进行解码。</p><p>     If in doubt let an experienced amateur radio operator decode it. I was not able to decode the signal at 100m with software.</p><p>如果有疑问，让一位经验丰富的业余无线电操作员来解码。我无法用软件解码100米的信号。</p><p>  Sending a stream of data at 1Gbps also produces a detectable signal change at 125MHz. There may be other frequencies where the signals were more readable, but equipment was avaliable to receive at 125MHz. This probably works by loading the supply voltage when the packets are generated. A change of voltage probably changes the frequency of some clock slightly, thus generating FSK (F1A to be exact). Note that this doesn’t work with all hardware, which could be explained by the hypothesis about the frequency being modulated by the interface load.</p><p>以1Gbps发送数据流也会在125 MHz处产生可检测到的信号变化。可能还有其他频率的信号更易读，但设备可以接收到125兆赫的信号。这可能是通过在生成分组时加载电源电压来实现的。电压的变化可能会略微改变某些时钟的频率，从而产生FSK(准确地说是F1a)。请注意，这并不适用于所有硬件，这可以用接口负载调制频率的假设来解释。</p><p> A large volume of traffic represents a logical 1, while no traffic represents logical 0.</p><p>大流量代表逻辑1，而没有流量代表逻辑0。</p><p> The transmission is implemented as a simple bash script, which sends the content of a short text file given as the argument, or “etherify demo” if none is given. The signal can be received as morse code around 125MHz, please use USB or CW mode in the receiver and use a narrow filter, also AM mode can be used.</p><p>传输被实现为一个简单的bash脚本，它发送作为参数提供的短文本文件的内容，如果没有提供，则发送“etherify demo”。该信号可以在125 MHz左右以莫尔斯电码的形式接收，请在接收器中使用USB或CW模式，并使用窄带滤波器，也可以使用AM模式。</p><p>  Ensure that the two raspberry PIs are connected and that there is an ethernet link between them (signalled via the LEDs). Set one raspberry PI to 192.168.1.1/24 and the other to 192.168.1.2/24 (the IP address can be changed in the etherify2 script). Ensure that the two raspberry PIs have IP connectivity and can ping each other, and that he interface rate is 1Gbps.</p><p>确保两个覆盆子PI已连接，并且它们之间有以太网链路(通过LED发出信号)。将一个Raspberry PI设置为192.168.1.1/24，将另一个设置为192.168.1.2/24(IP地址可以在etherify2脚本中更改)。确保两个树莓PI具有IP连接并且可以相互ping通，并且接口速率为1Gbps。</p><p>      The signal was decodable by ear at a distance of 30m with a simple Moxon directional antenna and a ham radio receiver.</p><p>通过简单的莫克森定向天线和业余无线电接收器，信号可以在30米远的地方用耳朵进行解码。</p><p>      The RF radiation differs with different equipment and ethernet cable type being used. In order to make this demo reproducible i used two Raspberry PI 4, because it makes it easy for everyone to obtain the exact hardware that was used for this experiment. The raspberry PIs were connected using the ethernet cable supplied with the official Raspberry PI 4 starter kit. The stock Raspbian 10 operating system, which was supplied on the SD cards  in the Starter Kit, was used. The devices were accessed via the serial console.</p><p>所使用的设备和以太网电缆类型不同，射频辐射也不同。为了使这个演示可重现，我使用了两个Raspberry PI 4，因为它使每个人都可以很容易地获得用于这个实验的确切硬件。树莓PI是通过官方提供的树莓PI 4初学者工具包提供的以太网线连接起来的。使用的是入门工具包中SD卡上提供的普通Raspbian 10操作系统。这些设备是通过串行控制台访问的。</p><p> Power was provided via powerbanks. This was to avoid a connection to the mains voltage, because the powerline could be an unintentional radiator.</p><p>电力是通过电力银行提供的。这是为了避免与电源电压连接，因为电力线可能是无意中的散热器。</p><p>    The signal was received via a Moxon antenna built for 125MHz and a Yaesu FT-817 transceiver with a 500Hz CW filter. Morse code was received and decoded by ear.</p><p>信号是通过125 MHz的莫克森天线和带有500赫兹连续波滤波器的YAEU FT-817收发机接收的。摩尔斯电码是通过耳朵接收和解码的。</p><p> The experiments can be repeated with other devices with ethernet ports, for example two laptops, running any linux distribution and the required tools installed (most will come with them out of the box). The devices should be able to establish an ethernet link very quickly upon switching speed. An SDR receiver can be used for reception, with any antenna that can receive 125MHz (test first at close range). Morse code decoding can be done via software, for example fldigi [3].</p><p>这些实验可以在其他带有以太网端口的设备上重复进行，例如两台笔记本电脑，运行任何Linux发行版并安装所需的工具(大多数设备都会提供现成的工具)。这些设备应该能够在交换速度之后非常快地建立以太网链路。SDR接收器可以用于接收，任何天线都可以接收125 MHz(首先在近距离测试)。莫尔斯电码译码可以通过软件完成，例如fldigi[3]。</p><p> The easiest receive setup would probably be gqrx with an rtl-sdr dongle, and fldigi for deciding the signals. If the signal is not decoded, it should be played to someone who can receive morse code by ear. Often such person will be able to decode it with ease.</p><p>最简单的接收设置可能是带有RTL-SDR加密狗的GQRX，以及用于决定信号的Fldigi。如果信号没有被解码，它应该播放给可以通过耳朵接收摩尔斯电码的人。通常情况下，这样的人能够很容易地破译它。</p><p> The experiment should be first conducted in an electromagnetically quiet area, nearby ethernet networks will generate a lot of interference. If testing in the vicinity of other ethernet networks move the antenna closer, and reduce the receiver gain as much as possible.</p><p>实验应该首先在电磁安静的区域进行，附近的以太网网络会产生很多干扰。如果在其他以太网附近进行测试，请将天线移动得更近，并尽可能降低接收器增益。</p><p>  The signal was shown to be decodable by ear at 100m for etherify 1, and 30m for etherify 2. This was done via a simple antenna and modest receiver. An antenna with more gain and better receiver would surely yield better range.</p><p>通过简单的天线和适中的接收器，可以在100米处(醚化1)和30米(醚化2)用耳朵来解码信号。具有更大增益和更好接收器的天线肯定会产生更大的射程。</p><p> Nearby ethernet networks will generate a lot of interference at the same frequencies. The 125MHz frequency falls in the 108-137MHz air band, and one can expect interference from strong signals on nearby frequencies from nearby airplanes and airports. Therefore first tests should be conducted in areas with less interference, such as outdoor areas or underground parking lots.</p><p>附近的以太网网络在相同的频率上会产生大量干扰。125兆赫的频率落在108-137兆赫的空中频段，人们可以预料到来自附近飞机和机场的强信号对附近频率的干扰。因此，首先应在干扰较小的区域进行测试，如室外区域或地下停车场。</p><p> The 125MHz frequency was chosen because of avaliable equipment. It would be hard for one person to hold and operate an antenna, laptop and SDR receiver. Other frequencies may be better.</p><p>选择125 MHz频率是因为有可用的设备。一个人很难拿着和操作天线、笔记本电脑和SDR接收器。其他频率可能更好。</p><p> Etherify 1 yields better range, however etherify 2 may enable to use a device located somewhere else in the network as the transmitter. This device may be physically closer to the receiver or may have greater leakage from the ethernet cable. Etherify 2 can be exploited as a non-root user by flooding the network with UDP datagrams or possibly other data.</p><p>Etherify 1可以提供更好的范围，但是Etherify 2可以使用网络中其他位置的设备作为发送器。该设备可能在物理上更靠近接收器，或者可能具有更大的以太网电缆泄漏。通过向网络发送UDP数据报或可能的其它数据，可将Etherify 2用作非根用户。</p><p>  I haven’t done an extensive search for similar prior publications, but a few quick searches didn’t yield any results. If you know of any, please let me know.</p><p>我没有对类似的以前的出版物进行过广泛的搜索，但几次快速搜索都没有找到任何结果。如果你知道什么，请告诉我。</p><p> If you cite this, please include the webpage address and attribute Jacek Lipkowski (SQ5BPF). Email can be sent to my_callsign @ this_domain.</p><p>如果您引用这一点，请包括网页地址和属性Jacek Lipkowski(SQ5BPF)。电子邮件可以发送到my_callsign@this_domain。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://lipkowski.com/etherify/">https://lipkowski.com/etherify/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/以太/">#以太</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/bringing/">#bringing</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/设备/">#设备</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>