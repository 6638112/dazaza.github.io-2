<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>如何设计一种新的编程语言 How to design a new programming language</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">How to design a new programming language<br/>如何设计一种新的编程语言 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-26 19:28:39</div><div class="page_narrow text-break page_content"><p>There is a long, difficult road from vague, pie-in-the-sky ideas about whatwould be cool to have in a new programming language, to a robust,self-consistent, practical implementation of those ideas. Designing andimplementing a new programming language from scratch is one of the mostchallenging tasks a programmer can undertake.</p><p>从模糊的，空洞的想法到如何在新的编程语言中实现，再到健壮，自洽，实际的实现这些想法，还有很长的路要走。从头开始设计和实现新的编程语言是程序员可以执行的最具挑战性的任务之一。</p><p> Note: this post is targeted at motivated programmers who want to make aserious attempt at designing a useful programming language. If you just want tomake a language as a fun side project, then you can totally just wing it. Takingon an unserious project of that nature is also a good way to develop someexpertise which will be useful for a serious project later on.</p><p> 注意：这篇文章的目标读者是那些想要在设计有用的编程语言上做出艰苦尝试的积极进取的程序员。如果您只是想将一种语言作为有趣的附带项目，那么您完全可以使用它。从事那种性质的不认真的项目也是发展专业知识的好方法，这对以后的严肃项目很有用。</p><p> Let’s set the scene. You already know a few programming languages, and you knowwhat you like and dislike about them — these are your influences. You havesome cool novel language design ideas as well. A good first step from here is todream up some pseudocode, putting some of your ideas to paper, so you can get anidea of what it would actually feel like to write or read code in thishypothetical language. Perhaps a short write-up or a list of goals and ideas isalso in order. Circulate these among your confidants for discussion andfeedback.</p><p> 让我们设置场景。您已经知道几种编程语言，并且知道自己对它们的喜好和不喜欢-这些都是您的影响。您也有一些很酷的新颖语言设计思想。从这里开始的一个很好的第一步是幻想一些伪代码，将您的一些想法付诸实践，以便您可以理解使用这种假想的语言编写或阅读代码的实际想法。也许是简短的写作或目标和想法的列表。在您的知己之间散布这些内容，以进行讨论和反馈。</p><p> Ideas need to be proven in the forge of implementations, and the next step is towrite a compiler (or interpreter — everything in this article appliesequally to them). We’ll call this the sacrificial implementation, because youshould be prepared to throw it away later. Its purpose is to prove that yourdesign ideas work and can be implemented efficiently, but  not to be theproduction-ready implementation of your new language. It’s a tool to help yourefine your language design.</p><p> 想法需要在实现的伪造中得到证明，下一步是编写编译器（或解释器，本文中的所有内容均适用于它们）。我们将其称为牺牲性实施，因为您应该准备在以后将其丢弃。其目的是证明您的设计思想有效并且可以有效地实施，而不是成为新语言的生产就绪型实施。它是帮助您优化语言设计的工具。</p><p> To this end, I would suggest using a parser generator like yacc to create yourparser, even if you’d prefer to ultimately use a different design (e.g.recursive descent). The ability to quickly make changes to your grammar, and theside-effect of having a formal grammar written as you work, are both valuable tohave at this stage of development. Being prepared to throw out the rest of thecompiler is helpful because, due to the inherent difficulty of designing andimplementing a programming language at the same time, your first implementationwill probably be shit. You don’t know what the language will look like, you’llmake assumptions that you have to undo later, and it’ll undergo dozens ofrefactorings. It’s gonna suck.</p><p> 为此，即使您最终希望使用其他设计（例如递归下降），也建议使用yacc这样的解析器生成器来创建解析器。快速更改语法的能力以及在工作时编写正式语法的副作用，都是在此开发阶段具有的宝贵价值。准备好扔掉其余的编译器是有帮助的，因为由于同时设计和实现编程语言的固有困难，您的第一个实现可能会变得很糟糕。您不知道该语言的外观，会假设您以后必须撤消操作，并且会进行数十种重构。会很烂。</p><p> However, shit as it may be, it will have done important work in validating yourideas and refining your design. I would recommend that your next step is tostart working on a formal specification of the language (something that Ibelieve all languages should have). You’ve proven what works, and writing it upformally is a good way to finalize the ideas and address the edge cases. Gathera group of interested early adopters, contributors, and subject matter experts(e.g. compiler experts who work with similar languages), and hold discussions onthe specification as you work.</p><p> 但是，尽管可能如此，它将在验证您的想法和完善您的设计方面做重要的工作。我建议您的下一步是开始研究该语言的正式规范（相信所有语言都应该具备的规范）。您已经证明了行之有效的方法，然后正式编写它是确定想法并解决极端情况的好方法。 Gathera小组由感兴趣的早期采用者，贡献者和主题专家（例如，使用类似语言的编译器专家）组成，并在工作时就规范进行讨论。</p><p> This is also a good time to start working on your second implementation. At thispoint, you will have a good grasp on the overall compiler design, the flaws fromyour original implementation, and better skills as a compiler programmer.Working on your second compiler and your specification at the same time can helpas both endeavours inform the others — a particularly difficult detail toimplement could lead to a simplification in the spec, and an under-specifieddetail getting shored up could lead to a more robust implementation.</p><p> 这也是开始第二个实施工作的好时机。在这一点上，您将掌握编译器的总体设计，原始实现的缺陷以及作为编译器程序员的更好技能。同时工作第二个编译器和您的规范可以为彼此提供帮助，因为这两个工作都可以使他人受益。特别难以实现的细节可能会导致规格简化，而规格不足的细节被拥护可能会导致更坚固的实现。 </p><p> Don’t get carried away — keep this new compiler simple and small. Don’t gocrazy on nice-to-have features like linters and formatters, an exhaustive testsuite, detailed error messages, a sophisticated optimizer, and so on. You wantit to implement the specification as simply as possible, so that you can use itfor the next step: the hosted compiler. You need to write a thirdimplementation, using your own language to compile itself.</p><p>不要气carried，让这个新的编译器变得简单小巧。不要疯狂地使用诸如linter和formatters，详尽的测试套件，详细的错误消息，复杂的优化器等出色的功能。您希望尽可能简单地实现该规范，以便可以将其用于下一步：托管编译器。您需要编写第三种实现，使用自己的语言进行编译。</p><p> The second compiler, which I hope you wrote in C, is now the bootstrap compiler.I recommend keeping it up-to-date with the specification and maintaining itperpetually as a convenient path to bootstrap your toolchain from scratch(looking at you, Rust). But it’s not going to be the final implementation: anyself-respecting general-purpose programming language is implemented in itself.The next, and final step, is to implement your language for a third time.</p><p> 我希望您使用C编写的第二个编译器现在是bootstrap编译器。我建议将其与规范保持最新并永久维护，这是从头开始启动工具链的便捷途径（看着您，Rust） 。但这并不是最终的实现：任何自尊的通用编程语言都将自己实现。下一步，也是最后一步，是第三次实现您的语言。</p><p> At this point, you will have refined and proven your language design. You willhave developed and applied compiler programming skills. You will have a robustimplementation for a complete and self-consistent programming language,developed carefully and with the benefit of hindsight. Your future communitywill thank you for the care and time you put into this work, as your languagedesign and implementation sets the ceiling on the quality of programs written init.</p><p> 此时，您将完善并证明您的语言设计。您将拥有开发和应用编译器编程的技能。您将拥有完整，自洽的编程语言的强大实现，该语言经过精心开发并具有后见之明。您未来的社区将感谢您为这项工作所付出的精力和时间，因为您的语言设计和实现为编写init程序的质量设定了上限。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://drewdevault.com/2020/12/25/How-to-design-a-new-programming-language.html">https://drewdevault.com/2020/12/25/How-to-design-a-new-programming-language.html</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/编程/">#编程</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/编译器/">#编译器</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>