<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>基于摩托罗拉68000的最小单板机</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">基于摩托罗拉68000的最小单板机</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-07-30 05:16:20</div><div class="story_img_container"><a href="http://img.diglog.com/img/2020/7/b81ebe8d3aa8a9b7e3fd28683ec8e175.png"><img src="http://img.diglog.com/img/2020/7/b81ebe8d3aa8a9b7e3fd28683ec8e175.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>68k纳米硬件简单明了。它可以构建在板外(尽管在更高的时钟速度下可能会有稳定性问题)。</p><p>由于最小的地址解码电路，访问某些存储器区域将导致选择多个设备。这是应该避免的。</p><p>$000000-0xFFFF只读存储器(重复16次)$100000-1FFFFF X禁止(多个设备选择)$200000-2FFFFF只读存储器($000000-0FFFFF的镜像)$300000-$7FFFF X禁止(多个设备选择)$800000-8FFFF开放式总线(可扩展)$900000-9xxxF紧凑型闪存卡$A00000-AxxxxF UART$B00000-BFFFFF。</p><p>16550的调制解调器控制线用作位Bang-banged SPI接口。为SparkFun；S&34；DeadOn&34；DS3234实时时钟板提供了7针插头。因此，通过16550的调制解调器控制寄存器和线路状态寄存器可以实现对串行总线的访问。</p><p>为存储设备提供了一个间距为2 mm的44针IDE连接器。这适用于CompactFlash卡适配器(在16位True IDE模式下运行)，但也可用于并行ATA硬盘。(未测试)。</p><p>所有中断源都通过16550路由。所有16550个中断都调用1级自动矢量(矢量偏移量$064)，并由软件确定中断源。</p><p>Bom.txt包含一个物料清单。在撰写本文时(2020年7月)，所有组件均可从Mouserand Jameco等主要分销商处获得。如果从eBay购买6800，请注意老式IC是盗版的常见目标。为了这个项目，我使用了Jameco的东芝TMP68HC000P-12芯片，它们工作得很好。</p><p>所有部件都是通孔，给人一种额外的复古感觉。请注意，一些去耦电容器(C4、C5、C6、C8和C10)位于IC下方，因此需要开放框架IC插座。大型IC插座也可能很贵(尤其是DIP-64插座！)。因此，更便宜的替代方案是使用分离式SIP0.1&34；机器插头。</p><p>由于芯片的间距，Textool ZIF插座不适合。对于ROMsU5和U7，白羊座28-526-10低调ZIF插座将适合，但勉强适合。释放闩锁可能会擦伤其北部的RAM IC，但我发现这并不是什么大不了的事。</p><p>X1可以使用全罐或半罐振荡器。请注意，如果使用频率不是12 MHz的振荡器，则必须更新Makefile中的F_CPU值。(见下文)还请注意，如果使用68HC000，最低时钟频率为4 MHz。</p><p>44针IDE接口接受像这样的CompactFlash适配器板，可从Amazon和其他供应商处购买。</p><p>本项目使用VASM汇编器和标准Makefile。Python 3和PySerial也需要通过串口将程序上传到计算机。Makefile还包含使用Minipro将ROM映像刻录到AT28C256 EEPROM的规则(如果您有TL866II+程序员)。(如果你没有芯片编程器，你应该买一台TL866II+，它们价格合理，可以从许多供应商那里买到。)。</p><p>运行make rom将构建ROM映像，并将其分成奇数和偶数两部分，即rom-l.bin和rom-u.bin。每个文件应该正好是32,768字节。运行make burnrom会使用Minipro将这些文件写入一对AT28C256 EEPROM。</p><p>注意：如果使用频率不是12 MHz的振荡器，请在生成文件中适当更改F_CPU的值。</p><p>Makefile中的波特率变量设置串行接口的波特率。使用包含的脚本baudrate.py确定在给定振荡器频率下可用的波特率。</p><p>ROM相当小--它更接近于引导加载程序，而不是操作系统。它支持从FAT16格式的CompactFlash卡的根目录加载程序，并支持一些基本的调试功能。它还为I/O提供了一组较小的系统调用，以简化应用程序。</p><p>测试RAM。如果发生RAM故障，故障地址将写入串口，状态LED快速闪烁。(当以较高的时钟速度在面板上运行时，这很容易失败。)。</p><p>检查实时时钟模块。如果找到，将当前日期和时间打印到串口。</p><p>检查CompactFlash卡，如果是FAT16格式，则尝试挂载第一个分区。</p><p>如果没有按住&#34；Enter&#34；按钮：如果插入了有效的卡，请检查根目录中名为STARTUP.BIN的文件。如果找到，则将其加载到RAM中并执行。</p><p>如果按下了&#34；Enter&#34；按钮，则输入交互式命令shell并跳过执行STARTUP.BIN。</p><p>68K Nano-ROM Version 00009900(20200708)(C)2020 Matt Sarnoff(MSARNOFF.ORG)测试内存...密码：1,048,576 BYTESROM：65,536 BYTESCPU：12,000,000 HZTIME IS 2020-07-07 19：14：36检测到的CARD：250,608KB&#39；没有名称#39；无法加载STARTUP.BIN-FILE NOT FOUNDTYPE？[回车]寻求帮助。&gt；</p><p>如果未加载STARTUP.BIN，则可通过串行端口使用交互式命令shell。(57600波特、8个数据位、无奇偶校验、1个停止位)。类型？然后按Enter键可查看支持的命令列表。此处对它们进行了简要总结。请注意，命令和文件名不区分大小写。</p><p>.L-列出CompactFlash卡根目录中的文件。不显示长文件名和隐藏文件。</p><p>.p文件-将CompactFlash卡根目录中名为file的文件的内容打印为ASCII文本。</p><p>.h文件-将CompactFlash卡根目录中名为file的文件的内容打印为十六进制转储。</p><p>.t-打印实时时钟模块报告的当前日期和时间。</p><p>.T YYYYMMDDWWhhmmss-设置当前日期和时间。新日期/时间应表示为不带分隔符的16位十进制数字字符串。WW应该是介于01和07(包括01和07)之间的两位数工作日。您可以使用Unix命令date&#34；+%Y%m%d0%u%H%M%S&#34；以此格式获取当前日期/时间。</p><p>文件-任何其他命令都被解释为要从CompactFlash卡的Root目录加载并执行的文件名。与MS-DOS不同，文件扩展名是必需的。例如，要执行名为foo.bin的文件，请输入FOO.BIN。(foo将尝试加载名为foo且没有扩展名的文件)。</p><p>串行输入线上的中断条件进入串行加载器，允许将程序从主机上传到RAM。Python脚本serload.py和Makefile规则make load和make run负责这一点。</p><p>硬件异常会导致传输到基本调试器。状态LED快速闪烁，并将寄存器转储打印到串行端口：</p><p>*非法INSTRUCTIOND0=00000064 D1=0000000A D2=00000038 D3=00000009D4=00000000 D5=00000000 D6=00000000 D7=00000000A0=00E0003C A1=00001D40 A2=00000000 A3=00F00000A4=00000000 A5=00000000 A6=000001E2 A7=00EFFFFASR=-S0--Z--PC=0000</p><p>有关ROMAPI提供的系统调用和应用程序指南的详细说明，请参阅API.md。</p><p>ROM始终位于地址空间的底部，因此应用程序代码无法覆盖异常向量。</p><p>这是一个小规模的项目。我正在考虑将来设计一个更大的68000冲浪板，所以我可能不会再继续做这件事了。这里有一些我没有时间去处理的项目想法，但欢迎您来：</p><p>使用DS3234实时时钟的SQW输出生成周期性中断。(uClinux可能需要)</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/74hc595/68k-nano">https://github.com/74hc595/68k-nano</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/单板机/">#单板机</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/single/">#single</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>