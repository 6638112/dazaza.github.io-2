<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Wix如何通过演变基础架构来改进网站性能 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Wix如何通过演变基础架构来改进网站性能 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-03-12 05:26:25</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/3/e1d877d8271b025689115e2c6a507bea.jpg"><img src="http://img2.diglog.com/img/2021/3/e1d877d8271b025689115e2c6a507bea.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>由于利用行业标准，云提供商和CDN功能，结合了我们网站运行时的主要重写，WIX站点的百分比达到了所有核心网站（CWV）度量超过年增长的年份，达到了一年多的年份，这来自CRUX和HTTPARCHIVE的数据。</p><p> Wix采用了以绩效为导向的文化，进一步改进将继续向用户推出。当我们专注于性能KPI时，我们希望看到通过CWV阈值的网站数量增长。</p><p>  性能世界是美妙的复杂性，具有许多变量和复杂性。研究表明，现场速度对企业的转换率和收入有直接影响。近年来，该行业更加重视性能可见性并更快地制作网络。从2021年5月开始，页面体验信号将包含在Google搜索排名中。</p><p> Wix的独特挑战是支持数百万个网站的支持，其中一些是多年前建立的，并且从那以后尚未更新。我们有各种工具和文章，以协助我们的用户在他们可以做些什么来分析和改善其网站的表现。</p><p> Wix是一个管理的环境，而不是一切都在用户手中。共享普通基础设施对所有这些网站带来了许多挑战，而且还为董事会的主要增强功能开启了机会，即利用规模经济。</p><p> 在此帖子中，我将专注于在服务初始HTML周围完成的增强功能，该初始HTML启动了页面加载过程。</p><p>  具有绩效的核心困难之一是找到一个常见的术语，以讨论用户体验的不同方面，同时考虑技术和感知性能。在组织中使用明确的常用语言使我们能够轻松地讨论和分类不同的技术零件和权衡，阐明了我们的绩效报告，并对我们应该重新改进的绩效报告并获得了卓越的帮助。 </p><p>我们调整了我们的所有监测和内部讨论，包括工业标准度量，如Web Vitals，包括：</p><p>   它很容易创建一个立即加载的网站，只要您使用HTML非常简单，可以通过CDN服务。</p><p>  但是，现实是，网站正在越来越复杂，更复杂，更像是应用程序而不是文档，并支持博客，电子商务解决方案，自定义代码等功能等功能。</p><p> Wix提供了很多各种模板，使用户能够轻松构建具有许多业务功能的网站。这些附加功能通常具有一些性能成本。</p><p>   每次加载网页时，它都始终以初始请求启动URL以检索HTML文档。此HTML响应触发所有其他客户端请求和浏览器逻辑运行和呈现您的网站。这是页面加载最重要的部分，因为直到响应开始到达（称为TTFB  - 第一个字节的时间）直到没有任何反应。</p><p>   操作大规模系统时，您始终需要考虑权衡，例如性能，可靠性和成本。最多几年前，Wix使用了客户端渲染（CSR），其中通过客户端（即在浏览器中的JavaScript）生成实际的HTML内容，允许我们支持大规模的站点而不具有巨大的后端运营成本。</p><p> CSR使我们能够使用常见的HTML文档，该文档基本上是空的。所有它确实触发了所需的代码和数据，然后用于在客户端设备上生成完整的HTML。 </p><p>几年前，我们过渡到服务器端渲染（SSR），因为它有利于SEO和性能，提高初始页面可见时间，并确保没有完全支持运行JavaScript的搜索引擎的更好索引。</p><p> 这种方法改善了可见性体验，特别是在较慢的装置/连接上，并打开门以进行进一步的性能优化。但是，它也意味着对于每个网页请求，飞行中生成了唯一的HTML响应，这远远不到最佳，特别是对于具有大量视图的网站。</p><p>   它经常改变。每次用户编辑其网站，或在网站数据中进行更改，例如网站商店库存。</p><p> 它有某些数据和饼干是游客特定的，这意味着访问同一站点的两个人会看到一些不同的HTML。例如，为了支持产品的功能，例如记住访问购物车中的商品，或者聊天访问者之前的聊天更早地开始使用。</p><p> 并非所有页面都很可缓存。例如，具有自定义用户代码的页面，它显示当前时间作为文档的一部分，不符合缓存。</p><p> 最初，我们采取了相对安全的方法来缓存HTML，没有访客数据，然后仅针对每个缓存命中的每个访问者的HTML响应的特定部分。</p><p>  我们通过部署内部解决方案来完成此目的：使用Varnish HTTP缓存进行代理和缓存，用于无效消息的Kafka，以及代理这些HTML响应的Scala / Netty的服务，但突变了HTML并添加了特定于访问者特定的数据Cookie到缓存的响应。 </p><p>此解决方案使我们能够在更多地理位置和多个云提供商区域部署这些苗条组件，这些组件和多个云提供商区域都在全球范围内传播。 2019年，我们推出了超过15个新地区，并逐步启用了90％的页面浏览量，这些浏览量有资格获得缓存。从其他位置提供服务器站点通过将内容较近网站＆＃39;访客，减少了客户端和服务器响应的服务器之间的网络延迟。</p><p> 我们还通过使用相同的解决方案开始缓存某些只读API响应，并使缓存失效到站点内容的任何更改。例如，当发布/修改后，站点上的博客文章列表缓存并无效。</p><p>  实现高速缓存改进的性能，大多数在TTFB和FCP阶段，并通过从更靠近最终用户的位置服务的内容来提高我们的可靠性。</p><p> 但是，需要修改每个响应的HTML引入了不必要的复杂性，即如果删除，则提出了进一步的性能改进的机会。</p><p>  HTML请求直接从浏览器缓存服务，保存了很多带宽并减少了重复视图的加载时间</p><p> 下一步是实际上完全从HTML中删除此访问者特定的数据，并在HTML到达后，从客户端调用的单独端点检索它。</p><p> 我们仔细迁移了此数据和cookie到一个新的端点，该终端将在每个页面上调用，但返回Slim JSON，仅需要用于保湿过程，以实现完整页面交互性。 </p><p>这使我们能够启用HTML的浏览器缓存，这意味着浏览器现在可以保存重复访问的HTML响应，并且仅调用服务器以验证内容Hasn＆＃39; t更改。这是使用HTTP ETAG完成的，这基本上是分配给特定版本的HTML资源的标识符。如果内容仍然是相同的，则我们的服务器向客户端发送304号修改响应，而无需身体。</p><p>  此外，此更改意味着我们的HTML不再特定于访问者，不包含cookie。换句话说，它基本上可以在任何地方缓存，打开门以使用CDN提供商，这些提供商在全球数百个地点拥有更好的地理位置。</p><p>  通过缓存启用，减少等待时间，初始连接的其他重要部分变得更加重要。增强我们的网络基础架构和监控使我们能够改进我们的DNS，Connection和SSL时间。</p><p>  为所有用户域启用了HTTP / 2，减少了每个新连接所需的连接量和开销。这是部署相对容易的改变，同时利用HTTP / 2的性能和恢复效益。</p><p>   传统上，我们的所有文件都使用Gzip压缩压缩，这是Web上最普遍的HTML压缩选项。这种压缩协议最初在近30年前实施！</p><p>  较新的Brotli压缩引入了压缩改进，几乎没有权衡，并且慢慢变得更受欢迎，如年度Web Almanac压缩章节所述。它已被所有主要浏览器支持一段时间。</p><p> 对于所有支持它的所有客户端，我们支持Brotli支持我们的Nginx代理。 </p><p>搬到使用Brotli压缩减少了21％至25％的中位文件传输大小，导致带宽使用率降低和改进的加载时间。</p><p>    在WIX，我们始终使用CDN来服务于用户网站上的所有JavaScript代码和图像。</p><p> 最近，我们与我们的DNS提供商的解决方案集成，根据客户端和原点自动选择最佳表演CDN。这使我们能够从每个访问者的最佳位置服务静态文件，并避免某个CDN上的可用性问题。</p><p>  拼图的最后一部分是通过CDN：来自用户域的HTML服务的最后一个和最关键的部分。</p><p> 如上所述，我们创建了自己的内部解决方案来缓存并提供特定于站点的HTML和API结果。在这么多新地区维护此解决方案也具有其运营成本，并添加新位置成为我们需要管理和不断优化的过程。</p><p> 我们目前与各种CDN提供商集成，以支持直接从CDN位置服务的整个WIX站点，以改善全球服务器的分发，从而进一步改善响应时间。这是由于我们服务的大量域，这是一个挑战，这需要在边缘处的SSL终止。</p><p> 与CDNS集成，将WIX网站比以往更近为客户，并更具改进，加载体验，包括在我们方面没有增加努力的最新技术，如HTTP / 3。 </p><p>如果您运行WIX网站，则您可能会想知道这意味着如何转化为您的WIX网站绩效结果，以及我们如何与其他网站平台进行比较。</p><p> 在过去的一年里，上面的大部分工作都已部署，有些人仍在推出。</p><p> Web almanac通过HttParchive最近发布了2020年版，其中包括关于CMS用户体验的一篇优秀章节。请记住，本文中描述的许多数字是从2020年中旬开始。</p><p> 我们期待看到2021年的更新报告，并积极监控我们网站以及我们的内部性能指标的CRUX报告。</p><p> 我们致力于不断改进装载时间，并为我们的用户提供一个平台，他们可以在他们想象的情况下构建网站，而不会妥协。</p><p>  Debugbear最近发布了一个非常有趣的网站建设者绩效审查，它触及上面提到的一些区域，并检查了在每个平台上建立的非常简单的网站的性能。本网站近两年前建于，而不是修改，但该平台不断改进，并且可以通过在过去的一年中查看其数据来寻求现场性能，并且可以通过在过去的一年中查看其数据来见证。</p><p>  我们希望我们的经验激励您在您的组织中采取绩效导向的文化，上面的细节有用，适用于您的平台或网站。 </p><p>选择一系列指标，您可以始终如一地使用行业认可的工具。 我们推荐核心网络威力。  感谢您学习我们的故事，我们邀请您提出问题，在Twitter和Github上分享想法，并加入您喜欢的频道上的Web性能对话。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://web.dev/wix/">https://web.dev/wix/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/性能/">#性能</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/演变/">#演变</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/improved/">#improved</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/网站/">#网站</a></button></div></div><div class="shadow p-3 mb-5 bg-white rounded clearfix"><div class="container"><div class="row"><div class="col-sm"><div><a target="_blank" href="/story/1051650.html"><img src="http://img2.diglog.com/img/2021/3/thumb_63119baa40652a71c1157090f63d9d88.jpeg" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1051650.html">Adobe推出了一款针对Apple Silicon优化的Photoshop版本，在英特尔MAC上的大多数Photoshop任务中声称1.5倍的性能改进 </a></div><span class="my_story_list_date">2021-3-11 9:32</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049976.html"><img src="http://img2.diglog.com/img/2021/3/thumb_62d2811e9884847bee91074836281240.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049976.html">JavaScript性能超出捆绑包大小 </a></div><span class="my_story_list_date">2021-3-1 2:11</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049435.html"><img src="http://img2.diglog.com/img/2021/2/thumb_0d69274f2a0e3a9bd037fc5577579ddc.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049435.html">我们正在从头开始构建高性能的电动三轮车 </a></div><span class="my_story_list_date">2021-2-26 2:36</span></div><div class="col-sm"><div><a target="_blank" href="/story/1049195.html"><img src="http://img2.diglog.com/img/2021/2/thumb_0a8bd0437f81d04d698969277eb64997.png" class="img-fluid" onerror="this.style.display='none'"></a></div><div class="item_title"><a target="_blank" href="/story/1049195.html">GitHub具有降级的Git操作性能 </a></div><span class="my_story_list_date">2021-2-25 3:58</span></div></div></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>