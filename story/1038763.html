<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PowerShell Crescendo Preview.1 </title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">PowerShell Crescendo Preview.1 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-10 06:17:52</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/cfabe39003fcf5dfbc425873d56d9196.png"><img src="http://img2.diglog.com/img/2020/12/cfabe39003fcf5dfbc425873d56d9196.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>作为外壳，PowerShell旨在与cmdlet一起使用本机命令。但是，本机命令具有自己独特的语法，有时包含许多子命令和参数/开关，并且常常像其自身的语言一样。可以利用PowerShell的技巧来使用新命令，或者更加精通已经使用的本机命令，这不是很好吗？作为PowerShell用户，如果这些本机命令支持PowerShell功能，例如：</p><p>  我们很高兴地宣布PowerShell Crescendo的第一个预览版，这是一个可以快速开发用于本机命令的PowerShell cmdlet的框架，而不论平台如何。</p><p> 当今许多现代的本机命令都很复杂，它们本身都是微型外壳，具有包含子级别或子上下文的自己的微型语言。如果您使用过kubectl，docker或netsh.exe，则您会体会到执行和自动化这些命令的复杂性。</p><p> 为了使本机命令具有更类似于PowerShell的感觉并提供类似的体验，您可以自己重新编写该工具，或者如果该工具使用REST，则可以使用AutoRest直接调用Web API。这些选项效果很好，但是需要更多的开发经验，并且随着时间的推移可能很难维护。</p><p> Crescendo提供了一些工具，可轻松包装本机命令以获得PowerShellcmdlet的优势。将本机命令包装到Crescendo cmdlet中可以提供参数处理，例如提示输入强制性参数和使用制表符完成参数值。 Crescendo cmdletscan从本机应用程序获取文本输出，并将其解析为对象。输出对象使您可以利用所有后处理工具，例如Sort-Object，Where-Object等。</p><p>        Preview.2的Next / Future计划将基于反馈，并包括一些正在调查的项目：</p><p>   若要创建Crescendo cmdlet，您将需要PowerShell画廊中的模块Microsoft.PowerShell.Crescendo。 </p><p>我们包含了about_Crescendo，将来还会添加更多文档。请务必查看模块中的Samples文件夹。</p><p>  要编写Crescendo模块，您需要创建一个JSON配置文件，该文件描述了您希望如何将命令投射为cmdlet。您需要Microsoft.PowerShell.Crescendo模块来构建包含Crescendo代理cmdlet的完成模块。 Microsoft.PowerShell.Crescendo模块在PowerShell 7+上运行。</p><p> 要使用Crescendo内置的模块，不需要安装Microsoft.PowerShell.Crescendo。只需下载或安装生成的模块，就可以了。由于Crescendo构建的模块与其他模块一样，因此Windows PowerShell 5.1及更高版本支持这些模块。您的工作可以帮助社区中的其他人自动化本机命令。幸运的是，当您发布到PowerShell库时，构建和共享Crescendo模块非常容易。</p><p>     此示例基于易于显示，安装和删除软件的通用Linux打包实用程序构建。属性Verb和Noun定义新cmdlet Get-InstalledPackage的名称。</p><p> Crescendo模块包括一个架构定义文件，用于协助创建和编辑JSON配置文件。该模块包含模式文件Microsoft.PowerShell.Crescendo.Schema.json。在下面的示例中，模式文件被复制到具有正在开发的JSON文件的临时工作目录。模式文件的位置在JSON配置中定义，可以位于任何位置。</p><p>  OutputHandlers：输出处理程序捕获本机命令的字符串输出，并将其转换为结构化数据（对象）。与其他PowerShell cmdlet一样，可以在管道中进一步操作此对象的输出。</p><p> 注意：示例代码包含JSON中的注释（//＆lt;-）。它们仅用于描述目的，应删除。 </p><p>{＆＃34; $ schema＆＃34 ;:＆＃34; ./ Microsoft.PowerShell.Crescendo.Schema.json＆＃34 ;, //＆lt;-架构定义文件＆＃34; Verb＆＃34 ;:＆＃ 34; Get＆＃34 ;, //＆lt;-Cmdlet动词＆＃34;名词＆＃34;：＆＃34; InstalledPackage＆＃34 ;, //＆lt;-Cmdlet名词＆＃34; OriginalName＆＃34 ;: ＆＃34; apt＆＃34 ;， //＆lt;-本机命令＆＃34; OriginalCommandElements＆＃34 ;： [＆＃34; -q＆＃34;，＆＃34; list＆＃34;，＆＃34; --installed＆＃34;]，＆＃34; OutputHandlers＆＃34 ;： [//＆lt;-将字符串输出添加到对象{＆＃34; ParameterSetName＆＃34;：＆＃34; Default＆＃34 ;、＆ ＃34; Handler＆＃34 ;：＆＃34; $ args [0] |选择对象-跳过1 | ％{$ n，$ v，$ p，$ s =＆＃34; $ _＆＃34; -拆分＆＃39; ＆＃39 ;; [pscustomobject] @ {名称= $ n -replace＆＃39; / now＆＃39 ;;版本= $ v;建筑= $ p;状态= $ s.Trim（＆＃39;）-拆分＆＃39;，＆＃39; }}＆＃34; }]}</p><p> 以下示例显示了如何使用我们在JSON文件中定义的Get-InstalledPackage。</p><p> PS＆gt;获取安装包| Where-Object {$ _。name -match＆＃34; libc＆＃34;}名称版本体系结构状态---- ------- ------------ ---- -libc-bin 2.31-0ubuntu9.1 amd64 {已安装，本地} libc6 2.31-0ubuntu9.1 amd64 {已安装，本地} libcap-ng0 0.7.9-2.1build1 amd64 {installed，local} libcom-err2 1.45.5-2ubuntu1 amd64 {installed，local} libcrypt1 1：4.4.10-10ubuntu4 amd64 {installed，local} PS＆gt;获取安装包|组对象-属性体系结构计数名称组----- ---- ----- 10全部{@ {Name = adduser;版本= 3.118ubuntu2;建筑=全部； State = System.String [}，@ {Name = debconf; V…82 amd64 {@ {Name = apt;版本= 2.0.2ubuntu0.1;架构= amd64; State = System.String []}，@ {Name =基本文件…</p><p>  本示例包装了Windows命令ipconfig.exe，并说明了如何定义参数。除了上述示例中的属性之外，该架构还支持Parameters部分，以将描述性命名的参数包装并投影到新cmdlet中。</p><p>  {＆＃34; $ schema＆＃34; ：＆＃34; ./ Microsoft.PowerShell.Crescendo.Schema.json＆＃34 ;、＆＃34;动词＆＃34 ;：＆＃34; Get＆＃34 ;、＆＃34;名词＆＃34 ;：＆＃34 ; IpConfig＆＃34;，＆＃34; OriginalName＆＃34;：＆＃34; c：/windows/system32/ipconfig.exe&#34;，＆＃34;说明＆＃34 ::＆＃34; Windows＆＃34 ;,＆＃34; Parameters＆＃34;上的当前IP配置信息：[//＆lt;-参数定义{＆＃34; Name＆＃34;：＆＃34; All＆＃34 ;, //＆lt ;-出现在cmdlet中的参数名称＆＃34; OriginalName＆＃34 ;:＆＃34; / all＆＃34 ;, //＆lt;-出现在本机cmd中的原始参数的名称＆＃34; ParameterType＆＃ 34 ;:＆＃34; switch＆＃34 ;,＆＃34 ;:＆＃34;此开关提供所有ip配置详细信息＆＃34; //＆lt;-帮助参数}，{＆＃34; Name＆＃34;：＆＃34; AllCompartments＆＃34 ;、＆＃34; OriginalName＆＃34 ;：＆＃34; / allcompartments＆＃34 ;、＆＃ 34; ParameterType＆＃34 ;：＆＃34;开关＆＃34 ;，说明＆＃34 ;：＆＃34;此开关提供隔离专区配置详细信息＆＃34; }]，＆＃34; OutputHandlers＆＃34 ;: [{＆＃34; ParameterSetName＆＃34 ;:＆＃34; Default＆＃34 ;,＆＃34; Handler＆＃34;：＆＃34; param（$ lines） $ post = $ false; foreach（$ lines中的$ line |？{$ _。trim（）}）{$ LineToCheck = $ line |选择字符串＆＃39; ^ [a-z]＆＃39 ;; if（$ LineToCheck）{if（$ post）{[pscustomobject] $ ht |添加成员-pass -typename $ oName} $ oName =（$ LineToCheck -match＆＃39; Configuration＆＃39;）？ ＆＃39; IpConfiguration＆＃39; ：＆＃39; EthernetAdapter＆＃39 ;; $ ht = @ {}; $ post = $ true} else {if（$ line -match＆＃39; ^ [az]＆＃39;）{$ prop，$ value = $ line.split（＆＃39;：＆＃39;，2 ）; $ pName = $ prop -replace＆＃39; [.-]＆＃39 ;; $ ht [$ pName] = $ value.Trim（）} else {$ ht [$ pName] =。{$ ht [$ pName]; $ line.trim（）}}}} [pscustomobject] $ ht | add-member -pass -typename $ oName＆＃34; }]}</p><p>  导出Crescendo JSON配置文件会生成一个PowerShell模块，该模块可以在GitHub和PowerShell Gallery上本地共享。 Crescendo包括Export-CrescendoModule cmdlet，该cmdlet从JSON配置文件生成代理模块。</p><p>    使用Crescendo创建模块后，就可以像安装其他模块一样安装和导入它。请记住，无论在哪里安装Crescendo模块，您都将需要原始的本机命令。 </p><p>PS＆gt; 导入模块.ipconfig.psm1PS＆gt; Get-IpConfig-全部| 选择对象属性ipv4address，DefaultGateway，子网掩码ipv4address DefaultGateway子网掩码------------------------- ---------- 172.24.112.1 255.255.240.0192.168.94.2 {fe80 :: 145e：1779：5cfa：c2a5％8，192.168.94.1} 255.255.255.0  我们的目标是使将本机命令转换为PowerShell cmdlet并更轻松地接收PowerShell提供的好处。 我们重视您的想法和反馈，希望您能尝试Crescendoa，然后在我们的GitHub存储库中停下来，让我们知道您想要添加的任何问题或功能。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://devblogs.microsoft.com/powershell/announcing-powershell-crescendo-preview-1/">https://devblogs.microsoft.com/powershell/announcing-powershell-crescendo-preview-1/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/crescendo/">#crescendo</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>