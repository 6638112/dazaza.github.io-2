<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>街头斗士2中视差效果的行滚动</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">街头斗士2中视差效果的行滚动</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-24 07:25:39</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/44724c33467d8557ff321189042ede72.png"><img src="http://img2.diglog.com/img/2020/10/44724c33467d8557ff321189042ede72.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>In the last post we looked at what tilemaps are and how they’re used in SF2, and ended with a mention of how multiple layers (or  scrolls) of tilemaps can be moved at different amounts to achieve  parallax scrolling, creating the illusion of depth.</p><p>在上一篇文章中，我们研究了什么是地图以及如何在SF2中使用地图，并在最后提到了如何以不同的数量移动多层(或滚动)地图来实现视差滚动，从而创造出深度的错觉。</p><p>  This really only works for elements that are standing upright, though. There’s no way we can use this effect for horizontal surfaces like floors and ceilings – we’d either need to use a lot more layers which we don’t have, or a huge amount of tiles to represent different perspective angles, which we’d rather not.</p><p>不过，这实际上只适用于直立的图元。我们没有办法将这种效果用于地板和天花板等水平表面-我们要么需要使用更多我们没有的层，要么需要大量的瓷砖来表示不同的透视角度，这是我们不愿使用的。</p><p> For horizontal surfaces like floors and ceilings, SF2 uses another technique called row scrolling (a.k.a. line scrolling).</p><p>对于地板和天花板等水平表面，SF2使用另一种称为行滚动的技术(也称为。行滚动)。</p><p> We saw in the previous post that the CPS1 has three layers of tilemaps which can be scrolled independently: Scrolls 1 through 3. One of these layers is special, and allows for each individual row of pixels to be scrolled horizontally, in addition to the entire layer itself. We can see this effect on the the floor here:</p><p>我们在上一篇文章中看到，CPS1有三层可以独立滚动的平铺地图：滚动1到3。其中一层是特殊的，除了整个层本身之外，还允许水平滚动每一行像素。我们可以在这里的地板上看到这个效果：</p><p>  This layer is Scroll 2. In SF2 we can think of this as the “main” scroll. The other two scrolls and the sprites are always positioned somewhere relative to this main scroll’s position, and the  Z-depth of those scrolls.</p><p>这一层是卷轴2。在SF2中，我们可以认为这是“主”卷轴。其他两个卷轴和精灵总是相对于这个主卷轴的位置和那些卷轴的Z深度放置在某个位置。</p><p> We can think of an imaginary line just underneath the feet of our fighters as having a Z-depth of zero. A small amount of floor in front of the fighters has a negative Z-depth, with background elements having some positive Z-depth.</p><p>我们可以把战斗机脚下的一条假想线想象成Z深度为零。战斗机前面的少量地面具有负Z深度，背景元素具有一些正Z深度。</p><p> As the camera moves horizontally, elements with a negative Z-depth move more than elements at Z=0, which in turn move more than elements with a positive depth. Elements very far away (in photography and modelling we call this “at infinity”) don’t move at all.</p><p>当相机水平移动时，Z深度为负的元素的移动比Z=0的元素移动的多，而Z=0的元素的移动又比深度为正的元素移动的多。非常远的元素(在摄影和建模中我们称之为“无穷远”)根本不会移动。</p><p> This matches our experience with the real world, for example riding a train and looking out the window a far away mountain. In the space of a minute, the mountain seems not to move at all, nearer features appear, cross our vision and disappear from view, while the fence bordering the railways corridor whizzes past, the only object giving us a true sense of the train’s speed.</p><p>这与我们与现实世界的体验相吻合，例如，乘坐火车，向窗外望去一座遥远的山。在一分钟的时间里，山似乎一动不动，更近的特征出现了，跨过了我们的视线，从视线中消失了，而铁路走廊边上的栅栏呼啸而过，唯一让我们真正感受到火车速度的物体。</p><p> Let’s take a look at E Honda’s stage as it is the most interesting. All of the SF2 stages have a floor with parallax scrolling, only a few also have a ceiling, but E Honda’s also has a nice bath in the centre of the stage. Let’s look at how that stage is layered:</p><p>让我们来看看E Honda的舞台，因为它是最有趣的。所有的SF2赛段都有一个视差滚动的地板，只有少数几个也有天花板，但E Honda的舞台中央也有一个很好的浴缸。让我们看看这个舞台是如何分层的：</p><p>  We have Scroll 1, with the front surface of the bath, Scroll 2 containing the floor, ceiling and the top surface of the bath, and Scroll 3 with the background.</p><p>我们有带有浴缸正面的Scroll1，包含地板、天花板和浴缸顶面的Scroll2，以及带有背景的Scroll3。</p><p> The three layers combine with the sprites to create the full image shown below. Ken and Ryu’s sprites are anchored to Scroll 2, water dripping from the bath and a small tub are anchored to Scroll 1, which contains the front surface of the bath.</p><p>这三个层与精灵结合在一起创建了如下所示的完整图像。Ken和Ryu的精灵锚定在Scroll 2上，浴缸滴水和一个小浴缸锚定在Scroll 1上，Scroll 1包含了浴缸的前表面。</p><p>  Note that while Scroll 1 is drawn on top of the other layers, the object it contains appears between the floor and the top of the bath. This works, because Scroll 1 moves as if it were located there. The key thing here is that the layer’s  priority (which layers it is drawn on top of) and the layer’s  displacement are two different things.</p><p>请注意，虽然滚动1绘制在其他层的顶部，但它包含的对象显示在地板和浴缸顶部之间。这是可行的，因为Scroll 1移动起来就像它位于那里一样。这里的关键是图层的优先级(在哪些图层上绘制)和图层的位移是两个不同的东西。</p><p> Note also that the scrolls don’t have to be layered with 1 on top and 3 at the bottom, it just happens to be this way for E Honda’s stage. Ryu’s stage uses Scroll 1 for drawing the sky, which places it underneath all the others. The clouds in the sky fly past independently of our movement on the stage – parallax isn’t used for it all.</p><p>还要注意的是，卷轴不一定要分层1在顶部和3在底部，它只是碰巧是这样的E本田的舞台。龙的舞台用卷轴1来画天空，把它放在所有其他的下面。天空中的云彩独立于我们在舞台上的移动而飞过-视差不是用来做所有事情的。</p><p> Consecutive rows in Scroll 2 are grouped together depending on which surface they belong two, and each row within that group is displaced by a certain amount to create a  shear transformation. I’ve drawn a rectangle around the floor area so its effect can be easily seen:</p><p>Scroll 2中的连续行根据它们所属的两个曲面被分组在一起，并且该组中的每一行都被位移一定的量以创建剪切变换。我在楼层周围画了一个矩形，这样就可以很容易地看到它的效果：</p><p>  In the centre of the stage, the horizontal offset is zero, and the tiles are drawn unmodified. As we move away from the centre of the stage, the rectangle becomes more and more skewed, and the entire layer also scrolls, giving the appearance of a flat horizontal plane behaving as if we were looking at a 3D scene.</p><p>在舞台中央，水平偏移为零，并且平铺被原封不动地绘制。当我们离开舞台中心时，矩形会变得越来越倾斜，整个图层也会滚动，给人一种平面水平面的感觉，就像我们在看3D场景一样。</p><p> Why can’t the front of the bath just go in Scroll 2? Because there are 16 rows of floor pixels that are beyond it. If the bath were in the same layer, it would be sheared along with the floor tiles, which wouldn’t look right. You can see the sheared floor rows disappearing behind the bath here:</p><p>为什么不能把浴缸的前面放在卷轴2里？因为它上面有16行楼层像素。如果浴缸在同一层，它就会和地砖一起被剪掉，这样看起来就不对了。你可以看到被剪掉的地板排在浴缸后面消失了：</p><p>  The same effect is used on the ceiling and the top of the bath. Nothing remarkable happens with Scroll 3, the most distant, background layer, until the round ends and man holds up his sign. (I used to think it was meant to be some sort of candy bar commercial, but it turns out the kanji says something like “round complete”).</p><p>同样的效果也用于天花板和浴缸顶部。最远的背景层Scroll3没有什么特别的事情发生，直到这一轮结束，人类举起了他的牌子。(我过去认为这是一种糖果广告，但原来汉字说的是“完整的圆”)。</p><p> This has been a visual overview of how the CPS1 uses row scrolling in addition to layered tilemaps to create parallax effects. In the next post, we’ll look under the hood at the code that makes all this happen.</p><p>这是CPS1如何使用行滚动以及分层平铺地图来创建视差效果的可视概述。在下一篇文章中，我们将深入了解实现这一切的代码。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://sf2platinum.wordpress.com/2020/10/15/row-scrolling-for-parallax-effects/">https://sf2platinum.wordpress.com/2020/10/15/row-scrolling-for-parallax-effects/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/视差/">#视差</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/scrolling/">#scrolling</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/滚动/">#滚动</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>