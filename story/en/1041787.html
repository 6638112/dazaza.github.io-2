<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Vacietis，一个针对Common Lisp的C编译器 Vacietis, a C compiler targeting Common Lisp</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Vacietis, a C compiler targeting Common Lisp<br/>Vacietis，一个针对Common Lisp的C编译器 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-12-26 00:13:07</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/12/f615d833ece725d282b56c4c82184eb8.png"><img src="http://img2.diglog.com/img/2020/12/f615d833ece725d282b56c4c82184eb8.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Vacietis is a C compiler for Common Lisp systems.Vacietis works by loading C code into a Common Lisp runtime as thoughit were Lisp code, where it can then be compiled or evaled. The loadedC code has the same function calling convention as regular CL code anduses the same numerical representations. C memory is backed by regularCommon Lisp arrays.Vacietis comes with a libc implemented in portable Common Lisp.* INSTALLING: ----------You can obtain Vacietis from github:git clone  https://github.com/vsedach/Vacietis.gitAll Vacietis dependencies are available via Quicklisp( http://www.quicklisp.org/). If you put Vacietis inquicklisp/local-projects/ you can just load it with(ql:quickload &#34;vacietis&#34;)* USAGE: -----C code can be read in the same way as regular Lisp code by usingreadtables:(let ((*readtable* vacietis:c-readtable) (vacietis:*compiler-state* (vacietis:make-compiler-state))) (read &lt;some stream&gt;))The Vacietis reader keeps track of type and preprocessormacro declarations in a compiler state object bound by*compiler-state*. This mechanism is exposed to make it possible tocreate things like C REPLs.To simplify loading C files, a convenience function is provided thatsets up the readtable, compiler state, and additional debugginginformation before calling LOAD:(vacietis:load-c-file &#34;/foo/bar/file.c&#34;)* COMPILER EXECUTABLE: -------------------The system vacietis.vcc produces a toy C compiler executable that cantake a single-file C program and produce an executableprogram. Currently it needs CCL, CLISP, or SBCL to work. Sample run:(ql:quickload &#34;vacietis.vcc&#34;) will produce the executable vcc/vcc inthe Vacietis source directory.$ ./vcc ../test/programs/hanly-83-scanf/main.cProduces the file a.out in the current directory.$ ./a.outEnter 8 numbers separated by blanks or &lt;return&gt;s&gt;* TECHNICAL DETAILS: -----------------Vacietis uses the memory model of Common Lisp as is, so sizeof of theprimitive data types (char, int, float etc.) is all 1. This shouldn&#39;tbe a problem for most C code, but some C programs claim to be portablewhile making assumptions that things can be cast into an array ofchars to be manipulated. These programs won&#39;t work under Vacietis.The basic idea for the Vacietis runtime and memory model comes fromScott L. Burson&#39;s Zeta-C compiler for Lisp Machines: http://www.bitsavers.org/bits/TI/Explorer/zeta-c/The technique for representing pointers to arbitrary C lvalues asclosures was first demonstrated by Oleg Kiselyov: http://okmij.org/ftp/Scheme/pointer-as-closure.txtThe idea for a combined single-pass preprocessor/tokenizer/parsercomes from Fabrice Bellard&#39;s TCC:  http://bellard.org/tcc/* OBTAINING CODE AND HELP: -----------------------The official Vacietis repository is at: https://github.com/vsedach/vacietisThere is a Vacietis mailing list on the web: http://groups.google.com/group/vacietisBug reports can be sent to the mailing list: http://groups.google.com/group/vacietisthe github issue tracker: https://github.com/vsedach/vacietisor directly to the author:vsedach@gmail.com* UNIT TESTS: ----------(ql:quickload &#34;vacietis.test&#34;)(vacietis.test:run-tests)The Vacietis test suite includes a variety of code that tests thecompiler and libc.* TODO: ----- pointer scaling- enums: assignment of arbitrary values to enum labels- struct call by value- pass arguments to main()- implement overloading class scope correctly (see H&amp;S p. 147)- libc stdio: binary streams- libc stddef: offsetof- libc signal- libc stdlib: div/ldiv, srand, exit cleanup, bsearch, qsort- libc time- libc setjmp* THINGS THAT PROBABLY WON&#39;T BE SUPPORTED: ---------------------------------------- trying to cast arrays of chars to other types (mmap)- any kind of GCC extension* LICENSING INFORMATION ---------------------Vacietis is authored by Vladimir Sedach &lt;vsedach@gmail.com&gt;; thelatest copyright year is 2012.Vacietis is licensed under the LLGPL (see the file LICENSE includedwith the distribution for details).Portions of the Vacietis libc may be derived from Zeta-C (releasedinto the public domain by its author, Scott L. Burson) and ErikAndersen&#39;s &lt;andersen@codepoet.org&gt; LGPL-licensed uClibc( http://www.uclibc.org/)</p><p>Vacietis是Common Lisp系统的C编译器.Vacietis的工作原理是将C代码加载到Common Lisp运行时中，就像Lisp代码一样，然后可以在其中进行编译或回避。重载的C代码具有与常规CL代码相同的函数调用约定，并使用相同的数字表示形式。 C内存由regularCommon Lisp数组支持。Vacietis带有在便携式Common Lisp中实现的libc。*安装：----------您可以从github：git clone https://github.com/获得Vacietis。 vsedach / Vacietis.git所有Vacietis依赖项都可以通过Quicklisp（http://www.quicklisp.org/）获得。如果您将Vacietis inquicklisp / local-projects /放在其中，则可以使用（ql：quickload＆＃34; vacietis＆＃34;）*加载它：用法：----- C代码的读取方式与常规Lisp代码相同通过使用readtables :(让（（（* readtable * vacietis：c-readtable）（vacietis：* compiler-state *（vacietis：make-compiler-state））））（read＆lt; some stream＆gt;））Vacietis阅读器会跟踪由* compiler-state *绑定的编译器状态对象中的type和preprocessormacro声明。公开了这种机制，使创建C REPL之类的东西成为可能。为简化C文件的加载，提供了一个便捷函数，该函数在调用LOAD：（vacietis：load-c-file＆＃之前设置了readtable，编译器状态和其他调试信息34; /foo/bar/file.c&#34;）*编译器可执行：-------------------系统vacietis.vcc产生一个玩具C编译器可执行文件一个单文件C程序并生成一个可执行程序。当前，它需要CCL，CLISP或SBCL才能工作。运行示例（ql：quickload＆＃34; vacietis.vcc＆＃34;）将在Vacietis源目录中生成可执行文件vcc / vcc。$ ./vcc ../test/programs/hanly-83-scanf/main.c $。/ a.out输入8个数字，用空格或＆lt; return＆gt; s＆gt; *分隔*数字技术细节：-----------------照原样使用Common Lisp的内存模型，因此原始数据类型（char，int，float等）的sizeof全部为1。这对于大多数C代码来说都不是问题，但是某些C程序声称可移植而假设可以将事物转换为要操纵的字符数组。这些程序无法在Vacietis下工作。Vacietis运行时和内存模型的基本思想来自Scott L. Burson的Lisp机器的Zeta-C编译器：http://www.bitsavers.org/bits/ TI / Explorer / zeta-c / Oleg Kiselyov首次演示了表示指向任意C lvalue封闭式的指针的技术：http://okmij.org/ftp/Scheme/pointer-as-closure.txt通过Fabrice Bellard的TCC传递预处理器/令牌生成器/解析器：http://bellard.org/tcc/*获取代码和帮助：------------------- ----官方的Vacietis存储库位于：https://github.com/vsedach/vacietis网络上有Vacietis邮件列表：http://groups.google.com/group/vacietis错误报告可以发送到邮件列表：http://groups.google.com/group/vacietisthe github问题跟踪器：https://github.com/vsedach/vacietis或直接发送给作者：vsedach@gmail.com*单元测试：----- -----（ql：quickload＆＃34; vacietis.test＆＃34;）（vacietis.test：run-tests）The Va cietis测试套件包括用于测试编译器和libc的各种代码。* TODO：-----指针缩放-枚举：为枚举标签分配任意值-通过值传递结构调用-main（）的传递参数-实现重载类范围正确（请参阅H＆amp; S 147）-libc stdio：二进制流-libc stddef：offsetof- libc signal- libc stdlib：div / ldiv，srand，exit clean，bsearch，qsort- libc time- libc setjmp *支持的东西可能会赢： ----------------------------------------尝试将字符数组转换为其他类型（ mmap）-任何类型的GCC扩展*许可信息--------------------- Vacietis由Vladimir Sedach＆lt; vsedach@gmail.com&gt;创作；最新的版权年是2012年。Vacietis已获得LLGPL的许可（有关详细信息，请参见分发中包含的文件LICENSE）。Vacietis libc的某些部分可能来自Zeta-C（其作者Scott L. Burson向公共领域发行）。和ErikAndersen的＆lt; andersen@codepoet.org&gt; LGPL许可的uClibc（http://www.uclibc.org/） </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://github.com/vsedach/Vacietis">https://github.com/vsedach/Vacietis</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/编译/">#编译</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/lisp/">#lisp</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/compiler/">#compiler</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/vacietis/">#vacietis</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>