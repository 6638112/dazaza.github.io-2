<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Chrome的代理预取建议：隐私，安全性和更广泛的网络含义 Chrome's proxy prefetch proposal: Privacy, Security and broader web implications</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Chrome's proxy prefetch proposal: Privacy, Security and broader web implications<br/>Chrome的代理预取建议：隐私，安全性和更广泛的网络含义 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-21 07:37:06</div><div class="page_narrow text-break page_content"><p>I have high regards for Chrome Security team because of their attention to detail in securing Chrome users against attacks from malicious publishers (case in point: see Chrome’s  Site Isolation work).</p><p>我对Chrome Security团队表示高度赞赏，因为他们注重细节，以保护Chrome用户免受恶意发布者的攻击（例如：请参阅Chrome的网站隔离工作）。</p><p> However, Privacy in Chrome is a completely different story. In the past, they have used dark patterns to leak user’s information to Google servers (e.g., Chrome automatically  logging users into the browser, Chrome  sending an user identifying attribute to Google servers, Chrome  exempting Google sites from user site data setting).</p><p> 但是，Chrome中的隐私则完全不同。过去，他们使用暗纹将用户信息泄漏到Google服务器（例如，Chrome自动将用户登录到浏览器中，Chrome将用户标识属性发送到Google服务器，Chrome将Google网站从用户网站数据设置中排除）。</p><p> More recently, Google has now started silently intercepting the user traffic, and proxying it via their servers without the consent from either the user or the web developer (Look for “search result link prefetches” in Chrome’s privacy  whitepaper, related GitHub  proxy proposal and the alternate-loading-modes  proposal). I’m sad to say this, but this is the figurative straw that finally broke the camel’s back, and  I have completely lost my trust in Chrome.</p><p> 最近，Google现在已开始悄悄地拦截用户流量，并在未经用户或Web开发人员同意的情况下通过其服务器进行代理（在Chrome的隐私白皮书，相关的GitHub代理建议和Google隐私白皮书中查找“搜索结果链接的预取”）。备用加载方式提案）。我很伤心地说，但是这是比喻的稻草最终压垮骆驼的背上，我已经完全失去了我在Chrome的信任。</p><p>   In the past, Google rolled out the proposal of signed exchanges that enabled aggregators (such as Google’s search engine) to serve content on behalf of other sites. Safari and Firefox do not support signed exchange even to this date due to security concerns. Google “handled” their concerns by claiming that signed exchanges are an opt-in feature by sites, and they need to be aware of the security risks. See  comment from Mozilla capturing this sentiment: “Sites opt-in to using this mechanism, and in doing so need to be aware that this comes with some risks, but in doing so they enable a new feature”.</p><p>   过去，Google推出了签署交易的提议，该提议使聚合器（例如Google的搜索引擎）能够代表其他站点提供内容。出于安全考虑，Safari和Firefox甚至在此日期之前都不支持签名交换。 Google通过声称已签署的交易所是站点的选择功能来“解决”他们的担忧，他们需要意识到安全风险。请参见Mozilla对此观点的评论：“网站选择使用此机制，这样做时需要意识到这样做会带来一些风险，但这样做会启用新功能”。</p><p> From what I can tell, most of the web developers also decided not to opt-in to signed exchanges. This significantly reduced the uptake of the signed exchanges, but on the positive side, it also meant that the developers had a say in what they were getting in to.</p><p> 据我所知，大多数Web开发人员还决定不加入已签署的交易所。这大大减少了已签约交易所的使用，但从积极的方面来说，这也意味着开发人员对他们的发展拥有发言权。</p><p> This new proposal from Google seems like another take of the similar idea. However, this time  Google has decided to silently proxy user’s traffic through their servers without any opt-in from either the user or the site.</p><p> Google的这项新提议似乎是对类似想法的另一种理解。但是，这次Google决定通过用户的服务器以静默方式代理用户的流量，而无需用户或网站的任何选择。</p><p> Now, that’s a problem for multiple reasons. I dug through the proposals, Chrome Privacy whitepaper, code source and distilled them down:</p><p> 现在，这个问题有多种原因。我仔细研究了提案，Chrome隐私权白皮书，代码源并将其精简如下： </p><p>  To understand these risks better, think of the proposed CONNECT HTTPS proxy as like a VPN. At first level approximation, exposing user information to a completely new entity (VPN or a proxy) is privacy negative. Of course, if the protocol and the proxy are well-designed and trusted, it could actually improve user’s privacy. Unfortunately, I do not think that’s case here. There are at least few specific ways in which Chrome’s private proxy proposal leaks user’s information:</p><p>为了更好地理解这些风险，可以将建议的CONNECT HTTPS代理视为VPN。在第一层近似上，将用户信息公开给一个全新的实体（VPN或代理）对隐私不利。当然，如果协议和代理经过精心设计和信任，则实际上可以改善用户的隐私。不幸的是，我认为情况并非如此。 Chrome的私人代理建议至少有几种特定的方式泄漏用户的信息：</p><p> The proposal mentions that the browser would only prefetch the URLs for which the user does not have cookies. Imagine that Google search page (or GMail or any other page controlled by Google) requests prefetching of https://foo.com and https://bar.com. Lets say user had cookies for foo.com, and so Chrome would only prefetch bar.com. By joining logs internally among different backends, Google can easily conclude that the user has previously visited foo.com.  This leaks user’s browsing history to Google without user’s consent.</p><p> 该提案提到，浏览器将仅预取用户没有Cookie的URL。假设Google搜索页面（或GMail或Google控制的任何其他页面）请求预取https://foo.com和https://bar.com。假设用户有用于foo.com的cookie，因此Chrome只会预取bar.com。通过内部在不同后端之间加入日志，Google可以轻松得出用户先前访问过foo.com的结论。未经用户同意，这会将用户的浏览历史记录泄露给Google。</p><p> Past Browsing history leaked to the employer: Lets say your employer wants to determine if you have visited https://foo.com in the past on the employer’s network or even outside on networks they do not control. To do this, your employer requests prefetching of https://foo.com on one of the webpages on the company’s Intranet webpage. Since Chrome will prefetch https://foo.com only if the user has not visited it in the past, the employer can observe the prefetched traffic, and determine user’s browsing history.</p><p> 过去的浏览历史泄露给了雇主：可以说，您的雇主想确定您过去是否在雇主的网络上访问过https://foo.com，或者甚至在他们无法控制的网络上访问过外部。为此，您的雇主要求在公司Intranet网页上的其中一个网页上预提取https://foo.com。由于Chrome仅在用户过去没有访问过https://foo.com时才会预取https://foo.com，因此雇主可以观察预取的流量并确定用户的浏览历史记录。</p><p> Browsing history leaked to all network observers: By the same logic as above, user’s network provider (think ISP/hotel/airport/coffee-chain WiFi) can also determine user’s past browsing history without their consent. This would happen even if all sites and connections are using HTTPS.</p><p> 浏览历史记录泄露给所有网络观察者：按照与上述相同的逻辑，用户的网络提供商（例如ISP /酒店/机场/咖啡链WiFi）也可以在未经用户同意的情况下确定用户的过去浏览历史记录。即使所有站点和连接都使用HTTPS，也会发生这种情况。</p><p>   It’s unclear what privacy guarantees are provided by the proxy and how the user or the web developer can verify those guarantees. Would Google use the intercepted traffic to build the ad profile of the user? I wish the proposal provided more clarity on the guarantees provided by the proxy, and how the users and developers can verify those guarantees.</p><p>   目前尚不清楚代理提供了哪些隐私保证，以及用户或网络开发人员如何验证这些保证。 Google会使用拦截的流量来构建用户的广告资料吗？我希望该提案在代理提供的保证以及用户和开发人员如何验证这些保证方面更加清晰。</p><p> Google does not disclose what user information they are logging at the proxy. I’m suspicious that to prevent abuse, the proxy would end up logging more information than just the user’s IP address. See this Tom Scott’s  video on VPNs for a similar discussion.</p><p> Google不会透露他们正在代理服务器上记录的用户信息。我怀疑为防止滥用，代理最终会记录的信息不仅仅是用户的IP地址。有关类似的讨论，请参见Tom Scott的有关VPN的视频。</p><p>  Users generally do not know this, but a proxy or a VPN can leverage recently leaked TLS certificates to inject malicious code on the browser. If the browser has not yet learned about the revoked certificates, it gives a window of opportunity to the proxy/VPN to create malicious HTML/JavaScript, sign it using leaked certificate, and deliver it to the browser. The browser would happily cache the malicious code for whatever duration is specified in the cache headers by the malicious proxy, and run that malicious code every time user visits that website.</p><p>  用户通常不知道这一点，但是代理或VPN可以利用最近泄漏的TLS证书在浏览器中注入恶意代码。如果浏览器尚未了解已吊销的证书，它将为代理/ VPN提供机会来创建恶意HTML / JavaScript，使用泄漏的证书对其进行签名，然后将其交付给浏览器。无论恶意代理在缓存头中指定的持续时间是多少，浏览器都会愉快地缓存恶意代码，并在用户每次访问该网站时运行该恶意代码。 </p><p> Now, I’m sure Google would not push malicious code to its own users, but it definitely makes proxy an appealing target for the attackers and authorities. The users or the publishers have no visibility in the working of the proxy and no way to verify on a continuous basis that the proxy has not been compromised.  As a user or a developer, I do not see why I should use a browser that unnecessarily increases my security attack surface?</p><p>现在，我确定Google不会将恶意代码推送给自己的用户，但它无疑使代理成为攻击者和当局的一个有吸引力的目标。用户或发布者在代理的工作过程中没有可见性，也无法连续地验证代理没有受到损害。作为用户或开发人员，我看不到为什么我应该使用不必要地增加安全攻击面的浏览器？</p><p>   The proposal requires sites to burden the serving cost of the prefetch traffic, but does not provide them with any tools to manage the traffic. The IP address of the other endpoint is hidden from the site which would make it difficult for them to detect abusive traffic. They have to rely entirely on the proxy to filter-out the abuse traffic.</p><p>   该提案要求站点负担预取流量的服务成本，但不向其提供任何工具来管理流量。该站点隐藏了另一个端点的IP地址，这将使他们很难检测到滥用流量。他们必须完全依靠代理来过滤滥用流量。</p><p> If you have ever used Google Search on VPN, you have probably gotten captchas. That tells us that Google is wary of trusting other services that hide user’s IP address. If so,  why would Google expect other web developers to blindly trust Google and relinquish their control to Google?</p><p> 如果您曾经在VPN上使用过Google搜索，那么您可能已经获得了验证码。这告诉我们，Google对信任隐藏用户IP地址的其他服务非常谨慎。如果是这样，为什么Google会期望其他Web开发人员盲目地信任Google并将其控制权交给Google？</p><p>   The proposal mentions that it will allow sites to opt-out from proxying. However, would Google start directly or indirectly punishing the sites that opt-out by de-ranking those sites from Google searches? That would mean that the sites would have the option to either relinquish their security and controls, or lose their market business — not really the best set of options.</p><p>   该提案提到它将允许站点选择退出代理。但是，Google会通过从Google搜索中取消对那些退出网站的排名来直接或间接地对其进行惩罚？这意味着这些站点将可以选择放弃其安全性和控制权，或者失去其市场业务-并不是真正的最佳选择。</p><p>   The sites have to rely on the proxy to filter the abusive traffic and blindly trust the proxy. Since there are only so many proxies that an individual site can blindly trust, it naturally means that the web ecosystem can realistically support very few proxies. It would not be possible for upcoming web browsers (or browsers with lower market share) to earn the trust of the developers.  This further centralizes the web at Google.</p><p>   这些站点必须依靠代理来过滤滥用流量并盲目地信任代理。由于只有单个站点可以盲目信任的代理，因此自然意味着Web生态系统实际上可以支持很少的代理。即将到来的Web浏览器（或市场份额较低的浏览器）将不可能赢得开发人员的信任。这进一步将网络集中在Google上。</p><p> At the same time, it’s unclear whether the proxy would give some preferential treatment to prefetches from Google websites vs. others. e.g., marking prefetch traffic from other sites as abusive, while letting www.google.com prefetch indiscriminately? Google should provide more details on their abuse prevention mechanisms.</p><p> 同时，目前尚不清楚代理服务器是否会相对于其他网站对Google网站的预取进行某些优惠。例如，将来自其他网站的预取流量标记为滥用，同时让www.google.com进行不加选择的预取？ Google应该提供有关其滥用预防机制的更多详细信息。</p><p>   The proposal mentions that it would allow users to opt-out from this traffic interception, but I will argue that enabling this feature by default is another example of Chrome’s dark pattern.  Users should not have to stay on a constant vigil to avoid hostile defaults in their software.</p><p>   该提案提到将允许用户退出这种流量拦截，但是我将争辩说默认情况下启用此功能是Chrome暗模式的另一个示例。用户不必一直保持警惕，以避免其软件中出现恶意的默认设置。 </p><p>   I’m sure that Google would try its best to safeguard its proxy against attackers. I’m less sure of whether they would fix the privacy gaps or provide more guarantees about how the proxy would safeguard sites from abusive traffic while logging minimal user information.</p><p>我确信Google会尽力保护其代理服务器免受攻击。我不太确定他们是否会解决隐私方面的差距，或者就代理如何在记录最少的用户信息的同时保护站点免受滥用流量的影响提供更多保证。</p><p> For me, I’m just left speechless that it’s somehow considered okay for the browser to automatically proxy parts of user traffic. If Chrome wants to earn the user trust, they would hopefully move this feature behind a site or user opt-in.</p><p> 对我来说，我只是无语了，认为浏览器自动代理部分用户流量是可以的。如果Chrome希望赢得用户的信任，他们希望将此功能移至网站或用户选择加入之后。</p><p>   I would suggest sites to opt-out of this feature as soon as possible to avoid security risks and for safe-guarding the privacy of their users.</p><p>   我建议站点尽快选择退出此功能，以避免安全风险并安全保护用户的隐私。</p><p> In the end, the goal of these proposals is to have users give out their private information to Google instead of the individual sites. If so, I would challenge Chrome to go with a 3rd option: Go back to whiteboard and design a solution that does not discloses user’s private information to either sites or to Google. Design a solution that both users and sites like. That way you would not have to strong-arm users and sites into a feature that’s harmful to users, sites and the broader web.</p><p> 最后，这些建议的目标是让用户向Google而不是单个网站提供其私人信息。如果是这样，我会挑战Chrome的第三个选择：回到白板并设计一种解决方案，该解决方案不会向网站或Google披露用户的私人信息。设计一个用户和网站都喜欢的解决方案。这样一来，您就不必将用户和网站强加于对用户，网站和整个网络有害的功能。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://securityrxer.substack.com/p/chromes-proxy-prefetch-proposal-privacy">https://securityrxer.substack.com/p/chromes-proxy-prefetch-proposal-privacy</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/chrome/">#chrome</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/代理/">#代理</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/proxy/">#proxy</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>