<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>灵丹妙药1.11</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">灵丹妙药1.11</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-07 12:11:36</div><div class="page_narrow text-break page_content"><p>在最近的版本中，Elixir团队一直专注于编译器，无论是在编译时捕获更多错误，还是在提高速度方面都是如此。ELEXIRV1.11在这两个方面都取得了很好的进展。此版本还包括许多其他优点，例如更紧密的Erlang集成、对更多保护表达式的支持、内置日期时间格式设置和其他日历增强。</p><p>在此期间，我们还开始在我们的网站上发布一系列生产案例，介绍Elixir在Brex、Farmbot和Heroku的使用情况，很快还会有更多的案例。</p><p>在v1.10的基础上，我们进一步集成了Erlang的新日志记录器，添加了四个新的日志级别：通知、严重、警报和紧急，与syslog标准中的所有日志级别相匹配。Logger模块现在通过将映射和关键字列表传递给其各种功能来支持结构化日志记录。还可以通过Logger.put_module_level/2函数指定每个模块的日志级别。未来版本中将添加每个应用程序的日志级别。</p><p>IEX也得到了改进，可以直接从您的Elixir终端显示Erlang模块的文档。例如，下面是我访问Erlang的gen_server模块的文档的片段：</p><p>这可以与Erlang/OTP23+一起使用，并且要求已经使用文档块编译了Erlang模块。非常感谢Erlang/OTP团队和Erlang生态系统基金会的文档工作组使这成为可能。</p><p>Elixir v1.11构建在最近添加的编译跟踪程序之上，以跟踪应用程序边界。从本版本开始，如果您从现有模块调用函数，但此模块不属于您列出的任何依赖项，则Elixir将发出警告。</p><p>这两个条件看起来可能是矛盾的。毕竟，如果模块可用，那么它一定来自依赖项。在两种情况下并非如此：</p><p>Elixir和Erlang/OTP中的模块始终可用-即使它们的应用程序未明确列为依赖项</p><p>在伞形项目中，因为所有子应用程序都是在同一个VM内编译的，所以即使您不依赖于所述兄弟项目，也可能有来自兄弟项目的模块可用。</p><p>这个新的编译器检查确保您调用的所有模块都作为依赖项的一部分列出，否则会发出如下警告：</p><p>：ssl.connect/2在application：ssl中定义，当前应用程序使用，但当前应用程序不直接依赖：ssl。要解决此问题，您必须执行以下操作之一：1.如果：SSL是Erlang/Elixir的一部分，则必须将其包含在您的Mix.exs 2中的：Extra_Applications Inside&#34；def application&#34；下。如果：SSL是一个依赖项，请确保它列在Mix.exs中的&#34；def deps&#34；下面。如果您不想向：SSL添加要求，您可以选择通过将[xref：[Exclude：：SSL]添加到您的&34；def项目中来跳过此警告。</p><p>这在伞形项目中带来了额外的好处，因为它要求子应用程序显式列出它们的依赖项，完全拒绝兄弟项之间的循环依赖项。</p><p>在Elixirv1.11中，编译器还跨函数体跟踪结构和映射字段。例如，假设您想要编写以下代码：</p><p>如果：age字段有拼写错误或：age字段尚未定义，编译器将相应失败。但是，如果您编写了以下代码：</p><p>编译器不会捕获缺少的字段，并且只会在运行时引发错误。在1.11版中，Elixir将跟踪同一函数中所有map和struct字段的使用情况，并在上述情况下发出警告：</p><p>警告：表达式：#example.exs：7user.age`中未定义的字段`age`需要以下字段之一：name，address，where&#34；user&#34；在：#example.exs：7%user{}=userExample.exs：7：Check.drive？/1中被赋予类型%user{}=userConflict</p><p>编译器还检查二进制构造函数。考虑到您必须使用基于长度的编码通过线路发送字符串，其中字符串的前缀是其长度，最高可达4MBs。您的初始尝试可能如下所示：</p><p>但是，上面的代码有一个错误。除非另有说明，否则在&lt；&lt；&gt；&gt；之间给出的每个段必须是整数。对于Elixir v1.11，编译器会告诉您：</p><p>警告：不兼容的类型：表达式中的&lt；&lt；byte_size(string)：：integer()-size(32)，()！~INTEGER()，其中&#34；String&#34；在：#foo.exs：4&lt；&lt；byte_size(string)：：integer()-size(32)，String&gt；&gt；WHERE&#34；String&#34；中被赋予类型INTEGER()。在：#foo.exs：3IS_BINARY(字符串)中被赋予类型BINARY()提示：除非另有说明，否则假定给予二进制文件的所有表达式都是INTEGER()类型。例如，&lt；&lt；expr&&gt;；&gt；假定&#34；expr&34；是整数。传递修饰符，如&lt；&lt；expr：：Float&gt；&gt；或&lt；&lt；expr：：Binary&gt；&gt；以更改默认行为。foo.exs：4：Check.run_length/1处发现的冲突。</p><p>虽然其中一些警告可以由编译器自动修复，但未来的版本也将跨函数执行这些检查，并可能跨模块执行这些检查，在这些情况下，不需要(也不可能)自动修复。</p><p>Elixir v1.11对编译器跟踪文件依赖关系的方式进行了许多改进，这样，接触一个文件会导致重新编译的文件更少。在以前的版本中，Elixir跟踪三种类型的依赖关系：</p><p>编译时依赖关系-如果A在编译时(如使用宏)依赖于B，则每当B更改时，都会重新编译A。</p><p>结构依赖关系-如果A依赖于B的结构，则每当B的结构定义更改时，都会重新编译A。</p><p>但是，因为依赖关系是可传递的，所以如果A在编译时依赖于B，而B在运行时依赖于C，那么A将在编译时依赖于C。因此，减少编译时依赖项的数量非常重要。</p><p>Config/runtime.exs与Elixir中的任何其他配置文件的工作方式相同。但是，由于config/runtime.exs要在生产系统中运行，在生产系统中我们的Mix构建工具不可用，因此开发人员不能在config/runtime.exs中使用Mix.env()或Mix.target()。相反，它们必须使用已添加到Config模块的新config_env()和config_target()。</p><p>虽然将继续支持config/release ases.exs，但开发人员可以迁移到config/runtime.exs，而不会丢失功能。例如，如下所示的config/release ases.exs文件。</p><p>可以作为config/runtime.exs按原样运行。但是，鉴于config/runtime.exs在所有环境中运行，您可能希望将部分配置限制为：Prod环境：</p><p>如果这两个文件都可用，版本将选择现在首选的config/runtime.exs，而不是config/release ases.exs。</p><p>总而言之，Mix还包括一个名为Mix app.config的新任务。此任务加载所有应用程序并对其进行配置，而不启动它们。每当您编写自己的混合任务时，通常都希望在运行自己的代码之前调用Mix app.start或Mix app.config。哪一个更好取决于您是要运行应用程序还是只希望配置应用程序。</p><p>ELIXIRV1.11添加了IS_STRUCT/2、IS_EXCEPTION/1和IS_EXCEPTION/2保护。它还在卫士中添加了对map.field语法的支持。</p><p>Calendar模块附带一个新的Calendar.strftime/3函数，该函数提供基于strftime格式的日期时间格式。日期模块获得了用于处理周和月的新函数，如Date.start_of_Month/1和Date.end_of_Week/2。最后，所有日历类型都具有与格里高利时间戳相互转换的函数，如Date.from_Gregorian_Days/2和NaveDateTime.to_Gregorian_Second/1。</p><p>最后，为了使前面小节中描述的编译器跟踪改进更具可见性，我们还添加了混合外部参照的新功能。混合外部参照是一项描述项目中文件之间的交叉引用的任务，有助于诊断项目中的大型编译周期。</p><p>请查看安装部分以安装Elixir，并阅读我们的入门指南以了解更多信息。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://elixir-lang.org/blog/2020/10/06/elixir-v1-11-0-released/">https://elixir-lang.org/blog/2020/10/06/elixir-v1-11-0-released/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/灵丹妙药/">#灵丹妙药</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/elixir/">#elixir</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/模块/">#模块</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>