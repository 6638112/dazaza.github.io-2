<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>新型供应链攻击袭击了苹果，微软和其他33家公司 New type of supply-chain attack hit Apple, Microsoft and 33 other companies</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">New type of supply-chain attack hit Apple, Microsoft and 33 other companies<br/>新型供应链攻击袭击了苹果，微软和其他33家公司 </h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2021-02-17 19:20:26</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2021/2/a30442bf1e2c352b58bdd2e6c73b3bfd.jpg"><img src="http://img2.diglog.com/img/2021/2/a30442bf1e2c352b58bdd2e6c73b3bfd.jpg" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>Last week, a researcher demonstrated a new supply-chain attack that executed counterfeit code on networks belonging to some of the biggest companies on the planet, Apple, Microsoft, and Tesla included. Now, fellow researchers are peppering the Internet with copycat packages, with more than 150 of them detected so far.</p><p>上周，一位研究人员演示了一种新的供应链攻击，该攻击在该星球上一些最大的公司（包括Apple，Microsoft和Tesla）所属的网络上执行了伪造代码。现在，其他研究人员正在使用模仿者程序包在Internet上大放异彩，到目前为止，已有150多个此类程序被检测到。</p><p> The technique was  unveiled last Tuesday by security researcher Alex Birsan. His so-called dependency confusion or namespace confusion attack starts by placing malicious code in an official public repository such as NPM, PyPI, or RubyGems. By giving the submissions the same package name as dependencies used by companies such as Apple, Microsoft, Tesla, and 33 other companies, Birsan was able to get these companies to automatically download and install the counterfeit code.</p><p> 该技术由安全研究员亚历克斯·伯桑（Alex Birsan）于上周二揭晓。他所谓的依赖混淆或命名空间混淆攻击始于将恶意代码放置在NPM，PyPI或RubyGems等官方公共存储库中。通过为提交的文件指定与Apple，Microsoft，Tesla和其他33个公司使用的依赖项相同的程序包名称，Birsan能够使这些公司自动下载并安装伪造代码。</p><p>  Dependencies are public code libraries or packages that developers use to add common types of functionality to the software they write. By leveraging the work of thousands of their open source peers, developers are spared the hassle and expense of creating the code themselves. The developer’s code automatically downloads and incorporates the dependency, or any update to it, either from the developer’s local computer or from a public repository.</p><p>  依赖关系是开发人员用来将常见功能类型添加到他们编写的软件中的公共代码库或程序包。通过利用成千上万的开放源代码同行的工作，开发人员可以避免自己创建代码的麻烦和开销。开发人员的代码可以从开发人员的本地计算机或公共存储库中自动下载并合并依赖项或对其的任何更新。</p><p> Birsan scoured Internet forums, JavaScript code, accidentally published internal packages, and other sources to find the names of code dependencies used in software from 35 companies. He then uploaded his own code to NPM, PyPI, or Ruby Gems using the same dependency names. In other words, the researcher was squatting on the authentic package name belonging to the companies. The researcher ended up receiving $130,000 in bug bounties.</p><p> Birsan搜寻了Internet论坛，JavaScript代码，意外发布的内部软件包以及其他来源，以查找35家公司在软件中使用的代码依赖项的名称。然后，他使用相同的依赖项名称将自己的代码上传到NPM，PyPI或Ruby Gems。换句话说，研究人员正在蹲下属于公司的真实包裹名称。研究人员最终获得了13万美元的错误赏金。</p><p> By giving the packages version numbers that were higher than the authentic ones, the targeted companies automatically downloaded and executed Birsan’s counterfeit packages.</p><p> 通过提供比真实版本更高的软件包版本号，目标公司可以自动下载并执行Birsan的假冒软件包。</p><p>     From one-off mistakes made by developers on their own machines, to misconfigured internal or cloud-based build servers, to systemically vulnerable development pipelines, one thing was clear: squatting valid internal package names was a nearly sure-fire method to get into the networks of some of the biggest tech companies out there, gaining remote code execution, and possibly allowing attackers to add backdoors during builds.</p><p>     从开发人员在自己的计算机上犯下的一次性错误，到内部或基于云的构建服务器配置不当，再到系统易受攻击的开发管道，一件事很明显：抢占有效的内部软件包名称几乎是一种肯定的方法。一些最大的科技公司的网络，可以远程执行代码，并且可能允许攻击者在构建过程中添加后门。</p><p> Within two days of Birsan publishing his results, security company Sonatype said last Friday, other developers or researchers had  carried out copycat attacks and put 150 similarly name-squatted packages in NPM.</p><p> 安全公司Sonatype上周五说，在Birsan发布结果的两天内，其他开发人员或研究人员就进行了模仿攻击，并在NPM中放入了150个类似名称的软件包。 </p><p>  Package managers typically accept dependencies listed as names and attempt to parse developers’ intentions. The managers look for dependencies both on the local computer where the project is stored and the Internet-accessible directory belonging to the package manager.</p><p>程序包管理器通常接受列为名称的依赖项，并尝试解析开发人员的意图。管理器在存储项目的本地计算机和程序包管理器的Internet可访问目录上都查找依赖项。</p><p> “The dependency confusion problem is an inherent design flaw in the native installation tools and DevOps workflows that pull dependencies into your software supply chain,” Sonatype researchers wrote in an  earlier writeup on Birsan’s attack. “In this context, dependency confusion refers to the inability of your development environment to distinguish between a private, internally-created present package in your software build, and a package by the same name available in a public software repository.”</p><p> “依赖关系混乱问题是本机安装工具和DevOps工作流程中固有的设计缺陷，这些缺陷将依赖关系拉入您的软件供应链，” Sonatype研究人员在较早的一篇有关Birsan攻击的文章中写道。 “在这种情况下，依赖性混淆是指您的开发环境无法区分软件构建中内部私有创建的当前程序包和公用软件存储库中同名的程序包。”</p><p>  For example, let’s assume your application uses an internal, privately-created PyPI component called foobar (version 1) as a dependency. Later, should an unrelated component by the same name but higher version number foobar (version 9999) be published to the PyPI downloads public repository, the default configuration of PyPI development environments dictates that the foobar with the higher version be downloaded as a dependency.</p><p>  例如，假设您的应用程序使用一个内部私有创建的PyPI组件foobar（版本1）作为依赖项。稍后，如果将同名但版本号更高的foobar（版本9999）的不相关组件发布到PyPI下载公共存储库，则PyPI开发环境的默认配置要求将具有更高版本的foobar作为依赖项下载。</p><p> In this case, that would mean, the attacker’s counterfeit foobar package with a higher version number would silently and automatically make its way into your software build.</p><p> 在这种情况下，这意味着攻击者使用更高版本号的伪造的foobar程序包会在无提示的情况下自动进入您的软件版本。</p><p> So-called  typo-squatting attacks have  existed for years. They upload code into public repositories and use names that are similar to the names of legitimate packages in the hopes a developer will make a typo or click on a malicious link that causes the fake code to be downloaded. The advantage of Birsan’s dependency confusion technique is that it doesn’t rely on human error to work.</p><p> 所谓的错字抢注攻击已经存在多年了。他们将代码上传到公共存储库中，并使用与合法软件包名称相似的名称，以希望开发人员输入错误或单击导致下载伪造代码的恶意链接。 Birsan的依赖关系混淆技术的优点是它不依赖人为错误进行工作。</p><p>    While the affected companies didn’t spot the counterfeit, Sonatype did. After checking with Birsan the company learned that the bogus dependencies were part of a benign experiment.</p><p>    虽然受影响的公司没有发现伪造品，但Sonatype却发现了。与Birsan核对后，该公司得知虚假依赖项是良性实验的一部分。</p><p>  Birsan found that the 35 affected companies used locally stored dependencies that weren’t available in the public directory. When he uploaded his own proof-of-concept malicious code to a public repository using the same name as the legitimate dependency and a higher version number, the companies’ software automatically installed and ran them.</p><p>  Birsan发现，受影响的35家公司使用的是本地存储的依赖项，而公共目录中没有这些依赖项。当他使用与合法依赖相同的名称和更高的版本号将自己的概念验证恶意代码上传到公共存储库时，这些公司的软件会自动安装并运行它们。 </p><p> To keep from running afoul of companies’ vulnerability-reporting policies, Birsan’s code limited its activities to sending the username, hostname, and current patch of each unique installation to the researcher. He also had permission to test the security of all 35 companies, either through public bug bounty programs or private agreements.</p><p>为了避免违反公司的漏洞报告政策，Birsan的代码将其活动限制为向研究人员发送每个唯一安装的用户名，主机名和当前补丁。他还被允许通过公共漏洞赏金计划或私人协议来测试所有35家公司的安全性。</p><p>  To ensure security defenses didn’t block the information from leaving the target company’s network, Birsan’s PoC code hex-encoded the data and sent it in a DNS query. The companies’ failure to block the traffic comes at least four years after the use of DNS exfiltration by malware came to the  attention of researchers. Canadian ecommerce company Shopify automatically installed a Ruby Gem named shopify-cloud within a few hours of Birsan making it available in the Ruby Gems repository. Meanwhile, multiple machines inside Apple’s network executed code Birsan uploaded to NPM. Birsan said the affected Apple projects appeared to be related to Apple ID, the company’s authentication system. Both Shopify and Apple awarded Birsan $30,000 bounties each.</p><p>  为了确保安全防御措施不会阻止信息离开目标公司的网络，Birsan的PoC代码对数据进行了十六进制编码，然后通过DNS查询发送。两家公司未能阻止流量，至少是在恶意软件使用DNS渗透引起研究人员注意的四年之后。加拿大电子商务公司Shopify在Birsan放置在Ruby Gems存储库中的几个小时内，自动安装了一个名为shopify-cloud的Ruby Gem。同时，苹果网络内部的多台计算机执行了Birsan上载的代码，并将其上传到了NPM。 Birsan表示，受影响的Apple项目似乎与该公司的身份验证系统Apple ID有关。 Shopify和Apple都分别向Birsan奖励了30,000美元的赏金。</p><p> Sonatype has a list of steps  here that developers can take to prevent dependency confusion attacks. Chief among the defenses is for repositories to enforce mandatory namespace and scope verification. One verification technique is the reverse use of the fully qualified domain name, which allows rightful owners of a brand or namespace to publish components in that namespace while keeping adversaries out.</p><p> Sonatype在此列出了开发人员可以用来防止依赖关系混淆攻击的步骤列表。防御措施中最主要的是使存储库强制执行强制的名称空间和范围验证。一种验证技术是反向使用完全限定的域名，该域名允许品牌或名称空间的合法所有者在该名称空间中发布组件，同时将对手拒之门外。 </p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://arstechnica.com/information-technology/2021/02/supply-chain-attack-that-fooled-apple-and-microsoft-is-attracting-copycats/">https://arstechnica.com/information-technology/2021/02/supply-chain-attack-that-fooled-apple-and-microsoft-is-attracting-copycats/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/microsoft/">#microsoft</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/攻击/">#攻击</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/分享/">#分享</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>