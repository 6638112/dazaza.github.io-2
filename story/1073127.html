<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Deno简介：它比Node好吗。js？</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script>
<script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Deno简介：它比Node好吗。js？</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2022-02-14 18:46:11</div><div class="page_narrow text-break page_content"><p>Deno是一个类似于toNode的JavaScript和TypeScript运行时。js，基于Rust和V8 JavaScript引擎构建。它由Node的原始发明人瑞安·达尔（Ryan Dahl）创建。js，以弥补他最初设计和发布Node时所犯的错误。早在2009年。</p><p>瑞安&#39；s对Node表示遗憾。js在他著名的&#39；我后悔的十件事。js&#39；2018年在JSConf欧盟大会上发表演讲。总而言之，他哀叹缺乏对安全性的关注，通过node#u模块的模块解析，以及浏览器与#39；除了其他的事情外，他还开始着手解决Deno中的所有这些错误。</p><p>在本文中，我们&#39；我们将讨论为什么要创建Deno，以及它与Node相比的优缺点。js。它&#39；我还将对Deno和#39；的怪癖和特点，这样你就可以决定它是否&#39；It’这很适合你的下一个项目。</p><p>Deno作为一个独立的二进制文件分发，没有任何依赖关系。根据您的操作系统，您可以以各种方式安装Deno。最简单的方法是下载并执行shell脚本，如下所示：</p><p>#Linux和macOS$curl-fsSLhttps://deno.land/x/install/install.sh|sh#Windows PowerShell$iwrhttps://deno.land/x/install/install.ps1-useb | iex</p><p>一旦你&#39；如果已经为您的操作系统执行了相应的命令，DenoCLI二进制文件将下载到您的计算机上。您可能需要将二进制位置添加到路径中，具体取决于您选择的安装方法。</p><p>在Bash中，可以通过将下面的行添加到$HOME/Bash_配置文件中来实现这一点。您可能需要启动一个新的shell会话，以使更改生效。</p><p>要验证Deno的安装版本，请运行以下命令。如果CLI下载成功并添加到您的路径中，它应该将Deno版本打印到控制台。</p><p>如果您的Deno版本过时，可以通过upgrade子命令升级到最新版本：</p><p>$deno升级查找最新版本发现最新版本1.14.2正在检查https://github.com/denoland/deno/releases/download/v1.14.2/deno-x86_64-unknown-linux-gnu.zip31.5 MiB/31.5 MiB（100.0%）Deno正在升级到1.14.2版存档：/tmp/。tmpfdtMXE/deno。拉链充气：deno升级成功</p><p>继续写一个习惯性的hello world程序来验证一切是否正常。您可以为Deno程序创建一个目录，并将以下代码放入索引中。ts文件位于目录&#39；它的根。</p><p>通过向run子命令提供文件名作为参数来保存和执行文件。如果文本为&#34；你好，德诺&#34; 输出，这意味着您已经正确安装和设置了Deno。</p><p>要了解Deno CLI提供的其他功能和选项，请使用--help标志：</p><p>Deno over Node的一大卖点。js是其对TypeScript的一流支持。</p><p>作为你&#39；我已经看过了，你不&#39；除了安装Deno CLI，不需要做任何事情。与它的前身一样，Deno使用V8运行时引擎来解析和执行JavaScript代码，但它也在可执行文件中包含TypeScriptcompiler，以实现对EtypeScript的支持。</p><p>在引擎盖下，检查并编译打字脚本代码。结果JavaScript代码缓存在文件系统的一个目录中，可以在不从头编译的情况下再次执行。您可以使用deno info检查缓存目录和包含deno托管文件的其他目录的位置。</p><p>Deno不需要任何配置来使用TypeScript，但是如果您想调整TypeScript编译器解析代码的方式，可以提供一个配置。您可以提供一个JSON文件来指定TypeScript编译器选项。尽管如此。json是使用独立编译器时的惯例，Deno团队建议使用Deno。json，因为其他特定于Deno的配置选项可以放在那里。</p><p>请注意，Deno没有&#39；不支持所有类型脚本编译器选项。DENO文档中提供了可用选项的完整列表及其默认值。这里&#39；这是Deno的一个示例配置文件：</p><p>在撰写本文时，Deno不会自动检测到Deno。json文件必须通过--config标志指定。不过，该功能计划在未来发布。</p><p>当Deno CLI遇到类型错误时，它会停止脚本的编译，并以非零退出代码终止。您可以通过以下方式绕过该错误：</p><p>Deno还提供了一个--no check标志来禁用类型checkingaltogether。这有助于防止TypeScript编译器在快速迭代问题时拖慢您的速度。</p><p>Deno为自己是JavaScript和TypeScript的安全运行时而自豪。它维护安全的部分方式是通过许可证系统。要演示权限在Deno中的工作方式，请将下面的脚本添加到索引中。ts文件。它&#39；这是一个从疾病中获取最新全球新冠肺炎统计数据的脚本。嘘。</p><p>异步函数getCovidStats（）{try{const response=await fetch（&#34；https://disease.sh/v3/covid-19/all&#34; );    const data=等待响应。json（）；安慰表（数据）；}catch（err）{console.error（err）；}getCovidStats（）；</p><p>$deno运行索引。ts许可被拒绝：需要访问&#34；病sh&#34，使用--allow net标志再次运行</p><p>上面的错误消息表明脚本没有&#39；我没有被授予网络访问权。它建议在命令togrant access中包含--allow net标志。</p><p>$deno run——允许净索引。ts┌────────────────────────┬───────────────┐  │ （idx）│ 价值观│  ├────────────────────────┼───────────────┤  │ 更新│ 1633335683059│  │ 案例│ 235736138│  │ 今天的案子│ 32766│  │ 死亡│ 4816283│  │ 今天的死亡人数│ 670│  │ 恢复│ 212616434│  │ 今天康复了│ 51546│  │ 忙碌的│ 18303421│  │ 批评的│ 86856│  │ 凯斯伯伦埃米利昂│ 30243│  │ 死亡之狮│ 617.9│  │ 测验│ 3716763329│  │ Testsperonemilion│ 473234.63│  │ 人口│ 7853954694│  │ 每人一箱│ 0│  │ 一人一死│ 0│  │ 一人一人│ 0│  │ 百万│ 2330.47│  │ 回收的百万│ 27071.26│  │ 临界百万│ 11.06│  │ 受影响国家│ 223│  └────────────────────────┴───────────────┘</p><p>您可以提供一个由逗号分隔的主机名或IP地址组成的allowlist，作为--allow net的参数，这样脚本就只能访问指定的网站，而不是授予脚本访问所有网站的全面批准（如shownabove所示）。如果脚本试图连接到allowlist中不存在的域，Deno将阻止它连接，脚本执行将失败。</p><p>这是Deno&#39；这是对节点的改进。任何脚本都可以通过网络访问任何资源。对文件系统的读写也存在类似的权限。如果脚本需要执行任一任务，则需要分别指定--allow read和--allow write权限。这两个标志都允许您设置脚本可访问的特定目录，以便文件系统的其他部分不受篡改。Deno还提供了一个--allow all标志，如果需要的话，它可以为脚本启用所有安全敏感函数。</p><p>其中一个是Deno&#39；它的主要目标是尽可能与网络浏览器兼容。这反映在它使用web平台API，而不是为某些操作创建特定于Deno的API。例如，我们在上一节中看到了FetchAPI的运行。这正是浏览器中使用的Fetch API，在需要考虑Deno中独特的安全模型时有一些偏差（这些更改大多无关紧要）。</p><p>Deno管理依赖关系的方式可能是它与Node显著不同的最明显的方式。js。</p><p>节点。js使用包管理器（如npm或Thread）将第三方包从npmregistry下载到node_modules目录和包中。用于跟踪项目的json文件&#39；它的依赖性。Deno摒弃了这些机制，支持以浏览器为中心的第三方软件包使用方式：URL。</p><p>这里&#39；这是一个使用Deno的web应用程序框架Oak创建基本web服务器的示例：</p><p>从&#34导入{Application}；https://deno.land/x/oak/mod.ts&#34; ;    const app=新应用程序（）；应用程序。使用（（ctx）=&gt；{ctx.response.body=&#34；Hello Deno！&#34；}）；应用程序。addEventListener（&#34；listen&#34；，（{hostname，port，secure}）=&gt；{console.log（`监听：http://localhost:${port}`；}）；等待应用程序。收听（{port:8000}）；</p><p>Deno使用ES模块，与web浏览器中使用的模块系统相同。只要引用的脚本导出方法或其他值，就可以从绝对或相对路径导入Amodule。它&#39；值得注意的是，无论是从绝对路径还是相对路径导入，文件扩展名都必须始终存在。</p><p>虽然您可以从任何URL导入模块，但许多专门为Deno构建的第三方模块都是通过Deno缓存的。land/x。每次删除模块的新版本时，它都会自动缓存在该位置，并使其不可变，以便特定版本模块的内容保持不变。</p><p>假设您运行了前面代码段中的代码。在这种情况下，它将下载模块及其所有依赖项，并将它们本地缓存在由DENO_DIR环境变量指定的目录中（默认值应为$HOME/.cache/DENO）。下次程序运行时，将不会下载，因为所有依赖项都已在本地缓存。这与Gomodule系统的工作原理类似。</p><p>$deno run——允许净索引。ts下载https://deno.land/x/oak/mod.ts使用最新版本（v9.0.1）隐式警告https://deno.land/x/oak/mod.ts下载https://deno.land/x/oak@v9。0.1/模。ts。</p><p>对于生产应用程序，Deno的创建者建议通过将依赖项检查到源代码管理中来提供依赖项，以确保连续可用性（即使模块的源代码不可用，无论出于何种原因）。将DENO_DIR环境变量指向项目中的本地目录（例如供应商），您可以将其提交给它。</p><p>例如，下面的命令将下载所有脚本&#39；将依赖项添加到项目中的供应商目录中。随后，您可以提交文件夹，以便在生产服务器中一次将其全部删除。你&#39；ll还需要将DENO_DIR变量设置为从服务器上的供应商目录中读取，而不是重新下载。</p><p>$DENO_DIR=$PWD/供应商DENO缓存索引。ts#Linux和macOS$$env:DENO#u DIR=&#34$（获取位置）\vendor&#34；deno缓存索引。ts#Windows PowerShell</p><p>Deno还支持对依赖项进行版本控制的概念，以确保可生成的构建。目前，我们&#39；我从美国进口橡木https://deno.land/x/oak/mod.ts.它总是下载最新版本，将来可能会与您的程序不兼容。当您第一次下载模块时，它还会导致出现警告：</p><p>如果你&#39；在代码库中的许多文件中重新引用一个模块，升级它可能会变得单调乏味，因为您必须在许多地方更新URL。为了避免这个问题，Deno团队建议在一个集中的deps中导入外部依赖项。ts文件，然后重新导出它们。这里&#39；这是一个样本。ts文件，用于从Oak库导出所需内容。</p><p>此时，更新一个模块就变成了在deps中更改URL的简单问题。ts文件指向新版本。</p><p>Deno提供了一个标准图书馆（stdlib），旨在成为Go和#39的自由港；s标准图书馆。标准库中包含的模块由Deno团队审核，并随Deno的每次发布而更新。提供stdlib的目的是允许您立即创建有用的web应用程序，而无需求助于任何第三方软件包（这是Node.js生态系统中的标准）。</p><p>编码：提供帮助来处理各种文件格式，如XML、CSV、base64、YAML、二进制等。</p><p>这里&#39；这是一个使用Deno&#39；s stdlib创建基本web服务器：</p><p>从&#34导入{listendserve}；https://deno.land/std@0.109.0/http/server。ts&#34；const addr=&#34；：8080&#34; ;    常量处理程序=（请求：请求）：响应=&gt；{let body=&#34；您的用户代理是：\n\n&#34；body+=request.headers.get（&#34；用户代理&#34；）|&#34;未知&#34；返回新的响应（body，{status:200}）；}；安慰日志（`HTTP Web服务器正在运行。请访问：http://localhost:8080/` );  等待列表并服务（地址、处理程序）；</p><p>请注意，标准库中的模块当前标记为不稳定（如版本号所示）。这意味着您不应该在正式的生产应用程序中依赖它们。</p><p>不可否认的一个主要原因是。js之所以成功，是因为在一个项目中可以下载和使用大量软件包。如果你&#39；如果你正在考虑改用Deno，你可能会想知道你是否&#39；我不得不放弃所有你知道和喜欢的NPM套餐。</p><p>简单的回答是：不。但是如果依赖节点，您可能无法在Deno中使用一些NPM包。js API（尤其是在Deno&#39；s Node.js兼容层不支持特定API的情况下），许多NPM包可以通过esm等CDN在Deno中使用。sh和skypack。开发人员：这两个CDN都将NPM包作为ES模块提供，即使包的作者没有专门针对Deno进行设计，也可以在Deno脚本中使用这些模块。</p><p>要确保Deno能够发现与包关联的类型，请确保添加？使用Skypack时，在程序包URL末尾添加dts后缀&#39；s CDN。这会导致Skypack设置一个X-TypeScript-Types头，这样Deno就可以自动发现与包关联的类型。Esm。默认情况下，shin包含此标题，但您可以通过添加？在包URL的末尾没有checksuffix。</p><p>Deno CLI附带了几个有价值的工具，使开发人员的体验更加愉快。比如节点。js，它附带了一个REPL（Read Evaluate PrintLoop），您可以使用deno REPL访问它。</p><p>它还有一个内置的FileWatcher，可以与它的几个子命令一起使用。例如，您可以通过使用--watch标志将deno run配置为在文件更改后自动重建并重新启动程序。在节点中。这个功能通常是通过一些第三方软件包实现的，比如nodemon。</p><p>$deno run——允许净——观察索引。ts HTTP Web服务器正在运行。请访问：http://localhost:8080/检测到监视程序文件更改！重启！HTTP Web服务器正在运行。请访问：http://localhost:8080/</p><p>使用Deno 1.6，您可以将脚本编译为自包含的可执行文件，而不需要通过compile子命令安装Deno（您可以在Node.js中使用pkg执行相同的操作）。还可以通过--target标志为其他平台生成可执行文件（交叉编译）。编译脚本时，必须指定运行脚本所需的权限。</p><p>请注意，通过这个过程产生的二进制文件非常庞大。在我的测试中，deno compile为一个简单的&#34生成了一个83MB的二进制文件；你好世界&#34；程序然而，Deno团队目前正在研究一种方法，将文件大小减少到更易于管理的程度。</p><p>分发Deno程序的另一种方法是通过bundle子命令将其打包成单个JavaScript文件。该文件包含程序的源代码及其所有依赖项，可以通过deno run执行，如下所示。</p><p>$deno bundle索引。ts索引。捆js支票file:///home/ayo/dev/demo/deno/index.js捆file:///home/ayo/dev/demo/deno/index.js排放&#34；指数捆js&#34；（7.39KB）$deno run——允许使用净索引。捆js HTTP Web服务器正在运行。请访问：http://localhost:8080/</p><p>Deno附带的另外两个很棒的工具是内置linter（Deno-lint）和formatter（Deno-fmt）。在节点中。js生态系统、linting和格式化代码通常分别使用ESLint和Prettier处理。</p><p>使用Deno时，您不再需要安装任何东西或编写配置文件来获取JavaScript、TypeScript和其他支持的文件格式的linting和格式化。</p><p>JavaScript和TypeScript代码都内置了对单元测试的支持。当您运行deno测试时，它会自动检测以_test结尾的任何文件。ts或。测验ts（也支持其他文件扩展名）并执行其中定义的任何测试。</p><p>要编写第一个测试，请创建一个索引测试。ts文件，并用以下代码填充它：</p><p>从&#34导入{assertEquals}；https://deno.land/std@0.109.0/测试/断言。ts&#34；德诺。测试（&#34；乘以两个数字&#34；，（）=&gt；{const ans=2*2；assertEquals（ans，4）；}）；</p><p>Deno提供了Deno。创建单元测试的测试方法。它将测试的名称作为第一个参数。它的第二个参数是测试运行时执行的函数。</p><p>还有第二种风格是用一个object代替两个参数。它支持测试名称和函数的其他属性，以配置测试是否运行或如何运行。</p><p>德诺。测试（{name:&#34；乘以两个数字&#34；，fn（）{const ans=2*2；assertEquals（ans，4）；}，}）；</p><p>assertEquals（）方法来自standardlibrary中的测试模块，它提供了一种轻松检查两个值相等的方法。</p><p>$deno测试将两个数字相乘。。。正常（8ms）测试结果：正常。1人通过；0次失败；0被忽略；测量0；0过滤掉（37毫秒）</p><p>选择编程语言或环境的主要考虑因素之一是它与编辑器和IDE的集成。在Deno 1.6中，向运行时添加了内置语言服务器（Deno lsp），以提供以下功能：</p><p>以及支持语言服务器协议（LSP）的任何编辑器的其他语言智能。您可以在Deno&#39；这是在线医生。</p><p>在本文中，我们&#39；我考虑了Deno运行时的许多方面，以及它的运行方式&#39；这是通过节点进行的升级。js。</p><p>关于Deno及其生态系统还有很多要说的，但这应该是对Node的有益介绍。js开发人员正在考虑一个新项目的Deno。Deno第三方软件包的可用性较低是一个明显的不足之处，因为它&#39；它不像Node那样经过战斗考验。由于年轻，js在现实世界中很受欢迎（Deno 1.0于2020年5月发布）。</p><p>比较节点之间的性能。js和Deno表明他们&#39；在大多数情况下，我们都在同一个大概范围内，尽管这里有一个较少的节点。js表现出了卓越的性能。随着Deno变得更加成熟，测量的差异必然会改善。</p><p>在决定节点之间的连接时。js和Deno，it&#39；记住，Deno提供的一些好处也可以带给Node，这一点也很重要。在第三方软件包的帮助下。所以，如果你对Deno只有一两件事是钦佩的，那么你很可能&#39；我们将能够在inNode上实现类似的结果。js，尽管没有那么完美。</p><p>另外，如果你喜欢这篇文章，请订阅我们的JavaScript魔法列表，每月深入了解更多神奇的JavaScript技巧。</p><p>P.P.S.如果您的节点需要APM。js应用程序，去查看AppSignal APM for Node。js。</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/简介/">#简介</a></button><button type="button" class="btn btn-light my_tag"><a href="/tag/deno/">#deno</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/恶搞/">#恶搞</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/qq/">#qq</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/工具/">#工具</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy;2012-2021 diglog.com </div></div></body></html>