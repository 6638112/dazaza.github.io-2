<!doctype html><html lang="zh-hans"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Composer 2.0现已推出</title><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><link rel="stylesheet" href="/img/css.css?random="><link data-rh="true" rel="icon" href="/img/favicon.ico"/><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "https://hm.baidu.com/hm.js?03c1a0f31299b4a2fbb83c34d6beaac9";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script data-ad-client="ca-pub-6067137220025946" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script type="text/javascript" src="https://platform-api.sharethis.com/js/sharethis.js#property=5effb96910009800120b8d4d&product=inline-share-buttons" async="async"></script></head><body><div id="my_header"><div class="container"><nav class="navbar navbar-expand-lg"><a class="navbar-brand" href="/"><img alt="diglog" src="/img/logo.v1.gif" class="rounded-sm"></a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarNavAltMarkup"><div class="navbar-nav"></div></div></nav></div></div><div class="container"><div id="my_content"><h1 class="page_narrow">Composer 2.0现已推出</h1><div class="row"><div class="col-lg-12 col-12"><div class="my_story_list_item shadow p-3 mb-5 bg-white rounded"><div class="story_page_pub_time page_narrow">2020-10-25 03:09:30</div><div class="story_img_container"><a href="http://img2.diglog.com/img/2020/10/1daaf4b53a97708ce91ecbfe960504f8.png"><img src="http://img2.diglog.com/img/2020/10/1daaf4b53a97708ce91ecbfe960504f8.png" class="img-fluid my_story_img" onerror="this.style.display='none'"></a></div><div class="page_narrow text-break page_content"><p>The list of changes and improvements is long, check the  complete changelog if you are interested in reading it all. I will highlight a few key points here.</p><p>更改和改进的列表很长，如果您有兴趣全部阅读，请查看完整的更改日志。我将在这里强调几个关键点。</p><p>  We overhauled pretty much everything from the protocol used between Composer and packagist.org to the dependency resolution, including downloading files in parallel using curl and constraint evaluation optimizations. This leads to massive improvements in terms of both speed and memory usage. The difference depends on your use case, so while I&#39;ve seen reports of improvements of over 50% to both in some projects, I cannot put an exact number on it. But I am sure you will be positively surprised if you haven&#39;t tried Composer 2 yet.</p><p>从Composer和Packagist.org之间使用的协议到依赖项解析，包括使用cURL和约束求值优化并行下载文件，我们对几乎所有内容都进行了全面检查。这在速度和内存使用方面都带来了巨大的改进。不同之处取决于您的用例，所以虽然我在一些项目中看到这两个项目都有超过50%的改进，但我不能给出一个确切的数字。但我相信，如果你还没有尝试过作曲家2，你一定会大吃一惊的。</p><p> As a side note to this,  require/ remove and partial updates are now much faster because Composer will now only load the metadata of the packages which are being changed.</p><p>另外，需要/删除和部分更新现在要快得多，因为Composer现在只加载正在更改的包的元数据。</p><p>   The way dependency updates are done internally was refactored, which, for you, will result in more deterministic updates. The current local state of the vendor directory will not interfere in updates anymore.</p><p>对内部完成依赖项更新的方式进行了重构，对您来说，这将导致更具确定性的更新。供应商目录的当前本地状态将不再干扰更新。</p><p> After an update is complete, the install process is run automatically and it will now execute all network bound operations first - and in parallel if possible. This will avoid leaving you with a half-updated vendor directory if a network error occurs midway through installation.</p><p>更新完成后，安装过程将自动运行，现在它将首先执行所有网络绑定操作-如果可能，还会并行执行。这将避免在安装过程中发生网络错误时留下更新了一半的供应商目录。</p><p>  We added a  platform-check step when  vendor/autoload.php gets initialized which checks the current PHP version/extensions match what is expected by your dependencies and fails hard otherwise.</p><p>我们在初始化Vendor/autoload.php时添加了一个平台检查步骤，该步骤检查当前PHP版本/扩展与您的依赖项期望的版本/扩展是否匹配，否则将严重失败。</p><p> There is a new class,  Composer\InstalledVersions, which is autoloaded in every project and is available at runtime. It allows you to check which packages/versions are present at runtime of your own project.</p><p>有一个新类Composer\InstalledVersions，它会自动加载到每个项目中，并在运行时可用。它允许您检查在您自己的项目运行时存在哪些包/版本。</p><p>  If your code relies on any of these runtime features, you should require  &#34;composer-runtime-api&#34;: &#34;^2.0&#34; in your composer.json. This is a virtual package which is provided by Composer and will make sure people have to use Composer 2.x to install your package.</p><p>如果您的代码依赖于这些运行时功能中的任何一个，则应该在您的Composer.json中要求&#34；Composer-Runtime-API&#34；：&#34；^2.0&#34；。这是一个由Composer提供的虚拟软件包，它将确保人们必须使用Composer 2.x来安装您的软件包。</p><p>  Because things don&#39;t always go the way they&#39;re supposed to, we made sure to improve the error reporting shown to you when dependencies cannot be resolved. It&#39;s hard to give concrete examples here as there are a million ways this can fail but you will hopefully notice that messages are now shorter, clearer and less repetitive.</p><p>因为事情并不总是按照它们应该的方式进行，所以我们确保改进了在无法解决依赖关系时向您显示的错误报告。在这里很难给出具体的例子，因为有一百万种方式可能会失败，但你会很有希望地注意到，现在的信息更短、更清晰、重复性更少。</p><p>  Sometimes it can be useful to upgrade or downgrade a single package to a specific version, perhaps temporarily to test something or wait for a bug fix. You can now run  composer update vendor/package:1.0.* for example (or  1.0.12 or any other version constraint), to run an update of only  vendor/package to a version matching this additional constraint. This will not update your require in composer.json, and it will not mark the lock file out of date.</p><p>有时，将单个软件包升级或降级到特定版本可能很有用，可能是为了临时测试某些东西或等待错误修复。例如，您现在可以运行Composer update vendor/package：1.0.*(或1.0.12或任何其他版本约束)，以便仅将供应商/包更新到与此附加约束匹配的版本。这不会更新Composer.json中的需求，也不会将锁定文件标记为过期。</p><p> If you want to add/restrict a constraint but still do a full update of all dependencies, you can use  update --with vendor/package:1.0.* which will run the update with that additional constraint.</p><p>如果您想要添加/限制约束，但仍然对所有依赖项进行完全更新，您可以使用update--with vendor/package：1.0.*，它将使用该附加约束来运行更新。</p><p>  Our goal is that every Composer user can upgrade smoothly and swiftly. The gains are huge and we want everyone to benefit from them. To achieve that we did a few things:</p><p>我们的目标是让每一位作曲家用户都能顺利、快速地升级。收益是巨大的，我们希望每个人都能从中受益。为了实现这一目标，我们做了几件事：</p><p> composer.lock files are interoperable between versions, so you can upgrade to 2.0 and roll back easily if needed.</p><p>Composer.lock文件可以在不同版本之间互操作，因此您可以升级到2.0并在需要时轻松回滚。</p><p> Most commands and arguments remain the same, and largely what you know about Composer remains true in 2.0.</p><p>大多数命令和参数都保持不变，在2.0中，您对Composer的了解在很大程度上仍然是正确的。</p><p> If you run  composer self-update from 1.x, it will warn you that a new stable major version of Composer is available, and you can use  composer self-update --2 to migrate to it.</p><p>如果您从1.x运行Composer Self-update，它将警告您有一个新的稳定的Composer主版本可用，您可以使用Composer Self-update--2迁移到它。</p><p> Should you encounter issues, you can go back at any time by using  composer self-update --1. Hopefully that will make everyone feel comfortable to experiment with the new release.</p><p>如果您遇到问题，您可以使用Composer Self-update--1随时返回。希望这会让每个人都感到舒服，可以尝试新的版本。</p><p> If you are  installing Composer automatically from the installer script, and wish to remain on Composer 1.x for the time being, you can also pass it a  --1 argument to prevent it from installing Composer 2.0 by default. If you do this please remember and aim to upgrade in a timely manner, as Composer 1.x will not be maintained for very long.</p><p>如果您正在从安装程序脚本自动安装Composer，并且希望暂时使用Composer 1.x，您还可以向其传递--1参数，以阻止其默认安装Composer 2.0。如果您这样做，请记住并以及时升级为目标，因为Composer 1.x的维护时间不会很长。</p><p>   Plugins: This is probably going to be the major source of problems for most people. Plugins need to be updated to support Composer 2, and some of them are not ready, yet. Composer 2 will complain and fail to resolve dependencies if a plugin does not support it, so no need to overthink it, you can try it out and see how it goes.</p><p>插件：对于大多数人来说，这可能是问题的主要来源。插件需要更新以支持Composer 2，其中一些还没有准备好。如果某个插件不支持Composer 2，它会抱怨并无法解决依赖关系，所以不必过多考虑，您可以试一试，看看它的运行情况。</p><p> The new  platform-check feature means that Composer checks the runtime PHP version and available extensions to ensure they match the project dependencies. If a mismatch is found, the autoloader exits with error details to make sure problems are not overlooked. To avoid issues when deploying to production it is recommended to run  composer check-platform-reqs --no-dev with the production PHP process as part of your build or deployment process.</p><p>新的平台检查功能意味着Composer会检查运行时PHP版本和可用的扩展，以确保它们与项目依赖项匹配。如果发现不匹配，自动加载机将退出并显示错误详细信息，以确保不会忽略问题。要避免在部署到生产环境时出现问题，建议在构建或部署过程中运行Composer check-platform-reqs--no-dev和生产PHP过程。</p><p> Repository priority: If a package exists in a higher priority repository, it will now be entirely ignored in lower priority repositories. If you seem to be missing packages when using Composer 2, see  repository priorities docs for details.</p><p>存储库优先级：如果包存在于较高优先级的存储库中，则在较低优先级的存储库中将完全忽略该包。如果您在使用Composer 2时似乎缺少软件包，请参阅存储库优先级文档了解详细信息。</p><p> Invalid PSR-0 / PSR-4 configurations will not autoload anymore in optimized-autoloader mode, as per the warnings introduced in Composer 1.10. Mostly these warnings were for classes that were not meant to autoload anyway so I don&#39;t expect major issues, but it&#39;s safer to clean these up before upgrading.</p><p>根据Composer 1.10中引入的警告，无效的PSR-0/PSR-4配置将不再在优化的自动加载器模式下自动加载。这些警告大多是针对那些本来不打算自动加载的类，所以我不认为会有大问题，但在升级之前清理这些会更安全。</p><p> If you want to know more, I would highly recommend reading the  UPGRADE guide which has multiple sections for end users, plugin authors and Composer repository implementors.</p><p>如果您想了解更多，我强烈建议您阅读升级指南，其中有多个部分面向最终用户、插件作者和Composer存储库实现者。</p><p>  We don&#39;t have a very detailed feature roadmap anymore as 2.0 contains tons of new goodies, but one important thing I want to explain is our PHP version support going forward.</p><p>我们不再有一个非常详细的功能路线图，因为2.0包含了大量的新功能，但是我想解释的一件重要的事情是我们未来对PHP版本的支持。</p><p> As I mentioned above, Composer 2.0 supports PHP 5.3+, which is at this point very outdated and makes the code quite hard to maintain in places. We went through the effort to make sure every Composer user can upgrade to Composer 2, but the plan is to drop support for EOL PHP versions in a future minor release.</p><p>正如我在上面提到的，Composer 2.0支持PHP 5.3+，这在这一点上已经非常过时，并且使得代码很难在某些地方维护。我们努力确保每个Composer用户都能升级到Composer 2，但计划在未来的次要版本中取消对EOL PHP版本的支持。</p><p> Composer 2.1 might still come with PHP 5.3 support, depending on the timeline and which features end up being included, but then at the latest by Composer 2.2 we will drop support for everything older than PHP 7.1.3. According to our stats this allows over 90% of the Composer users to use the latest version, and for the others who are stuck on outdated PHP versions we will keep providing critical bug and security fixes in the 2.0.x or 2.1.x range.</p><p>Composer 2.1可能仍然支持PHP 5.3，这取决于时间线以及最终包含哪些功能，但是最晚到Composer 2.2，我们将放弃对PHP 7.1.3之前的所有内容的支持。根据我们的统计数据，这使得超过90%的Composer用户可以使用最新版本，对于其他坚持使用过时PHP版本的用户，我们将继续提供2.0.x或2.1.x范围内的重要错误和安全修复。</p><p> As for Composer 1.x, it is now more or less EOL. It will also receive critical fixes if anything comes up but the goal for everyone should be to migrate to 2.x as soon as possible.</p><p>至于Composer 1.x，现在或多或少是停产了。如果出现任何问题，它也会收到重要的修复，但每个人的目标应该是尽快迁移到2.x。</p><p>   Finally I want to thank everyone who contributed and helped make this a reality. The 2.0 release represents over 1100 commits from 28 people, 150+ GitHub issues and pull requests, plus everyone who test it, reviewed PRs, etc. It has been a huge effort with the first commits made about two years ago.</p><p>最后，我要感谢每一位为实现这一目标做出贡献和帮助的人。2.0版本包括来自28个人的1100多个提交，150多个GitHub问题和拉请求，加上每个测试它、审查PR等的人。大约两年前的第一次提交是一项巨大的努力。</p><p> I also want to thank all our  Private Packagist customers who helped finance this effort and afforded us the time we spent on all this. We sincerely hope everyone will appreciate the result!</p><p>我还想感谢我们所有的私人包装商客户，他们帮助我们资助了这项工作，并为我们提供了时间来做这一切。我们真诚地希望每个人都能欣赏到这个结果！</p></div><div id="story_share_this"><div class="sharethis-inline-share-buttons"></div></div><div class="text-break sotry_link page_narrow"><a target="_blank" href="https://blog.packagist.com/composer-2-0-is-now-available/">https://blog.packagist.com/composer-2-0-is-now-available/</a></div><div class="story_tags page_narrow"><button type="button" class="btn btn-light my_tag"><a href="/tag/composer/">#composer</a></button></div></div><div class="my_movie_list_item shadow p-3 mb-5 bg-white rounded"><button type="button" class="btn btn-link my_tag"><a href="/tag/web2.0/">#web2.0</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/google/">#google</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/设计/">#设计</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/游戏/">#游戏</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/创意/">#创意</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/apple/">#apple</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/苹果/">#苹果</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/摄影/">#摄影</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/软件/">#软件</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/美国/">#美国</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/iphone/">#iphone</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/图片/">#图片</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/手机/">#手机</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/视频/">#视频</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/广告/">#广告</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/免费/">#免费</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/谷歌/">#谷歌</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/网站/">#网站</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/windows/">#windows</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/微软/">#微软</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/下载/">#下载</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/firefox/">#firefox</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/音乐/">#音乐</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/linux/">#linux</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/blog/">#blog</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/博客/">#博客</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/程序/">#程序</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/艺术/">#艺术</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/web/">#web</a></button><button type="button" class="btn btn-link my_tag"><a href="/tag/wordpress/">#wordpress</a></button></div></div></div><div id="my_footer"><div class=""><a href="/tags/">tags</a> <a href="/users/">users</a></div>&copy; 2020 diglog.com </div></div></body></html>